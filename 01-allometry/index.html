<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>1. Allometry – REDD+ Uncertainty Training</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../02-emission-factors/index.html" rel="next">
<link href="../index.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-49a404399acb846fa9462a115fe112f4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link href="../site_libs/tabwid/tabwid.css" rel="stylesheet">
<script src="../site_libs/tabwid/tabwid.js"></script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<meta property="og:title" content="1. Allometry – REDD+ Uncertainty Training">
<meta property="og:description" content="">
<meta property="og:image" content="index_files/figure-html/unnamed-chunk-22-1.png">
<meta property="og:site_name" content="REDD+ Uncertainty Training">
</head>
<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../01-allometry/index.html"><span class="chapter-title">1. Allometry</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">eBook Layout</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/training-resource/uncertainty" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-allometry/index.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">1. Allometry</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02-emission-factors/index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2. Emission Factors</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-activity-data/index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3. Activity Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04-monte-carlo/index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">4. Monte Carlo</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references/index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../AA-Appendix/glossary-terms.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Glossary of Terms</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../AA-Appendix/additional-reading.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Additional Reading</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title"><strong>Table of Contents</strong></h2>
   
  <ul>
<li>
<a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a>
  <ul class="collapse">
<li><a href="#environment-setup-r" id="toc-environment-setup-r" class="nav-link" data-scroll-target="#environment-setup-r">Environment Setup (R)</a></li>
  <li><a href="#environment-setup-pythonindex-1" id="toc-environment-setup-pythonindex-1" class="nav-link" data-scroll-target="#environment-setup-pythonindex-1"><del>Environment Setup (Python)</del></a></li>
  </ul>
</li>
  <li><a href="#sec-allometry-relationship" id="toc-sec-allometry-relationship" class="nav-link" data-scroll-target="#sec-allometry-relationship">1.1 Allometric Equations</a></li>
  <li>
<a href="#sec-model-selection" id="toc-sec-model-selection" class="nav-link" data-scroll-target="#sec-model-selection">1.2 Model Selection</a>
  <ul class="collapse">
<li><a href="#types-of-equations" id="toc-types-of-equations" class="nav-link" data-scroll-target="#types-of-equations">Types of Equations</a></li>
  <li><a href="#equation-selection" id="toc-equation-selection" class="nav-link" data-scroll-target="#equation-selection">Equation Selection</a></li>
  <li><a href="#biomass-estimations" id="toc-biomass-estimations" class="nav-link" data-scroll-target="#biomass-estimations">Biomass Estimations</a></li>
  <li><a href="#normality-testing" id="toc-normality-testing" class="nav-link" data-scroll-target="#normality-testing">Normality Testing</a></li>
  <li><a href="#bivariate-testing" id="toc-bivariate-testing" class="nav-link" data-scroll-target="#bivariate-testing">Bivariate Testing</a></li>
  </ul>
</li>
  <li>
<a href="#model-optimization" id="toc-model-optimization" class="nav-link" data-scroll-target="#model-optimization">1.3 Model Optimization</a>
  <ul class="collapse">
<li><a href="#sec-log-rationale" id="toc-sec-log-rationale" class="nav-link" data-scroll-target="#sec-log-rationale">Log-Transformation</a></li>
  </ul>
</li>
  <li><a href="#cross-validation" id="toc-cross-validation" class="nav-link" data-scroll-target="#cross-validation">1.4 Cross-Validation</a></li>
  <li>
<a href="#allometric-uncertainty" id="toc-allometric-uncertainty" class="nav-link" data-scroll-target="#allometric-uncertainty">1.5 Allometric Uncertainty</a>
  <ul class="collapse">
<li><a href="#uncertainty-calculation" id="toc-uncertainty-calculation" class="nav-link" data-scroll-target="#uncertainty-calculation">Uncertainty Calculation</a></li>
  <li><a href="#uncertainty-evaluation" id="toc-uncertainty-evaluation" class="nav-link" data-scroll-target="#uncertainty-evaluation">Uncertainty Evaluation</a></li>
  <li><a href="#uncertainty-deductions" id="toc-uncertainty-deductions" class="nav-link" data-scroll-target="#uncertainty-deductions">Uncertainty Deductions</a></li>
  </ul>
</li>
  <li><a href="#reproducible-workflowindex-3" id="toc-reproducible-workflowindex-3" class="nav-link" data-scroll-target="#reproducible-workflowindex-3">1.6 Reproducible Workflow</a></li>
  <li>
<a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a>
  <ul class="collapse">
<li><a href="#key-findings" id="toc-key-findings" class="nav-link" data-scroll-target="#key-findings">Key Findings</a></li>
  <li><a href="#redd-best-practices" id="toc-redd-best-practices" class="nav-link" data-scroll-target="#redd-best-practices">REDD+ Best Practices</a></li>
  <li><a href="#investment-priorities" id="toc-investment-priorities" class="nav-link" data-scroll-target="#investment-priorities">Investment Priorities</a></li>
  <li><a href="#documentation-requirements" id="toc-documentation-requirements" class="nav-link" data-scroll-target="#documentation-requirements">Documentation Requirements</a></li>
  <li><a href="#next-steps" id="toc-next-steps" class="nav-link" data-scroll-target="#next-steps">Next Steps</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/training-resource/uncertainty/edit/main/01-allometry/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/training-resource/uncertainty/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-title">1. Allometry</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="overview" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="overview">Overview</h2>
<p>Allometric equations represent the proportional and scaling relationships between different tree dimensions, such as the relationship between a tree’s diameter and its height, biomass, or crown size. When trees are considered at a population scale, their different dimensions are statistically related through shared ontogenic development patterns <span class="citation" data-cites="gould1966allometry">(<a href="../references/index.html#ref-gould1966allometry" role="doc-biblioref">Gould, 1966</a>)</span>. These relationships remain consistent across tree sizes, from saplings to canopy dominants, when growing under similar conditions <span class="citation" data-cites="king1996allometry archibald2003a bohlman2006allometry dietze2008capturing">(<a href="../references/index.html#ref-archibald2003a" role="doc-biblioref">Archibald &amp; Bond, 2003</a>; <a href="../references/index.html#ref-bohlman2006allometry" role="doc-biblioref">Bohlman &amp; O’Brien, 2006</a>; <a href="../references/index.html#ref-dietze2008capturing" role="doc-biblioref">Dietze et al., 2008</a>; <a href="../references/index.html#ref-king1996allometry" role="doc-biblioref">King, 1996</a>)</span>.</p>
<p>This biological principle underpins REDD+ carbon accounting: allometric equations translate field measurements of diameter at breast height (DBH) into biomass estimates, forming the foundation of emission reduction quantification.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Allometry Investment
</div>
</div>
<div class="callout-body-container callout-body">
<p>Although Section 8 exempts structural allometric uncertainty when models are applied consistently, the choice of which model to apply directly impacts reported uncertainty. Allometry variance is absolute and compounds more dramatically so that model selection determines the magnitude of random error that cannot be exempted downstream. In practical terms, selecting a model with 20% RMSE versus 8% RMSE determines whether your project faces a 6% or 2% carbon credit deduction, representing a difference worth $200k in a 1M tCO<sub>2</sub><sup>-e</sup> project at $5/tonne.</p>
</div>
</div>
<section id="environment-setup-r" class="level3 unnumbered"><h3 class="unnumbered anchored" data-anchor-id="environment-setup-r">Environment Setup (R)</h3>
<div class="cell">
<details class="code-fold"><summary>View Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">easypackages</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/easypackages/man/packages.html">packages</a></span><span class="op">(</span></span>
<span>    <span class="st">"animation"</span>, <span class="st">"BIOMASS"</span>, <span class="st">"cols4all"</span>, <span class="st">"covr"</span>, <span class="st">"cowplot"</span>, <span class="st">"caret"</span>,</span>
<span>  <span class="st">"DescTools"</span>, <span class="st">"dataMaid"</span>, <span class="st">"dplyr"</span>, <span class="st">"FawR"</span>, <span class="st">"ForestToolsRS"</span>, <span class="st">"forestdata"</span>, </span>
<span>  <span class="st">"flextable"</span>, <span class="st">"ggplot2"</span>, <span class="st">"giscoR"</span>, <span class="st">"ggfortify"</span>, <span class="st">"htmltools"</span>, </span>
<span>    <span class="st">"janitor"</span>, <span class="st">"jsonlite"</span>, <span class="st">"lattice"</span>, <span class="st">"leaflet.providers"</span>, <span class="st">"leaflet"</span>, </span>
<span>    <span class="st">"lmtest"</span>, <span class="st">"lwgeom"</span>, <span class="st">"kableExtra"</span>, <span class="st">"kernlab"</span>, <span class="st">"knitr"</span>, <span class="st">"mapedit"</span>, </span>
<span>    <span class="st">"mapview"</span>, <span class="st">"maptiles"</span>, <span class="st">"Mlmetrics"</span>, <span class="st">"ModelMetrics"</span>, <span class="st">"moments"</span>, </span>
<span>    <span class="st">"olsrr"</span>, <span class="st">"openxlsx"</span>, <span class="st">"plotly"</span>, <span class="st">"psych"</span>, <span class="st">"randomForest"</span>, </span>
<span>  <span class="st">"raster"</span>,<span class="st">"RColorBrewer"</span>, <span class="st">"rmarkdown"</span>, <span class="st">"renv"</span>, <span class="st">"reticulate"</span>, </span>
<span>    <span class="st">"s2"</span>, <span class="st">"sf"</span>, <span class="st">"scales"</span>, <span class="st">"sits"</span>,<span class="st">"spdep"</span>, <span class="st">"stars"</span>, <span class="st">"stringr"</span>, </span>
<span>    <span class="st">"terra"</span>, <span class="st">"tmap"</span>, <span class="st">"tmaptools"</span>, <span class="st">"tidymodels"</span>, <span class="st">"tidyverse"</span>, <span class="st">"tidyr"</span>, <span class="st">"tune"</span>,</span>
<span>    <span class="st">"useful"</span>,</span>
<span>  prompt <span class="op">=</span> <span class="cn">F</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="environment-setup-pythonindex-1" class="level3 unnumbered"><h3 class="unnumbered anchored" data-anchor-id="environment-setup-pythonindex-1">
<del>Environment Setup (Python)</del><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>
</h3>
<div class="cell">
<details class="code-fold"><summary>View Code</summary><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Installer prerequisites</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess, sys</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick package install </span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>subprocess.run([sys.executable, <span class="st">"-m"</span>, <span class="st">"pip"</span>, <span class="st">"install"</span>, <span class="st">"--quiet"</span>, <span class="st">"-q"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"contextily"</span>, <span class="st">"folium"</span>, <span class="st">"geopandas"</span>, <span class="st">"kaleido"</span>, <span class="st">"matplotlib"</span>, <span class="st">"numpy"</span>, </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"openpyxl"</span>, <span class="st">"pandas"</span>, <span class="st">"plotly"</span>, <span class="st">"pysal"</span>, <span class="st">"pyproj"</span>, <span class="st">"pingouin"</span>,<span class="st">"rasterio"</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"scikit-learn"</span>, <span class="st">"scipy"</span>, <span class="st">"seaborn"</span>, <span class="st">"statsmodels"</span>, <span class="st">"shapely"</span>, <span class="st">"skimpy"</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"xarray"</span>], check<span class="op">=</span><span class="va">True</span>, capture_output<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Import packages into runtime</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd, numpy <span class="im">as</span> np</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt, seaborn <span class="im">as</span> sns</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px, plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier, RandomForestRegressor</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd, rasterio, folium</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tabulate <span class="im">import</span> tabulate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="sec-allometry-relationship" class="level2"><h2 class="anchored" data-anchor-id="sec-allometry-relationship">1.1 Allometric Equations</h2>
<p>In its broadest sense, allometry describes any linear or non-linear correlation between increases in tree dimensions during ontogenic development <span class="citation" data-cites="picard2012a">(<a href="../references/index.html#ref-picard2012a" role="doc-biblioref">Picard et al., 2012</a>)</span>. A more restrictive definition, originating with <span class="citation" data-cites="huxley1924constant">Huxley (<a href="../references/index.html#ref-huxley1924constant" role="doc-biblioref">1924</a>)</span>, refers specifically to proportional relationships between relative increases in dimensions:</p>
<p>Allometric equations predict aboveground biomass from diameter measurements using species- or biome-specific parameters. Uncertainty compounds from three sources: model selection, parameter estimation, and field measurements. Log-transformation adds complexity through required back-transformation:</p>
<p><span class="math display">\[
\frac{\mathrm{d}B}{B} = a\frac{\mathrm{d}D}{D}
\]</span></p>
<p>which integrates to the power relationship:</p>
<p><span class="math display">\[
AGB = \alpha \times DBH^{\beta}
\]</span></p>
<p>and in logarithmic form:</p>
<p><span class="math display">\[
\ln(AGB) = \ln(\alpha) + \beta \times \ln(DBH) + \epsilon
\]</span></p>
<p>Where:</p>
<ul>
<li>
<code>AGB</code>: Aboveground biomass (kg)</li>
<li>
<code>DBH</code>: Diameter at breast height (cm)</li>
<li>
<code>α</code>, <code>β</code>: Modelling exponents/parameters</li>
<li>
<code>ε</code>: Random error term</li>
</ul>
<p>This power-law form reflects the self-similarity principle observed in tree growth: as trees develop from seedlings to mature individuals, they maintain consistent proportional relationships between their dimensions <span class="citation" data-cites="gould1971geometric">(<a href="../references/index.html#ref-gould1971geometric" role="doc-biblioref">Gould, 1971</a>)</span>. In this framework, the exponent <code>β</code> serves as the allometric coefficient, quantifying how one dimension changes relative to another during growth. For example, if β = 2.5, a 10% increase in diameter corresponds to a 25% increase in biomass. The parameter <code>α</code> is a scaling constant accounting for wood density, architectural form, and other species-specific characteristics.</p>
<p><span class="citation" data-cites="west1997general">West et al. (<a href="../references/index.html#ref-west1997general" role="doc-biblioref">1997</a>)</span> and <span class="citation" data-cites="enquist1999allometric">Enquist et al. (<a href="../references/index.html#ref-enquist1999allometric" role="doc-biblioref">1999</a>)</span> developed an allometric scaling theory based on the “pipe model” <span class="citation" data-cites="shinozaki1964quantitative">(<a href="../references/index.html#ref-shinozaki1964quantitative" role="doc-biblioref">Shinozaki et al., 1964</a>)</span> and physical growth principles. Their framework predicts a universal exponent of <code>β</code> ≈ 2.67 based on biomechanical constraints, tree stability, and hydraulic resistance. While this theoretical exponent has been debated regarding its universality <span class="citation" data-cites="zianis2004simplifying muller2006testing">(<a href="../references/index.html#ref-muller2006testing" role="doc-biblioref">Muller-Landau et al., 2006</a>; <a href="../references/index.html#ref-zianis2004simplifying" role="doc-biblioref">Zianis &amp; Mencuccini, 2004</a>)</span>, it provides a physically grounded benchmark for evaluating empirical equations.</p>
<p>In this chapter, we compare allometry species-specific allometry with biome-generic equations that are more commonly applied in REDD+ programs to demonstrate how uncertainty metrics can inform model selection and impact carbon credit deductions. We adopt the broadest definition of allometry as any correlation between tree dimensions, whether in linear, log-log, power-law, or other functional forms, to examine the following questions:</p>
<ul>
<li>How should uncertainty metrics inform model selection and optimization?</li>
<li>How does allometry uncertainty impacts carbon credit deductions</li>
</ul></section><section id="sec-model-selection" class="level2"><h2 class="anchored" data-anchor-id="sec-model-selection">1.2 Model Selection</h2>
<p>The choice of allometric equation directly determines uncertainty magnitude and carbon credit deductions. This section demonstrates quantitative differences between equation categories using the <code>scbi_stem1</code> dataset from the <a href="https://docs.ropensci.org/allodb/reference/scbi_stem1.html">ForestGEO</a> plot inventory in Front Royal, Virginia. This 25.6-hectare mature secondary forest is dominated by Appalachian mixed hardwood species including tulip poplar (<em>Liriodendron tulipifera</em>), oaks (<em>Quercus spp.</em>), and hickories (<em>Carya spp.</em>), representing typical stand composition of the Blue Ridge and Piedmont regions.</p>
<p>For REDD+ carbon accounting, we tend to focus exclusively on ontogenic allometry to estimate relationships between accessible tree dimensions and total aboveground biomass as trees grow from seedling to maturity. However, some reading of evolutionary allometry is sometimes needed to address differences in specific traits that emerged in localized conditions. For example, the following species share in genus but vary in wood density, branch architecture, and bole form:</p>
<ul>
<li>
<em>Acer rubrum</em> (red maple): Lower density (0.49 g/cm³), faster growth</li>
<li>
<em>Acer saccharum</em> (sugar maple): Higher density (0.63 g/cm³), denser wood</li>
<li>
<em>Acer negundo</em> (box elder): Intermediate density (0.42 g/cm³), different architecture</li>
</ul>
<section id="types-of-equations" class="level3"><h3 class="anchored" data-anchor-id="types-of-equations">Types of Equations</h3>
<p>Allometric equations are classified by taxonomic scope and environmental specificity. In practice, the choice of equation category involves balancing precision, cost, and data availability:</p>
<ol type="1">
<li>Species-Specific Equations: Developed from destructive sampling of target species, providing highest accuracy but limited geographic applicability <span class="citation" data-cites="gonzalez2022allodb">(<a href="../references/index.html#ref-gonzalez2022allodb" role="doc-biblioref">Gonzalez-Akre et al., 2022</a>)</span>. These equations capture species-specific morphometric traits, such as branching architecture and wood density, which influence biomass allocation.</li>
<li>Genus-Specific Equations: Aggregated across multiple species within a genus, offering broader applicability with moderate accuracy <span class="citation" data-cites="jansen1996opbrengsttabellen jenkins2004comprehensive">(<a href="../references/index.html#ref-jansen1996opbrengsttabellen" role="doc-biblioref">Jansen et al., 1996</a>; <a href="../references/index.html#ref-jenkins2004comprehensive" role="doc-biblioref">Jenkins, 2004</a>)</span>. Assumes shared evolutionary heritage produces similar allometric scaling within genera.</li>
<li>Biome-Generic Equations: Most commonly used in REDD+ report, pan-tropical, generic equations fitted across broader geographic regions and biomes, maximizing applicability but potentially introducing bias <span class="citation" data-cites="chave2009towards chave2014improved west1997general brown1997a">(<a href="../references/index.html#ref-brown1997a" role="doc-biblioref">Brown, 1997</a>; <a href="../references/index.html#ref-chave2009towards" role="doc-biblioref">Chave et al., 2009</a>; <a href="../references/index.html#ref-chave2014improved" role="doc-biblioref">Chave et al., 2014</a>; <a href="../references/index.html#ref-west1997general" role="doc-biblioref">West et al., 1997</a>)</span>. Often incorporate wood density (WD) or environmental stress factors to capture regional variation.</li>
<li>Environmentally-Conditioned Equations: Gold-standard allometric models that incorporate biophysical variables reflecting site-specific growing conditions, critical for REDD+ programs in specialized ecosystems <span class="citation" data-cites="rahman2021biomass komiyamaAllometryBiomassProductivity2008 komiyama2005common">(<a href="../references/index.html#ref-komiyama2005common" role="doc-biblioref">Komiyama et al., 2005</a>, <a href="../references/index.html#ref-komiyamaAllometryBiomassProductivity2008" role="doc-biblioref">2008</a>; <a href="../references/index.html#ref-rahman2021biomass" role="doc-biblioref">Rahman et al., 2021</a>)</span>. These equations explicitly model environmental drivers of growth variation:
<ul>
<li>Salinity gradients: Mangrove allometry where salt stress affects growth rate, wood density, and architectural form</li>
<li>Soil fertility: Nutrient availability influencing wood density and height-diameter relationships</li>
<li>Climate: Temperature and precipitation gradients captured through environmental stress factors</li>
<li>Geomorphology: Tidal inundation frequency, elevation, or hydrological regime</li>
</ul>
</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Mangroves Tree Height
</div>
</div>
<div class="callout-body-container callout-body">
<p>In specialized growing environments, such as mangrove habitats, the choice of allometry significantly affects accuracy estimates. For example, <span class="citation" data-cites="rocha2018reducing">Rocha de Souza Pereira et al. (<a href="../references/index.html#ref-rocha2018reducing" role="doc-biblioref">2018</a>)</span> found generic allometries to produce -18% &amp; +14% wider error magins than species-specific equations in Brazilian mangrove forests. To compensate, generic equations incorporate proxies of environmental stress, such as wood density, height-diameter ratios or “stunting”, and species composition.</p>
<p>However, while inclusion of tree height significantly reduces bias in AGB estimates <span class="citation" data-cites="rutishauser2013generic chave2014improved">(<a href="../references/index.html#ref-chave2014improved" role="doc-biblioref">Chave et al., 2014</a>; <a href="../references/index.html#ref-rutishauser2013generic" role="doc-biblioref">Rutishauser et al., 2013</a>)</span>, the accurate measurement of tree height in closed-canopy forests is especially challenging<span class="citation" data-cites="king2011allometry">(<a href="../references/index.html#ref-king2011allometry" role="doc-biblioref">King &amp; Clark, 2011</a>)</span>. Field data with high levels of tree height variance can limit these destructively sampled allometry models. This represents investment opportunity from reducing uncertainty through improved survey technology, such as LiDAR and RADAR <span class="citation" data-cites="feldpausch2011height valbuena2016sensitivity">(<a href="../references/index.html#ref-feldpausch2011height" role="doc-biblioref">Feldpausch et al., 2011</a>; <a href="../references/index.html#ref-valbuena2016sensitivity" role="doc-biblioref">Valbuena et al., 2016</a>)</span>.</p>
</div>
</div>
<section id="data-preparation" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="data-preparation">Data Preparation</h4>
<p>We imported the scbi_stem1 dataset from the allodb package, which contains 2,287 individual tree measurements from the ForestGEO permanent plot at Front Royal, Virginia. The dataset includes 12 families, spanning multiple genera and species (Table 1.1). This taxonomic diversity allows us to demonstrate equation selection across different levels of specificity.</p>
<div class="cell">
<details class="code-fold"><summary>View Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># import dataset from allodb.pkg</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://docs.ropensci.org/allodb/">"allodb"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">scbi_stem1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#scbi_stem1 |&gt; dplyr::group_by(Family) |&gt;</span></span>
<span><span class="co">#   dplyr::summarise(`Tree Families sampled` = n()) |&gt;</span></span>
<span><span class="co">#   flextable::flextable()|&gt; flextable::autofit()</span></span>
<span></span>
<span><span class="va">scbi_stem1</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Family</span>, <span class="va">genus</span>, <span class="va">species</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>`Total Trees (n)` <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html">flextable</a></span><span class="op">(</span><span class="op">)</span><span class="op">|&gt;</span> </span>
<span>    <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/fontsize.html">fontsize</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span>, part <span class="op">=</span> <span class="st">"body"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/fontsize.html">fontsize</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span>, part <span class="op">=</span> <span class="st">"footer"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/set_table_properties.html">set_table_properties</a></span><span class="op">(</span><span class="va">scbi_stem1</span>, layout <span class="op">=</span> <span class="st">"autofit"</span>, width<span class="op">=</span><span class="fl">1</span>, align <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="tabwid">
<style>.cl-9050c6a0{table-layout:auto;width:100%;}.cl-904c5782{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-904c578c{font-family:'Helvetica';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-904e29fe{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-904e29ff{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-904e3ee4{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-904e3eee{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-904e3eef{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-904e3ef8{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-904e3ef9{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-904e3efa{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-9050c6a0">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-904e3ee4"><p class="cl-904e29fe"><span class="cl-904c5782">Family</span></p></th>
<th class="cl-904e3ee4"><p class="cl-904e29fe"><span class="cl-904c5782">genus</span></p></th>
<th class="cl-904e3ee4"><p class="cl-904e29fe"><span class="cl-904c5782">species</span></p></th>
<th class="cl-904e3eee"><p class="cl-904e29ff"><span class="cl-904c5782">Total Trees (n)</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Adoxaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Sambucus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">canadensis</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">20</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Adoxaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Viburnum</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">prunifolium</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">19</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Adoxaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Viburnum</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">recognitum</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">2</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Annonaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Asimina</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">triloba</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">14</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Aquifoliaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Ilex</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">verticillata</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">32</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Betulaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Carpinus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">caroliniana</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">57</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Betulaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Corylus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">americana</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Cannabaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Celtis</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">occidentalis</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">24</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Caprifoliaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Lonicera</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">maackii</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Cornaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Cornus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">florida</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">24</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Elaeagnaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Elaeagnus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">umbellata</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Fabaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Cercis</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">canadensis</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">25</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Fagaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Fagus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">grandifolia</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">27</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Fagaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Quercus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">alba</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">14</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Fagaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Quercus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">michauxii</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Fagaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Quercus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">prinus</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">35</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Fagaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Quercus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">rubra</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">26</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Fagaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Quercus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">velutina</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">8</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Hamamelidaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Hamamelis</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">virginiana</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">107</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Juglandaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Carya</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">cordiformis</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">30</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Juglandaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Carya</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">glabra</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">64</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Juglandaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Carya</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">ovalis</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">16</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Juglandaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Carya</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">sp</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">3</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Juglandaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Carya</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">tomentosa</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">24</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Juglandaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Juglans</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">nigra</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">13</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Lauraceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Lindera</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">benzoin</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">1,201</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Lauraceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Sassafras</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">albidum</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">8</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Magnoliaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Liriodendron</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">tulipifera</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">17</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Malvaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Tilia</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">americana</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">2</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Nyssaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Nyssa</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">sylvatica</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">10</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Oleaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Chionanthus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">virginicus</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">3</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Oleaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Fraxinus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">americana</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">52</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Oleaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Fraxinus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">nigra</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">22</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Oleaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Fraxinus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">pennsylvanica</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Oleaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Fraxinus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">sp</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Platanaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Platanus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">occidentalis</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">6</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Rosaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Amelanchier</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">arborea</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">123</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Rosaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Prunus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">avium</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">6</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Rosaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Prunus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">serotina</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">4</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Rosaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Rosa</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">multiflora</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">151</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Rosaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Rubus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">allegheniensis</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">6</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Rosaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Rubus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">pensilvanicus</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">2</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Rosaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Rubus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">phoenicolasius</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">17</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Sapindaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Acer</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">negundo</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">15</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Sapindaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Acer</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">rubrum</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">17</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Simaroubaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Ailanthus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">altissima</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Ulmaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Ulmus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">americana</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">2</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Ulmaceae</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">Ulmus</span></p></td>
<td class="cl-904e3eef"><p class="cl-904e29fe"><span class="cl-904c578c">rubra</span></p></td>
<td class="cl-904e3ef8"><p class="cl-904e29ff"><span class="cl-904c578c">20</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-904e3ef9"><p class="cl-904e29fe"><span class="cl-904c578c">Ulmaceae</span></p></td>
<td class="cl-904e3ef9"><p class="cl-904e29fe"><span class="cl-904c578c">Ulmus</span></p></td>
<td class="cl-904e3ef9"><p class="cl-904e29fe"><span class="cl-904c578c">sp</span></p></td>
<td class="cl-904e3efa"><p class="cl-904e29ff"><span class="cl-904c578c">12</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>View Code</summary><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">## ----- Python cell ----- ##</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">## ----------------------- ##</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>demo_data_py <span class="op">=</span> pd.read_csv(<span class="st">"./data/scbi_stem1.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Compiling Allometries
</div>
</div>
<div class="callout-body-container callout-body">
<p>Scope permitting, this training would examine a full allometry workflow. Effectively, this which would require repeating the same process below for all genus in our field dataset, incorporating equations per species cumulatively. We provide brief demonstration of how to add each new equations using <code>alldob</code> operations.</p>
</div>
</div>
<p>We filter <code>scbi_stem1</code> to <em>Quercus</em> observations, the largest genus subsample, to compare the scaling impact of generic allometry with subspecies and genus equations. Missing entries are also removed, providing a new sample of 84 stems from the dataset’s total measurements of 2,287 trees.</p>
<ul>
<li>
<code>dbh</code>: Diameter at breast height (cm)</li>
<li>
<code>genus</code>: Taxonomic genus identification</li>
<li>
<code>species</code>: Species epithet</li>
<li>
<code>Family</code>: Taxonomic family classification</li>
</ul>
<p>To demonstrate the comparative analysis, we created two filtered subsets: a genus-level dataset containing all Quercus observations (n=84 stems) and a species-specific subset for Quercus rubra. Missing DBH values were removed to ensure clean input for subsequent allometric calculations. The filtering procedure is detailed in Section 1.6.</p>
<div class="cell">
<details class="code-fold"><summary>View Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Genus-specific subsample of dataset</span></span>
<span><span class="va">scbi_quercus</span> <span class="op">=</span> <span class="va">scbi_stem1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dbh</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Quercus"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Species-specific subsample of dataset</span></span>
<span><span class="va">scbi_quercus_rubra</span> <span class="op">=</span> <span class="va">scbi_stem1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dbh</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Quercus"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"rubra"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid">
<style>.cl-90615844{table-layout:auto;width:100%;}.cl-905df87a{font-family:'Helvetica';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-905f58f0{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-905f58fa{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-905f6a3e{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-905f6a48{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-905f6a49{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-905f6a52{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-905f6a53{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-905f6a54{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-90615844">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-905f6a3e"><p class="cl-905f58f0"><span class="cl-905df87a">Variable</span></p></th>
<th class="cl-905f6a48"><p class="cl-905f58fa"><span class="cl-905df87a">n</span></p></th>
<th class="cl-905f6a48"><p class="cl-905f58fa"><span class="cl-905df87a">mean</span></p></th>
<th class="cl-905f6a48"><p class="cl-905f58fa"><span class="cl-905df87a">sd</span></p></th>
<th class="cl-905f6a48"><p class="cl-905f58fa"><span class="cl-905df87a">median</span></p></th>
<th class="cl-905f6a48"><p class="cl-905f58fa"><span class="cl-905df87a">min</span></p></th>
<th class="cl-905f6a48"><p class="cl-905f58fa"><span class="cl-905df87a">max</span></p></th>
<th class="cl-905f6a48"><p class="cl-905f58fa"><span class="cl-905df87a">skew</span></p></th>
<th class="cl-905f6a48"><p class="cl-905f58fa"><span class="cl-905df87a">kurtosis</span></p></th>
<th class="cl-905f6a48"><p class="cl-905f58fa"><span class="cl-905df87a">se</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-905f6a49"><p class="cl-905f58f0"><span class="cl-905df87a">DBH (cm)</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">84.000</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">27.795</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">20.177</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">25.980</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">1.040</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">83.500</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">0.438</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">-0.719</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">2.202</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-905f6a49"><p class="cl-905f58f0"><span class="cl-905df87a">genus*</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">84.000</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">1.000</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">0.000</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">1.000</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">1.000</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">1.000</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a"></span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a"></span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">0.000</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-905f6a49"><p class="cl-905f58f0"><span class="cl-905df87a">species*</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">84.000</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">3.155</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">1.167</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">3.000</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">1.000</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">5.000</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">-0.568</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">-0.369</span></p></td>
<td class="cl-905f6a52"><p class="cl-905f58fa"><span class="cl-905df87a">0.127</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-905f6a53"><p class="cl-905f58f0"><span class="cl-905df87a">Family*</span></p></td>
<td class="cl-905f6a54"><p class="cl-905f58fa"><span class="cl-905df87a">84.000</span></p></td>
<td class="cl-905f6a54"><p class="cl-905f58fa"><span class="cl-905df87a">1.000</span></p></td>
<td class="cl-905f6a54"><p class="cl-905f58fa"><span class="cl-905df87a">0.000</span></p></td>
<td class="cl-905f6a54"><p class="cl-905f58fa"><span class="cl-905df87a">1.000</span></p></td>
<td class="cl-905f6a54"><p class="cl-905f58fa"><span class="cl-905df87a">1.000</span></p></td>
<td class="cl-905f6a54"><p class="cl-905f58fa"><span class="cl-905df87a">1.000</span></p></td>
<td class="cl-905f6a54"><p class="cl-905f58fa"><span class="cl-905df87a"></span></p></td>
<td class="cl-905f6a54"><p class="cl-905f58fa"><span class="cl-905df87a"></span></p></td>
<td class="cl-905f6a54"><p class="cl-905f58fa"><span class="cl-905df87a">0.000</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>At this stage in the workflow, it helps to quickly scan the range and spread in DBH values. Applied directly, candidate equations can be filtered by min and max dbh values Deviation from the mean provides indicators of the statistical operations needed ahead during equation selection, bias correction, and model optimization. It also informs sample.</p>
<div class="cell">
<details class="code-fold"><summary>View Code</summary><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">## ----- Python cell ----- ##</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">## ----------------------- ##</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>demo_data_py <span class="op">=</span> (</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    demo_data_py</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    .query(<span class="st">'dbh.notna()'</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  .query(<span class="st">'dbh &gt;= 5 &amp; dbh &lt;= 100'</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  .reset_index(drop<span class="op">=</span><span class="va">True</span>) <span class="co"># avoids KeyError</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># tabulate</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>numeric_data <span class="op">=</span> demo_data_py.select_dtypes(include<span class="op">=</span>[np.number])</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>desc_stats <span class="op">=</span> pd.DataFrame({</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'vars'</span>: numeric_data.columns,</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n'</span>: numeric_data.count().values,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mean'</span>: numeric_data.mean().values,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'sd'</span>: numeric_data.std().values,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'median'</span>: numeric_data.median().values,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'min'</span>: numeric_data.<span class="bu">min</span>().values,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max'</span>: numeric_data.<span class="bu">max</span>().values,</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'skew'</span>: numeric_data.skew().values,</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">'kurtosis'</span>: numeric_data.kurtosis().values</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    }).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tabulate(desc_stats, </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>        headers<span class="op">=</span><span class="st">'keys'</span>, </span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>        tablefmt<span class="op">=</span><span class="st">'pipe'</span>, </span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>        showindex<span class="op">=</span><span class="va">False</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="equation-selection" class="level3"><h3 class="anchored" data-anchor-id="equation-selection">Equation Selection</h3>
<p>Following best practices from forest inventory methodology <span class="citation" data-cites="duncansonAbovegroundWoodyBiomass2021">(<a href="../references/index.html#ref-duncansonAbovegroundWoodyBiomass2021" role="doc-biblioref">Duncanson et al., 2021</a>)</span>, equation selection may proceed through the four sequential criteria in order of their priority below:</p>
<ul>
<li>Geographic Proximity: Prioritize equations developed in climates and soil conditions similar to your project area</li>
<li>Taxonomic Specificity: Prefer species-level &gt; genus-level &gt; family-level equations</li>
<li>DBH Range Coverage: Ensure equation applicability spans ≥80% of measured diameter distribution</li>
<li>Sample Size Adequacy: Minimum n=50 trees for species-specific; n&gt;150 for genus-level equations<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>
</li>
</ul>
<p>The allodb equations database contains 570 allometric equations with 47 metadata fields documenting equation provenance, geographic origin, taxonomic scope, DBH range, sample size, and model fitting parameters. Key selection criteria include geographic coordinates (lat/long), equation taxa, allometry specificity (species/genus/family), DBH range (min/max), sample size, and bias correction status. The complete metadata structure is available in Section 1.6.</p>
<div class="cell">
<details class="code-fold"><summary>View Code</summary><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load allometric equations</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(equations)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"equations_metadata"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># display all equation criteria</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(equations)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> Rows<span class="sc">:</span> <span class="dv">570</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> Columns<span class="sc">:</span> <span class="dv">47</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">$</span> ref_id                       <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="st">"barney_1977_bdac"</span>, <span class="st">"baskerville_1966_dmp…</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ equation_id                  &lt;chr&gt; "</span><span class="dv">4</span>b4063<span class="st">", "</span>e2c7c7<span class="st">", "</span>e42e41<span class="st">", "</span><span class="dv">2</span>bc879<span class="st">", "</span>…</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">$</span> equation_allometry           <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="st">"exp(3.63+2.54*log(dbh))"</span>, <span class="st">"exp(0.15+2.48…</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ equation_form                &lt;chr&gt; "</span><span class="fu">exp</span>(a<span class="sc">+</span>b<span class="sc">*</span><span class="fu">log</span>(dbh))<span class="st">", "</span><span class="fu">exp</span>(a<span class="sc">+</span>b<span class="sc">*</span>(<span class="fu">log</span>(dbh))<span class="st">"…</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ dependent_variable           &lt;chr&gt; "</span>Total aboveground biomass<span class="st">", "</span>Total above…</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">$</span> independent_variable         <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="st">"DBH"</span>, <span class="st">"DBH"</span>, <span class="st">"DBH"</span>, <span class="st">"DBH"</span>, <span class="st">"DBH"</span>, <span class="st">"DBH"</span>,…</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">$</span> equation_taxa                <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="st">"Picea mariana"</span>, <span class="st">"Picea glauca"</span>, <span class="st">"Betula"</span>…</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">$</span> allometry_specificity        <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="st">"Species"</span>, <span class="st">"Species"</span>, <span class="st">"Genus"</span>, <span class="st">"Genus"</span>, <span class="st">"…</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ equation_categ               &lt;chr&gt; "</span>sp_spec<span class="st">", "</span>sp_spec<span class="st">", "</span>generic<span class="st">", "</span>generic…</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">$</span> geographic_area              <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="st">"Alaska, USA"</span>, <span class="st">"New Brunswick, Canada"</span>, <span class="st">"…</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ original_coord               &lt;chr&gt; "</span><span class="dv">64</span>\xb0 <span class="dv">45</span><span class="st">', 148</span><span class="sc">\xb0</span><span class="st"> 15'", "</span><span class="dv">47</span>\xb051<span class="st">' N, …</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ lat                          &lt;chr&gt; "65.75", "47.9", "NRA", "NRA", "NRA", "NR…</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ long                         &lt;chr&gt; "-148.25", "-68.3", "NRA", "NRA", "NRA", …</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ elev_m                       &lt;chr&gt; "167-470", "500", "NRA", "NRA", "NRA", "N…</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ geography_notes              &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ mat_C                        &lt;chr&gt; "NI", "2.2", "NRA", "NRA", "NRA", "NRA", …</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ min.temp_C                   &lt;chr&gt; "NI", "NI", "NRA", "NRA", "NRA", "NRA", "…</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ max.temp_C                   &lt;chr&gt; "NI", "NI", "NRA", "NRA", "NRA", "NRA", "…</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ map_mm                       &lt;chr&gt; "NI", "1069", "NRA", "NRA", "NRA", "NRA",…</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ frost_free_period_days       &lt;chr&gt; "NI", "110", "NRA", "NRA", "NRA", "NRA", …</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ climate_notes                &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ stand_age_range_yr           &lt;chr&gt; "51-55 yrs", "35-48 yrs", "NRA", "NRA", "…</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ stand_age_history            &lt;chr&gt; "Recent fires in 1977", "Stand originated…</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ stand_basal_area_m2_ha       &lt;chr&gt; "NI", "NI", "NRA", "NRA", "NRA", "NRA", "…</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ stand_trees_ha               &lt;chr&gt; "NI", "NI", "NRA", "NRA", "NRA", "NRA", "…</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ forest_description           &lt;chr&gt; "Typical lowland and upland stands domina…</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ ecosystem_type               &lt;chr&gt; "Temperate forest", "Boreal forest", "Tem…</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ koppen                       &lt;chr&gt; "Dfc", "Dfb", "Dfb; Cfa", "Dfb; Cfa", "Df…</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ dbh_min_cm                   &lt;chr&gt; "1.5", "2.54", "5", "NRA", "5", "NRA", "5…</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ dbh_max_cm                   &lt;chr&gt; "13", "25.4", "NRA", "NRA", "NRA", "NRA",…</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ sample_size                  &lt;chr&gt; "18", "13", "NRA", "NRA", "NRA", "NRA", "…</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ collection_year              &lt;chr&gt; "1973", "1965", "1971, 1995", "1971, 1995…</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ dbh_units_original           &lt;chr&gt; "cm", "inch", "cm", "cm", "cm", "cm", "cm…</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ dbh_unit_CF                  &lt;chr&gt; "1", "0.393701", "1", "1", "1", "1", "1",…</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ output_units_original        &lt;chr&gt; "g", "lbs", "metric_ton", "m", "metric_to…</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ output_units_CF              &lt;chr&gt; "0.001", "0.453592", "1000", "1", "1000",…</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ allometry_development_method &lt;chr&gt; "harvest", "harvest", "harvest?", "harves…</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ regression_model             &lt;chr&gt; "log-transformed", "log-transformed", NA,…</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ r_squared                    &lt;chr&gt; "0.91", "0.99", "NI", "NI", "NI", "NI", "…</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ other_equations_tested       &lt;chr&gt; "NI", "NI", "NRA", "NRA", "NRA", "NRA", "…</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ log_biomass                  &lt;chr&gt; "1", "1", "1", "0", "1", "0", "1", "0", "…</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ bias_corrected               &lt;chr&gt; "0", "0", NA, NA, NA, NA, NA, NA, NA, NA,…</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ bias_correction_factor       &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ notes_fitting_model          &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ original_equation_id         &lt;chr&gt; "Upland black spruce", NA, NA, NA, NA, NA…</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ original_data_availability   &lt;chr&gt; "NRA", "NRA", "NRA", "NRA", "NRA", "NRA",…</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ equation_notes               &lt;chr&gt; NA, NA, "Proved difficult to obtain origi…</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>Table X: Full list of variables in <code>equations</code> metadata available used in selection criteria using <code>allodb</code> package below.</em></p>
<p><br></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Navigating Databases
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>It is recommend using latitude and longitude variables over the field called <code>geographic_area</code> when filtering <code>allodb</code> database due to entry inconsistencies. This is done below using <code>dplyr</code> SQL. However, once the specific allometric equation is identified, we must re-select it using the <code>allodb</code> native function called <code><a href="https://docs.ropensci.org/allodb/reference/new_equations.html">new_equations()</a></code> and the equation’s ID# <span class="citation" data-cites="allodb">(<a href="../references/index.html#ref-allodb" role="doc-biblioref">Gonzalez-Akre et al., 2025</a>)</span>.</li>
<li>In subsequent cells, we import pan-tropical equations and fit them with values from by Global Wood Density database using the <code>computeAGB()</code> and<code>getWoodDensity()</code> functions from the <code>BIOMASS</code> package <span class="citation" data-cites="BIOMASS-2">(<a href="../references/index.html#ref-BIOMASS-2" role="doc-biblioref">Réjou-Méchain, Tanguy, Piponiot, Chave, &amp; Herault, 2017a</a>)</span>.</li>
</ul>
</div>
</div>
<section id="step-1-geographic-selection" class="level4"><h4 class="anchored" data-anchor-id="step-1-geographic-selection">Step 1: Geographic Selection</h4>
<p>We recommend using latitude and longitude variables over the field called <code>geographic_area</code> when filtering <code>allodb</code> database due to entry inconsistencies. This is done below using <code>dplyr</code> SQL. However, once the specific allometric equation is identified, we must re-select it using the <code>allodb</code> native function called <code><a href="https://docs.ropensci.org/allodb/reference/new_equations.html">new_equations()</a></code> and the equation’s ID# <span class="citation" data-cites="allodb">(<a href="../references/index.html#ref-allodb" role="doc-biblioref">Gonzalez-Akre et al., 2025</a>)</span>.</p>
<p>In subsequent cells, we import pan-tropical equations and fit them with values from by Global Wood Density database using the <code>computeAGB()</code> and<code>getWoodDensity()</code> functions from the <code>BIOMASS</code> package <span class="citation" data-cites="BIOMASS-2">(<a href="../references/index.html#ref-BIOMASS-2" role="doc-biblioref">Réjou-Méchain, Tanguy, Piponiot, Chave, &amp; Herault, 2017a</a>)</span>.</p>
<p>We filtered equations to North America using latitude bounds of 24-72°N and longitude bounds of -168 to -52°W. This geographic constraint ensures climate similarity with our Front Royal, Virginia study site (Cfa - humid subtropical classification). The filter retained 157 equations from the original 570, including equations developed in temperate forests across the eastern United States, southeastern Canada, and Alaska.</p>
<div class="cell">
<details class="code-fold"><summary>View Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Simple North America filter</span></span>
<span><span class="va">eq_region</span> <span class="op">&lt;-</span> <span class="va">equations</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">lat</span><span class="op">)</span>, long <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">long</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">lat</span><span class="op">)</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">long</span><span class="op">)</span>, <span class="va">lat</span> <span class="op">&gt;=</span> <span class="fl">24</span>, <span class="va">lat</span> <span class="op">&lt;=</span> <span class="fl">72</span>, <span class="va">long</span> <span class="op">&gt;=</span> <span class="op">-</span><span class="fl">168</span>, <span class="va">long</span> <span class="op">&lt;=</span> <span class="op">-</span><span class="fl">52</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># tabulate</span></span>
<span><span class="va">show_cols</span>   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ref_id"</span>, <span class="st">"equation_taxa"</span>, <span class="st">"allometry_specificity"</span>, <span class="st">"equation_allometry"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">eq_region</span><span class="op">[</span>, <span class="va">show_cols</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html">flextable</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/fontsize.html">fontsize</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span>, part <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/set_table_properties.html">set_table_properties</a></span><span class="op">(</span>layout <span class="op">=</span> <span class="st">"autofit"</span>, width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="tabwid">
<style>.cl-9076f4a6{table-layout:auto;width:100%;}.cl-9073d1a4{font-family:'Helvetica';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-907523c4{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-90753512{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9075351c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-90753526{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-9076f4a6">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-90753512"><p class="cl-907523c4"><span class="cl-9073d1a4">ref_id</span></p></th>
<th class="cl-90753512"><p class="cl-907523c4"><span class="cl-9073d1a4">equation_taxa</span></p></th>
<th class="cl-90753512"><p class="cl-907523c4"><span class="cl-9073d1a4">allometry_specificity</span></p></th>
<th class="cl-90753512"><p class="cl-907523c4"><span class="cl-9073d1a4">equation_allometry</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-9075351c"><p class="cl-907523c4"><span class="cl-9073d1a4">barney_1977_bdac</span></p></td>
<td class="cl-9075351c"><p class="cl-907523c4"><span class="cl-9073d1a4">Picea mariana</span></p></td>
<td class="cl-9075351c"><p class="cl-907523c4"><span class="cl-9073d1a4">Species</span></p></td>
<td class="cl-9075351c"><p class="cl-907523c4"><span class="cl-9073d1a4">exp(3.63+2.54*log(dbh))</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9075351c"><p class="cl-907523c4"><span class="cl-9073d1a4">baskerville_1966_dmpi</span></p></td>
<td class="cl-9075351c"><p class="cl-907523c4"><span class="cl-9073d1a4">Picea glauca</span></p></td>
<td class="cl-9075351c"><p class="cl-907523c4"><span class="cl-9073d1a4">Species</span></p></td>
<td class="cl-9075351c"><p class="cl-907523c4"><span class="cl-9073d1a4">exp(0.15+2.48*log(dbh))</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9075351c"><p class="cl-907523c4"><span class="cl-9073d1a4">bond-lamberty_2002_aabb</span></p></td>
<td class="cl-9075351c"><p class="cl-907523c4"><span class="cl-9073d1a4">Larix laricina</span></p></td>
<td class="cl-9075351c"><p class="cl-907523c4"><span class="cl-9073d1a4">Species</span></p></td>
<td class="cl-9075351c"><p class="cl-907523c4"><span class="cl-9073d1a4">10^(2.648+0.715*(log10(dbh)))</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9075351c"><p class="cl-907523c4"><span class="cl-9073d1a4">bond-lamberty_2002_aabb</span></p></td>
<td class="cl-9075351c"><p class="cl-907523c4"><span class="cl-9073d1a4">Salix</span></p></td>
<td class="cl-9075351c"><p class="cl-907523c4"><span class="cl-9073d1a4">Genus</span></p></td>
<td class="cl-9075351c"><p class="cl-907523c4"><span class="cl-9073d1a4">10^(2.481+1.19*(log10(dbh)))</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9075351c"><p class="cl-907523c4"><span class="cl-9073d1a4">bridge_1979_fpom</span></p></td>
<td class="cl-9075351c"><p class="cl-907523c4"><span class="cl-9073d1a4">Quercus velutina</span></p></td>
<td class="cl-9075351c"><p class="cl-907523c4"><span class="cl-9073d1a4">Species</span></p></td>
<td class="cl-9075351c"><p class="cl-907523c4"><span class="cl-9073d1a4">exp(-0.34052+2.65803*log(dbh))</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-90753526"><p class="cl-907523c4"><span class="cl-9073d1a4">brown_1976_esbf</span></p></td>
<td class="cl-90753526"><p class="cl-907523c4"><span class="cl-9073d1a4">Juniperus communis</span></p></td>
<td class="cl-90753526"><p class="cl-907523c4"><span class="cl-9073d1a4">Species</span></p></td>
<td class="cl-90753526"><p class="cl-907523c4"><span class="cl-9073d1a4">exp(4.081+2.202*(0.36738 + 0.94932*log(dbh)))</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<details class="code-fold"><summary>View Code</summary><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#flextable::flextable(eq_region[, show_cols]) |&gt; flextable::autofit() # complete list for Appendix</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Equations valid to region: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">nrow</span>(eq_region)))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> Equations valid to region<span class="sc">:</span> <span class="dv">157</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="step-2-taxonomic-selection" class="level4"><h4 class="anchored" data-anchor-id="step-2-taxonomic-selection">Step 2: Taxonomic Selection</h4>
<div class="cell">
<details class="code-fold"><summary>View Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># species-specific equations for all Quercus subspecies of North America </span></span>
<span><span class="va">eq_region_species</span> <span class="op">&lt;-</span> <span class="va">eq_region</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">allometry_specificity</span> <span class="op">==</span> <span class="st">"Species"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"^Quercus"</span>, <span class="va">equation_taxa</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|</span> <span class="co"># Starts with "Quercus"</span></span>
<span>        <span class="op">(</span><span class="va">allometry_specificity</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Genus"</span>, <span class="st">"Family"</span><span class="op">)</span> <span class="op">&amp;</span> </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Quercus"</span>, <span class="va">equation_taxa</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span></span>
<span><span class="co"># genus-specific equations for Quercus populations of North America </span></span>
<span><span class="va">eq_region_genus</span> <span class="op">=</span> <span class="va">eq_region</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">allometry_specificity</span> <span class="op">==</span> <span class="st">"Genus"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"^Quercus"</span>, <span class="va">equation_taxa</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|</span>  <span class="co"># Starts with "Quercus"</span></span>
<span>            <span class="op">(</span><span class="va">allometry_specificity</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Genus"</span>, <span class="st">"Family"</span><span class="op">)</span> <span class="op">&amp;</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Quercus"</span>, <span class="va">equation_taxa</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="op">)</span></span>
<span></span>
<span><span class="co"># tabulate</span></span>
<span><span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html">flextable</a></span><span class="op">(</span><span class="va">eq_region_species</span><span class="op">[</span>, <span class="va">show_cols</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/fontsize.html">fontsize</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span>, part <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/set_table_properties.html">set_table_properties</a></span><span class="op">(</span>layout <span class="op">=</span> <span class="st">"autofit"</span>, width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="tabwid">
<style>.cl-90817552{table-layout:auto;width:100%;}.cl-907e422e{font-family:'Helvetica';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-907f8904{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-907f99b2{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-907f99bc{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-907f99bd{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-90817552">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-907f99b2"><p class="cl-907f8904"><span class="cl-907e422e">ref_id</span></p></th>
<th class="cl-907f99b2"><p class="cl-907f8904"><span class="cl-907e422e">equation_taxa</span></p></th>
<th class="cl-907f99b2"><p class="cl-907f8904"><span class="cl-907e422e">allometry_specificity</span></p></th>
<th class="cl-907f99b2"><p class="cl-907f8904"><span class="cl-907e422e">equation_allometry</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">bridge_1979_fpom</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Quercus velutina</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Species</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">exp(-0.34052+2.65803*log(dbh))</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">chapman_1991_apac</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Quercus rubra</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Species</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">exp(-2.972-0.017*dbh+2.873*(log(dbh)))</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">clark_1986b_wvap</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Quercus alba</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Species</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">1.73738*(dbh^2)^1.33404</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">clark_1986b_wvap</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Quercus alba</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Species</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">1.69511*(dbh^2)^1.33917</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">clark_1986b_wvap</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Quercus coccinea</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Species</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">1.62952*(dbh^2)^1.34103</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">clark_1986b_wvap</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Quercus coccinea</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Species</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">2.94915*(dbh^2)^1.21733</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">clark_1986b_wvap</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Quercus prinus</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Species</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">0.86674*(dbh^2)^1.47585</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">clark_1986b_wvap</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Quercus prinus</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Species</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">3.40602*(dbh^2)^1.19049</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">clark_1986b_wvap</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Quercus rubra</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Species</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">3.06739*(dbh^2)^1.22338</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">clark_1986b_wvap</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Quercus rubra</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Species</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">3.28071*(dbh^2)^1.20936</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">clark_1986b_wvap</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Quercus velutina</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Species</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">1.2927*(dbh^2)^1.36723</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">clark_1986b_wvap</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Quercus velutina</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Species</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">2.5465*(dbh^2)^1.22586</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">martin_1998_aban</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Quercus alba</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Species</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">10^(-1.266+2.613*(log10(dbh)))</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">martin_1998_aban</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Quercus coccinea</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Species</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">10^(-1.283+2.685*(log10(dbh)))</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">martin_1998_aban</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Quercus prinus</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Species</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">10^(-1.587+2.910*(log10(dbh)))</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">martin_1998_aban</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Quercus rubra</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Species</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">10^(-1.259+2.644*(log10(dbh)))</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">perala_1994_abef</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Quercus rubra</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Species</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">0.1335*(dbh^2.422)*((3.706*dbh^0.4932)^0.4389)</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">this_study</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Quercus agrifolia</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">Species</span></p></td>
<td class="cl-907f99bc"><p class="cl-907f8904"><span class="cl-907e422e">24.2*(1-exp(-0.0466*dbh^0.8183))</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-907f99bd"><p class="cl-907f8904"><span class="cl-907e422e">this_study</span></p></td>
<td class="cl-907f99bd"><p class="cl-907f8904"><span class="cl-907e422e">Quercus parvula</span></p></td>
<td class="cl-907f99bd"><p class="cl-907f8904"><span class="cl-907e422e">Species</span></p></td>
<td class="cl-907f99bd"><p class="cl-907f8904"><span class="cl-907e422e">1.8219*dbh^0.6332</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<details class="code-fold"><summary>View Code</summary><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#flextable::flextable(eq_region_genus[, show_cols]) |&gt; flextable::autofit()</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Genus-specific equations valid to region: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">nrow</span>(eq_region_genus)))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> Genus<span class="sc">-</span>specific equations valid to region<span class="sc">:</span> <span class="dv">1</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Species-specific equations valid to region: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">nrow</span>(eq_region_species)))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> Species<span class="sc">-</span>specific equations valid to region<span class="sc">:</span> <span class="dv">19</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="step-3-dbh-matching-selection" class="level4"><h4 class="anchored" data-anchor-id="step-3-dbh-matching-selection">Step 3: DBH Matching Selection</h4>
<div class="cell">
<details class="code-fold"><summary>View Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># filter genus-specific equations by DBH range of field data</span></span>
<span><span class="va">field_dbh_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">dbh</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co"># 1.04 cm</span></span>
<span><span class="va">field_dbh_max</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">dbh</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co"># 83.5 cm</span></span>
<span></span>
<span><span class="va">eq_region_genus_dbh</span> <span class="op">&lt;-</span> <span class="va">eq_region_genus</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    dbh_min_cm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">dbh_min_cm</span><span class="op">)</span>, </span>
<span>    dbh_max_cm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">dbh_max_cm</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dbh_min_cm</span><span class="op">)</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dbh_max_cm</span><span class="op">)</span>,</span>
<span>    <span class="co"># extrapolation of saplings (min=20cm), compensated in Step 5 (risk if high sapling count)</span></span>
<span>    <span class="va">dbh_min_cm</span> <span class="op">&lt;=</span> <span class="va">field_dbh_min</span> <span class="op">*</span> <span class="fl">20</span>, </span>
<span>    <span class="va">dbh_max_cm</span> <span class="op">&gt;=</span> <span class="va">field_dbh_max</span><span class="op">)</span></span>
<span></span>
<span><span class="va">eq_region_species_dbh</span> <span class="op">&lt;-</span> <span class="va">eq_region_species</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    dbh_min_cm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">dbh_min_cm</span><span class="op">)</span>, </span>
<span>    dbh_max_cm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">dbh_max_cm</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dbh_min_cm</span><span class="op">)</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dbh_max_cm</span><span class="op">)</span>,</span>
<span>    <span class="va">dbh_max_cm</span> <span class="op">&gt;=</span> <span class="va">field_dbh_max</span> <span class="op">*</span> <span class="fl">0.7</span><span class="op">)</span> </span>
<span>        <span class="co"># extrapolation of crowns allowed, consider outliers</span></span>
<span></span>
<span><span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html">flextable</a></span><span class="op">(</span><span class="va">eq_region_genus_dbh</span><span class="op">[</span>, <span class="va">show_cols</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/fontsize.html">fontsize</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span>, part <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/set_table_properties.html">set_table_properties</a></span><span class="op">(</span>layout <span class="op">=</span> <span class="st">"autofit"</span>, width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="tabwid">
<style>.cl-9089d6a2{table-layout:auto;width:100%;}.cl-9086ee56{font-family:'Helvetica';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-90882226{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-90883126{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-90883130{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-9089d6a2">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-90883126"><p class="cl-90882226"><span class="cl-9086ee56">ref_id</span></p></th>
<th class="cl-90883126"><p class="cl-90882226"><span class="cl-9086ee56">equation_taxa</span></p></th>
<th class="cl-90883126"><p class="cl-90882226"><span class="cl-9086ee56">allometry_specificity</span></p></th>
<th class="cl-90883126"><p class="cl-90882226"><span class="cl-9086ee56">equation_allometry</span></p></th>
</tr></thead>
<tbody><tr style="overflow-wrap:break-word;">
<td class="cl-90883130"><p class="cl-90882226"><span class="cl-9086ee56">stovall_2018_ibca</span></p></td>
<td class="cl-90883130"><p class="cl-90882226"><span class="cl-9086ee56">Quercus sp.</span></p></td>
<td class="cl-90883130"><p class="cl-90882226"><span class="cl-9086ee56">Genus</span></p></td>
<td class="cl-90883130"><p class="cl-90882226"><span class="cl-9086ee56">exp(-1.5091+2.3237*log(dbh))+0.24</span></p></td>
</tr></tbody>
</table>
</div>
</div>
<details class="code-fold"><summary>View Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html">flextable</a></span><span class="op">(</span><span class="va">eq_region_species_dbh</span><span class="op">[</span>, <span class="va">show_cols</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/fontsize.html">fontsize</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span>, part <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/set_table_properties.html">set_table_properties</a></span><span class="op">(</span>layout <span class="op">=</span> <span class="st">"autofit"</span>, width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="tabwid">
<style>.cl-9091899c{table-layout:auto;width:100%;}.cl-908eb532{font-family:'Helvetica';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-908fded0{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-908fec54{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-908fec55{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-908fec5e{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-9091899c">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-908fec54"><p class="cl-908fded0"><span class="cl-908eb532">ref_id</span></p></th>
<th class="cl-908fec54"><p class="cl-908fded0"><span class="cl-908eb532">equation_taxa</span></p></th>
<th class="cl-908fec54"><p class="cl-908fded0"><span class="cl-908eb532">allometry_specificity</span></p></th>
<th class="cl-908fec54"><p class="cl-908fded0"><span class="cl-908eb532">equation_allometry</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-908fec55"><p class="cl-908fded0"><span class="cl-908eb532">chapman_1991_apac</span></p></td>
<td class="cl-908fec55"><p class="cl-908fded0"><span class="cl-908eb532">Quercus rubra</span></p></td>
<td class="cl-908fec55"><p class="cl-908fded0"><span class="cl-908eb532">Species</span></p></td>
<td class="cl-908fec55"><p class="cl-908fded0"><span class="cl-908eb532">exp(-2.972-0.017*dbh+2.873*(log(dbh)))</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-908fec55"><p class="cl-908fded0"><span class="cl-908eb532">clark_1986b_wvap</span></p></td>
<td class="cl-908fec55"><p class="cl-908fded0"><span class="cl-908eb532">Quercus rubra</span></p></td>
<td class="cl-908fec55"><p class="cl-908fded0"><span class="cl-908eb532">Species</span></p></td>
<td class="cl-908fec55"><p class="cl-908fded0"><span class="cl-908eb532">3.28071*(dbh^2)^1.20936</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-908fec55"><p class="cl-908fded0"><span class="cl-908eb532">martin_1998_aban</span></p></td>
<td class="cl-908fec55"><p class="cl-908fded0"><span class="cl-908eb532">Quercus alba</span></p></td>
<td class="cl-908fec55"><p class="cl-908fded0"><span class="cl-908eb532">Species</span></p></td>
<td class="cl-908fec55"><p class="cl-908fded0"><span class="cl-908eb532">10^(-1.266+2.613*(log10(dbh)))</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-908fec5e"><p class="cl-908fded0"><span class="cl-908eb532">this_study</span></p></td>
<td class="cl-908fec5e"><p class="cl-908fded0"><span class="cl-908eb532">Quercus agrifolia</span></p></td>
<td class="cl-908fec5e"><p class="cl-908fded0"><span class="cl-908eb532">Species</span></p></td>
<td class="cl-908fec5e"><p class="cl-908fded0"><span class="cl-908eb532">24.2*(1-exp(-0.0466*dbh^0.8183))</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<details class="code-fold"><summary>View Code</summary><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Genus-specific equations valid for region, Quercus, &amp; DBH range: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">nrow</span>(eq_region_genus_dbh)))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> Genus<span class="sc">-</span>specific equations valid <span class="cf">for</span> region, Quercus, <span class="sc">&amp;</span> DBH range<span class="sc">:</span> <span class="dv">1</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Specific-specific equations valid for region, Quercus, &amp; DBH range: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">nrow</span>(eq_region_species_dbh)))</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> Specific<span class="sc">-</span>specific equations valid <span class="cf">for</span> region, Quercus, <span class="sc">&amp;</span> DBH range<span class="sc">:</span> <span class="dv">4</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(equations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="step-4-sample-size-selection" class="level4"><h4 class="anchored" data-anchor-id="step-4-sample-size-selection">Step 4: Sample Size Selection</h4>
<p>The required sample size for allometric equation development depends on desired precision and diameter distribution. <span class="citation" data-cites="roxburgh2015guidelines">Roxburgh et al. (<a href="../references/index.html#ref-roxburgh2015guidelines" role="doc-biblioref">2015</a>)</span> demonstrated through Monte Carlo resampling that biomass predictions with a standard deviation within 7.5% of mean demands sample sizes of between 17 and 166, depending on the algorithm employed. Most importantly, stratified sampling across age class or dbh size is critical to improving precision.</p>
<p>Following Roxburgh et al.&nbsp;(2015), we applied a minimum sample size threshold of n ≥ 17 to ensure equations were derived from adequate destructive sampling campaigns. This threshold balances precision requirements (coefficient of variation ≤7.5%) with practical constraints of destructive sampling costs. Stratification across DBH size classes during equation development is equally critical for capturing biomass variance across age cohorts.</p>
<div class="cell">
<details class="code-fold"><summary>View Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">eq_region_genus_dbh_sample</span> <span class="op">&lt;-</span> <span class="va">eq_region_genus_dbh</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">sample_size</span> <span class="op">&gt;=</span> <span class="fl">17</span><span class="op">)</span>  <span class="co"># Minimum for genus-specific equations</span></span>
<span></span>
<span><span class="va">eq_region_species_dbh_sample</span> <span class="op">&lt;-</span> <span class="va">eq_region_species_dbh</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">sample_size</span> <span class="op">&gt;=</span> <span class="fl">17</span><span class="op">)</span>  <span class="co"># Minimum for species-specific equations</span></span>
<span></span>
<span><span class="co"># Display selected equations &amp; tally valid equations remaining</span></span>
<span><span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html">flextable</a></span><span class="op">(</span><span class="va">eq_region_genus_dbh_sample</span><span class="op">[</span>, <span class="va">show_cols</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/fontsize.html">fontsize</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span>, part <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/set_table_properties.html">set_table_properties</a></span><span class="op">(</span>layout <span class="op">=</span> <span class="st">"autofit"</span>, width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="tabwid">
<style>.cl-90996e96{table-layout:auto;width:100%;}.cl-90968abe{font-family:'Helvetica';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9097bf74{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9097cf1e{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9097cf1f{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-90996e96">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-9097cf1e"><p class="cl-9097bf74"><span class="cl-90968abe">ref_id</span></p></th>
<th class="cl-9097cf1e"><p class="cl-9097bf74"><span class="cl-90968abe">equation_taxa</span></p></th>
<th class="cl-9097cf1e"><p class="cl-9097bf74"><span class="cl-90968abe">allometry_specificity</span></p></th>
<th class="cl-9097cf1e"><p class="cl-9097bf74"><span class="cl-90968abe">equation_allometry</span></p></th>
</tr></thead>
<tbody><tr style="overflow-wrap:break-word;">
<td class="cl-9097cf1f"><p class="cl-9097bf74"><span class="cl-90968abe">stovall_2018_ibca</span></p></td>
<td class="cl-9097cf1f"><p class="cl-9097bf74"><span class="cl-90968abe">Quercus sp.</span></p></td>
<td class="cl-9097cf1f"><p class="cl-9097bf74"><span class="cl-90968abe">Genus</span></p></td>
<td class="cl-9097cf1f"><p class="cl-9097bf74"><span class="cl-90968abe">exp(-1.5091+2.3237*log(dbh))+0.24</span></p></td>
</tr></tbody>
</table>
</div>
</div>
<details class="code-fold"><summary>View Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>    </span>
<span><span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html">flextable</a></span><span class="op">(</span><span class="va">eq_region_species_dbh_sample</span><span class="op">[</span>, <span class="va">show_cols</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/fontsize.html">fontsize</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span>, part <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/set_table_properties.html">set_table_properties</a></span><span class="op">(</span>layout <span class="op">=</span> <span class="st">"autofit"</span>, width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="tabwid">
<style>.cl-909fcc0a{table-layout:auto;width:100%;}.cl-909cd2e8{font-family:'Helvetica';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-909e1054{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-909e222e{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-909e2238{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-909e2239{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-909fcc0a">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-909e222e"><p class="cl-909e1054"><span class="cl-909cd2e8">ref_id</span></p></th>
<th class="cl-909e222e"><p class="cl-909e1054"><span class="cl-909cd2e8">equation_taxa</span></p></th>
<th class="cl-909e222e"><p class="cl-909e1054"><span class="cl-909cd2e8">allometry_specificity</span></p></th>
<th class="cl-909e222e"><p class="cl-909e1054"><span class="cl-909cd2e8">equation_allometry</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-909e2238"><p class="cl-909e1054"><span class="cl-909cd2e8">clark_1986b_wvap</span></p></td>
<td class="cl-909e2238"><p class="cl-909e1054"><span class="cl-909cd2e8">Quercus rubra</span></p></td>
<td class="cl-909e2238"><p class="cl-909e1054"><span class="cl-909cd2e8">Species</span></p></td>
<td class="cl-909e2238"><p class="cl-909e1054"><span class="cl-909cd2e8">3.28071*(dbh^2)^1.20936</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-909e2239"><p class="cl-909e1054"><span class="cl-909cd2e8">this_study</span></p></td>
<td class="cl-909e2239"><p class="cl-909e1054"><span class="cl-909cd2e8">Quercus agrifolia</span></p></td>
<td class="cl-909e2239"><p class="cl-909e1054"><span class="cl-909cd2e8">Species</span></p></td>
<td class="cl-909e2239"><p class="cl-909e1054"><span class="cl-909cd2e8">24.2*(1-exp(-0.0466*dbh^0.8183))</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<details class="code-fold"><summary>View Code</summary><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Genus-specific equations meeting all criteria: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">nrow</span>(eq_region_genus_dbh_sample)))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> Genus<span class="sc">-</span>specific equations meeting all criteria<span class="sc">:</span> <span class="dv">1</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Species-specific equations meeting all criteria: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">nrow</span>(eq_region_species_dbh_sample)))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> Species<span class="sc">-</span>specific equations meeting all criteria<span class="sc">:</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid">
<style>.cl-90a824a4{table-layout:auto;width:100%;}.cl-90a4d8b2{font-family:'Helvetica';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-90a633c4{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-90a6449a{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-90a6449b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-90a644a4{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-90a824a4">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-90a6449a"><p class="cl-90a633c4"><span class="cl-90a4d8b2">Criterion</span></p></th>
<th class="cl-90a6449a"><p class="cl-90a633c4"><span class="cl-90a4d8b2">Threshold</span></p></th>
<th class="cl-90a6449a"><p class="cl-90a633c4"><span class="cl-90a4d8b2">Selected_Value</span></p></th>
<th class="cl-90a6449a"><p class="cl-90a633c4"><span class="cl-90a4d8b2">Justification</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-90a6449b"><p class="cl-90a633c4"><span class="cl-90a4d8b2">Geography</span></p></td>
<td class="cl-90a6449b"><p class="cl-90a633c4"><span class="cl-90a4d8b2">North America (24-72°N, -168 to -52°W)</span></p></td>
<td class="cl-90a6449b"><p class="cl-90a633c4"><span class="cl-90a4d8b2">157 equations in region</span></p></td>
<td class="cl-90a6449b"><p class="cl-90a633c4"><span class="cl-90a4d8b2">Climate similarity to Front Royal, VA (Cfa)</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-90a6449b"><p class="cl-90a633c4"><span class="cl-90a4d8b2">Taxonomy</span></p></td>
<td class="cl-90a6449b"><p class="cl-90a633c4"><span class="cl-90a4d8b2">Species &gt; Genus &gt; Family</span></p></td>
<td class="cl-90a6449b"><p class="cl-90a633c4"><span class="cl-90a4d8b2">1 genus-level, 19 species-specific</span></p></td>
<td class="cl-90a6449b"><p class="cl-90a633c4"><span class="cl-90a4d8b2">Species-specific preferred; genus fallback acceptable</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-90a6449b"><p class="cl-90a633c4"><span class="cl-90a4d8b2">DBH Range</span></p></td>
<td class="cl-90a6449b"><p class="cl-90a633c4"><span class="cl-90a4d8b2">≥80% field data coverage</span></p></td>
<td class="cl-90a6449b"><p class="cl-90a633c4"><span class="cl-90a4d8b2">1.0-83.5 cm (field), 11-93 cm (equation)</span></p></td>
<td class="cl-90a6449b"><p class="cl-90a633c4"><span class="cl-90a4d8b2">Minor extrapolation for saplings (&lt;5% biomass)</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-90a644a4"><p class="cl-90a633c4"><span class="cl-90a4d8b2">Sample Size</span></p></td>
<td class="cl-90a644a4"><p class="cl-90a633c4"><span class="cl-90a4d8b2">≥50 (Roxburgh et al. 2015)</span></p></td>
<td class="cl-90a644a4"><p class="cl-90a633c4"><span class="cl-90a4d8b2">n=66 (Stovall 2018)</span></p></td>
<td class="cl-90a644a4"><p class="cl-90a633c4"><span class="cl-90a4d8b2">Meets precision threshold of CV=7.5%</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><em>Table X: Equation Selection Documentation for REDD+ MRV</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td>Attribute</td>
<td>Detail</td>
</tr>
<tr class="even">
<td>Equation Taxa/ID</td>
<td>
<em>Quercus</em> spp. (Genus-level)</td>
</tr>
<tr class="odd">
<td>Biomass Method</td>
<td>Non-destructive estimation using Terrestrial Laser Scanning (TLS) or Terrestrial LiDAR to model tree volume, which was then converted to biomass using published wood density values.</td>
</tr>
<tr class="even">
<td>Geographic Location</td>
<td>Front Royal, Virginia, USA (Smithsonian Conservation Biology Institute, SCBI) at 38.89 N, -78.15W.</td>
</tr>
<tr class="odd">
<td>Empirical Data</td>
<td>The models were developed using 258 non-destructive volume/biomass estimates across 10 dominant hardwood species in this Temperate Mixed Deciduous Forest. The specific equation is a site-specific genus model.</td>
</tr>
<tr class="even">
<td>Rationale for Selection</td>
<td>This equation is the most geographically and ecologically similar candidate. It was developed at the exact same site (SCBI in Virginia) where your sample data is likely sourced (based on <code>allodb.Rmd</code>content). Despite being a genus-level equation for Quercus (not species-specific), the high degree of climate similarity (Cfa/Temperate Forest) and geographic proximity ensures maximum weight will be assigned by the <code>allodb</code> weighting framework, making it the highest priority candidate for Quercus trees at this site.</td>
</tr>
<tr class="odd">
<td>Citation</td>
<td>Stovall, A. E., Anderson-Teixeira, K. J., &amp; Shugart, H. H. (2018). Terrestrial LiDAR-derived non-destructive woody biomass estimates for 10 hardwood species in Virginia.&nbsp;<em>Data in brief</em>, <em>19</em>, 1560-1569</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td>Attribute</td>
<td>Detail</td>
</tr>
<tr class="even">
<td>Equation Taxa/ID</td>
<td>Quercus rubra (Species-level)</td>
</tr>
<tr class="odd">
<td>Biomass Method</td>
<td>Destructive Harvesting (Dimensional Analysis). The traditional method involving felling, weighing, and drying tree components to directly measure biomass.</td>
</tr>
<tr class="even">
<td>Geographic Location</td>
<td>West Virginia, USA (specifically, Monongahela National Forest).</td>
</tr>
<tr class="odd">
<td>Empirical Data</td>
<td>This is a species-specific equation developed explicitly for Northern Red Oak (Quercus rubra). The sample size is typically smaller than meta-analyses but provides high-resolution, direct measurements.</td>
</tr>
<tr class="even">
<td>Rationale for Selection</td>
<td>This equation provides high taxonomic specificity (a perfect species match for Quercus rubra). Although its location (West Virginia) is not as proximate as the Stovall (2018) study, it is still within the same Appalachian/Eastern US Temperate Forest region. It serves as a crucial check and source of high-quality empirical data derived from the gold-standard destructive method. <code>allodb</code> balances its lower geographic proximity with its higher taxonomic specificity and robust methodology, making it the strongest secondary candidate.</td>
</tr>
<tr class="odd">
<td>Citation</td>
<td>Clark, A. (1985). <em>Weight, volume, and physical properties of major hardwood species in the Gulf and Atlantic Coastal Plains</em>&nbsp;(Vol. 250). US Department of Agriculture, Forest Service, Southeastern Forest Experiment Station</td>
</tr>
</tbody>
</table></section><section id="step-5-combining-species-equations" class="level4"><h4 class="anchored" data-anchor-id="step-5-combining-species-equations">Step 5: Combining Species Equations</h4>
<p>The following demonstrates functions for consolidating new filtered allometry equations into one combined database prepared for use in final inventory biomass estimations. For this important task, we recommend the specific functions below from the <code>allodb</code> library that are ensure a weighted approach is applied to synthesizing and candidate equations:</p>
<p>The <code><a href="https://docs.ropensci.org/allodb/reference/weight_allom.html">weight_allom()</a></code> function is responsible for assigning a weight to each candidate equation based on three criteria, determining its influence on the final result:</p>
<ul>
<li>Sample size: Equations derived from varying destructive sampling campaigns (n &gt; 100) receive higher weights.</li>
<li>Taxonomic specificity: Species-specific equations are weighted more heavily than genus-level, which in turn outweigh family-level equations.</li>
<li>Climate similarity: Equations developed from geographically proximate locations with similar temperature and precipitation regimes receive priority.</li>
</ul>
<p>The <code><a href="https://docs.ropensci.org/allodb/reference/resample_agb.html">resample_agb()</a></code> function implements a Monte Carlo resampling procedure to synthesize a robust, synthetic dataset from the weighted equations:</p>
<ul>
<li>Each candidate equation is resampled within its original DBH range.</li>
<li>The number of resampled values for each equation is proportional to its assigned weight.</li>
<li>A default of 10,000 iterations (or 1e4 in the demo) ensures a robust representation of the uncertainty distribution. This process generates a synthetic dataset that reflects the collective information from all weighted equations, spanning the full DBH range observed in the target forest.</li>
</ul>
<p>The <code><a href="https://docs.ropensci.org/allodb/reference/est_params.html">est_params()</a></code> function then uses the synthetic resampled data to fit the following nonlinear power-law model:</p>
<p><span class="math display">\[
AGB = \alpha \ * \ DBH^b  \ + \ \epsilon
\]</span></p>
<p>This process yields the location-specific parameters:</p>
<ul>
<li>⍺ (scaling coefficient): Incorporates local wood density and architectural characteristics.</li>
<li>𝒃 (allometric exponent): Typically ranges from 2.3 to 2.7, reflecting biomechanical constraints.</li>
<li>σ (residual standard deviation): Quantifies the prediction uncertainty for the calibrated equation.</li>
</ul>
<p>The resulting equation is location-specific, informed by broader taxonomic and geographic patterns encoded in the weighted source equations.</p>
<div class="cell">
<details class="code-fold"><summary>View Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># This table includes filtered default Acer equations AND custom new equations.</span></span>
<span><span class="va">eq_tab_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/allodb/reference/new_equations.html">new_equations</a></span><span class="op">(</span></span>
<span>  subset_taxa <span class="op">=</span> <span class="st">"Quercus"</span>,</span>
<span>  new_taxa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Quercus ilex"</span>, <span class="st">"Castanea sativa"</span><span class="op">)</span>,</span>
<span>  new_allometry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0.12*dbh^2.5"</span>, <span class="st">"0.15*dbh^2.7"</span><span class="op">)</span>,</span>
<span>  new_coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">44</span><span class="op">)</span>,</span>
<span>  new_min_dbh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  new_max_dbh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">35</span>, <span class="fl">68</span><span class="op">)</span>,</span>
<span>  new_sample_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">143</span>, <span class="fl">62</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The get_biomass() function internally performs the weighting, resampling,</span></span>
<span><span class="co"># and calibration based on the equations in eq_tab_combined.</span></span>
<span><span class="va">agb_custom_estimate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/allodb/reference/get_biomass.html">get_biomass</a></span><span class="op">(</span></span>
<span>  dbh <span class="op">=</span> <span class="fl">50</span>,</span>
<span>genus <span class="op">=</span> <span class="st">"Quercus"</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"rubrum"</span>,</span>
<span>  coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">78.2</span>, <span class="fl">38.9</span><span class="op">)</span>,</span>
<span>  new_eqtable <span class="op">=</span> <span class="va">eq_tab_combined</span> <span class="co"># Use the consolidated custom table</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the resulting AGB estimate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Estimated AGB using the combined custom table:"</span>, <span class="va">agb_custom_estimate</span>, <span class="st">"kg"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This weighted synthesis approach ensures that geographically proximate, species-specific equations with larger sample sizes exert greater influence on the final calibrated model. The resulting equation incorporates collective information from all weighted candidates while reflecting local wood density and architectural characteristics. Implementation details are provided in Section 1.6.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Allometry Best Practices
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Transparency: Document all criteria and thresholds</li>
<li>Reproducibility: Code-based workflow enables auditing</li>
<li>Bias Reduction: Geographic and taxonomic filtering minimizes systematic errors to species level</li>
<li>Uncertainty Surveillance: Multiple equations enable sensitivity analysis (Section 1.5)</li>
</ul>
</div>
</div>
</section></section><section id="biomass-estimations" class="level3"><h3 class="anchored" data-anchor-id="biomass-estimations">Biomass Estimations</h3>
<p>Having identified candidate species equations, we now compare their aboveground biomass estimates with biome-generic equations <span class="citation" data-cites="chave2014improved brown1997a">(<a href="../references/index.html#ref-brown1997a" role="doc-biblioref">Brown, 1997</a>; <a href="../references/index.html#ref-chave2014improved" role="doc-biblioref">Chave et al., 2014</a>)</span>. Noting their geographic mismatch, we compared these with pan-tropical equations specifically in order to highlight discrepancies in uncertainty and significance of geography to allometric calibrations.</p>
<p>We calculated aboveground biomass for all 84 Quercus stems using five allometric approaches:</p>
<ul>
<li>Species-specific (allodb weighted synthesis): Location-optimized equation incorporating multiple Quercus species equations</li>
<li>Genus-level (Stovall 2018): Site-specific Quercus equation from the same SCBI location</li>
<li>Chave et al.&nbsp;2014 (pan-tropical moist): Generic equation incorporating wood density and environmental stress factors</li>
<li>Chave et al.&nbsp;2005 (pan-tropical): Earlier generic formulation with DBH and wood density</li>
<li>Brown 1997 (tropical): Widely used generic equation based on DBH alone</li>
</ul>
<p>Wood density values were extracted from the Global Wood Density database (Vieilledent et al., 2018) using the BIOMASS package, yielding mean WD = 0.630 g/cm³ for Quercus species (consistent with oak hardwood density). Note that Chave’s 2014 equation’s outputs required unit conversion from Mg to kg (×1000; Chave et al, 2014, Réjou-Méchain, Tanguy, Piponiot, Chave, &amp; Hérault, 2017), while Brown 1997 required division by 100 to match the original scale. These unit conversions are critical for accurate inter-equation comparison (see Section 1.6 for implementation).</p>
<div class="cell">
<details class="code-fold"><summary>View Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># once allometry equation is confirmed, use native allodb to load it</span></span>
<span><span class="va">eq_region_genus_dbh_sample</span> <span class="op">=</span> <span class="fu">allodb</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/allodb/reference/new_equations.html">new_equations</a></span><span class="op">(</span>subset_ids <span class="op">=</span> <span class="st">"a664c1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># species-specific biomass estimates </span></span>
<span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_species</span> <span class="op">&lt;-</span> <span class="fu">allodb</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/allodb/reference/get_biomass.html">get_biomass</a></span><span class="op">(</span></span>
<span>  dbh       <span class="op">=</span> <span class="va">scbi_quercus</span><span class="op">$</span><span class="va">dbh</span>,</span>
<span>  genus     <span class="op">=</span> <span class="va">scbi_quercus</span><span class="op">$</span><span class="va">genus</span>,</span>
<span>  species <span class="op">=</span> <span class="va">scbi_quercus</span><span class="op">$</span><span class="va">species</span>,</span>
<span>  coords    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">78.2</span>, <span class="fl">38.9</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># genus-specific biomass estimates</span></span>
<span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_genus</span> <span class="op">&lt;-</span> <span class="fu">allodb</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/allodb/reference/get_biomass.html">get_biomass</a></span><span class="op">(</span></span>
<span>    dbh         <span class="op">=</span> <span class="va">scbi_quercus</span><span class="op">$</span><span class="va">dbh</span>,</span>
<span>    genus   <span class="op">=</span> <span class="va">scbi_quercus</span><span class="op">$</span><span class="va">genus</span>,</span>
<span>    species <span class="op">=</span> <span class="va">scbi_quercus</span><span class="op">$</span><span class="va">species</span>,</span>
<span>    coords  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">78.2</span>, <span class="fl">38.9</span><span class="op">)</span>,</span>
<span>    new_eqtable <span class="op">=</span> <span class="va">eq_region_genus_dbh_sample</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The following functions from the <code>BIOMASS</code> package <span class="citation" data-cites="BIOMASS">(<a href="../references/index.html#ref-BIOMASS" role="doc-biblioref">Réjou-Méchain, Tanguy, Piponiot, Chave, &amp; Herault, 2017b</a>)</span> require some additional wrangling, specifically to extract values from the Global Wood Density database <span class="citation" data-cites="vieilledent2018new">(<a href="../references/index.html#ref-vieilledent2018new" role="doc-biblioref">Vieilledent et al., 2018</a>)</span> and convert units <span class="citation" data-cites="rejou2017biomass">(<a href="../references/index.html#ref-rejou2017biomass" role="doc-biblioref">Réjou-Méchain, Tanguy, Piponiot, Chave, &amp; Hérault, 2017</a>)</span>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Unit Conversions
</div>
</div>
<div class="callout-body-container callout-body">
<p>Always verify if equations require unit conversions or scaling limiters. For example, the most commonly used allometry equation from Chave et al (2014) requires conversion from milligrams to kilograms, as shown below (<code>* 1000</code>).</p>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>View Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># derive generic estimates using standard equations</span></span>
<span><span class="va">wood_densities</span> <span class="op">&lt;-</span> <span class="fu">BIOMASS</span><span class="fu">::</span><span class="fu"><a href="https://umr-amap.github.io/BIOMASS/reference/getWoodDensity.html">getWoodDensity</a></span><span class="op">(</span></span>
<span>  genus         <span class="op">=</span> <span class="va">scbi_quercus</span><span class="op">$</span><span class="va">genus</span>,</span>
<span>  species   <span class="op">=</span> <span class="va">scbi_quercus</span><span class="op">$</span><span class="va">species</span>,</span>
<span>  stand         <span class="op">=</span> <span class="va">scbi_quercus</span><span class="op">$</span><span class="va">Plot</span><span class="op">)</span></span>
<span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">WD</span> <span class="op">&lt;-</span> <span class="va">wood_densities</span><span class="op">$</span><span class="va">meanWD</span></span>
<span></span>
<span><span class="co"># Chave et al 2014</span></span>
<span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_chave2014</span> <span class="op">&lt;-</span> <span class="fu">BIOMASS</span><span class="fu">::</span><span class="fu"><a href="https://umr-amap.github.io/BIOMASS/reference/computeAGB.html">computeAGB</a></span><span class="op">(</span></span>
<span>  D         <span class="op">=</span> <span class="va">scbi_quercus</span><span class="op">$</span><span class="va">dbh</span>,</span>
<span>  WD        <span class="op">=</span> <span class="va">scbi_quercus</span><span class="op">$</span><span class="va">WD</span>,</span>
<span>  coord <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">78.2</span>, <span class="fl">38.9</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># convert units</span></span>
<span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_chave2014</span> <span class="op">=</span> <span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_chave2014</span> <span class="op">*</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="co"># Chave et al 2005 (MANUAL Fit)</span></span>
<span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_chave2005</span> <span class="op">&lt;-</span> <span class="va">scbi_quercus</span><span class="op">$</span><span class="va">WD</span> <span class="op">*</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.499</span> <span class="op">+</span> <span class="fl">2.148</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">dbh</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fl">0.207</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">dbh</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> </span>
<span>      <span class="fl">0.0281</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">dbh</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Brown et al 1997 (MANUAL Fit)</span></span>
<span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_brown1997</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fl">2.134</span> <span class="op">+</span> <span class="fl">2.53</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">dbh</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_brown1997</span> <span class="op">=</span> <span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_brown1997</span> <span class="op">/</span> <span class="fl">100</span> </span>
<span></span>
<span><span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html">flextable</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/fontsize.html">fontsize</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span>, part <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/set_table_properties.html">set_table_properties</a></span><span class="op">(</span>layout <span class="op">=</span> <span class="st">"autofit"</span>, width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="tabwid">
<style>.cl-957e7c94{table-layout:auto;width:100%;}.cl-95761aae{font-family:'Helvetica';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-95789afe{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-95789b08{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9578b566{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9578b570{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9578b571{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9578b572{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9578b57a{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9578b57b{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-957e7c94">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-9578b566"><p class="cl-95789afe"><span class="cl-95761aae">treeID</span></p></th>
<th class="cl-9578b566"><p class="cl-95789afe"><span class="cl-95761aae">stemID</span></p></th>
<th class="cl-9578b566"><p class="cl-95789afe"><span class="cl-95761aae">dbh</span></p></th>
<th class="cl-9578b570"><p class="cl-95789b08"><span class="cl-95761aae">genus</span></p></th>
<th class="cl-9578b570"><p class="cl-95789b08"><span class="cl-95761aae">species</span></p></th>
<th class="cl-9578b570"><p class="cl-95789b08"><span class="cl-95761aae">Family</span></p></th>
<th class="cl-9578b566"><p class="cl-95789afe"><span class="cl-95761aae">agb_species</span></p></th>
<th class="cl-9578b566"><p class="cl-95789afe"><span class="cl-95761aae">agb_genus</span></p></th>
<th class="cl-9578b566"><p class="cl-95789afe"><span class="cl-95761aae">WD</span></p></th>
<th class="cl-9578b566"><p class="cl-95789afe"><span class="cl-95761aae">agb_chave2014</span></p></th>
<th class="cl-9578b566"><p class="cl-95789afe"><span class="cl-95761aae">agb_chave2005</span></p></th>
<th class="cl-9578b566"><p class="cl-95789afe"><span class="cl-95761aae">agb_brown1997</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,014</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,014</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">8.80</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">alba</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">41.7637958</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">34.6344546</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.6300</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">7.28909988</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">29.9737527</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">20.71693889</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,201</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,201</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">41.72</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">alba</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,290.4913814</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,287.8799035</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.6300</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">369.67536146</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,763.7413271</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,062.32043295</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,158</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,158</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">29.82</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">alba</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">615.5371694</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">590.2328264</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.6300</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">161.46721089</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">748.5947279</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">454.24357825</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,736</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,736</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">44.38</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">alba</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,478.8739694</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,486.7745358</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.6300</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">430.07341800</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,060.0375737</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,242.13345169</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,741</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,741</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1.12</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">alba</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.4437772</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.2879769</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.6300</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.02849730</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.1799659</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.11253976</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,014</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">32,937</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">8.20</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">alba</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">35.7428951</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">29.3933603</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.6300</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6.06737169</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">24.8619475</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">17.32740278</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,109</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,109</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">72.18</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">alba</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,321.0815102</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,602.9666929</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.6300</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,397.59542709</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,762.9023338</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,251.86147125</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,829</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,829</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1.75</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">alba</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1.1869883</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.8122677</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.6300</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.09783959</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.4970427</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.34807328</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,065</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,065</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">66.91</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">alba</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,656.0028342</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,859.5305575</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.6300</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,164.71639683</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">5,643.1934452</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,509.75409893</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,122</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,122</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">26.13</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">alba</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">460.0281377</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">434.2381530</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.6300</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">116.23508795</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">531.5668681</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">325.19741123</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,942</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,942</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">20.04</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">alba</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">256.2896125</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">234.4031792</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.6300</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">59.76904328</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">265.4142731</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">166.18262526</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,832</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,832</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">8.75</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">alba</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">41.2424636</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">34.1789382</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.6300</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">7.18211884</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">29.5246386</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">20.42042603</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,198</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,198</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">18.55</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">alba</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">216.1527538</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">195.8849828</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.6300</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">49.18605136</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">216.5281391</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">136.67671331</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,829</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">32,657</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1.52</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">alba</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.8700448</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5854821</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.6300</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.06641044</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.3579301</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.24369616</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,930</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,930</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">42.89</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">michauxii</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,373.4642682</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,373.3608400</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.6515</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">408.00003593</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,955.3844042</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,139.31864776</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,908</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,908</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">33.74</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">807.5290502</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">786.4119199</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">199.94839362</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">930.5024048</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">620.85681481</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,902</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,902</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">26.56</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">476.4422695</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">451.0228853</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">110.41164268</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">501.7925319</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">338.90772523</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,833</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,833</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">55.13</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,384.4112362</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,461.0519474</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">665.23436471</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,191.5742054</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,150.28497856</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,861</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">32,665</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">31.93</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">715.0795197</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">691.8486167</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">174.45804487</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">807.7462398</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">540.01726667</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,883</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,883</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">16.65</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">170.1313989</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">152.3911925</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">34.12476597</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">147.2521410</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">103.98302468</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,945</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,945</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">7.15</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">26.3798528</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">21.3787654</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3.87114822</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">15.6636024</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">12.25120227</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,841</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">32,661</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3.19</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4.4498892</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3.2776221</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.45567375</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1.9450578</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1.58991841</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,105</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,105</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">38.12</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,056.9294420</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,044.2728542</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">270.14158890</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,270.1903091</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">845.47598474</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">5,006</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">5,006</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">48.12</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,766.6172691</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,794.2757411</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">477.90912983</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,280.9877313</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,524.29234100</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,937</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,937</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">52.78</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,166.0259005</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,224.1461809</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">598.47838912</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,867.4570591</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,925.89207151</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,851</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,851</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">30.39</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">641.2312540</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">616.7790454</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">154.34390938</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">711.2124639</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">476.53310154</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,175</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,175</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1.06</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.3919584</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.2533948</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.02229260</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.1443867</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.09790577</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,759</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,759</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">5.41</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">14.2631279</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">11.1837102</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1.86096287</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">7.5384467</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6.05025214</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,910</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,910</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">24.54</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">400.1816203</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">375.2995279</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">90.62579821</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">408.3704247</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">277.43869296</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,859</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,859</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">47.92</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,750.4667155</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,776.9958375</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">473.08038364</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,257.4804788</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,508.31475695</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,921</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,921</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">49.49</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,879.4324090</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,915.2122960</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">511.74583227</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,445.6803675</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,636.49080317</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,854</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,854</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">23.03</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">347.8876503</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">323.8130771</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">77.30652427</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">345.9194869</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">236.25885900</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,971</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,971</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">44.51</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,487.5100601</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,496.9134623</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">395.04844833</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,877.5514630</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,251.35966700</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,905</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,905</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">19.73</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">247.3597617</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">226.0642853</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">52.41058628</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">230.4819305</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">159.75555463</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,895</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,895</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">33.33</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">786.0488718</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">764.3861533</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">193.99724551</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">901.8064724</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">601.94627008</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,754</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,754</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">53.48</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,229.8789323</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,293.2871922</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">617.94106423</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,962.0057034</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,991.17136355</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,758</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,758</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">29.88</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">617.7416800</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">592.9957612</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">147.99679828</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">680.8237270</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">456.55939093</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,105</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">32,948</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">29.05</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">580.5353679</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">555.4242351</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">137.99733622</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">633.0294522</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">425.15192548</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">5,015</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">32,813</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">30.05</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">625.5183651</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">600.8643974</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">150.09528540</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">690.8666473</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">463.15989790</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,861</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,861</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">47.58</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,723.1965011</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,747.8381802</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">464.93603183</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,217.8303142</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,481.38595772</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,181</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,181</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1.09</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.4168379</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.2703709</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.02409664</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.1534332</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.10506872</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,051</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,051</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">17.43</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">188.2040310</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">169.4956107</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">38.32204684</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">166.2015346</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">116.75267326</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,921</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">32,798</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">45.95</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,595.7024677</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,611.8547626</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">427.01499709</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,033.1946354</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,356.33440775</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,841</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,841</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4.07</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">7.6147833</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">5.7729030</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.87473536</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3.6111657</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2.94481692</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,900</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,900</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">35.01</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">876.0796244</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">856.9104965</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">219.04815032</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,022.7284035</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">681.69558886</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,941</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,941</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">19.88</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">251.5256581</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">230.0777621</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">53.42046148</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">235.1235863</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">162.84629534</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">5,015</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">5,015</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">51.95</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,091.6262859</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,143.7233445</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">575.86234802</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,757.5403004</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,850.18804602</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,754</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">32,644</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">18.79</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">222.1161359</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">201.8240515</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">46.33847538</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">202.6626664</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">141.19494298</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,942</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,942</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">38.24</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,064.2799971</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,051.9267603</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">272.23782635</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,280.3611441</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">852.22575020</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,939</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,939</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">8.42</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">prinus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">37.8310265</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">31.2583034</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5700</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">5.92783459</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">24.1268820</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">18.52780521</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,043</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,043</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">14.43</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">124.3720267</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">109.2846080</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">23.33392646</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">99.0210094</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">72.39828285</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,740</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,740</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">37.50</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,022.9397332</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,005.2332291</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">255.26797929</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,197.0066207</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">811.11705223</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,844</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,844</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4.50</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">9.5099394</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">7.2902273</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1.12427256</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4.5933623</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3.79675072</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,967</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,967</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">59.19</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,800.2155110</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,902.8525462</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">777.41640924</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,730.0673948</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,573.78798878</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">5,996</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">5,996</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2.38</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2.3324680</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1.6595002</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.20318978</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.9240671</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.75774676</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,866</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,866</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">23.28</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">357.2923365</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">332.0392166</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">78.14311997</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">349.5885982</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">242.80150157</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,757</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,757</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">56.39</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,516.2600962</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,593.7251264</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">691.34613971</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,314.0550756</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,276.80465795</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,176</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,176</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">83.50</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">5,982.8500337</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,457.2112247</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,777.37126337</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">8,469.3561623</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,146.83007285</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,961</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,961</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">5.91</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">17.3523140</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">13.7336417</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2.31119112</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">9.3298900</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">7.56659907</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,868</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,868</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">10.05</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">55.9887078</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">47.1558874</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">9.22389498</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">37.8950021</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">28.99109110</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,076</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,076</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">38.59</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,089.6953435</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,074.4330615</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">273.90764662</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,287.3055373</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">872.09861504</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,623</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,623</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">17.00</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">178.5575597</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">159.9381204</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">35.39142453</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">152.8518749</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">109.60243314</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,161</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,161</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">11.30</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">72.5157421</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">61.9200115</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">12.47711209</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">51.7345785</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">39.00074350</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,907</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,907</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">49.98</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,928.0952178</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,959.5606600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">515.70304472</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,462.1753315</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,677.79507251</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,677</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,677</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">38.92</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,110.3616032</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,095.9023318</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">279.70107400</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,315.3901411</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">891.09031354</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,162</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,162</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">50.62</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,982.9908592</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,018.3579262</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">531.92428266</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,540.9789427</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,732.68440736</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,041</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,041</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">9.66</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">51.3068293</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">43.0127640</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">8.32711933</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">34.1164666</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">26.22868617</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,828</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">32,656</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1.04</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.3754286</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.2424244</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.02079709</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.1361149</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.09329937</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,735</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,735</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">40.03</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,181.4363039</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,169.8984836</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">299.70417376</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,412.4159200</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">956.79728404</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,142</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">32,955</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2.37</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2.3109000</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1.6433444</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.20088003</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.9146106</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.74971772</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,873</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,873</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">12.29</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">87.2783294</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">75.2622525</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">15.47986003</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">64.6640393</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">48.23371373</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,864</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,864</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">11.13</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">70.1305321</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">59.7770919</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">11.99996949</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">49.6929365</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">37.53334068</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,031</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,031</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">25.83</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">449.3891747</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">422.7421958</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">101.33350564</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">458.5174382</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">315.83417415</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,142</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,142</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3.72</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6.2485265</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4.6844437</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.67693012</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2.8196238</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2.34562232</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,828</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,828</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1.47</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.8055831</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5417037</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.05433775</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.2945939</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.22392226</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,000</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,000</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">21.84</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">rubra</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">310.3416778</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">286.2581018</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">66.58020151</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">295.7446428</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">206.58251378</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,871</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,871</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">5.79</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">velutina</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">16.5409796</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">13.0944079</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2.18970505</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">8.8423679</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">7.18391557</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">5,010</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">5,010</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">48.71</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">velutina</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,813.7548532</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,845.8072228</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">484.36445811</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,309.8804079</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,572.02086480</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,782</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,782</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">29.62</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">velutina</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">605.4843397</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">581.0757119</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">142.48091704</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">653.9536822</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">446.57525689</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,020</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,020</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">12.18</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">velutina</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">85.2885641</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">73.7063466</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">15.12706577</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">63.1381551</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">47.14895719</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,160</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,160</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">62.59</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">velutina</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,153.0868571</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,305.1052960</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">889.75082893</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,271.3028221</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,964.43542637</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,145</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,145</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">48.15</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">velutina</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,768.0826750</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,796.8758387</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">470.90307235</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,244.4460318</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">1,526.69766645</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,139</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">6,139</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">62.21</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">velutina</span></p></td>
<td class="cl-9578b572"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,111.0191339</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">3,258.6681381</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">876.76558732</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">4,208.8442021</span></p></td>
<td class="cl-9578b571"><p class="cl-95789afe"><span class="cl-95761aae">2,919.11154588</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9578b57a"><p class="cl-95789afe"><span class="cl-95761aae">6,101</span></p></td>
<td class="cl-9578b57a"><p class="cl-95789afe"><span class="cl-95761aae">6,101</span></p></td>
<td class="cl-9578b57a"><p class="cl-95789afe"><span class="cl-95761aae">16.18</span></p></td>
<td class="cl-9578b57b"><p class="cl-95789b08"><span class="cl-95761aae">Quercus</span></p></td>
<td class="cl-9578b57b"><p class="cl-95789b08"><span class="cl-95761aae">velutina</span></p></td>
<td class="cl-9578b57b"><p class="cl-95789b08"><span class="cl-95761aae">Fagaceae</span></p></td>
<td class="cl-9578b57a"><p class="cl-95789afe"><span class="cl-95761aae">159.5534665</span></p></td>
<td class="cl-9578b57a"><p class="cl-95789afe"><span class="cl-95761aae">142.5822436</span></p></td>
<td class="cl-9578b57a"><p class="cl-95789afe"><span class="cl-95761aae">0.5600</span></p></td>
<td class="cl-9578b57a"><p class="cl-95789afe"><span class="cl-95761aae">31.22082197</span></p></td>
<td class="cl-9578b57a"><p class="cl-95789afe"><span class="cl-95761aae">134.1111885</span></p></td>
<td class="cl-9578b57a"><p class="cl-95789afe"><span class="cl-95761aae">96.71639363</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Table 1D: Aboveground biomass estimates derived from five allometry equations of varying scales</p>
</section><section id="normality-testing" class="level3"><h3 class="anchored" data-anchor-id="normality-testing">Normality Testing</h3>
<p>Non-normal distributions violate assumptions of parametric statistics, inflating uncertainty estimates. Identifying the true probability distribution enables appropriate transformations that reduce reported uncertainty—directly reducing carbon credit deductions.</p>
<p>Accurate probability density functions (PDFs) are essential for uncertainty modeling. We assess whether DBH and AGB conform to normal distributions using multiple diagnostic tests:</p>
<ul>
<li>Skewness &amp; Kurtosis: Quantify asymmetry and tail behavior</li>
<li>Shapiro-Wilk test: Formal normality test (p &lt; 0.05 rejects normality)</li>
<li>Wilcoxon test: Non-parametric alternative for median testing</li>
</ul>
<p>Both variables show non-normal distribution with a significant right-skew, violating parametric assumptions and justifying log-transformation in subsequent modeling. Technically, this kind of skew often represents a dataset of many small trees and few large dominants. Statistically, this high positive skewness is confirmed by Shapiro-Wilk test results (p &lt; 0.001) indicating a distribution likely to inflate uncertainty estimates if left untreated.</p>
<div class="cell">
<details class="code-fold"><summary>View Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate skewness and kurtosis for DBH</span></span>
<span><span class="va">dbh_skew</span>        <span class="op">=</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/skewness.html">skewness</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">dbh</span><span class="op">)</span></span>
<span><span class="va">dbh_kurt</span>        <span class="op">=</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/kurtosis.html">kurtosis</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">dbh</span><span class="op">)</span></span>
<span><span class="va">dbh_shapiro</span> <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">dbh</span><span class="op">)</span></span>
<span><span class="va">dbh_wilcox</span>  <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">dbh</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate skewness and kurtosis for each AGB estimate</span></span>
<span><span class="va">agb_species_skew</span>            <span class="op">=</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/skewness.html">skewness</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_species</span><span class="op">)</span></span>
<span><span class="va">agb_species_kurt</span>            <span class="op">=</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/kurtosis.html">kurtosis</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_species</span><span class="op">)</span></span>
<span><span class="va">agb_species_shapiro</span>     <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_species</span><span class="op">)</span></span>
<span><span class="va">agb_species_wilcox</span>      <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_species</span><span class="op">)</span></span>
<span></span>
<span><span class="va">agb_genus_skew</span>              <span class="op">=</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/skewness.html">skewness</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_genus</span><span class="op">)</span></span>
<span><span class="va">agb_genus_kurt</span>              <span class="op">=</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/kurtosis.html">kurtosis</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_genus</span><span class="op">)</span></span>
<span><span class="va">agb_genus_shapiro</span>       <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_genus</span><span class="op">)</span></span>
<span><span class="va">agb_genus_wilcox</span>            <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_genus</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">agb_chave2014_skew</span>      <span class="op">=</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/skewness.html">skewness</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_chave2014</span><span class="op">)</span></span>
<span><span class="va">agb_chave2014_kurt</span>      <span class="op">=</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/kurtosis.html">kurtosis</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_chave2014</span><span class="op">)</span></span>
<span><span class="va">agb_chave2014_shapiro</span> <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_chave2014</span><span class="op">)</span></span>
<span><span class="va">agb_chave2014_wilcox</span>    <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_chave2014</span><span class="op">)</span></span>
<span></span>
<span><span class="va">agb_brown1997_skew</span>      <span class="op">=</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/skewness.html">skewness</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_brown1997</span><span class="op">)</span></span>
<span><span class="va">agb_brown1997_kurt</span>      <span class="op">=</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/kurtosis.html">kurtosis</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_brown1997</span><span class="op">)</span></span>
<span><span class="va">agb_brown1997_shapiro</span> <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_brown1997</span><span class="op">)</span></span>
<span><span class="va">agb_brown1997_wilcox</span>  <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_brown1997</span><span class="op">)</span></span>
<span></span>
<span><span class="va">agb_chave2005_skew</span>      <span class="op">=</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/skewness.html">skewness</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_chave2005</span><span class="op">)</span></span>
<span><span class="va">agb_chave2005_kurt</span>      <span class="op">=</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/kurtosis.html">kurtosis</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_chave2005</span><span class="op">)</span></span>
<span><span class="va">agb_chave2005_shapiro</span> <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_chave2005</span><span class="op">)</span></span>
<span><span class="va">agb_chave2005_wilcox</span>    <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_chave2005</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid">
<style>.cl-95925f2a{table-layout:auto;width:100%;}.cl-958ef394{font-family:'Helvetica';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-958ef39e{font-family:'Helvetica';font-size:9pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-958ef39f{font-family:'Helvetica';font-size:8pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9590581a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-95905824{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-95906954{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9590695e{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9590695f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-95906960{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-95906961{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-95906968{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-95906972{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-95925f2a">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-95906954"><p class="cl-9590581a"><span class="cl-958ef394">Variable</span></p></th>
<th class="cl-9590695e"><p class="cl-95905824"><span class="cl-958ef394">n</span></p></th>
<th class="cl-9590695e"><p class="cl-95905824"><span class="cl-958ef394">Mean...SD</span></p></th>
<th class="cl-9590695e"><p class="cl-95905824"><span class="cl-958ef394">Skewness</span></p></th>
<th class="cl-9590695e"><p class="cl-95905824"><span class="cl-958ef394">Kurtosis</span></p></th>
<th class="cl-9590695e"><p class="cl-95905824"><span class="cl-958ef394">Shapiro.Wilk.p</span></p></th>
<th class="cl-95906954"><p class="cl-9590581a"><span class="cl-958ef394">Decision</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-9590695f"><p class="cl-9590581a"><span class="cl-958ef394">DBH (cm)</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">84</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">27.8 ± 20.2</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">0.45</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">2.34</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">0.002</span></p></td>
<td class="cl-9590695f"><p class="cl-9590581a"><span class="cl-958ef39e">Log(x) needed?: YES</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9590695f"><p class="cl-9590581a"><span class="cl-958ef394">AGB Species (kg)</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">84</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">894.7 ± 1124.2</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">1.89</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">7.44</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">&lt; 0.001</span></p></td>
<td class="cl-9590695f"><p class="cl-9590581a"><span class="cl-958ef39e">Log(x) needed?: YES</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9590695f"><p class="cl-9590581a"><span class="cl-958ef394">AGB Genus (kg)</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">84</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">908.5 ± 1187.6</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">2.03</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">8.21</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">&lt; 0.001</span></p></td>
<td class="cl-9590695f"><p class="cl-9590581a"><span class="cl-958ef39e">Log(x) needed?: YES</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9590695f"><p class="cl-9590581a"><span class="cl-958ef394">AGB Chave2014 (kg)</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">84</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">244.1 ± 333.1</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">2.15</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">8.61</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">&lt; 0.001</span></p></td>
<td class="cl-9590695f"><p class="cl-9590581a"><span class="cl-958ef39e">Log(x) needed?: YES</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9590695f"><p class="cl-9590581a"><span class="cl-958ef394">AGB Brown1997 (kg)</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">84</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">776.5 ± 1085.9</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">2.30</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">9.79</span></p></td>
<td class="cl-95906960"><p class="cl-95905824"><span class="cl-958ef394">&lt; 0.001</span></p></td>
<td class="cl-9590695f"><p class="cl-9590581a"><span class="cl-958ef39e">Log(x) needed?: YES</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-95906961"><p class="cl-9590581a"><span class="cl-958ef394">AGB Chave2005 (kg)</span></p></td>
<td class="cl-95906968"><p class="cl-95905824"><span class="cl-958ef394">84</span></p></td>
<td class="cl-95906968"><p class="cl-95905824"><span class="cl-958ef394">1159.3 ± 1601.6</span></p></td>
<td class="cl-95906968"><p class="cl-95905824"><span class="cl-958ef394">2.15</span></p></td>
<td class="cl-95906968"><p class="cl-95905824"><span class="cl-958ef394">8.54</span></p></td>
<td class="cl-95906968"><p class="cl-95905824"><span class="cl-958ef394">&lt; 0.001</span></p></td>
<td class="cl-95906961"><p class="cl-9590581a"><span class="cl-958ef39e">Log(x) needed?: YES</span></p></td>
</tr>
</tbody>
<tfoot><tr style="overflow-wrap:break-word;"><td colspan="7" class="cl-95906972"><p class="cl-9590581a"><span class="cl-958ef39f">All AGB estimates exhibit significant departure from normality (p &lt; 0.001) with extreme right-skew (skewness &gt; 2) regardless of equation type, justifying log-transformation in subsequent analysis.</span></p></td></tr></tfoot>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</section><section id="bivariate-testing" class="level3"><h3 class="anchored" data-anchor-id="bivariate-testing">Bivariate Testing</h3>
<p>Heteroscedasticity violates ordinary least squares assumptions, producing unreliable standard errors and inflated uncertainty estimates that threaten carbon credit revenues. The Breusch-Pagan test identifies which predictor drives heteroscedasticity by regressing squared residuals against predictor values:</p>
<ul>
<li>Null hypothesis (H₀): Homoscedastic (constant variance)</li>
<li>Alternative (H₁): Heteroscedastic (variance changes with predictors)</li>
<li>Decision rule: p &lt; 0.05 rejects H₀</li>
</ul>
<p>Large trees exhibit greater prediction variance than small trees due to power-law scaling (AGB ∝ DBH^2.5). Without correction, uncertainty estimates are systematically upward-biased, particularly for canopy dominants that drive cumulative biomass.</p>
<p>Test Results</p>
<ul>
<li>BP statistic: 10.0051</li>
<li>p-value: 0.0016</li>
<li>Decision: Heteroscedasticity confirmed</li>
</ul>
<p>The diagnostic plot (Figure 1.2) shows the classic funnel pattern: small trees (DBH &lt; 20 cm) cluster tightly around the fitted line while large trees (DBH &gt; 60 cm) exhibit substantial scatter. This reflects power-law scaling where small multiplicative errors in β translate to large absolute errors for canopy dominants.</p>
<section id="common-corrections" class="level4"><h4 class="anchored" data-anchor-id="common-corrections">Common Corrections</h4>
<ul>
<li>Log-transformation of both variables</li>
<li>Weighted regression for residual heteroscedasticity</li>
<li>Robust standard errors to supplement transformation</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>View Code</summary><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Derive results to test non-constant variance of selected predictor</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>dbh_agb_species_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(agb_species <span class="sc">~</span> dbh, <span class="at">data =</span> scbi_quercus)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>bp_test <span class="ot">&lt;-</span> lmtest<span class="sc">::</span><span class="fu">bptest</span>(dbh_agb_species_lm)  </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Breusch-Pagan Test Results:</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> Breusch<span class="sc">-</span>Pagan Test Results<span class="sc">:</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"BP statistic: %.4f</span><span class="sc">\n</span><span class="st">"</span>, bp_test<span class="sc">$</span>statistic))</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> BP statistic<span class="sc">:</span> <span class="fl">10.0051</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"p-value: %.4f</span><span class="sc">\n</span><span class="st">"</span>, bp_test<span class="sc">$</span>p.value))</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> p<span class="sc">-</span>value<span class="sc">:</span> <span class="fl">0.0016</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Decision: %s</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">ifelse</span>(bp_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>, </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Reject H₀ - Heteroscedasticity present"</span>, <span class="st">"Fail to reject H₀ - Homoscedasticity"</span>)))</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> Decision<span class="sc">:</span> Reject H₀ <span class="sc">-</span> Heteroscedasticity present</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(scbi_quercus<span class="sc">$</span>dbh, scbi_quercus<span class="sc">$</span>agb_species,</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"DBH (cm)"</span>, <span class="at">ylab =</span> <span class="st">"AGB (kg)"</span>,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"DBH-AGB Relationship: Heteroscedasticity Assessment"</span>)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(dbh_agb_species_lm, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>), <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Observed values"</span>, <span class="st">"Linear fit"</span>, <span class="st">"Size class breaks"</span>), </span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="fu">c</span>(<span class="st">"steelblue"</span>, <span class="st">"red"</span>, <span class="st">"gray"</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="cn">NA</span>, <span class="cn">NA</span>), </span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">lwd =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">70</span>, <span class="at">y =</span> <span class="fu">max</span>(scbi_quercus<span class="sc">$</span>agb_species) <span class="sc">*</span> <span class="fl">0.9</span>,</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">sprintf</span>(<span class="st">"BP test: p = %.4f</span><span class="sc">\n</span><span class="st">Heteroscedasticity confirmed"</span>, bp_test<span class="sc">$</span>p.value),</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">adj =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">cex =</span> <span class="fl">0.9</span>, <span class="at">font =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<p>Large trees exhibit greater prediction variance than small trees due to the power-law relationship (AGB ∝ DBH<sup>~2.5</sup>). Without correction, uncertainty estimates are biased upward, particularly for canopy dominants.</p>
<p>Required corrections:</p>
<ul>
<li>Log-transformation of both variables</li>
<li>Weighted regression for residual heteroscedasticity</li>
<li>Robust standard errors to supplement transformation</li>
</ul></section></section></section><section id="model-optimization" class="level2"><h2 class="anchored" data-anchor-id="model-optimization">1.3 Model Optimization</h2>
<section id="sec-log-rationale" class="level3"><h3 class="anchored" data-anchor-id="sec-log-rationale">Log-Transformation</h3>
<p>Linear regression on this untransformed allometric data produces 45-60% uncertainty. Log-transformation reduces RMSE a 51 percentage point uncertainty reduction. Allometric relationships tend to follow the power law:</p>
<p><span class="math display">\[AGB = \alpha \times DBH^{\beta}\]</span></p>
<p>where β typically ranges from 2.3-2.7, meaning biomass scales with DBH raised to a power. Attempting to fit this with linear regression (<code>AGB = a + b * DBH</code>) misrepresents the functional form thereby underestimating or overestimating specific tree cohorts. Critical to crediting, this forces exponential patterns into residual noise that inflates uncertainty downstream. Alternatively, we may apply logarithmic transformations to the equation or specific variables. This linearizes the power-law relationship so that:</p>
<p><span class="math display">\[\ln(AGB) = \ln(\alpha) + \beta \times \ln(DBH) + \epsilon\]</span></p>
<p>where</p>
<ul>
<li>
<code>β</code> becomes a slope coefficient</li>
<li>Variance stabilizes across tree sizes</li>
<li>Residuals are normalized enough to satisfy OLS assumptions that our predictions are dependent on</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Back-Transformation
</div>
</div>
<div class="callout-body-container callout-body">
<p>As demonstrated below, it is important to back-transform the log-scale of RMSE. This converts log-scale error to proportional error on its original scale, which enables direct comparison with linear model uncertainty while preserving variance structure stabilized by log-transformation.</p>
</div>
</div>
<p>We fitted linear and log-transformed regression models for all five allometric equations, comparing their prediction accuracy using:</p>
<ul>
<li>MAE (Mean Absolute Error): Average absolute deviation in kg</li>
<li>RMSE (Root Mean Square Error): Standard deviation of residuals in kg</li>
<li>Relative RMSE (%): RMSE as percentage of mean biomass, enabling cross-equation comparison</li>
</ul>
<p>For log-transformed models, predictions were back-transformed to the original scale using exponentiation (exp(predicted log-AGB)), and metrics were calculated on back-transformed residuals. This ensures fair comparison with linear models while preserving the variance-stabilizing benefits of log-transformation.</p>
<p>Results (Table X) demonstrate dramatic improvement: log-transformation reduced relative RMSE from 45-60% to 0.3-17% across all equation types—representing 40-60 percentage point reductions in uncertainty. The species-specific log model achieved the lowest uncertainty (0.34%), while even generic pan-tropical equations improved substantially under log-transformation.</p>
<div class="cell">
<details class="code-fold"><summary>View Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Derive performance metrics #</span></span>
<span><span class="va">lin_species</span>     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">agb_species</span> <span class="op">~</span> <span class="va">dbh</span>, data <span class="op">=</span> <span class="va">scbi_quercus</span><span class="op">)</span></span>
<span><span class="va">lin_genus</span>           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">agb_genus</span> <span class="op">~</span> <span class="va">dbh</span>, data <span class="op">=</span> <span class="va">scbi_quercus</span><span class="op">)</span> </span>
<span><span class="va">lin_chave2014</span>   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">agb_chave2014</span> <span class="op">~</span> <span class="va">dbh</span>, data <span class="op">=</span> <span class="va">scbi_quercus</span><span class="op">)</span> </span>
<span><span class="va">lin_brown1997</span>   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">agb_brown1997</span> <span class="op">~</span> <span class="va">dbh</span>, data <span class="op">=</span> <span class="va">scbi_quercus</span><span class="op">)</span> </span>
<span><span class="va">lin_chave2005</span>   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">agb_chave2005</span> <span class="op">~</span> <span class="va">dbh</span>, data <span class="op">=</span> <span class="va">scbi_quercus</span><span class="op">)</span> </span>
<span><span class="va">log_species</span>     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">agb_species</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">dbh</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">scbi_quercus</span><span class="op">)</span> </span>
<span><span class="va">log_genus</span>       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">agb_genus</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">dbh</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">scbi_quercus</span><span class="op">)</span> </span>
<span><span class="va">log_chave2014</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">agb_chave2014</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">dbh</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">scbi_quercus</span><span class="op">)</span></span>
<span><span class="va">log_brown1997</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">agb_brown1997</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">dbh</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">scbi_quercus</span><span class="op">)</span></span>
<span><span class="va">log_chave2005</span>   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">agb_chave2005</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">dbh</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">scbi_quercus</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Residuals: log models back-transformed **essential</span></span>
<span><span class="va">lin_species_resid</span>   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">lin_species</span>, <span class="va">scbi_quercus</span>, type<span class="op">=</span><span class="st">'response'</span><span class="op">)</span></span>
<span><span class="va">lin_genus_resid</span>         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">lin_genus</span>, <span class="va">scbi_quercus</span>, type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">lin_chave2014_resid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">lin_chave2014</span>, <span class="va">scbi_quercus</span>, type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">lin_brown1997_resid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">lin_brown1997</span>, <span class="va">scbi_quercus</span>, type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">lin_chave2005_resid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">lin_chave2005</span>, <span class="va">scbi_quercus</span>, type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">log_species_resid</span>       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">log_species</span>, <span class="va">scbi_quercus</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">log_genus_resid</span>         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">log_genus</span>, <span class="va">scbi_quercus</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">log_chave2014_resid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">log_chave2014</span>, <span class="va">scbi_quercus</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">log_brown1997_resid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">log_brown1997</span>, <span class="va">scbi_quercus</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">log_chave2005_resid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">log_chave2005</span>, <span class="va">scbi_quercus</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">lin_species_mae</span>         <span class="op">=</span> <span class="fu">ModelMetrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ModelMetrics/man/mae.html">mae</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_species</span>, <span class="va">lin_species_resid</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">lin_species_rmse</span>        <span class="op">=</span> <span class="fu">ModelMetrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ModelMetrics/man/rmse.html">rmse</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_species</span>, <span class="va">lin_species_resid</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">lin_species_rmse_rel</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">lin_species_rmse</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_species</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">log_species_mae</span>         <span class="op">=</span> <span class="fu">ModelMetrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ModelMetrics/man/mae.html">mae</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_species</span>, <span class="va">log_species_resid</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">log_species_rmse</span>        <span class="op">=</span> <span class="fu">ModelMetrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ModelMetrics/man/rmse.html">rmse</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_species</span>, <span class="va">log_species_resid</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">log_species_rmse_rel</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">log_species_rmse</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_species</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="co"># ******** CRITICAL back-transformation = log_species_rmse_rel</span></span>
<span></span>
<span><span class="co"># Genus-level</span></span>
<span><span class="va">lin_genus_mae</span>           <span class="op">=</span> <span class="fu">ModelMetrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ModelMetrics/man/mae.html">mae</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_genus</span>, <span class="va">lin_genus_resid</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">lin_genus_rmse</span>          <span class="op">=</span> <span class="fu">ModelMetrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ModelMetrics/man/rmse.html">rmse</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_genus</span>, <span class="va">lin_genus_resid</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">lin_genus_rmse_rel</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">lin_genus_rmse</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_genus</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">log_genus_mae</span>           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2e"</span>, <span class="fu">ModelMetrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ModelMetrics/man/mae.html">mae</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_brown1997</span>, <span class="va">log_brown1997_resid</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">log_genus_rmse</span>          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2e"</span>, <span class="fu">ModelMetrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ModelMetrics/man/rmse.html">rmse</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_genus</span>, <span class="va">log_genus_resid</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">log_genus_rmse_rel</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2e"</span>, <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">log_genus_rmse</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_genus</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># ******** CRITICAL back-transformation = log_genus_rmse_rel ***********</span></span>
<span></span>
<span><span class="co"># Chave 2014</span></span>
<span><span class="va">lin_chave2014_mae</span>           <span class="op">=</span> <span class="fu">ModelMetrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ModelMetrics/man/mae.html">mae</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_chave2014</span>, <span class="va">lin_chave2014_resid</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">lin_chave2014_rmse</span>      <span class="op">=</span> <span class="fu">ModelMetrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ModelMetrics/man/rmse.html">rmse</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_chave2014</span>, <span class="va">lin_chave2014_resid</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">lin_chave2014_rmse_rel</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">lin_chave2014_rmse</span> <span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_chave2014</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">log_chave2014_mae</span>           <span class="op">=</span> <span class="fu">ModelMetrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ModelMetrics/man/mae.html">mae</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_chave2014</span>, <span class="va">log_chave2014_resid</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">log_chave2014_rmse</span>      <span class="op">=</span> <span class="fu">ModelMetrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ModelMetrics/man/rmse.html">rmse</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_chave2014</span>, <span class="va">log_chave2014_resid</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">log_chave2014_rmse_rel</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">log_chave2014_rmse</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_chave2014</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Brown 1997</span></span>
<span><span class="va">lin_brown1997_mae</span>           <span class="op">=</span> <span class="fu">ModelMetrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ModelMetrics/man/mae.html">mae</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_brown1997</span>, <span class="va">lin_brown1997_resid</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">lin_brown1997_rmse</span>      <span class="op">=</span> <span class="fu">ModelMetrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ModelMetrics/man/rmse.html">rmse</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_brown1997</span>, <span class="va">lin_brown1997_resid</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">lin_brown1997_rmse_rel</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">lin_brown1997_rmse</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_brown1997</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">log_brown1997_mae</span>       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2e"</span>, <span class="fu">ModelMetrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ModelMetrics/man/mae.html">mae</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_brown1997</span>, <span class="va">log_brown1997_resid</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">log_brown1997_rmse</span>      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2e"</span>, <span class="fu">ModelMetrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ModelMetrics/man/rmse.html">rmse</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_brown1997</span>, <span class="va">log_brown1997_resid</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">log_brown1997_rmse_rel</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2e"</span>, <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">log_brown1997_rmse</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_brown1997</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">*</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Chave 2005</span></span>
<span><span class="va">linear_chave2005_mae</span>            <span class="op">=</span> <span class="fu">ModelMetrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ModelMetrics/man/mae.html">mae</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_chave2005</span>, <span class="va">lin_chave2005_resid</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">linear_chave2005_rmse</span>           <span class="op">=</span> <span class="fu">ModelMetrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ModelMetrics/man/rmse.html">rmse</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_chave2005</span>, <span class="va">lin_chave2005_resid</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">linear_chave2005_rmse_rel</span> <span class="op">=</span> <span class="op">(</span><span class="va">linear_chave2005_rmse</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_chave2005</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">log_chave2005_mae</span>               <span class="op">=</span> <span class="fu">ModelMetrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ModelMetrics/man/mae.html">mae</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_chave2005</span>, <span class="va">log_chave2005_resid</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">log_chave2005_rmse</span>              <span class="op">=</span> <span class="fu">ModelMetrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ModelMetrics/man/rmse.html">rmse</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_chave2005</span>, <span class="va">log_chave2005_resid</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">log_chave2005_rmse_rel</span>      <span class="op">=</span> <span class="op">(</span><span class="va">log_chave2005_rmse</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">scbi_quercus</span><span class="op">$</span><span class="va">agb_chave2005</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid">
<style>.cl-9634b540{table-layout:auto;width:100%;}.cl-96303952{font-family:'Helvetica';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-96321600{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9632160a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-96322be0{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-96322bfe{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-96322bff{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-96322c08{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-96322c09{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-96322c0a{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-9634b540">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-96322be0"><p class="cl-96321600"><span class="cl-96303952">Equation</span></p></th>
<th class="cl-96322bfe"><p class="cl-9632160a"><span class="cl-96303952">MAE_Lin</span></p></th>
<th class="cl-96322be0"><p class="cl-96321600"><span class="cl-96303952">MAE_Log</span></p></th>
<th class="cl-96322bfe"><p class="cl-9632160a"><span class="cl-96303952">RMSE_Lin</span></p></th>
<th class="cl-96322be0"><p class="cl-96321600"><span class="cl-96303952">RMSE_Log</span></p></th>
<th class="cl-96322bfe"><p class="cl-9632160a"><span class="cl-96303952">RMSE_Lin_rel</span></p></th>
<th class="cl-96322be0"><p class="cl-96321600"><span class="cl-96303952">RMSE_Log_rel</span></p></th>
<th class="cl-96322bfe"><p class="cl-9632160a"><span class="cl-96303952">Reduction</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-96322bff"><p class="cl-96321600"><span class="cl-96303952">Species-specific</span></p></td>
<td class="cl-96322c08"><p class="cl-9632160a"><span class="cl-96303952">306.8919</span></p></td>
<td class="cl-96322bff"><p class="cl-96321600"><span class="cl-96303952">1.3638</span></p></td>
<td class="cl-96322c08"><p class="cl-9632160a"><span class="cl-96303952">407.8615</span></p></td>
<td class="cl-96322bff"><p class="cl-96321600"><span class="cl-96303952">3.0036</span></p></td>
<td class="cl-96322c08"><p class="cl-9632160a"><span class="cl-96303952">45.5869</span></p></td>
<td class="cl-96322bff"><p class="cl-96321600"><span class="cl-96303952">0.3357</span></p></td>
<td class="cl-96322c08"><p class="cl-9632160a"><span class="cl-96303952">45.2469</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-96322bff"><p class="cl-96321600"><span class="cl-96303952">Genus-level</span></p></td>
<td class="cl-96322c08"><p class="cl-9632160a"><span class="cl-96303952">345.0502</span></p></td>
<td class="cl-96322bff"><p class="cl-96321600"><span class="cl-96303952">2.48e-12</span></p></td>
<td class="cl-96322c08"><p class="cl-9632160a"><span class="cl-96303952">461.6111</span></p></td>
<td class="cl-96322bff"><p class="cl-96321600"><span class="cl-96303952">1.56e-12</span></p></td>
<td class="cl-96322c08"><p class="cl-9632160a"><span class="cl-96303952">50.8083</span></p></td>
<td class="cl-96322bff"><p class="cl-96321600"><span class="cl-96303952">1.72e-13</span></p></td>
<td class="cl-96322c08"><p class="cl-9632160a"><span class="cl-96303952">50.8083</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-96322bff"><p class="cl-96321600"><span class="cl-96303952">Chave 2014</span></p></td>
<td class="cl-96322c08"><p class="cl-9632160a"><span class="cl-96303952">102.7348</span></p></td>
<td class="cl-96322bff"><p class="cl-96321600"><span class="cl-96303952">15.5252</span></p></td>
<td class="cl-96322c08"><p class="cl-9632160a"><span class="cl-96303952">138.5064</span></p></td>
<td class="cl-96322bff"><p class="cl-96321600"><span class="cl-96303952">40.3143</span></p></td>
<td class="cl-96322c08"><p class="cl-9632160a"><span class="cl-96303952">56.7456</span></p></td>
<td class="cl-96322bff"><p class="cl-96321600"><span class="cl-96303952">16.5166</span></p></td>
<td class="cl-96322c08"><p class="cl-9632160a"><span class="cl-96303952">40.2256</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-96322bff"><p class="cl-96321600"><span class="cl-96303952">Brown 1997</span></p></td>
<td class="cl-96322c08"><p class="cl-9632160a"><span class="cl-96303952">345.8073</span></p></td>
<td class="cl-96322bff"><p class="cl-96321600"><span class="cl-96303952">2.48e-12</span></p></td>
<td class="cl-96322c08"><p class="cl-9632160a"><span class="cl-96303952">469.4678</span></p></td>
<td class="cl-96322bff"><p class="cl-96321600"><span class="cl-96303952">4.70e-12</span></p></td>
<td class="cl-96322c08"><p class="cl-9632160a"><span class="cl-96303952">60.4590</span></p></td>
<td class="cl-96322bff"><p class="cl-96321600"><span class="cl-96303952">6.05e-13</span></p></td>
<td class="cl-96322c08"><p class="cl-9632160a"><span class="cl-96303952">60.4590</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-96322c09"><p class="cl-96321600"><span class="cl-96303952">Chave 2005</span></p></td>
<td class="cl-96322c0a"><p class="cl-9632160a"><span class="cl-96303952">102.7348</span></p></td>
<td class="cl-96322c09"><p class="cl-96321600"><span class="cl-96303952">42.0631</span></p></td>
<td class="cl-96322c0a"><p class="cl-9632160a"><span class="cl-96303952">469.4678</span></p></td>
<td class="cl-96322c09"><p class="cl-96321600"><span class="cl-96303952">122.7474</span></p></td>
<td class="cl-96322c0a"><p class="cl-9632160a"><span class="cl-96303952">58.0900</span></p></td>
<td class="cl-96322c09"><p class="cl-96321600"><span class="cl-96303952">10.5881</span></p></td>
<td class="cl-96322c0a"><p class="cl-9632160a"><span class="cl-96303952">47.5000</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Results shown in two previous tables provides the necessary justification for designing the cross-validation workflow in the next section, where we implement log-transformed models and quantify the uncertainty reduction according to different bias corrections and hyper-parameter tuning.</p>
<section id="age-class-stratification-split" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="age-class-stratification-split">Age-Class Stratification Split</h4>
<p>Stratification by size class or age cohort involves a critical component in forest biomass modeling. This ensures proportional representation of diameter classes, which effectively prevents bias from the systematic under-sampling of large trees <span class="citation" data-cites="paul2017moisture duncansonAbovegroundWoodyBiomass2021">(<a href="../references/index.html#ref-duncansonAbovegroundWoodyBiomass2021" role="doc-biblioref">Duncanson et al., 2021, p. 100</a>; <a href="../references/index.html#ref-paul2017moisture" role="doc-biblioref">Paul et al., 2017</a>)</span>.</p>
<div class="cell">
<details class="code-fold"><summary>View Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">age_class</span> <span class="op">=</span> <span class="va">scbi_quercus</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>    <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dbh</span><span class="op">)</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">agb_genus</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>dbh_class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">dbh</span>, </span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">50</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0-10"</span>, <span class="st">"10-20"</span>, <span class="st">"20-30"</span>, <span class="st">"30-40"</span>, <span class="st">"40-50"</span>, <span class="st">"&gt;50"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check raw distribution across size classes</span></span>
<span><span class="va">age_class_distribution</span> <span class="op">=</span> <span class="va">age_class</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">dbh_class</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    mean_dbh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dbh</span><span class="op">)</span>, mean_agb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">agb_genus</span><span class="op">)</span>,</span>
<span>    total_biomass_pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">agb_genus</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">age_class</span><span class="op">$</span><span class="va">agb_genus</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">'drop'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check 80:20% to maintain proportional representation</span></span>
<span><span class="va">train_idx</span> <span class="op">&lt;-</span> <span class="va">age_class</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>row_id <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">dbh_class</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">row_id</span><span class="op">)</span></span>
<span></span>
<span><span class="va">calibration_data</span> <span class="op">&lt;-</span> <span class="va">age_class</span><span class="op">[</span><span class="va">train_idx</span>, <span class="op">]</span></span>
<span><span class="va">validation_data</span> <span class="op">&lt;-</span> <span class="va">age_class</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span></span>
<span><span class="va">cal_props</span> <span class="op">&lt;-</span> <span class="va">calibration_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">dbh_class</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>cal_pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>cal_n <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span><span class="va">val_props</span> <span class="op">&lt;-</span> <span class="va">validation_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">dbh_class</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>val_pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>val_n <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span><span class="va">split_verification</span> <span class="op">&lt;-</span> <span class="va">cal_props</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">val_props</span>, by <span class="op">=</span> <span class="st">"dbh_class"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Total_n <span class="op">=</span> <span class="va">cal_n</span> <span class="op">+</span> <span class="va">val_n</span>, Difference_pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">cal_pct</span> <span class="op">-</span> <span class="va">val_pct</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">dbh_class</span>, <span class="va">cal_n</span>, <span class="va">cal_pct</span>, <span class="va">val_n</span>, <span class="va">val_pct</span>, <span class="va">Total_n</span>, <span class="va">Difference_pct</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid">
<style>.cl-964c9cdc{table-layout:auto;width:100%;}.cl-9648ed8a{font-family:'Helvetica';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9648ed94{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-964a6098{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-964a60a2{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-964a6fb6{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-964a6fb7{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-964a6fb8{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-964a6fc0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-964a6fc1{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-964a6fc2{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-964a6fca{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-964c9cdc">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-964a6fb6"><p class="cl-964a6098"><span class="cl-9648ed8a">DBH Class (cm)</span></p></th>
<th class="cl-964a6fb7"><p class="cl-964a60a2"><span class="cl-9648ed8a">Calibration (n)</span></p></th>
<th class="cl-964a6fb7"><p class="cl-964a60a2"><span class="cl-9648ed8a">Cal. % of Total</span></p></th>
<th class="cl-964a6fb7"><p class="cl-964a60a2"><span class="cl-9648ed8a">Validation (n)</span></p></th>
<th class="cl-964a6fb7"><p class="cl-964a60a2"><span class="cl-9648ed8a">Val. % of Total</span></p></th>
<th class="cl-964a6fb7"><p class="cl-964a60a2"><span class="cl-9648ed8a">Total (n)</span></p></th>
<th class="cl-964a6fb7"><p class="cl-964a60a2"><span class="cl-9648ed8a">Δ (%)</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-964a6fb8"><p class="cl-964a6098"><span class="cl-9648ed8a">0-10</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">17</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">26.6</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">5</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">25.0</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">22</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">1.6</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-964a6fb8"><p class="cl-964a6098"><span class="cl-9648ed8a">10-20</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">11</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">17.2</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">3</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">15.0</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">14</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">2.2</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-964a6fb8"><p class="cl-964a6098"><span class="cl-9648ed8a">20-30</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">9</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">14.1</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">3</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">15.0</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">12</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">0.9</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-964a6fb8"><p class="cl-964a6098"><span class="cl-9648ed8a">30-40</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">8</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">12.5</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">3</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">15.0</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">11</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">2.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-964a6fb8"><p class="cl-964a6098"><span class="cl-9648ed8a">40-50</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">10</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">15.6</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">3</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">15.0</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">13</span></p></td>
<td class="cl-964a6fc0"><p class="cl-964a60a2"><span class="cl-9648ed8a">0.6</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-964a6fc1"><p class="cl-964a6098"><span class="cl-9648ed8a">&gt;50</span></p></td>
<td class="cl-964a6fc2"><p class="cl-964a60a2"><span class="cl-9648ed8a">9</span></p></td>
<td class="cl-964a6fc2"><p class="cl-964a60a2"><span class="cl-9648ed8a">14.1</span></p></td>
<td class="cl-964a6fc2"><p class="cl-964a60a2"><span class="cl-9648ed8a">3</span></p></td>
<td class="cl-964a6fc2"><p class="cl-964a60a2"><span class="cl-9648ed8a">15.0</span></p></td>
<td class="cl-964a6fc2"><p class="cl-964a60a2"><span class="cl-9648ed8a">12</span></p></td>
<td class="cl-964a6fc2"><p class="cl-964a60a2"><span class="cl-9648ed8a">0.9</span></p></td>
</tr>
</tbody>
<tfoot><tr style="overflow-wrap:break-word;"><td colspan="7" class="cl-964a6fca"><p class="cl-964a6098"><span class="cl-9648ed94">Stratified sampling ensures DBH class proportions remain similar between datasets. 'Cal. % of Total' and 'Val. % of Total' show each class as % of its respective dataset. Δ shows absolute difference - values &lt;2% indicate good proportionality preservation.</span></p></td></tr></tfoot>
</table>
</div>
</div>
</div>
<p><em>Table X: Calibration and Validation SubSet Proportionality Check</em></p>
<p>The above example showcases a successful outcome, where all size classes show &lt;3% difference between calibration and validation sets, confirming successful stratification. This prevents over-representation of small trees and under-representation of large trees in model training.</p>
</section></section></section><section id="cross-validation" class="level2"><h2 class="anchored" data-anchor-id="cross-validation">1.4 Cross-Validation</h2>
<p>Cross-validation quantifies out-of-sample prediction error, preventing over-fitting and providing realistic uncertainty estimates for REDD+ carbon credit deductions. We employ Monte Carlo Leave-Group-Out Cross-Validation (LGOCV) training regime using the <code>caret</code> library to demonstrate the following:</p>
<ul>
<li>Assess generalization: Test model performance on unseen data</li>
<li>Quantify uncertainty: Calculate robust RMSE estimates</li>
<li>Compare models: Select best-performing equation type</li>
<li>Meet MRV standards: Demonstrate compliance with ART-TREES/VCS requirements</li>
</ul>
<section id="monte-carlo-simulation-design" class="level4"><h4 class="anchored" data-anchor-id="monte-carlo-simulation-design">Monte Carlo Simulation Design:</h4>
<p>We implemented 100-iteration Monte Carlo cross-validation to quantify out-of-sample prediction error and prevent over-fitting. Each iteration:</p>
<ul>
<li>Randomly splits data into 80% calibration / 20% validation (stratified by DBH class)</li>
<li>Fits the model on calibration data</li>
<li>Predicts validation data</li>
<li>Calculates performance metrics (MAE, RMSE, R²)</li>
</ul>
<p>This process was repeated for all 10 model configurations:</p>
<ul>
<li>5 allometric equations (Species-specific, Genus, Chave 2014, Brown 1997, Chave 2005)</li>
<li>2 transformations each (Linear, Log-transformed)</li>
</ul>
<p>Across 100 iterations, we accumulated validation predictions per model, providing robust uncertainty estimates that reflect true generalization performance rather than training-set over-fitting. The Monte Carlo approach is particularly valuable for small datasets (n=84), where a single train-test split might yield unrepresentative results due to sampling variance.</p>
<div class="cell">
<details class="code-fold"><summary>View Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Define Monte Carlo cross-validation parameters</span></span>
<span><span class="va">monte_carlo_100</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/trainControl.html">trainControl</a></span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="st">"LGOCV"</span>,</span>
<span>  number <span class="op">=</span> <span class="fl">100</span>,     <span class="co"># no.# of full cycle resamples</span></span>
<span>  p <span class="op">=</span> <span class="fl">0.8</span>,              <span class="co"># percentage of full cycle resampled </span></span>
<span>  savePredictions <span class="op">=</span> <span class="st">"final"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Species-Specific Model: Linear model tuned at species level with un-transformed covs</span></span>
<span><span class="va">lin_species_mc</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span></span>
<span>  <span class="va">agb_species</span> <span class="op">~</span> <span class="va">dbh</span>,</span>
<span>  data <span class="op">=</span> <span class="va">scbi_quercus</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"lm"</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.omit</span>,</span>
<span>  trControl <span class="op">=</span> <span class="va">monte_carlo_100</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Species-Specific Model: Logarithmic model tuned at species level withg log-transformed covs</span></span>
<span><span class="va">log_species_mc</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">agb_species</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">dbh</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">scbi_quercus</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"lm"</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.omit</span>,</span>
<span>  trControl <span class="op">=</span> <span class="va">monte_carlo_100</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Genus-Specific Model: LINEAR  model tuned at genus level with un-transformed covs</span></span>
<span><span class="va">lin_genus_mc</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span></span>
<span>  <span class="va">agb_genus</span> <span class="op">~</span> <span class="va">dbh</span>,</span>
<span>  data <span class="op">=</span> <span class="va">scbi_quercus</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"lm"</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.omit</span>,</span>
<span>  trControl <span class="op">=</span> <span class="va">monte_carlo_100</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Genus-Specific Model: LOG model tuned at genus level with un-transformed covs</span></span>
<span><span class="va">log_genus_mc</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">agb_genus</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">dbh</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">scbi_quercus</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"lm"</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.omit</span>,</span>
<span>  trControl <span class="op">=</span> <span class="va">monte_carlo_100</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Chave 2014 models: Generic scaled </span></span>
<span><span class="va">lin_chave2014_mc</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span></span>
<span>  <span class="va">agb_chave2014</span> <span class="op">~</span> <span class="va">dbh</span>,</span>
<span>  data <span class="op">=</span> <span class="va">scbi_quercus</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"lm"</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.omit</span>,</span>
<span>  trControl <span class="op">=</span> <span class="va">monte_carlo_100</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">log_chave2014_mc</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">agb_chave2014</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">dbh</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">scbi_quercus</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"lm"</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.omit</span>,</span>
<span>  trControl <span class="op">=</span> <span class="va">monte_carlo_100</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Brown 1997 models</span></span>
<span><span class="va">lin_brown1997_mc</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span></span>
<span>  <span class="va">agb_brown1997</span> <span class="op">~</span> <span class="va">dbh</span>,</span>
<span>  data <span class="op">=</span> <span class="va">scbi_quercus</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"lm"</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.omit</span>,</span>
<span>  trControl <span class="op">=</span> <span class="va">monte_carlo_100</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">log_brown1997_mc</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">agb_brown1997</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">dbh</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">scbi_quercus</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"lm"</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.omit</span>,</span>
<span>  trControl <span class="op">=</span> <span class="va">monte_carlo_100</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Chave 2005 models</span></span>
<span><span class="va">lin_chave2005_mc</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span></span>
<span>  <span class="va">agb_chave2005</span> <span class="op">~</span> <span class="va">dbh</span>,</span>
<span>  data <span class="op">=</span> <span class="va">scbi_quercus</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"lm"</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.omit</span>,</span>
<span>  trControl <span class="op">=</span> <span class="va">monte_carlo_100</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">log_chave2005_mc</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">agb_chave2005</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">dbh</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">scbi_quercus</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"lm"</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.omit</span>,</span>
<span>  trControl <span class="op">=</span> <span class="va">monte_carlo_100</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="allometric-uncertainty" class="level2"><h2 class="anchored" data-anchor-id="allometric-uncertainty">1.5 Allometric Uncertainty</h2>
<section id="uncertainty-calculation" class="level3"><h3 class="anchored" data-anchor-id="uncertainty-calculation">Uncertainty Calculation</h3>
<p>We evaluate models using metrics aligned with REDD+ MRV requirements:</p>
<ul>
<li>RMSE (Root Mean Square Error): Primary uncertainty metric for ART-TREES deductions</li>
<li>Relative RMSE (%): RMSE as percentage of mean, enabling cross-equation comparison</li>
<li>MAE (Mean Absolute Error): Robust alternative less sensitive to outliers</li>
<li>R² (Coefficient of Determination): Proportion of variance explained</li>
<li>Shapiro-Wilk p-value: Tests residual normality (OLS assumption verification)</li>
<li>Deduction (%): Carbon credit deduction rate per ART-TREES Equation 11</li>
</ul>
<p>For log-transformed models, all metrics were calculated on back-transformed predictions to ensure fair comparison with linear models. Back-transformation applies exp() to log-scale predictions, restoring values to the original kg scale while preserving the variance structure stabilized by log-transformation.</p>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid">
<style>.cl-966c2f70{table-layout:auto;width:100%;}.cl-96688280{font-family:'Helvetica';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9668828a{font-family:'Helvetica';font-size:9pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-96688294{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-966a0a1a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-966a0a24{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-966a1e06{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-966a1e07{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-966a1e10{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-966a1e11{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-966a1e12{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-966a1e1a{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-966a1e1b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-966c2f70">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-966a1e06"><p class="cl-966a0a1a"><span class="cl-96688280">Equation Type</span></p></th>
<th class="cl-966a1e06"><p class="cl-966a0a1a"><span class="cl-96688280">Transform</span></p></th>
<th class="cl-966a1e07"><p class="cl-966a0a24"><span class="cl-96688280">n</span></p></th>
<th class="cl-966a1e07"><p class="cl-966a0a24"><span class="cl-96688280">Shapiro p</span></p></th>
<th class="cl-966a1e07"><p class="cl-966a0a24"><span class="cl-96688280">MAE (kg)</span></p></th>
<th class="cl-966a1e07"><p class="cl-966a0a24"><span class="cl-96688280">RMSE (kg)</span></p></th>
<th class="cl-966a1e07"><p class="cl-966a0a24"><span class="cl-96688280">RMSE (%)</span></p></th>
<th class="cl-966a1e07"><p class="cl-966a0a24"><span class="cl-96688280">R²</span></p></th>
<th class="cl-966a1e07"><p class="cl-966a0a24"><span class="cl-96688280">Deduction (%)</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-966a1e10"><p class="cl-966a0a1a"><span class="cl-96688280">Species-specific</span></p></td>
<td class="cl-966a1e10"><p class="cl-966a0a1a"><span class="cl-96688280">Linear</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">1,600</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">1.14e-43</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">318.05</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">451.82</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-9668828a">50.5</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">0.8506</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-9668828a">16.1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-966a1e10"><p class="cl-966a0a1a"><span class="cl-96688280">Species-specific</span></p></td>
<td class="cl-966a1e10"><p class="cl-966a0a1a"><span class="cl-96688280">Log</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">1,600</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">1.71e-33</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">1.40</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">3.12</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-9668828a">0.3</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">1.0000</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-9668828a">0.1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-966a1e10"><p class="cl-966a0a1a"><span class="cl-96688280">Genus-level</span></p></td>
<td class="cl-966a1e10"><p class="cl-966a0a1a"><span class="cl-96688280">Linear</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">1,600</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">1.42e-44</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">353.45</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">510.20</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-9668828a">56.2</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">0.8210</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-9668828a">17.9</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-966a1e10"><p class="cl-966a0a1a"><span class="cl-96688280">Genus-level</span></p></td>
<td class="cl-966a1e10"><p class="cl-966a0a1a"><span class="cl-96688280">Log</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">1,600</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">1.03e-13</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">0.00</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">0.00</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-9668828a">0.0</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">1.0000</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-9668828a">0.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-966a1e10"><p class="cl-966a0a1a"><span class="cl-96688280">Chave 2014</span></p></td>
<td class="cl-966a1e10"><p class="cl-966a0a1a"><span class="cl-96688280">Linear</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">1,600</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">2.27e-42</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">104.75</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">144.21</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-9668828a">59.1</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">0.8044</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-9668828a">18.8</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-966a1e10"><p class="cl-966a0a1a"><span class="cl-96688280">Chave 2014</span></p></td>
<td class="cl-966a1e10"><p class="cl-966a0a1a"><span class="cl-96688280">Log</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">1,600</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">8.00e-17</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">15.62</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">41.45</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-9668828a">17.0</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">0.9948</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-9668828a">5.4</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-966a1e10"><p class="cl-966a0a1a"><span class="cl-96688280">Brown 1997</span></p></td>
<td class="cl-966a1e10"><p class="cl-966a0a1a"><span class="cl-96688280">Linear</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">1,600</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">1.16e-44</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">356.55</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">505.70</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-9668828a">65.1</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">0.7854</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-9668828a">20.8</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-966a1e10"><p class="cl-966a0a1a"><span class="cl-96688280">Brown 1997</span></p></td>
<td class="cl-966a1e10"><p class="cl-966a0a1a"><span class="cl-96688280">Log</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">1,600</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">5.12e-12</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">0.00</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">0.00</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-9668828a">0.0</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">1.0000</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-9668828a">0.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-966a1e10"><p class="cl-966a0a1a"><span class="cl-96688280">Chave 2005</span></p></td>
<td class="cl-966a1e10"><p class="cl-966a0a1a"><span class="cl-96688280">Linear</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">1,600</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">5.39e-42</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">516.02</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">711.06</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-9668828a">61.3</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-96688280">0.7967</span></p></td>
<td class="cl-966a1e11"><p class="cl-966a0a24"><span class="cl-9668828a">19.6</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-966a1e12"><p class="cl-966a0a1a"><span class="cl-96688280">Chave 2005</span></p></td>
<td class="cl-966a1e12"><p class="cl-966a0a1a"><span class="cl-96688280">Log</span></p></td>
<td class="cl-966a1e1a"><p class="cl-966a0a24"><span class="cl-96688280">1,600</span></p></td>
<td class="cl-966a1e1a"><p class="cl-966a0a24"><span class="cl-96688280">8.22e-23</span></p></td>
<td class="cl-966a1e1a"><p class="cl-966a0a24"><span class="cl-96688280">44.94</span></p></td>
<td class="cl-966a1e1a"><p class="cl-966a0a24"><span class="cl-96688280">127.12</span></p></td>
<td class="cl-966a1e1a"><p class="cl-966a0a24"><span class="cl-9668828a">11.0</span></p></td>
<td class="cl-966a1e1a"><p class="cl-966a0a24"><span class="cl-96688280">0.9942</span></p></td>
<td class="cl-966a1e1a"><p class="cl-966a0a24"><span class="cl-9668828a">3.5</span></p></td>
</tr>
</tbody>
<tfoot><tr style="overflow-wrap:break-word;"><td colspan="9" class="cl-966a1e1b"><p class="cl-966a0a1a"><span class="cl-96688294">Monte Carlo LGOCV (100 iterations, 80/20 split). Shapiro p &lt; 0.001 displayed in scientific notation. Green highlighting: RMSE &lt;20% (acceptable); red: RMSE ≥50% (poor). Log models show back-transformed metrics on original scale.</span></p></td></tr></tfoot>
</table>
</div>
</div>
</div>
<p><em>Table 1.X: Monte Carlo LGOCV results demonstrate superiority of log-transformed models. Species-specific log model achieves lowest uncertainty RMSE = 15.2%, deduction = 4.8%), while linear models exceed 60% uncertainty, risking a deduction of &gt;20%.</em></p>
</section><section id="uncertainty-evaluation" class="level3"><h3 class="anchored" data-anchor-id="uncertainty-evaluation">Uncertainty Evaluation</h3>
<p>We ranked the five log-transformed models by relative RMSE (%), showing their performance hierarchy and financial implications for a hypothetical 1M tCO₂e REDD+ project at $5/tonne carbon price:</p>
<p>The ranking reveals that genus-level and Brown 1997 models achieved perfect fits (RMSE = 0.00%, R² = 1.000), which likely indicates over-fitting given the small sample size. The species-specific model provides a more realistic uncertainty estimate (0.35% RMSE, $11k deduction), while pan-tropical equations show higher but acceptable uncertainty (11-17% RMSE, $350-541k deductions).</p>
<div class="cell">
<details class="code-fold"><summary>View Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Extract log-transformed models as best performers</span></span>
<span><span class="va">log_models_ranked</span> <span class="op">&lt;-</span> <span class="va">mc_performance</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Model_Type</span> <span class="op">==</span> <span class="st">"Log"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">Rel_RMSE_pct</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    Rank <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    Financial_Impact_1M <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"$%.0fk"</span>, <span class="va">Credit_Deduction_pct</span> <span class="op">*</span> <span class="fl">10000</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Rank</span>, <span class="va">Equation</span>, <span class="va">Rel_RMSE_pct</span>, <span class="va">R2</span>, <span class="va">Credit_Deduction_pct</span>, <span class="va">Financial_Impact_1M</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid">
<style>.cl-9679bbe0{table-layout:auto;width:100%;}.cl-96765df6{font-family:'Helvetica';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-96765e00{font-family:'Helvetica';font-size:9pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-96765e01{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9677d190{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9677d19a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9677e1bc{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9677e1c6{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9677e1c7{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9677e1c8{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9677e1d0{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9677e1d1{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9677e1d2{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="cl-9679bbe0">
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-9677e1bc"><p class="cl-9677d190"><span class="cl-96765df6">Rank</span></p></th>
<th class="cl-9677e1c6"><p class="cl-9677d19a"><span class="cl-96765df6">Equation Type</span></p></th>
<th class="cl-9677e1bc"><p class="cl-9677d190"><span class="cl-96765df6">RMSE (%)</span></p></th>
<th class="cl-9677e1bc"><p class="cl-9677d190"><span class="cl-96765df6">R²</span></p></th>
<th class="cl-9677e1bc"><p class="cl-9677d190"><span class="cl-96765df6">Deduction (%)</span></p></th>
<th class="cl-9677e1bc"><p class="cl-9677d190"><span class="cl-96765df6">Impact @ 1M tCO₂e</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-9677e1c7"><p class="cl-9677d190"><span class="cl-96765e00">1</span></p></td>
<td class="cl-9677e1c8"><p class="cl-9677d19a"><span class="cl-96765e00">Genus-level</span></p></td>
<td class="cl-9677e1c7"><p class="cl-9677d190"><span class="cl-96765e00">0.0000</span></p></td>
<td class="cl-9677e1c7"><p class="cl-9677d190"><span class="cl-96765e00">1.0000</span></p></td>
<td class="cl-9677e1c7"><p class="cl-9677d190"><span class="cl-96765e00">0.0000</span></p></td>
<td class="cl-9677e1c7"><p class="cl-9677d190"><span class="cl-96765e00">$0k</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9677e1c7"><p class="cl-9677d190"><span class="cl-96765df6">2</span></p></td>
<td class="cl-9677e1c8"><p class="cl-9677d19a"><span class="cl-96765df6">Brown 1997</span></p></td>
<td class="cl-9677e1c7"><p class="cl-9677d190"><span class="cl-96765df6">0.0000</span></p></td>
<td class="cl-9677e1c7"><p class="cl-9677d190"><span class="cl-96765df6">1.0000</span></p></td>
<td class="cl-9677e1c7"><p class="cl-9677d190"><span class="cl-96765df6">0.0000</span></p></td>
<td class="cl-9677e1c7"><p class="cl-9677d190"><span class="cl-96765df6">$0k</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9677e1c7"><p class="cl-9677d190"><span class="cl-96765df6">3</span></p></td>
<td class="cl-9677e1c8"><p class="cl-9677d19a"><span class="cl-96765df6">Species-specific</span></p></td>
<td class="cl-9677e1c7"><p class="cl-9677d190"><span class="cl-96765df6">0.3486</span></p></td>
<td class="cl-9677e1c7"><p class="cl-9677d190"><span class="cl-96765df6">1.0000</span></p></td>
<td class="cl-9677e1c7"><p class="cl-9677d190"><span class="cl-96765df6">0.1111</span></p></td>
<td class="cl-9677e1c7"><p class="cl-9677d190"><span class="cl-96765df6">$11k</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9677e1c7"><p class="cl-9677d190"><span class="cl-96765df6">4</span></p></td>
<td class="cl-9677e1c8"><p class="cl-9677d19a"><span class="cl-96765df6">Chave 2005</span></p></td>
<td class="cl-9677e1c7"><p class="cl-9677d190"><span class="cl-96765df6">10.9656</span></p></td>
<td class="cl-9677e1c7"><p class="cl-9677d190"><span class="cl-96765df6">0.9942</span></p></td>
<td class="cl-9677e1c7"><p class="cl-9677d190"><span class="cl-96765df6">3.4958</span></p></td>
<td class="cl-9677e1c7"><p class="cl-9677d190"><span class="cl-96765df6">$350k</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-9677e1d0"><p class="cl-9677d190"><span class="cl-96765df6">5</span></p></td>
<td class="cl-9677e1d1"><p class="cl-9677d19a"><span class="cl-96765df6">Chave 2014</span></p></td>
<td class="cl-9677e1d0"><p class="cl-9677d190"><span class="cl-96765df6">16.9826</span></p></td>
<td class="cl-9677e1d0"><p class="cl-9677d190"><span class="cl-96765df6">0.9948</span></p></td>
<td class="cl-9677e1d0"><p class="cl-9677d190"><span class="cl-96765df6">5.4139</span></p></td>
<td class="cl-9677e1d0"><p class="cl-9677d190"><span class="cl-96765df6">$541k</span></p></td>
</tr>
</tbody>
<tfoot><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-9677e1d2"><p class="cl-9677d19a"><span class="cl-96765e01">Financial impact calculated assuming $5/tonne carbon price. Species-specific equation recommended for Quercus-dominated stands; genus-level provides acceptable alternative when species identification uncertain.</span></p></td></tr></tfoot>
</table>
</div>
</div>
</div>
</section><section id="uncertainty-deductions" class="level3"><h3 class="anchored" data-anchor-id="uncertainty-deductions">Uncertainty Deductions</h3>
<p>Following ART-TREES Equation 11, we calculated the carbon credit deduction for the best-performing model (genus-level log-transformed). The deduction formula converts relative RMSE into a half-width 90% confidence interval, then applies the UA (uncertainty adjustment) factor: <span class="math display">\[
UA_t = 0.524417 \times \frac{HW_{90\%}}{1.645006}
\]</span></p>
<p>Where:</p>
<ul>
<li>Half-width 90% CI = RMSE (%) / 100</li>
<li>The constant 1.645006 is the z-score for 90% confidence</li>
<li>The constant 0.524417 converts to ART-TREES deduction rate</li>
</ul>
<p>For a hypothetical 1M tCO₂e project at $5/tonne, the calculation proceeds as shown in the output below. Note that the genus-level model’s 0.00% RMSE yields zero deduction, which highlights the over-fitting concern mentioned previously. In practice, species-specific or validated generic equations would be more appropriate for MRV reporting. We demonstrate the ART-TREES uncertainty deduction calculationin following section 1.6.</p>
<div class="cell">
<details class="code-fold"><summary>View Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Select best-performing model (species-specific log)</span></span>
<span><span class="va">best_model</span> <span class="op">&lt;-</span> <span class="va">log_models_ranked</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Extract metrics</span></span>
<span><span class="va">rmse_pct</span> <span class="op">&lt;-</span> <span class="va">best_model</span><span class="op">$</span><span class="va">Rel_RMSE_pct</span></span>
<span><span class="va">hw_90_pct</span> <span class="op">&lt;-</span> <span class="va">rmse_pct</span> <span class="op">/</span> <span class="fl">100</span>  <span class="co"># Half-width 90% CI as proportion</span></span>
<span><span class="va">ua_factor</span> <span class="op">&lt;-</span> <span class="fl">0.524417</span> <span class="op">*</span> <span class="op">(</span><span class="va">hw_90_pct</span> <span class="op">/</span> <span class="fl">1.645006</span><span class="op">)</span>  <span class="co"># ART Equation 11</span></span>
<span></span>
<span><span class="co"># Calculate financial impact for example project</span></span>
<span><span class="va">project_tonnes</span> <span class="op">&lt;-</span> <span class="fl">1000000</span>  <span class="co"># 1M tCO₂e</span></span>
<span><span class="va">price_per_tonne</span> <span class="op">&lt;-</span> <span class="fl">5</span>       <span class="co"># $5/tonne</span></span>
<span><span class="va">total_value</span> <span class="op">&lt;-</span> <span class="va">project_tonnes</span> <span class="op">*</span> <span class="va">price_per_tonne</span></span>
<span><span class="va">deduction_value</span> <span class="op">&lt;-</span> <span class="va">total_value</span> <span class="op">*</span> <span class="va">ua_factor</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"=== REDD+ Uncertainty Deduction Example ===\n\n"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## === REDD+ Uncertainty Deduction Example ===</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"Selected Model: %s (log-transformed)\n"</span>, <span class="va">best_model</span><span class="op">$</span><span class="va">Equation</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Selected Model: Genus-level (log-transformed)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"Relative RMSE: %.1f%%\n"</span>, <span class="va">rmse_pct</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Relative RMSE: 0.0%</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"Half-width 90%% CI: %.4f\n"</span>, <span class="va">hw_90_pct</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Half-width 90% CI: 0.0000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"UA factor (ART Eq.11): %.6f\n\n"</span>, <span class="va">ua_factor</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## UA factor (ART Eq.11): 0.000000</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"Project Parameters:\n"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Project Parameters:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"  Total credits: %s tCO₂e\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">project_tonnes</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##   Total credits: 1,000,000 tCO₂e</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"  Carbon price: $%.2f/tonne\n"</span>, <span class="va">price_per_tonne</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##   Carbon price: $5.00/tonne</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"  Gross value: $%s\n\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">total_value</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##   Gross value: $5,000,000</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"Uncertainty Deduction:\n"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Uncertainty Deduction:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"  Deduction rate: %.2f%%\n"</span>, <span class="va">ua_factor</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##   Deduction rate: 0.00%</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"  Credits deducted: %s tCO₂e\n"</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">project_tonnes</span> <span class="op">*</span> <span class="va">ua_factor</span><span class="op">)</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##   Credits deducted: 0 tCO₂e</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"  Revenue loss: $%s\n"</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">deduction_value</span><span class="op">)</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##   Revenue loss: $0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"  Net credited value: $%s\n"</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">total_value</span> <span class="op">-</span> <span class="va">deduction_value</span><span class="op">)</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##   Net credited value: $5,000,000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Financial Impact
</div>
</div>
<div class="callout-body-container callout-body">
<p>Selecting species-specific over generic equation:</p>
<ul>
<li>RMSE improvement: 18.9% =&gt; 15.2% (3.7 percentage points)</li>
<li>Deduction reduction: 6.0% =&gt; 4.8% (1.2 percentage points)</li>
<li>Revenue protected: ~$12,000 per million tCO₂e // $5/tonne</li>
</ul>
<p>Over a 30-year REDD+ project crediting period with 100,000 tCO₂e/year:</p>
<ul>
<li>Total protected revenue: ~$360,000</li>
<li>Additional cost: ~$15-30k for species-specific equation development</li>
<li>Return on investment: 12-24x</li>
</ul>
</div>
</div>
</section></section><section id="reproducible-workflowindex-3" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="reproducible-workflowindex-3">1.6 Reproducible Workflow<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>
</h2>
<p>This section contains all executable code referenced throughout Chapter 1, organized sequentially to match the conceptual flow of Sections 1.2-1.5. Please note that the entire training and its four chapters markdown can be downloaded as completed scripts from the project’s code repository here and live eBook here.</p>
<div class="cell">
<details class="code-fold"><summary>View Code</summary><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.6.1 Environment Setup</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load required packages</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>easypackages<span class="sc">::</span><span class="fu">packages</span>(</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="st">"animation"</span>, <span class="st">"BIOMASS"</span>, <span class="st">"cols4all"</span>, <span class="st">"covr"</span>, <span class="st">"cowplot"</span>, <span class="st">"caret"</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="st">"DescTools"</span>, <span class="st">"dataMaid"</span>, <span class="st">"dplyr"</span>, <span class="st">"FawR"</span>, <span class="st">"ForestToolsRS"</span>, <span class="st">"forestdata"</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="st">"flextable"</span>, <span class="st">"ggplot2"</span>, <span class="st">"giscoR"</span>, <span class="st">"ggfortify"</span>, <span class="st">"htmltools"</span>, <span class="st">"janitor"</span>, <span class="st">"jsonlite"</span>, <span class="st">"lattice"</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="st">"leaflet.providers"</span>, <span class="st">"leaflet"</span>, <span class="st">"lmtest"</span>, <span class="st">"lwgeom"</span>, <span class="st">"kableExtra"</span>, <span class="st">"kernlab"</span>, <span class="st">"knitr"</span>, <span class="st">"mapedit"</span>,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="st">"mapview"</span>, <span class="st">"maptiles"</span>, <span class="st">"Mlmetrics"</span>, <span class="st">"ModelMetrics"</span>, <span class="st">"moments"</span>, <span class="st">"olsrr"</span>, <span class="st">"openxlsx"</span>,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="st">"plotly"</span>, <span class="st">"psych"</span>, <span class="st">"randomForest"</span>, <span class="st">"raster"</span>,<span class="st">"RColorBrewer"</span>, <span class="st">"rmarkdown"</span>, <span class="st">"renv"</span>, <span class="st">"reticulate"</span>,</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="st">"s2"</span>, <span class="st">"sf"</span>, <span class="st">"scales"</span>, <span class="st">"sits"</span>,<span class="st">"spdep"</span>, <span class="st">"stars"</span>, <span class="st">"stringr"</span>, <span class="st">"terra"</span>, <span class="st">"tmap"</span>, <span class="st">"tmaptools"</span>,</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="st">"tidymodels"</span>, <span class="st">"tidyverse"</span>, <span class="st">"tidyr"</span>, <span class="st">"tune"</span>, <span class="st">"useful"</span>,</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="at">prompt =</span> F)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.6.2 Data Import and Preparation (Section 1.2)</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="co"># import dataset from allodb.pkg</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"allodb"</span>)</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(scbi_stem1)</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> Parallel development of Python cells was paused to concentrate efforts on delivering a completed R workflow. However, initial</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>python code was preserved <span class="cf">in</span> each chapter’s markdown file and can be rendered from cloning the repository and adjusting <span class="st">`</span><span class="at">echo</span><span class="st">`</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> to reveal and run python operations and compare computations.</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a><span class="dv">24</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>scbi_stem1 <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">group_by</span>(Family, genus, species) <span class="sc">|&gt;</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="st">`</span><span class="at">Total Trees (n)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>flextable<span class="sc">::</span><span class="fu">flextable</span>()<span class="sc">|&gt;</span> </span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">part =</span> <span class="st">"footer"</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width=</span><span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">head</span>() <span class="co"># top10 rows only</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Genus-specific subsample of dataset</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>scbi_quercus <span class="ot">=</span> scbi_stem1 <span class="sc">|&gt;</span></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dbh)) <span class="sc">|&gt;</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(genus <span class="sc">==</span> <span class="st">"Quercus"</span>)</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Species-specific subsample of dataset</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>scbi_quercus_rubra <span class="ot">=</span> scbi_stem1 <span class="sc">|&gt;</span></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dbh)) <span class="sc">|&gt;</span></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(genus <span class="sc">==</span> <span class="st">"Quercus"</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"rubra"</span>)</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.6.3 Equation Selection (Section 1.2)</span></span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Load allometric equations</span></span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(equations)</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"equations_metadata"</span>)</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a><span class="co"># display all equation criteria</span></span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(equations)</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> Rows<span class="sc">:</span> <span class="dv">570</span></span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> Columns<span class="sc">:</span> <span class="dv">47</span></span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">$</span> ref_id <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="st">"barney_1977_bdac"</span>, <span class="st">"baskerville_1966_dmp…</span></span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ equation_id &lt;chr&gt; "</span><span class="dv">4</span>b4063<span class="st">", "</span>e2c7c7<span class="st">", "</span>e42e41<span class="st">", "</span><span class="dv">2</span>bc879<span class="st">", "</span>…</span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">$</span> equation_allometry <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="st">"exp(3.63+2.54*log(dbh))"</span>, <span class="st">"exp(0.15+2.48…</span></span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ equation_form &lt;chr&gt; "</span><span class="fu">exp</span>(a<span class="sc">+</span>b<span class="sc">*</span><span class="fu">log</span>(dbh))<span class="st">", "</span><span class="fu">exp</span>(a<span class="sc">+</span>b<span class="sc">*</span>(<span class="fu">log</span>(dbh))<span class="st">"…</span></span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ dependent_variable &lt;chr&gt; "</span>Total aboveground biomass<span class="st">", "</span>Total above…</span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">$</span> independent_variable <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="st">"DBH"</span>, <span class="st">"DBH"</span>, <span class="st">"DBH"</span>, <span class="st">"DBH"</span>, <span class="st">"DBH"</span>, <span class="st">"DBH"</span>,…</span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">$</span> equation_taxa <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="st">"Picea mariana"</span>, <span class="st">"Picea glauca"</span>, <span class="st">"Betula"</span>…</span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">$</span> allometry_specificity <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="st">"Species"</span>, <span class="st">"Species"</span>, <span class="st">"Genus"</span>, <span class="st">"Genus"</span>, <span class="st">"…</span></span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ equation_categ &lt;chr&gt; "</span>sp_spec<span class="st">", "</span>sp_spec<span class="st">", "</span>generic<span class="st">", "</span>generic…</span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">$</span> geographic_area <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="st">"Alaska, USA"</span>, <span class="st">"New Brunswick, Canada"</span>, <span class="st">"…</span></span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ original_coord &lt;chr&gt; "</span><span class="dv">64</span>\xb0 <span class="dv">45</span><span class="st">', 148</span><span class="sc">\xb0</span><span class="st"> 15'", "</span><span class="dv">47</span>\xb051<span class="st">' N, …</span></span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ lat &lt;chr&gt; "65.75", "47.9", "NRA", "NRA", "NRA", "NR…</span></span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ long &lt;chr&gt; "-148.25", "-68.3", "NRA", "NRA", "NRA", …</span></span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ elev_m &lt;chr&gt; "167-470", "500", "NRA", "NRA", "NRA", "N…</span></span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ geography_notes &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</span></span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ mat_C &lt;chr&gt; "NI", "2.2", "NRA", "NRA", "NRA", "NRA", …</span></span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ min.temp_C &lt;chr&gt; "NI", "NI", "NRA", "NRA", "NRA", "NRA", "…</span></span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ max.temp_C &lt;chr&gt; "NI", "NI", "NRA", "NRA", "NRA", "NRA", "…</span></span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ map_mm &lt;chr&gt; "NI", "1069", "NRA", "NRA", "NRA", "NRA",…</span></span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ frost_free_period_days &lt;chr&gt; "NI", "110", "NRA", "NRA", "NRA", "NRA", …</span></span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ climate_notes &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</span></span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ stand_age_range_yr &lt;chr&gt; "51-55 yrs", "35-48 yrs", "NRA", "NRA", "…</span></span>
<span id="cb28-73"><a href="#cb28-73" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ stand_age_history &lt;chr&gt; "Recent fires in 1977", "Stand originated…</span></span>
<span id="cb28-74"><a href="#cb28-74" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ stand_basal_area_m2_ha &lt;chr&gt; "NI", "NI", "NRA", "NRA", "NRA", "NRA", "…</span></span>
<span id="cb28-75"><a href="#cb28-75" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ stand_trees_ha &lt;chr&gt; "NI", "NI", "NRA", "NRA", "NRA", "NRA", "…</span></span>
<span id="cb28-76"><a href="#cb28-76" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ forest_description &lt;chr&gt; "Typical lowland and upland stands domina…</span></span>
<span id="cb28-77"><a href="#cb28-77" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ ecosystem_type &lt;chr&gt; "Temperate forest", "Boreal forest", "Tem…</span></span>
<span id="cb28-78"><a href="#cb28-78" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ koppen &lt;chr&gt; "Dfc", "Dfb", "Dfb; Cfa", "Dfb; Cfa", "Df…</span></span>
<span id="cb28-79"><a href="#cb28-79" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ dbh_min_cm &lt;chr&gt; "1.5", "2.54", "5", "NRA", "5", "NRA", "5…</span></span>
<span id="cb28-80"><a href="#cb28-80" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ dbh_max_cm &lt;chr&gt; "13", "25.4", "NRA", "NRA", "NRA", "NRA",…</span></span>
<span id="cb28-81"><a href="#cb28-81" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ sample_size &lt;chr&gt; "18", "13", "NRA", "NRA", "NRA", "NRA", "…</span></span>
<span id="cb28-82"><a href="#cb28-82" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ collection_year &lt;chr&gt; "1973", "1965", "1971, 1995", "1971, 1995…</span></span>
<span id="cb28-83"><a href="#cb28-83" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ dbh_units_original &lt;chr&gt; "cm", "inch", "cm", "cm", "cm", "cm", "cm…</span></span>
<span id="cb28-84"><a href="#cb28-84" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ dbh_unit_CF &lt;chr&gt; "1", "0.393701", "1", "1", "1", "1", "1",…</span></span>
<span id="cb28-85"><a href="#cb28-85" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ output_units_original &lt;chr&gt; "g", "lbs", "metric_ton", "m", "metric_to…</span></span>
<span id="cb28-86"><a href="#cb28-86" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ output_units_CF &lt;chr&gt; "0.001", "0.453592", "1000", "1", "1000",…</span></span>
<span id="cb28-87"><a href="#cb28-87" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ allometry_development_method &lt;chr&gt; "harvest", "harvest", "harvest?", "harves…</span></span>
<span id="cb28-88"><a href="#cb28-88" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ regression_model &lt;chr&gt; "log-transformed", "log-transformed", NA,…</span></span>
<span id="cb28-89"><a href="#cb28-89" aria-hidden="true" tabindex="-1"></a><span class="st">25</span></span>
<span id="cb28-90"><a href="#cb28-90" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ r_squared &lt;chr&gt; "0.91", "0.99", "NI", "NI", "NI", "NI", "…</span></span>
<span id="cb28-91"><a href="#cb28-91" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ other_equations_tested &lt;chr&gt; "NI", "NI", "NRA", "NRA", "NRA", "NRA", "…</span></span>
<span id="cb28-92"><a href="#cb28-92" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ log_biomass &lt;chr&gt; "1", "1", "1", "0", "1", "0", "1", "0", "…</span></span>
<span id="cb28-93"><a href="#cb28-93" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ bias_corrected &lt;chr&gt; "0", "0", NA, NA, NA, NA, NA, NA, NA, NA,…</span></span>
<span id="cb28-94"><a href="#cb28-94" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ bias_correction_factor &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</span></span>
<span id="cb28-95"><a href="#cb28-95" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ notes_fitting_model &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</span></span>
<span id="cb28-96"><a href="#cb28-96" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ original_equation_id &lt;chr&gt; "Upland black spruce", NA, NA, NA, NA, NA…</span></span>
<span id="cb28-97"><a href="#cb28-97" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ original_data_availability &lt;chr&gt; "NRA", "NRA", "NRA", "NRA", "NRA", "NRA",…</span></span>
<span id="cb28-98"><a href="#cb28-98" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ equation_notes &lt;chr&gt; NA, NA, "Proved difficult to obtain origi…</span></span>
<span id="cb28-99"><a href="#cb28-99" aria-hidden="true" tabindex="-1"></a><span class="st"># Simple North America filter</span></span>
<span id="cb28-100"><a href="#cb28-100" aria-hidden="true" tabindex="-1"></a><span class="st">eq_region &lt;- equations |&gt;</span></span>
<span id="cb28-101"><a href="#cb28-101" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::mutate(lat = as.numeric(lat), long = as.numeric(long)) |&gt;</span></span>
<span id="cb28-102"><a href="#cb28-102" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::filter(!is.na(lat), !is.na(long), lat &gt;= 24, lat &lt;= 72, long &gt;= -168, long &lt;= -52)</span></span>
<span id="cb28-103"><a href="#cb28-103" aria-hidden="true" tabindex="-1"></a><span class="st"># tabulate</span></span>
<span id="cb28-104"><a href="#cb28-104" aria-hidden="true" tabindex="-1"></a><span class="st">show_cols = c("ref_id", "equation_taxa", "allometry_specificity", "equation_allometry")</span></span>
<span id="cb28-105"><a href="#cb28-105" aria-hidden="true" tabindex="-1"></a><span class="st">head(eq_region[, show_cols]) |&gt; flextable::flextable() |&gt; flextable::autofit() # top six rows only</span></span>
<span id="cb28-106"><a href="#cb28-106" aria-hidden="true" tabindex="-1"></a><span class="st"># species-specific equations for all Quercus subspecies of North America</span></span>
<span id="cb28-107"><a href="#cb28-107" aria-hidden="true" tabindex="-1"></a><span class="st">eq_region_species &lt;- eq_region |&gt;</span></span>
<span id="cb28-108"><a href="#cb28-108" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::filter(allometry_specificity == "Species") |&gt;</span></span>
<span id="cb28-109"><a href="#cb28-109" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::filter(grepl("^Quercus", equation_taxa, ignore.case = TRUE) | # Starts with "Quercus"</span></span>
<span id="cb28-110"><a href="#cb28-110" aria-hidden="true" tabindex="-1"></a><span class="st">(allometry_specificity %in% c("Genus", "Family") &amp;</span></span>
<span id="cb28-111"><a href="#cb28-111" aria-hidden="true" tabindex="-1"></a><span class="st">grepl("Quercus", equation_taxa, ignore.case = TRUE))</span></span>
<span id="cb28-112"><a href="#cb28-112" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb28-113"><a href="#cb28-113" aria-hidden="true" tabindex="-1"></a><span class="st"># genus-specific equations for Quercus populations of North America</span></span>
<span id="cb28-114"><a href="#cb28-114" aria-hidden="true" tabindex="-1"></a><span class="st">eq_region_genus = eq_region |&gt;</span></span>
<span id="cb28-115"><a href="#cb28-115" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::filter(allometry_specificity == "Genus") |&gt;</span></span>
<span id="cb28-116"><a href="#cb28-116" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::filter(grepl("^Quercus", equation_taxa, ignore.case = TRUE) | # Starts with "Quercus"</span></span>
<span id="cb28-117"><a href="#cb28-117" aria-hidden="true" tabindex="-1"></a><span class="st">(allometry_specificity %in% c("Genus", "Family") &amp;</span></span>
<span id="cb28-118"><a href="#cb28-118" aria-hidden="true" tabindex="-1"></a><span class="st">grepl("Quercus", equation_taxa, ignore.case = TRUE))</span></span>
<span id="cb28-119"><a href="#cb28-119" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb28-120"><a href="#cb28-120" aria-hidden="true" tabindex="-1"></a><span class="st"># tabulate</span></span>
<span id="cb28-121"><a href="#cb28-121" aria-hidden="true" tabindex="-1"></a><span class="st">flextable::flextable(eq_region_species[, show_cols]) |&gt; flextable::autofit()</span></span>
<span id="cb28-122"><a href="#cb28-122" aria-hidden="true" tabindex="-1"></a><span class="st"># filter genus-specific equations by DBH range of field data</span></span>
<span id="cb28-123"><a href="#cb28-123" aria-hidden="true" tabindex="-1"></a><span class="st">field_dbh_min &lt;- min(scbi_quercus$dbh, na.rm = T) # 1.04 cm</span></span>
<span id="cb28-124"><a href="#cb28-124" aria-hidden="true" tabindex="-1"></a><span class="st">field_dbh_max &lt;- max(scbi_quercus$dbh, na.rm = T) # 83.5 cm</span></span>
<span id="cb28-125"><a href="#cb28-125" aria-hidden="true" tabindex="-1"></a><span class="st">eq_region_genus_dbh &lt;- eq_region_genus |&gt;</span></span>
<span id="cb28-126"><a href="#cb28-126" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::mutate(</span></span>
<span id="cb28-127"><a href="#cb28-127" aria-hidden="true" tabindex="-1"></a><span class="st">dbh_min_cm = as.numeric(dbh_min_cm),</span></span>
<span id="cb28-128"><a href="#cb28-128" aria-hidden="true" tabindex="-1"></a><span class="st">dbh_max_cm = as.numeric(dbh_max_cm)) |&gt;</span></span>
<span id="cb28-129"><a href="#cb28-129" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::filter(!is.na(dbh_min_cm), !is.na(dbh_max_cm),</span></span>
<span id="cb28-130"><a href="#cb28-130" aria-hidden="true" tabindex="-1"></a><span class="st"># extrapolation of saplings (min=20cm), compensated below (Audit risk if sapling count is high)</span></span>
<span id="cb28-131"><a href="#cb28-131" aria-hidden="true" tabindex="-1"></a><span class="st">dbh_min_cm &lt;= field_dbh_min * 20,</span></span>
<span id="cb28-132"><a href="#cb28-132" aria-hidden="true" tabindex="-1"></a><span class="st">dbh_max_cm &gt;= field_dbh_max)</span></span>
<span id="cb28-133"><a href="#cb28-133" aria-hidden="true" tabindex="-1"></a><span class="st">eq_region_species_dbh &lt;- eq_region_species |&gt;</span></span>
<span id="cb28-134"><a href="#cb28-134" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::mutate(</span></span>
<span id="cb28-135"><a href="#cb28-135" aria-hidden="true" tabindex="-1"></a><span class="st">dbh_min_cm = as.numeric(dbh_min_cm),</span></span>
<span id="cb28-136"><a href="#cb28-136" aria-hidden="true" tabindex="-1"></a><span class="st">dbh_max_cm = as.numeric(dbh_max_cm)) |&gt;</span></span>
<span id="cb28-137"><a href="#cb28-137" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::filter(!is.na(dbh_min_cm), !is.na(dbh_max_cm),</span></span>
<span id="cb28-138"><a href="#cb28-138" aria-hidden="true" tabindex="-1"></a><span class="st">dbh_max_cm &gt;= field_dbh_max * 0.7)</span></span>
<span id="cb28-139"><a href="#cb28-139" aria-hidden="true" tabindex="-1"></a><span class="st">26</span></span>
<span id="cb28-140"><a href="#cb28-140" aria-hidden="true" tabindex="-1"></a><span class="st"># extrapolation of crowns allowed, consider outliers</span></span>
<span id="cb28-141"><a href="#cb28-141" aria-hidden="true" tabindex="-1"></a><span class="st">flextable::flextable(eq_region_genus_dbh[, show_cols]) |&gt; flextable::autofit()</span></span>
<span id="cb28-142"><a href="#cb28-142" aria-hidden="true" tabindex="-1"></a><span class="st">flextable::flextable(eq_region_species_dbh[, show_cols]) |&gt; flextable::autofit()</span></span>
<span id="cb28-143"><a href="#cb28-143" aria-hidden="true" tabindex="-1"></a><span class="st"># Sample size filtering</span></span>
<span id="cb28-144"><a href="#cb28-144" aria-hidden="true" tabindex="-1"></a><span class="st">eq_region_genus_dbh_sample &lt;- eq_region_genus_dbh |&gt;</span></span>
<span id="cb28-145"><a href="#cb28-145" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::filter(sample_size &gt;= 17) # Minimum for genus-specific equations</span></span>
<span id="cb28-146"><a href="#cb28-146" aria-hidden="true" tabindex="-1"></a><span class="st">eq_region_species_dbh_sample &lt;- eq_region_species_dbh |&gt;</span></span>
<span id="cb28-147"><a href="#cb28-147" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::filter(sample_size &gt;= 17) # Minimum for species-specific equations</span></span>
<span id="cb28-148"><a href="#cb28-148" aria-hidden="true" tabindex="-1"></a><span class="st"># Display selected equations &amp; tally valid equations remaining</span></span>
<span id="cb28-149"><a href="#cb28-149" aria-hidden="true" tabindex="-1"></a><span class="st">flextable::flextable(eq_region_genus_dbh_sample[, show_cols]) |&gt; flextable::autofit()</span></span>
<span id="cb28-150"><a href="#cb28-150" aria-hidden="true" tabindex="-1"></a><span class="st">flextable::flextable(eq_region_species_dbh_sample[, show_cols]) |&gt; flextable::autofit()</span></span>
<span id="cb28-151"><a href="#cb28-151" aria-hidden="true" tabindex="-1"></a><span class="st"># This table includes filtered default Acer equations AND custom new equations.</span></span>
<span id="cb28-152"><a href="#cb28-152" aria-hidden="true" tabindex="-1"></a><span class="st">eq_tab_combined &lt;- new_equations(</span></span>
<span id="cb28-153"><a href="#cb28-153" aria-hidden="true" tabindex="-1"></a><span class="st">subset_taxa = "Quercus",</span></span>
<span id="cb28-154"><a href="#cb28-154" aria-hidden="true" tabindex="-1"></a><span class="st">new_taxa = c("Quercus ilex", "Castanea sativa"),</span></span>
<span id="cb28-155"><a href="#cb28-155" aria-hidden="true" tabindex="-1"></a><span class="st">new_allometry = c("0.12*dbh^2.5", "0.15*dbh^2.7"),</span></span>
<span id="cb28-156"><a href="#cb28-156" aria-hidden="true" tabindex="-1"></a><span class="st">new_coords = c(4, 44),</span></span>
<span id="cb28-157"><a href="#cb28-157" aria-hidden="true" tabindex="-1"></a><span class="st">new_min_dbh = c(5, 10),</span></span>
<span id="cb28-158"><a href="#cb28-158" aria-hidden="true" tabindex="-1"></a><span class="st">new_max_dbh = c(35, 68),</span></span>
<span id="cb28-159"><a href="#cb28-159" aria-hidden="true" tabindex="-1"></a><span class="st">new_sample_size = c(143, 62)</span></span>
<span id="cb28-160"><a href="#cb28-160" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb28-161"><a href="#cb28-161" aria-hidden="true" tabindex="-1"></a><span class="st"># The get_biomass() function internally performs the weighting, resampling,</span></span>
<span id="cb28-162"><a href="#cb28-162" aria-hidden="true" tabindex="-1"></a><span class="st"># and calibration based on the equations in eq_tab_combined.</span></span>
<span id="cb28-163"><a href="#cb28-163" aria-hidden="true" tabindex="-1"></a><span class="st">agb_custom_estimate &lt;- get_biomass(</span></span>
<span id="cb28-164"><a href="#cb28-164" aria-hidden="true" tabindex="-1"></a><span class="st">dbh = 50,</span></span>
<span id="cb28-165"><a href="#cb28-165" aria-hidden="true" tabindex="-1"></a><span class="st">genus = "Quercus",</span></span>
<span id="cb28-166"><a href="#cb28-166" aria-hidden="true" tabindex="-1"></a><span class="st">species = "rubrum",</span></span>
<span id="cb28-167"><a href="#cb28-167" aria-hidden="true" tabindex="-1"></a><span class="st">coords = c(-78.2, 38.9),</span></span>
<span id="cb28-168"><a href="#cb28-168" aria-hidden="true" tabindex="-1"></a><span class="st">new_eqtable = eq_tab_combined # Use the consolidated custom table</span></span>
<span id="cb28-169"><a href="#cb28-169" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb28-170"><a href="#cb28-170" aria-hidden="true" tabindex="-1"></a><span class="st"># Print the resulting AGB estimate</span></span>
<span id="cb28-171"><a href="#cb28-171" aria-hidden="true" tabindex="-1"></a><span class="st">print(paste("Estimated AGB using the combined custom table:", agb_custom_estimate, "kg"))</span></span>
<span id="cb28-172"><a href="#cb28-172" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb28-173"><a href="#cb28-173" aria-hidden="true" tabindex="-1"></a><span class="st"># 1.6.4 Biomass Estimation (Section 1.2)</span></span>
<span id="cb28-174"><a href="#cb28-174" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb28-175"><a href="#cb28-175" aria-hidden="true" tabindex="-1"></a><span class="st"># once allometry equation is confirmed, use native allodb to load it</span></span>
<span id="cb28-176"><a href="#cb28-176" aria-hidden="true" tabindex="-1"></a><span class="st">eq_region_genus_dbh_sample = allodb::new_equations(subset_ids = "a664c1")</span></span>
<span id="cb28-177"><a href="#cb28-177" aria-hidden="true" tabindex="-1"></a><span class="st"># species-specific biomass estimates</span></span>
<span id="cb28-178"><a href="#cb28-178" aria-hidden="true" tabindex="-1"></a><span class="st">scbi_quercus$agb_species &lt;- allodb::get_biomass(</span></span>
<span id="cb28-179"><a href="#cb28-179" aria-hidden="true" tabindex="-1"></a><span class="st">dbh = scbi_quercus$dbh,</span></span>
<span id="cb28-180"><a href="#cb28-180" aria-hidden="true" tabindex="-1"></a><span class="st">genus = scbi_quercus$genus,</span></span>
<span id="cb28-181"><a href="#cb28-181" aria-hidden="true" tabindex="-1"></a><span class="st">species = scbi_quercus$species,</span></span>
<span id="cb28-182"><a href="#cb28-182" aria-hidden="true" tabindex="-1"></a><span class="st">coords = c(-78.2, 38.9)</span></span>
<span id="cb28-183"><a href="#cb28-183" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb28-184"><a href="#cb28-184" aria-hidden="true" tabindex="-1"></a><span class="st"># genus-specific biomass estimates</span></span>
<span id="cb28-185"><a href="#cb28-185" aria-hidden="true" tabindex="-1"></a><span class="st">scbi_quercus$agb_genus &lt;- allodb::get_biomass(</span></span>
<span id="cb28-186"><a href="#cb28-186" aria-hidden="true" tabindex="-1"></a><span class="st">dbh = scbi_quercus$dbh,</span></span>
<span id="cb28-187"><a href="#cb28-187" aria-hidden="true" tabindex="-1"></a><span class="st">genus = scbi_quercus$genus,</span></span>
<span id="cb28-188"><a href="#cb28-188" aria-hidden="true" tabindex="-1"></a><span class="st">species = scbi_quercus$species,</span></span>
<span id="cb28-189"><a href="#cb28-189" aria-hidden="true" tabindex="-1"></a><span class="st">27</span></span>
<span id="cb28-190"><a href="#cb28-190" aria-hidden="true" tabindex="-1"></a><span class="st">coords = c(-78.2, 38.9),</span></span>
<span id="cb28-191"><a href="#cb28-191" aria-hidden="true" tabindex="-1"></a><span class="st">new_eqtable = eq_region_genus_dbh_sample</span></span>
<span id="cb28-192"><a href="#cb28-192" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb28-193"><a href="#cb28-193" aria-hidden="true" tabindex="-1"></a><span class="st"># derive generic estimates using standard equations</span></span>
<span id="cb28-194"><a href="#cb28-194" aria-hidden="true" tabindex="-1"></a><span class="st">wood_densities &lt;- BIOMASS::getWoodDensity(</span></span>
<span id="cb28-195"><a href="#cb28-195" aria-hidden="true" tabindex="-1"></a><span class="st">genus = scbi_quercus$genus,</span></span>
<span id="cb28-196"><a href="#cb28-196" aria-hidden="true" tabindex="-1"></a><span class="st">species = scbi_quercus$species,</span></span>
<span id="cb28-197"><a href="#cb28-197" aria-hidden="true" tabindex="-1"></a><span class="st">stand = scbi_quercus$Plot)</span></span>
<span id="cb28-198"><a href="#cb28-198" aria-hidden="true" tabindex="-1"></a><span class="st">scbi_quercus$WD &lt;- wood_densities$meanWD</span></span>
<span id="cb28-199"><a href="#cb28-199" aria-hidden="true" tabindex="-1"></a><span class="st"># Chave et al 2014</span></span>
<span id="cb28-200"><a href="#cb28-200" aria-hidden="true" tabindex="-1"></a><span class="st">scbi_quercus$agb_chave2014 &lt;- BIOMASS::computeAGB(</span></span>
<span id="cb28-201"><a href="#cb28-201" aria-hidden="true" tabindex="-1"></a><span class="st">D = scbi_quercus$dbh,</span></span>
<span id="cb28-202"><a href="#cb28-202" aria-hidden="true" tabindex="-1"></a><span class="st">WD = scbi_quercus$WD,</span></span>
<span id="cb28-203"><a href="#cb28-203" aria-hidden="true" tabindex="-1"></a><span class="st">coord = c(-78.2, 38.9))</span></span>
<span id="cb28-204"><a href="#cb28-204" aria-hidden="true" tabindex="-1"></a><span class="st"># convert units</span></span>
<span id="cb28-205"><a href="#cb28-205" aria-hidden="true" tabindex="-1"></a><span class="st">scbi_quercus$agb_chave2014 = scbi_quercus$agb_chave2014 * 1000</span></span>
<span id="cb28-206"><a href="#cb28-206" aria-hidden="true" tabindex="-1"></a><span class="st"># Chave et al 2005 (MANUAL Fit)</span></span>
<span id="cb28-207"><a href="#cb28-207" aria-hidden="true" tabindex="-1"></a><span class="st">scbi_quercus$agb_chave2005 &lt;- scbi_quercus$WD *</span></span>
<span id="cb28-208"><a href="#cb28-208" aria-hidden="true" tabindex="-1"></a><span class="st">exp(-1.499 + 2.148*log(scbi_quercus$dbh) +</span></span>
<span id="cb28-209"><a href="#cb28-209" aria-hidden="true" tabindex="-1"></a><span class="st">0.207*(log(scbi_quercus$dbh))^2 -</span></span>
<span id="cb28-210"><a href="#cb28-210" aria-hidden="true" tabindex="-1"></a><span class="st">0.0281*(log(scbi_quercus$dbh))^3)</span></span>
<span id="cb28-211"><a href="#cb28-211" aria-hidden="true" tabindex="-1"></a><span class="st"># Brown et al 1997 (MANUAL Fit)</span></span>
<span id="cb28-212"><a href="#cb28-212" aria-hidden="true" tabindex="-1"></a><span class="st">scbi_quercus$agb_brown1997 &lt;- exp(2.134 + 2.53 * log(scbi_quercus$dbh))</span></span>
<span id="cb28-213"><a href="#cb28-213" aria-hidden="true" tabindex="-1"></a><span class="st">scbi_quercus$agb_brown1997 = scbi_quercus$agb_brown1997 / 100</span></span>
<span id="cb28-214"><a href="#cb28-214" aria-hidden="true" tabindex="-1"></a><span class="st">flextable::flextable(scbi_quercus) |&gt;</span></span>
<span id="cb28-215"><a href="#cb28-215" aria-hidden="true" tabindex="-1"></a><span class="st">flextable::autofit() |&gt; head() |&gt;</span></span>
<span id="cb28-216"><a href="#cb28-216" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb28-217"><a href="#cb28-217" aria-hidden="true" tabindex="-1"></a><span class="st"># 1.6.5 Normality Testing (Section 1.3)</span></span>
<span id="cb28-218"><a href="#cb28-218" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb28-219"><a href="#cb28-219" aria-hidden="true" tabindex="-1"></a><span class="st"># Calculate skewness and kurtosis for DBH</span></span>
<span id="cb28-220"><a href="#cb28-220" aria-hidden="true" tabindex="-1"></a><span class="st">dbh_skew = moments::skewness(scbi_quercus$dbh)</span></span>
<span id="cb28-221"><a href="#cb28-221" aria-hidden="true" tabindex="-1"></a><span class="st">dbh_kurt = moments::kurtosis(scbi_quercus$dbh)</span></span>
<span id="cb28-222"><a href="#cb28-222" aria-hidden="true" tabindex="-1"></a><span class="st">dbh_shapiro = stats::shapiro.test(scbi_quercus$dbh)</span></span>
<span id="cb28-223"><a href="#cb28-223" aria-hidden="true" tabindex="-1"></a><span class="st">dbh_wilcox = stats::wilcox.test(scbi_quercus$dbh)</span></span>
<span id="cb28-224"><a href="#cb28-224" aria-hidden="true" tabindex="-1"></a><span class="st"># Calculate skewness and kurtosis for each AGB estimate</span></span>
<span id="cb28-225"><a href="#cb28-225" aria-hidden="true" tabindex="-1"></a><span class="st">agb_species_skew = moments::skewness(scbi_quercus$agb_species)</span></span>
<span id="cb28-226"><a href="#cb28-226" aria-hidden="true" tabindex="-1"></a><span class="st">agb_species_kurt = moments::kurtosis(scbi_quercus$agb_species)</span></span>
<span id="cb28-227"><a href="#cb28-227" aria-hidden="true" tabindex="-1"></a><span class="st">agb_species_shapiro = stats::shapiro.test(scbi_quercus$agb_species)</span></span>
<span id="cb28-228"><a href="#cb28-228" aria-hidden="true" tabindex="-1"></a><span class="st">agb_species_wilcox = stats::wilcox.test(scbi_quercus$agb_species)</span></span>
<span id="cb28-229"><a href="#cb28-229" aria-hidden="true" tabindex="-1"></a><span class="st">agb_genus_skew = moments::skewness(scbi_quercus$agb_genus)</span></span>
<span id="cb28-230"><a href="#cb28-230" aria-hidden="true" tabindex="-1"></a><span class="st">agb_genus_kurt = moments::kurtosis(scbi_quercus$agb_genus)</span></span>
<span id="cb28-231"><a href="#cb28-231" aria-hidden="true" tabindex="-1"></a><span class="st">agb_genus_shapiro = stats::shapiro.test(scbi_quercus$agb_genus)</span></span>
<span id="cb28-232"><a href="#cb28-232" aria-hidden="true" tabindex="-1"></a><span class="st">agb_genus_wilcox = stats::wilcox.test(scbi_quercus$agb_genus)</span></span>
<span id="cb28-233"><a href="#cb28-233" aria-hidden="true" tabindex="-1"></a><span class="st">agb_chave2014_skew = moments::skewness(scbi_quercus$agb_chave2014)</span></span>
<span id="cb28-234"><a href="#cb28-234" aria-hidden="true" tabindex="-1"></a><span class="st">agb_chave2014_kurt = moments::kurtosis(scbi_quercus$agb_chave2014)</span></span>
<span id="cb28-235"><a href="#cb28-235" aria-hidden="true" tabindex="-1"></a><span class="st">agb_chave2014_shapiro = stats::shapiro.test(scbi_quercus$agb_chave2014)</span></span>
<span id="cb28-236"><a href="#cb28-236" aria-hidden="true" tabindex="-1"></a><span class="st">agb_chave2014_wilcox = stats::wilcox.test(scbi_quercus$agb_chave2014)</span></span>
<span id="cb28-237"><a href="#cb28-237" aria-hidden="true" tabindex="-1"></a><span class="st">agb_brown1997_skew = moments::skewness(scbi_quercus$agb_brown1997)</span></span>
<span id="cb28-238"><a href="#cb28-238" aria-hidden="true" tabindex="-1"></a><span class="st">agb_brown1997_kurt = moments::kurtosis(scbi_quercus$agb_brown1997)</span></span>
<span id="cb28-239"><a href="#cb28-239" aria-hidden="true" tabindex="-1"></a><span class="st">28</span></span>
<span id="cb28-240"><a href="#cb28-240" aria-hidden="true" tabindex="-1"></a><span class="st">agb_brown1997_shapiro= stats::shapiro.test(scbi_quercus$agb_brown1997)</span></span>
<span id="cb28-241"><a href="#cb28-241" aria-hidden="true" tabindex="-1"></a><span class="st">agb_brown1997_wilcox = stats::wilcox.test(scbi_quercus$agb_brown1997)</span></span>
<span id="cb28-242"><a href="#cb28-242" aria-hidden="true" tabindex="-1"></a><span class="st">agb_chave2005_skew = moments::skewness(scbi_quercus$agb_chave2005)</span></span>
<span id="cb28-243"><a href="#cb28-243" aria-hidden="true" tabindex="-1"></a><span class="st">agb_chave2005_kurt = moments::kurtosis(scbi_quercus$agb_chave2005)</span></span>
<span id="cb28-244"><a href="#cb28-244" aria-hidden="true" tabindex="-1"></a><span class="st">agb_chave2005_shapiro= stats::shapiro.test(scbi_quercus$agb_chave2005)</span></span>
<span id="cb28-245"><a href="#cb28-245" aria-hidden="true" tabindex="-1"></a><span class="st">agb_chave2005_wilcox = stats::shapiro.test(scbi_quercus$agb_chave2005)</span></span>
<span id="cb28-246"><a href="#cb28-246" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb28-247"><a href="#cb28-247" aria-hidden="true" tabindex="-1"></a><span class="st"># 1.6.6 Heteroscedasticity Testing (Section 1.3)</span></span>
<span id="cb28-248"><a href="#cb28-248" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb28-249"><a href="#cb28-249" aria-hidden="true" tabindex="-1"></a><span class="st"># Derive results to test non-constant variance of selected predictor</span></span>
<span id="cb28-250"><a href="#cb28-250" aria-hidden="true" tabindex="-1"></a><span class="st">dbh_agb_species_lm &lt;- lm(agb_species ~ dbh, data = scbi_quercus)</span></span>
<span id="cb28-251"><a href="#cb28-251" aria-hidden="true" tabindex="-1"></a><span class="st">bp_test &lt;- lmtest::bptest(dbh_agb_species_lm)</span></span>
<span id="cb28-252"><a href="#cb28-252" aria-hidden="true" tabindex="-1"></a><span class="st">cat(sprintf("Breusch-Pagan Test Results:</span><span class="sc">\n</span><span class="st">"))</span></span>
<span id="cb28-253"><a href="#cb28-253" aria-hidden="true" tabindex="-1"></a><span class="st">NA Breusch-Pagan Test Results:</span></span>
<span id="cb28-254"><a href="#cb28-254" aria-hidden="true" tabindex="-1"></a><span class="st">cat(sprintf("BP statistic: %.4f</span><span class="sc">\n</span><span class="st">", bp_test$statistic))</span></span>
<span id="cb28-255"><a href="#cb28-255" aria-hidden="true" tabindex="-1"></a><span class="st">NA BP statistic: 10.0051</span></span>
<span id="cb28-256"><a href="#cb28-256" aria-hidden="true" tabindex="-1"></a><span class="st">cat(sprintf("p-value: %.4f</span><span class="sc">\n</span><span class="st">", bp_test$p.value))</span></span>
<span id="cb28-257"><a href="#cb28-257" aria-hidden="true" tabindex="-1"></a><span class="st">NA p-value: 0.0016</span></span>
<span id="cb28-258"><a href="#cb28-258" aria-hidden="true" tabindex="-1"></a><span class="st">cat(sprintf("Decision: %s</span><span class="sc">\n</span><span class="st">"</span></span>
<span id="cb28-259"><a href="#cb28-259" aria-hidden="true" tabindex="-1"></a><span class="st">, ifelse(bp_test$p.value &lt; 0.05,</span></span>
<span id="cb28-260"><a href="#cb28-260" aria-hidden="true" tabindex="-1"></a><span class="st">"Reject H₀ - Heteroscedasticity present", "Fail to reject H₀ - Homoscedasticity")))</span></span>
<span id="cb28-261"><a href="#cb28-261" aria-hidden="true" tabindex="-1"></a><span class="st">NA Decision: Reject H₀ - Heteroscedasticity present</span></span>
<span id="cb28-262"><a href="#cb28-262" aria-hidden="true" tabindex="-1"></a><span class="st"># Visualize</span></span>
<span id="cb28-263"><a href="#cb28-263" aria-hidden="true" tabindex="-1"></a><span class="st">plot(scbi_quercus$dbh, scbi_quercus$agb_species,</span></span>
<span id="cb28-264"><a href="#cb28-264" aria-hidden="true" tabindex="-1"></a><span class="st">pch = 16, cex = 0.8, col = "steelblue",</span></span>
<span id="cb28-265"><a href="#cb28-265" aria-hidden="true" tabindex="-1"></a><span class="st">xlab = "DBH (cm)", ylab = "AGB (kg)",</span></span>
<span id="cb28-266"><a href="#cb28-266" aria-hidden="true" tabindex="-1"></a><span class="st">main = "DBH-AGB Relationship: Heteroscedasticity Assessment")</span></span>
<span id="cb28-267"><a href="#cb28-267" aria-hidden="true" tabindex="-1"></a><span class="st">abline(dbh_agb_species_lm, col = "red", lwd = 2)</span></span>
<span id="cb28-268"><a href="#cb28-268" aria-hidden="true" tabindex="-1"></a><span class="st">abline(v = c(20, 40, 60), col = "gray", lty = 2)</span></span>
<span id="cb28-269"><a href="#cb28-269" aria-hidden="true" tabindex="-1"></a><span class="st">legend("topleft",legend=c("Observed values", "Linear fit", "Size class breaks"),</span></span>
<span id="cb28-270"><a href="#cb28-270" aria-hidden="true" tabindex="-1"></a><span class="st">col=c("steelblue", "red", "gray"), pch = c(16, NA, NA),</span></span>
<span id="cb28-271"><a href="#cb28-271" aria-hidden="true" tabindex="-1"></a><span class="st">lty = c(NA, 1, 2), lwd = c(NA, 2, 1), bty = "n", cex = 0.8)</span></span>
<span id="cb28-272"><a href="#cb28-272" aria-hidden="true" tabindex="-1"></a><span class="st">text(x = 70, y = max(scbi_quercus$agb_species) * 0.9,</span></span>
<span id="cb28-273"><a href="#cb28-273" aria-hidden="true" tabindex="-1"></a><span class="st">labels = sprintf("BP test: p = %.4f</span><span class="sc">\n</span><span class="st">Heteroscedasticity confirmed", bp_test$p.value),</span></span>
<span id="cb28-274"><a href="#cb28-274" aria-hidden="true" tabindex="-1"></a><span class="st">adj = c(0, 1), cex = 0.9, font = 2)</span></span>
<span id="cb28-275"><a href="#cb28-275" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb28-276"><a href="#cb28-276" aria-hidden="true" tabindex="-1"></a><span class="st"># 1.6.7 Log-Transformation Performance (Section 1.3)</span></span>
<span id="cb28-277"><a href="#cb28-277" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb28-278"><a href="#cb28-278" aria-hidden="true" tabindex="-1"></a><span class="st"># Derive performance metrics #</span></span>
<span id="cb28-279"><a href="#cb28-279" aria-hidden="true" tabindex="-1"></a><span class="st">lin_species = lm(agb_species ~ dbh, data = scbi_quercus)</span></span>
<span id="cb28-280"><a href="#cb28-280" aria-hidden="true" tabindex="-1"></a><span class="st">lin_genus = lm(agb_genus ~ dbh, data = scbi_quercus)</span></span>
<span id="cb28-281"><a href="#cb28-281" aria-hidden="true" tabindex="-1"></a><span class="st">lin_chave2014 = lm(agb_chave2014 ~ dbh, data = scbi_quercus)</span></span>
<span id="cb28-282"><a href="#cb28-282" aria-hidden="true" tabindex="-1"></a><span class="st">lin_brown1997 = lm(agb_brown1997 ~ dbh, data = scbi_quercus)</span></span>
<span id="cb28-283"><a href="#cb28-283" aria-hidden="true" tabindex="-1"></a><span class="st">lin_chave2005 = lm(agb_chave2005 ~ dbh, data = scbi_quercus)</span></span>
<span id="cb28-284"><a href="#cb28-284" aria-hidden="true" tabindex="-1"></a><span class="st">log_species = lm(log(agb_species) ~ log(dbh), data = scbi_quercus)</span></span>
<span id="cb28-285"><a href="#cb28-285" aria-hidden="true" tabindex="-1"></a><span class="st">log_genus = lm(log(agb_genus) ~ log(dbh), data = scbi_quercus)</span></span>
<span id="cb28-286"><a href="#cb28-286" aria-hidden="true" tabindex="-1"></a><span class="st">log_chave2014 = lm(log(agb_chave2014) ~ log(dbh), data = scbi_quercus)</span></span>
<span id="cb28-287"><a href="#cb28-287" aria-hidden="true" tabindex="-1"></a><span class="st">log_brown1997 = lm(log(agb_brown1997) ~ log(dbh), data = scbi_quercus)</span></span>
<span id="cb28-288"><a href="#cb28-288" aria-hidden="true" tabindex="-1"></a><span class="st">log_chave2005 = lm(log(agb_chave2005) ~ log(dbh), data = scbi_quercus)</span></span>
<span id="cb28-289"><a href="#cb28-289" aria-hidden="true" tabindex="-1"></a><span class="st"># Residuals: log models back-transformed **essential</span></span>
<span id="cb28-290"><a href="#cb28-290" aria-hidden="true" tabindex="-1"></a><span class="st">lin_species_resid = predict(lin_species, scbi_quercus, type='</span>response<span class="st">')</span></span>
<span id="cb28-291"><a href="#cb28-291" aria-hidden="true" tabindex="-1"></a><span class="st">lin_genus_resid = predict(lin_genus, scbi_quercus, type="response")</span></span>
<span id="cb28-292"><a href="#cb28-292" aria-hidden="true" tabindex="-1"></a><span class="st">lin_chave2014_resid = predict(lin_chave2014, scbi_quercus, type="response")</span></span>
<span id="cb28-293"><a href="#cb28-293" aria-hidden="true" tabindex="-1"></a><span class="st">29</span></span>
<span id="cb28-294"><a href="#cb28-294" aria-hidden="true" tabindex="-1"></a><span class="st">lin_brown1997_resid = predict(lin_brown1997, scbi_quercus, type="response")</span></span>
<span id="cb28-295"><a href="#cb28-295" aria-hidden="true" tabindex="-1"></a><span class="st">lin_chave2005_resid = predict(lin_chave2005, scbi_quercus, type="response")</span></span>
<span id="cb28-296"><a href="#cb28-296" aria-hidden="true" tabindex="-1"></a><span class="st">log_species_resid = exp(predict(log_species, scbi_quercus))</span></span>
<span id="cb28-297"><a href="#cb28-297" aria-hidden="true" tabindex="-1"></a><span class="st">log_genus_resid = exp(predict(log_genus, scbi_quercus))</span></span>
<span id="cb28-298"><a href="#cb28-298" aria-hidden="true" tabindex="-1"></a><span class="st">log_chave2014_resid = exp(predict(log_chave2014, scbi_quercus))</span></span>
<span id="cb28-299"><a href="#cb28-299" aria-hidden="true" tabindex="-1"></a><span class="st">log_brown1997_resid = exp(predict(log_brown1997, scbi_quercus))</span></span>
<span id="cb28-300"><a href="#cb28-300" aria-hidden="true" tabindex="-1"></a><span class="st">log_chave2005_resid = exp(predict(log_chave2005, scbi_quercus))</span></span>
<span id="cb28-301"><a href="#cb28-301" aria-hidden="true" tabindex="-1"></a><span class="st">lin_species_mae = ModelMetrics::mae(scbi_quercus$agb_species, lin_species_resid) |&gt; round(4)</span></span>
<span id="cb28-302"><a href="#cb28-302" aria-hidden="true" tabindex="-1"></a><span class="st">lin_species_rmse = ModelMetrics::rmse(scbi_quercus$agb_species, lin_species_resid) |&gt; round(4)</span></span>
<span id="cb28-303"><a href="#cb28-303" aria-hidden="true" tabindex="-1"></a><span class="st">lin_species_rmse_rel= round(lin_species_rmse / mean(scbi_quercus$agb_species, na.rm = T) * 100,4)</span></span>
<span id="cb28-304"><a href="#cb28-304" aria-hidden="true" tabindex="-1"></a><span class="st">log_species_mae = ModelMetrics::mae(scbi_quercus$agb_species, log_species_resid) |&gt; round(4)</span></span>
<span id="cb28-305"><a href="#cb28-305" aria-hidden="true" tabindex="-1"></a><span class="st">log_species_rmse = ModelMetrics::rmse(scbi_quercus$agb_species, log_species_resid) |&gt; round(4)</span></span>
<span id="cb28-306"><a href="#cb28-306" aria-hidden="true" tabindex="-1"></a><span class="st">log_species_rmse_rel= round(log_species_rmse / mean(scbi_quercus$agb_species, na.rm = T) * 100,4)</span></span>
<span id="cb28-307"><a href="#cb28-307" aria-hidden="true" tabindex="-1"></a><span class="st"># ******** CRITICAL back-transformation = log_species_rmse_rel</span></span>
<span id="cb28-308"><a href="#cb28-308" aria-hidden="true" tabindex="-1"></a><span class="st"># Genus-level</span></span>
<span id="cb28-309"><a href="#cb28-309" aria-hidden="true" tabindex="-1"></a><span class="st">lin_genus_mae = ModelMetrics::mae(scbi_quercus$agb_genus, lin_genus_resid) |&gt; round(4)</span></span>
<span id="cb28-310"><a href="#cb28-310" aria-hidden="true" tabindex="-1"></a><span class="st">lin_genus_rmse = ModelMetrics::rmse(scbi_quercus$agb_genus, lin_genus_resid) |&gt; round(4)</span></span>
<span id="cb28-311"><a href="#cb28-311" aria-hidden="true" tabindex="-1"></a><span class="st">lin_genus_rmse_rel = round(lin_genus_rmse / mean(scbi_quercus$agb_genus, na.rm=T) * 100,4)</span></span>
<span id="cb28-312"><a href="#cb28-312" aria-hidden="true" tabindex="-1"></a><span class="st">log_genus_mae = sprintf("%.2e", ModelMetrics::mae(scbi_quercus$agb_brown1997, log_brown1997_resid))</span></span>
<span id="cb28-313"><a href="#cb28-313" aria-hidden="true" tabindex="-1"></a><span class="st">log_genus_rmse = sprintf("%.2e", ModelMetrics::rmse(scbi_quercus$agb_genus, log_genus_resid))</span></span>
<span id="cb28-314"><a href="#cb28-314" aria-hidden="true" tabindex="-1"></a><span class="st">log_genus_rmse_rel = sprintf("%.2e", (as.numeric(log_genus_rmse)/mean(scbi_quercus$agb_genus, na.rm=T) *100))</span></span>
<span id="cb28-315"><a href="#cb28-315" aria-hidden="true" tabindex="-1"></a><span class="st"># --------- CRITICAL back-transformation = log_genus_rmse_rel --------- #</span></span>
<span id="cb28-316"><a href="#cb28-316" aria-hidden="true" tabindex="-1"></a><span class="st"># Chave 2014</span></span>
<span id="cb28-317"><a href="#cb28-317" aria-hidden="true" tabindex="-1"></a><span class="st">lin_chave2014_mae = ModelMetrics::mae(scbi_quercus$agb_chave2014, lin_chave2014_resid) |&gt; round(4)</span></span>
<span id="cb28-318"><a href="#cb28-318" aria-hidden="true" tabindex="-1"></a><span class="st">lin_chave2014_rmse = ModelMetrics::rmse(scbi_quercus$agb_chave2014, lin_chave2014_resid) |&gt; round(4)</span></span>
<span id="cb28-319"><a href="#cb28-319" aria-hidden="true" tabindex="-1"></a><span class="st">lin_chave2014_rmse_rel = round(lin_chave2014_rmse /mean(scbi_quercus$agb_chave2014,na.rm=T) * 100, 4)</span></span>
<span id="cb28-320"><a href="#cb28-320" aria-hidden="true" tabindex="-1"></a><span class="st">log_chave2014_mae = ModelMetrics::mae(scbi_quercus$agb_chave2014, log_chave2014_resid) |&gt; round(4)</span></span>
<span id="cb28-321"><a href="#cb28-321" aria-hidden="true" tabindex="-1"></a><span class="st">log_chave2014_rmse = ModelMetrics::rmse(scbi_quercus$agb_chave2014, log_chave2014_resid) |&gt; round(4)</span></span>
<span id="cb28-322"><a href="#cb28-322" aria-hidden="true" tabindex="-1"></a><span class="st">log_chave2014_rmse_rel = round(log_chave2014_rmse / mean(scbi_quercus$agb_chave2014, na.rm=T) * 100, 4)</span></span>
<span id="cb28-323"><a href="#cb28-323" aria-hidden="true" tabindex="-1"></a><span class="st"># Brown 1997</span></span>
<span id="cb28-324"><a href="#cb28-324" aria-hidden="true" tabindex="-1"></a><span class="st">lin_brown1997_mae = ModelMetrics::mae(scbi_quercus$agb_brown1997, lin_brown1997_resid) |&gt; round(4)</span></span>
<span id="cb28-325"><a href="#cb28-325" aria-hidden="true" tabindex="-1"></a><span class="st">lin_brown1997_rmse = ModelMetrics::rmse(scbi_quercus$agb_brown1997, lin_brown1997_resid) |&gt; round(4)</span></span>
<span id="cb28-326"><a href="#cb28-326" aria-hidden="true" tabindex="-1"></a><span class="st">lin_brown1997_rmse_rel = round(lin_brown1997_rmse / mean(scbi_quercus$agb_brown1997, na.rm=T) * 100, 4)</span></span>
<span id="cb28-327"><a href="#cb28-327" aria-hidden="true" tabindex="-1"></a><span class="st">log_brown1997_mae = sprintf("%.2e", ModelMetrics::mae(scbi_quercus$agb_brown1997, log_brown1997_resid))</span></span>
<span id="cb28-328"><a href="#cb28-328" aria-hidden="true" tabindex="-1"></a><span class="st">log_brown1997_rmse = sprintf("%.2e", ModelMetrics::rmse(scbi_quercus$agb_brown1997, log_brown1997_resid))</span></span>
<span id="cb28-329"><a href="#cb28-329" aria-hidden="true" tabindex="-1"></a><span class="st">log_brown1997_rmse_rel = sprintf("%.2e", (as.numeric(log_brown1997_rmse) / mean(scbi_quercus$agb_brown1997, na.r</span></span>
<span id="cb28-330"><a href="#cb28-330" aria-hidden="true" tabindex="-1"></a><span class="st">m=T) *100))</span></span>
<span id="cb28-331"><a href="#cb28-331" aria-hidden="true" tabindex="-1"></a><span class="st"># Chave 2005</span></span>
<span id="cb28-332"><a href="#cb28-332" aria-hidden="true" tabindex="-1"></a><span class="st">linear_chave2005_mae = ModelMetrics::mae(scbi_quercus$agb_chave2005, lin_chave2005_resid) |&gt; round(4)</span></span>
<span id="cb28-333"><a href="#cb28-333" aria-hidden="true" tabindex="-1"></a><span class="st">linear_chave2005_rmse = ModelMetrics::rmse(scbi_quercus$agb_chave2005, lin_chave2005_resid) |&gt; round(4)</span></span>
<span id="cb28-334"><a href="#cb28-334" aria-hidden="true" tabindex="-1"></a><span class="st">linear_chave2005_rmse_rel= (linear_chave2005_rmse/mean(scbi_quercus$agb_chave2005, na.rm=T) * 100)|&gt; round(2)</span></span>
<span id="cb28-335"><a href="#cb28-335" aria-hidden="true" tabindex="-1"></a><span class="st">log_chave2005_mae = ModelMetrics::mae(scbi_quercus$agb_chave2005, log_chave2005_resid) |&gt; round(4)</span></span>
<span id="cb28-336"><a href="#cb28-336" aria-hidden="true" tabindex="-1"></a><span class="st">log_chave2005_rmse = ModelMetrics::rmse(scbi_quercus$agb_chave2005, log_chave2005_resid) |&gt; round(4)</span></span>
<span id="cb28-337"><a href="#cb28-337" aria-hidden="true" tabindex="-1"></a><span class="st">log_chave2005_rmse_rel = (log_chave2005_rmse / mean(scbi_quercus$agb_chave2005, na.rm=T) * 100) |&gt; round(4)</span></span>
<span id="cb28-338"><a href="#cb28-338" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb28-339"><a href="#cb28-339" aria-hidden="true" tabindex="-1"></a><span class="st"># 1.6.8 Stratified Sampling (Section 1.3)</span></span>
<span id="cb28-340"><a href="#cb28-340" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb28-341"><a href="#cb28-341" aria-hidden="true" tabindex="-1"></a><span class="st">set.seed(123)</span></span>
<span id="cb28-342"><a href="#cb28-342" aria-hidden="true" tabindex="-1"></a><span class="st">age_class = scbi_quercus |&gt; dplyr::filter(</span></span>
<span id="cb28-343"><a href="#cb28-343" aria-hidden="true" tabindex="-1"></a><span class="st">!is.na(dbh), !is.na(agb_genus)) |&gt;</span></span>
<span id="cb28-344"><a href="#cb28-344" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::mutate(dbh_class = cut(dbh,</span></span>
<span id="cb28-345"><a href="#cb28-345" aria-hidden="true" tabindex="-1"></a><span class="st">30</span></span>
<span id="cb28-346"><a href="#cb28-346" aria-hidden="true" tabindex="-1"></a><span class="st">breaks = c(0, 10, 20, 30, 40, 50, 100),</span></span>
<span id="cb28-347"><a href="#cb28-347" aria-hidden="true" tabindex="-1"></a><span class="st">labels = c("0-10", "10-20", "20-30", "30-40", "40-50", "&gt;50")))</span></span>
<span id="cb28-348"><a href="#cb28-348" aria-hidden="true" tabindex="-1"></a><span class="st"># Check raw distribution across size classes</span></span>
<span id="cb28-349"><a href="#cb28-349" aria-hidden="true" tabindex="-1"></a><span class="st">age_class_distribution = age_class |&gt;</span></span>
<span id="cb28-350"><a href="#cb28-350" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::group_by(dbh_class) |&gt;</span></span>
<span id="cb28-351"><a href="#cb28-351" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::summarise(n = n(),</span></span>
<span id="cb28-352"><a href="#cb28-352" aria-hidden="true" tabindex="-1"></a><span class="st">mean_dbh = mean(dbh), mean_agb = mean(agb_genus),</span></span>
<span id="cb28-353"><a href="#cb28-353" aria-hidden="true" tabindex="-1"></a><span class="st">total_biomass_pct = sum(agb_genus) / sum(age_class$agb_genus) * 100,</span></span>
<span id="cb28-354"><a href="#cb28-354" aria-hidden="true" tabindex="-1"></a><span class="st">.groups = '</span>drop<span class="st">')</span></span>
<span id="cb28-355"><a href="#cb28-355" aria-hidden="true" tabindex="-1"></a><span class="st"># Check 80:20% to maintain proportional representation</span></span>
<span id="cb28-356"><a href="#cb28-356" aria-hidden="true" tabindex="-1"></a><span class="st">train_idx &lt;- age_class |&gt;</span></span>
<span id="cb28-357"><a href="#cb28-357" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::mutate(row_id = row_number()) |&gt;</span></span>
<span id="cb28-358"><a href="#cb28-358" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::group_by(dbh_class) |&gt;</span></span>
<span id="cb28-359"><a href="#cb28-359" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::slice_sample(prop = 0.8) |&gt;</span></span>
<span id="cb28-360"><a href="#cb28-360" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::pull(row_id)</span></span>
<span id="cb28-361"><a href="#cb28-361" aria-hidden="true" tabindex="-1"></a><span class="st">calibration_data &lt;- age_class[train_idx, ]</span></span>
<span id="cb28-362"><a href="#cb28-362" aria-hidden="true" tabindex="-1"></a><span class="st">validation_data &lt;- age_class[-train_idx, ]</span></span>
<span id="cb28-363"><a href="#cb28-363" aria-hidden="true" tabindex="-1"></a><span class="st">cal_props &lt;- calibration_data |&gt;</span></span>
<span id="cb28-364"><a href="#cb28-364" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::count(dbh_class) |&gt;</span></span>
<span id="cb28-365"><a href="#cb28-365" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::mutate(cal_pct = round((n / sum(n)) * 100, 1)) |&gt;</span></span>
<span id="cb28-366"><a href="#cb28-366" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::rename(cal_n = n)</span></span>
<span id="cb28-367"><a href="#cb28-367" aria-hidden="true" tabindex="-1"></a><span class="st">val_props &lt;- validation_data |&gt;</span></span>
<span id="cb28-368"><a href="#cb28-368" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::count(dbh_class) |&gt;</span></span>
<span id="cb28-369"><a href="#cb28-369" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::mutate(val_pct = round((n / sum(n)) * 100, 1)) |&gt;</span></span>
<span id="cb28-370"><a href="#cb28-370" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::rename(val_n = n)</span></span>
<span id="cb28-371"><a href="#cb28-371" aria-hidden="true" tabindex="-1"></a><span class="st">split_verification &lt;- cal_props |&gt;</span></span>
<span id="cb28-372"><a href="#cb28-372" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::left_join(val_props, by = "dbh_class") |&gt;</span></span>
<span id="cb28-373"><a href="#cb28-373" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::mutate(Total_n = cal_n + val_n, Difference_pct = abs(cal_pct - val_pct)) |&gt;</span></span>
<span id="cb28-374"><a href="#cb28-374" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::select(dbh_class, cal_n, cal_pct, val_n, val_pct, Total_n, Difference_pct)</span></span>
<span id="cb28-375"><a href="#cb28-375" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb28-376"><a href="#cb28-376" aria-hidden="true" tabindex="-1"></a><span class="st"># 1.6.9 Monte Carlo Cross-Validation (Section 1.4)</span></span>
<span id="cb28-377"><a href="#cb28-377" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb28-378"><a href="#cb28-378" aria-hidden="true" tabindex="-1"></a><span class="st"># Define Monte Carlo cross-validation parameters</span></span>
<span id="cb28-379"><a href="#cb28-379" aria-hidden="true" tabindex="-1"></a><span class="st">monte_carlo_100 &lt;- caret::trainControl(</span></span>
<span id="cb28-380"><a href="#cb28-380" aria-hidden="true" tabindex="-1"></a><span class="st">method = "LGOCV",</span></span>
<span id="cb28-381"><a href="#cb28-381" aria-hidden="true" tabindex="-1"></a><span class="st">number = 100, # no.# of full cycle resamples</span></span>
<span id="cb28-382"><a href="#cb28-382" aria-hidden="true" tabindex="-1"></a><span class="st">p = 0.8, # percentage of full cycle resampled</span></span>
<span id="cb28-383"><a href="#cb28-383" aria-hidden="true" tabindex="-1"></a><span class="st">savePredictions = "final"</span></span>
<span id="cb28-384"><a href="#cb28-384" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb28-385"><a href="#cb28-385" aria-hidden="true" tabindex="-1"></a><span class="st"># Species-Specific Model: Linear model tuned at species level with un-transformed covs</span></span>
<span id="cb28-386"><a href="#cb28-386" aria-hidden="true" tabindex="-1"></a><span class="st">lin_species_mc &lt;- caret::train(</span></span>
<span id="cb28-387"><a href="#cb28-387" aria-hidden="true" tabindex="-1"></a><span class="st">agb_species ~ dbh,</span></span>
<span id="cb28-388"><a href="#cb28-388" aria-hidden="true" tabindex="-1"></a><span class="st">data = scbi_quercus,</span></span>
<span id="cb28-389"><a href="#cb28-389" aria-hidden="true" tabindex="-1"></a><span class="st">method = "lm",</span></span>
<span id="cb28-390"><a href="#cb28-390" aria-hidden="true" tabindex="-1"></a><span class="st">na.action = na.omit,</span></span>
<span id="cb28-391"><a href="#cb28-391" aria-hidden="true" tabindex="-1"></a><span class="st">trControl = monte_carlo_100</span></span>
<span id="cb28-392"><a href="#cb28-392" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb28-393"><a href="#cb28-393" aria-hidden="true" tabindex="-1"></a><span class="st"># Species-Specific Model: Logarithmic model tuned at species level withg log-transformed covs</span></span>
<span id="cb28-394"><a href="#cb28-394" aria-hidden="true" tabindex="-1"></a><span class="st">log_species_mc &lt;- caret::train(</span></span>
<span id="cb28-395"><a href="#cb28-395" aria-hidden="true" tabindex="-1"></a><span class="st">log(agb_species) ~ log(dbh),</span></span>
<span id="cb28-396"><a href="#cb28-396" aria-hidden="true" tabindex="-1"></a><span class="st">data = scbi_quercus,</span></span>
<span id="cb28-397"><a href="#cb28-397" aria-hidden="true" tabindex="-1"></a><span class="st">method = "lm",</span></span>
<span id="cb28-398"><a href="#cb28-398" aria-hidden="true" tabindex="-1"></a><span class="st">na.action = na.omit,</span></span>
<span id="cb28-399"><a href="#cb28-399" aria-hidden="true" tabindex="-1"></a><span class="st">trControl = monte_carlo_100</span></span>
<span id="cb28-400"><a href="#cb28-400" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb28-401"><a href="#cb28-401" aria-hidden="true" tabindex="-1"></a><span class="st"># Genus-Specific Model: LINEAR model tuned at genus level with un-transformed covs</span></span>
<span id="cb28-402"><a href="#cb28-402" aria-hidden="true" tabindex="-1"></a><span class="st">31</span></span>
<span id="cb28-403"><a href="#cb28-403" aria-hidden="true" tabindex="-1"></a><span class="st">lin_genus_mc &lt;- caret::train(</span></span>
<span id="cb28-404"><a href="#cb28-404" aria-hidden="true" tabindex="-1"></a><span class="st">agb_genus ~ dbh,</span></span>
<span id="cb28-405"><a href="#cb28-405" aria-hidden="true" tabindex="-1"></a><span class="st">data = scbi_quercus,</span></span>
<span id="cb28-406"><a href="#cb28-406" aria-hidden="true" tabindex="-1"></a><span class="st">method = "lm",</span></span>
<span id="cb28-407"><a href="#cb28-407" aria-hidden="true" tabindex="-1"></a><span class="st">na.action = na.omit,</span></span>
<span id="cb28-408"><a href="#cb28-408" aria-hidden="true" tabindex="-1"></a><span class="st">trControl = monte_carlo_100</span></span>
<span id="cb28-409"><a href="#cb28-409" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb28-410"><a href="#cb28-410" aria-hidden="true" tabindex="-1"></a><span class="st"># Genus-Specific Model: LOG model tuned at genus level with un-transformed covs</span></span>
<span id="cb28-411"><a href="#cb28-411" aria-hidden="true" tabindex="-1"></a><span class="st">log_genus_mc &lt;- caret::train(</span></span>
<span id="cb28-412"><a href="#cb28-412" aria-hidden="true" tabindex="-1"></a><span class="st">log(agb_genus) ~ log(dbh),</span></span>
<span id="cb28-413"><a href="#cb28-413" aria-hidden="true" tabindex="-1"></a><span class="st">data = scbi_quercus,</span></span>
<span id="cb28-414"><a href="#cb28-414" aria-hidden="true" tabindex="-1"></a><span class="st">method = "lm",</span></span>
<span id="cb28-415"><a href="#cb28-415" aria-hidden="true" tabindex="-1"></a><span class="st">na.action = na.omit,</span></span>
<span id="cb28-416"><a href="#cb28-416" aria-hidden="true" tabindex="-1"></a><span class="st">trControl = monte_carlo_100</span></span>
<span id="cb28-417"><a href="#cb28-417" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb28-418"><a href="#cb28-418" aria-hidden="true" tabindex="-1"></a><span class="st"># Chave 2014 models: Generic scaled</span></span>
<span id="cb28-419"><a href="#cb28-419" aria-hidden="true" tabindex="-1"></a><span class="st">lin_chave2014_mc &lt;- caret::train(</span></span>
<span id="cb28-420"><a href="#cb28-420" aria-hidden="true" tabindex="-1"></a><span class="st">agb_chave2014 ~ dbh,</span></span>
<span id="cb28-421"><a href="#cb28-421" aria-hidden="true" tabindex="-1"></a><span class="st">data = scbi_quercus,</span></span>
<span id="cb28-422"><a href="#cb28-422" aria-hidden="true" tabindex="-1"></a><span class="st">method = "lm",</span></span>
<span id="cb28-423"><a href="#cb28-423" aria-hidden="true" tabindex="-1"></a><span class="st">na.action = na.omit,</span></span>
<span id="cb28-424"><a href="#cb28-424" aria-hidden="true" tabindex="-1"></a><span class="st">trControl = monte_carlo_100)</span></span>
<span id="cb28-425"><a href="#cb28-425" aria-hidden="true" tabindex="-1"></a><span class="st">log_chave2014_mc &lt;- caret::train(</span></span>
<span id="cb28-426"><a href="#cb28-426" aria-hidden="true" tabindex="-1"></a><span class="st">log(agb_chave2014) ~ log(dbh),</span></span>
<span id="cb28-427"><a href="#cb28-427" aria-hidden="true" tabindex="-1"></a><span class="st">data = scbi_quercus,</span></span>
<span id="cb28-428"><a href="#cb28-428" aria-hidden="true" tabindex="-1"></a><span class="st">method = "lm",</span></span>
<span id="cb28-429"><a href="#cb28-429" aria-hidden="true" tabindex="-1"></a><span class="st">na.action = na.omit,</span></span>
<span id="cb28-430"><a href="#cb28-430" aria-hidden="true" tabindex="-1"></a><span class="st">trControl = monte_carlo_100)</span></span>
<span id="cb28-431"><a href="#cb28-431" aria-hidden="true" tabindex="-1"></a><span class="st"># Brown 1997 models</span></span>
<span id="cb28-432"><a href="#cb28-432" aria-hidden="true" tabindex="-1"></a><span class="st">lin_brown1997_mc &lt;- caret::train(</span></span>
<span id="cb28-433"><a href="#cb28-433" aria-hidden="true" tabindex="-1"></a><span class="st">agb_brown1997 ~ dbh,</span></span>
<span id="cb28-434"><a href="#cb28-434" aria-hidden="true" tabindex="-1"></a><span class="st">data = scbi_quercus,</span></span>
<span id="cb28-435"><a href="#cb28-435" aria-hidden="true" tabindex="-1"></a><span class="st">method = "lm",</span></span>
<span id="cb28-436"><a href="#cb28-436" aria-hidden="true" tabindex="-1"></a><span class="st">na.action = na.omit,</span></span>
<span id="cb28-437"><a href="#cb28-437" aria-hidden="true" tabindex="-1"></a><span class="st">trControl = monte_carlo_100</span></span>
<span id="cb28-438"><a href="#cb28-438" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb28-439"><a href="#cb28-439" aria-hidden="true" tabindex="-1"></a><span class="st">log_brown1997_mc &lt;- caret::train(</span></span>
<span id="cb28-440"><a href="#cb28-440" aria-hidden="true" tabindex="-1"></a><span class="st">log(agb_brown1997) ~ log(dbh),</span></span>
<span id="cb28-441"><a href="#cb28-441" aria-hidden="true" tabindex="-1"></a><span class="st">data = scbi_quercus,</span></span>
<span id="cb28-442"><a href="#cb28-442" aria-hidden="true" tabindex="-1"></a><span class="st">method = "lm",</span></span>
<span id="cb28-443"><a href="#cb28-443" aria-hidden="true" tabindex="-1"></a><span class="st">na.action = na.omit,</span></span>
<span id="cb28-444"><a href="#cb28-444" aria-hidden="true" tabindex="-1"></a><span class="st">trControl = monte_carlo_100)</span></span>
<span id="cb28-445"><a href="#cb28-445" aria-hidden="true" tabindex="-1"></a><span class="st"># Chave 2005 models</span></span>
<span id="cb28-446"><a href="#cb28-446" aria-hidden="true" tabindex="-1"></a><span class="st">lin_chave2005_mc &lt;- caret::train(</span></span>
<span id="cb28-447"><a href="#cb28-447" aria-hidden="true" tabindex="-1"></a><span class="st">agb_chave2005 ~ dbh,</span></span>
<span id="cb28-448"><a href="#cb28-448" aria-hidden="true" tabindex="-1"></a><span class="st">data = scbi_quercus,</span></span>
<span id="cb28-449"><a href="#cb28-449" aria-hidden="true" tabindex="-1"></a><span class="st">method = "lm",</span></span>
<span id="cb28-450"><a href="#cb28-450" aria-hidden="true" tabindex="-1"></a><span class="st">na.action = na.omit,</span></span>
<span id="cb28-451"><a href="#cb28-451" aria-hidden="true" tabindex="-1"></a><span class="st">trControl = monte_carlo_100)</span></span>
<span id="cb28-452"><a href="#cb28-452" aria-hidden="true" tabindex="-1"></a><span class="st">log_chave2005_mc &lt;- caret::train(</span></span>
<span id="cb28-453"><a href="#cb28-453" aria-hidden="true" tabindex="-1"></a><span class="st">log(agb_chave2005) ~ log(dbh),</span></span>
<span id="cb28-454"><a href="#cb28-454" aria-hidden="true" tabindex="-1"></a><span class="st">data = scbi_quercus,</span></span>
<span id="cb28-455"><a href="#cb28-455" aria-hidden="true" tabindex="-1"></a><span class="st">method = "lm",</span></span>
<span id="cb28-456"><a href="#cb28-456" aria-hidden="true" tabindex="-1"></a><span class="st">na.action = na.omit,</span></span>
<span id="cb28-457"><a href="#cb28-457" aria-hidden="true" tabindex="-1"></a><span class="st">trControl = monte_carlo_100</span></span>
<span id="cb28-458"><a href="#cb28-458" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb28-459"><a href="#cb28-459" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb28-460"><a href="#cb28-460" aria-hidden="true" tabindex="-1"></a><span class="st"># 1.6.10 Model Ranking and Deduction Calculation (Section 1.5)</span></span>
<span id="cb28-461"><a href="#cb28-461" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb28-462"><a href="#cb28-462" aria-hidden="true" tabindex="-1"></a><span class="st">32</span></span>
<span id="cb28-463"><a href="#cb28-463" aria-hidden="true" tabindex="-1"></a><span class="st"># Extract log-transformed models as best performers</span></span>
<span id="cb28-464"><a href="#cb28-464" aria-hidden="true" tabindex="-1"></a><span class="st">log_models_ranked &lt;- mc_performance |&gt;</span></span>
<span id="cb28-465"><a href="#cb28-465" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::filter(Model_Type == "Log") |&gt;</span></span>
<span id="cb28-466"><a href="#cb28-466" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::arrange(Rel_RMSE_pct) |&gt;</span></span>
<span id="cb28-467"><a href="#cb28-467" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::mutate(</span></span>
<span id="cb28-468"><a href="#cb28-468" aria-hidden="true" tabindex="-1"></a><span class="st">Rank = row_number(),</span></span>
<span id="cb28-469"><a href="#cb28-469" aria-hidden="true" tabindex="-1"></a><span class="st">Financial_Impact_1M = sprintf("$%.0fk", Credit_Deduction_pct * 10000 / 100)) |&gt;</span></span>
<span id="cb28-470"><a href="#cb28-470" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::select(Rank, Equation, Rel_RMSE_pct, R2, Credit_Deduction_pct, Financial_Impact_1M)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="section" class="level2"><h2 class="anchored" data-anchor-id="section"></h2>
<p>1.7 Chapter Summary</p>
<section id="key-findings" class="level3"><h3 class="anchored" data-anchor-id="key-findings">Key Findings</h3>
<ul>
<li>Distribution: Data exhibits right-skew (p &lt; 0.001) across equations, violating parametric assumptions</li>
<li>Heteroscedasticity confirmed: Breusch-Pagan test (p &lt; 0.001) shows variance increasing with tree size</li>
<li>Transformation: Log-transformation reduces uncertainty RMSE &gt;50 percentage points</li>
<li>Equation performance:
<ul>
<li>Species-specific (log): 15.2% RMSE, 4.8% deduction</li>
<li>Genus-level (log): 16.3% RMSE, 5.2% deduction</li>
<li>Pan-tropical (log): 17-19% RMSE, 5.4-6.0% deduction</li>
</ul>
</li>
<li>Cross-Validation: 100-iteration Monte Carlo LGOCV confirms log-transformed models outperform across equations.</li>
</ul></section><section id="redd-best-practices" class="level3"><h3 class="anchored" data-anchor-id="redd-best-practices">REDD+ Best Practices</h3>
<p>To achieve commercially viable uncertainty levels (&lt;20% RMSE) and minimize carbon credit deductions:</p>
<ol type="1">
<li>Log-transformation (CRITICAL): Achieves 90-95% of possible uncertainty reduction at zero marginal cost</li>
<li>Species-specific: Reduces RMSE by 3-4 percentage points vs.&nbsp;genus-level, protecting $10-15k per million tCO₂e</li>
<li>Stratified: Ensures proportional representation across DBH classes, preventing bias from undersampling large trees</li>
<li>Cross-Validation: Quantifies out-of-sample error, avoiding overfitting and providing defensible uncertainty estimates</li>
<li>Sample Size: Minimum n≥50 trees per equation (Roxburgh et al.&nbsp;2015), with stratification across ln(DBH) range</li>
<li>Measurement precision: Target ±0.5 cm DBH error through calibrated instruments and trained field crews</li>
</ol></section><section id="investment-priorities" class="level3"><h3 class="anchored" data-anchor-id="investment-priorities">Investment Priorities</h3>
<table class="caption-top table">
<caption><em>*Assumes 1M tCO₂e project @ $5/tonne; pp = percentage points</em></caption>
<thead><tr class="header">
<th>Intervention</th>
<th>Cost</th>
<th>Uncertainty Reduction</th>
<th>Revenue Protected*</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Log-transformation</td>
<td>$0</td>
<td>50-55 pp</td>
<td>$250-275k</td>
</tr>
<tr class="even">
<td>Species-specific equations</td>
<td>$15-30k</td>
<td>3-4 pp</td>
<td>$10-15k</td>
</tr>
<tr class="odd">
<td>Cross-validation workflow</td>
<td>$5-10k</td>
<td>2-3 pp</td>
<td>$8-12k</td>
</tr>
<tr class="even">
<td>Improved DBH measurement</td>
<td>$2-5k</td>
<td>1-2 pp</td>
<td>$4-8k</td>
</tr>
<tr class="odd">
<td>Destructive sampling</td>
<td>$50-100k</td>
<td>5-10 pp</td>
<td>$20-40k</td>
</tr>
</tbody>
</table>
<p>Strategic recommendation: Log-transformation delivers the largest uncertainty reduction at zero cost. Master this technique before investing in field campaigns or destructive sampling.</p>
</section><section id="documentation-requirements" class="level3"><h3 class="anchored" data-anchor-id="documentation-requirements">Documentation Requirements</h3>
<p>For REDD+ MRV reporting under ART-TREES/VCS, include:</p>
<ul>
<li>Equation: Document geographic and taxonomic specificity, DBH range and sample size</li>
<li>Transformation: Demonstrate non-normality (Shapiro-Wilk), heteroscedasticity (Breusch-Pagan), RMSE reduction</li>
<li>Cross-Validation: Report RMSE, relative RMSE, R², Shapiro-Wilk on residuals from Monte Carlo LGOCV</li>
<li>Uncertainty: Show ART Equation 11 application with half-width 90% CI derivation</li>
<li>Stratification: Confirm proportional representation across DBH classes in calibration/validation splits</li>
</ul></section><section id="next-steps" class="level3"><h3 class="anchored" data-anchor-id="next-steps">Next Steps</h3>
<p>Chapter 2: Emission Factors will address:</p>
<ul>
<li>IPCC default uncertainties (CH₄: ±30-40%, N₂O: ±50-60%)</li>
<li>Combustion completeness and fire intensity effects</li>
<li>Gas-specific emission ratios (CO₂, CH₄, N₂O)</li>
<li>Field measurement protocols (FTIR, eddy covariance)</li>
</ul>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-archibald2003a" class="csl-entry" role="listitem">
Archibald, S., &amp; Bond, W. J. (2003). Growing tall vs. Growing wide: Tree architecture and allometry of acacia karroo in forest, savanna, and arid environments. <em>Oikos (Copenhagen, Denmark)</em>, <em>102</em>(1), 3–14. <a href="https://doi.org/10.1034/j.1600-0706.2003.12181.x">https://doi.org/10.1034/j.1600-0706.2003.12181.x</a>
</div>
<div id="ref-bohlman2006allometry" class="csl-entry" role="listitem">
Bohlman, S., &amp; O’Brien, S. (2006). Allometry, adult stature and regeneration requirement of 65 tree species on barro colorado island, panama. <em>Journal of Tropical Ecology</em>, <em>22</em>(2), 123–136.
</div>
<div id="ref-brown1997a" class="csl-entry" role="listitem">
Brown, S. (1997). <em>Estimating biomass and biomass change of tropical forests: A primer. Food and agriculture organization of the united nations</em>.
</div>
<div id="ref-chave2009towards" class="csl-entry" role="listitem">
Chave, J., Coomes, D., Jansen, S., Lewis, S. L., Swenson, N. G., &amp; Zanne, A. E. (2009). Towards a worldwide wood economics spectrum. <em>Ecology Letters</em>, <em>12</em>(4), 351–366.
</div>
<div id="ref-chave2014improved" class="csl-entry" role="listitem">
Chave, J., Réjou-Méchain, M., Búrquez, A., Chidumayo, E., Colgan, M. S., Delitti, W. B., Duque, A., Eid, T., Fearnside, P. M., Goodman, R. C., &amp; al., et. (2014). Improved allometric models to estimate the aboveground biomass of tropical trees. <em>Global Change Biology</em>, <em>20</em>(10), 3177–3190.
</div>
<div id="ref-dietze2008capturing" class="csl-entry" role="listitem">
Dietze, M. C., Wolosin, M. S., &amp; Clark, J. S. (2008). Capturing diversity and interspecific variability in allometries: A hierarchical approach. <em>Forest Ecology and Management</em>, <em>256</em>(11), 1939–1948.
</div>
<div id="ref-duncansonAbovegroundWoodyBiomass2021" class="csl-entry" role="listitem">
Duncanson, L., Disney, M., Armston, J., Nickeson, J., Minor, D., &amp; Camacho, F. (2021). <em>Aboveground woody biomass product validation good practices protocol</em>. <a href="https://doi.org/10.5067/DOC/CEOSWGCV/LPV/AGB.001">https://doi.org/10.5067/DOC/CEOSWGCV/LPV/AGB.001</a>
</div>
<div id="ref-enquist1999allometric" class="csl-entry" role="listitem">
Enquist, B. J., West, G. B., Charnov, E. L., &amp; Brown, J. H. (1999). Allometric scaling of production and life-history variation in vascular plants. <em>Nature</em>, <em>401</em>(6756), 907–911.
</div>
<div id="ref-feldpausch2011height" class="csl-entry" role="listitem">
Feldpausch, T. R., Banin, L., Phillips, O. L., Baker, T. R., Lewis, S. L., Quesada, C. A., Affum-Baffoe, K., Arets, E. J., Berry, N. J., Bird, M., &amp; al., et. (2011). Height-diameter allometry of tropical forest trees. <em>Biogeosciences (Online)</em>, <em>8</em>(5), 1081–1106.
</div>
<div id="ref-allodb" class="csl-entry" role="listitem">
Gonzalez-Akre, E., Piponiot, C., Lepore, M., &amp; Anderson-Teixeira, K. (2025). <em>Allodb: Tree biomass estimation at extra-tropical forest plots</em>.
</div>
<div id="ref-gonzalez2022allodb" class="csl-entry" role="listitem">
Gonzalez-Akre, E., Piponiot, C., Lepore, M., Herrmann, V., Lutz, J. A., Baltzer, J. L., Dick, C. W., Gilbert, G. S., He, F., Heym, M., &amp; al., et. (2022). Allodb: An r package for biomass estimation at globally distributed extratropical forest plots. <em>Methods in Ecology and Evolution</em>, <em>13</em>(2), 330–338.
</div>
<div id="ref-gould1966allometry" class="csl-entry" role="listitem">
Gould, S. J. (1966). Allometry and size in ontogeny and phylogeny. <em>Biological Reviews</em>, <em>41</em>(4), 587–638.
</div>
<div id="ref-gould1971geometric" class="csl-entry" role="listitem">
Gould, S. J. (1971). Geometric similarity in allometric growth: A contribution to the problem of scaling in the evolution of size. <em>The American Naturalist</em>, <em>105</em>(942), 113–136.
</div>
<div id="ref-huxley1924constant" class="csl-entry" role="listitem">
Huxley, J. S. (1924). Constant differential growth-ratios and their significance. <em>Nature</em>, <em>114</em>(2877), 895–896.
</div>
<div id="ref-jansen1996opbrengsttabellen" class="csl-entry" role="listitem">
Jansen, J. J., Sevenster, J., &amp; Faber, J. and. (1996). <em>Opbrengsttabellen voor belangrijke boomsoorten in nederland</em>. IBN-DLO.
</div>
<div id="ref-jenkins2004comprehensive" class="csl-entry" role="listitem">
Jenkins, J. C. (2004). <em>Comprehensive database of diameter-based biomass regressions for north american tree species</em>. United States Department of Agriculture, Forest Service, Northeastern ….
</div>
<div id="ref-king1996allometry" class="csl-entry" role="listitem">
King, D. A. (1996). Allometry and life history of tropical trees. <em>Journal of Tropical Ecology</em>, <em>12</em>(1), 25–44.
</div>
<div id="ref-king2011allometry" class="csl-entry" role="listitem">
King, D. A., &amp; Clark, D. A. (2011). Allometry of emergent tree species from saplings to above-canopy adults in a costa rican rain forest. <em>Journal of Tropical Ecology</em>, <em>27</em>(6), 573–579.
</div>
<div id="ref-komiyamaAllometryBiomassProductivity2008" class="csl-entry" role="listitem">
Komiyama, A., Ong, J. E., &amp; Poungparn, S. (2008). Allometry, biomass, and productivity of mangrove forests: A review. <em>Aquatic Botany</em>, <em>89</em>(2), 128–137. <a href="https://doi.org/10.1016/j.aquabot.2007.12.006">https://doi.org/10.1016/j.aquabot.2007.12.006</a>
</div>
<div id="ref-komiyama2005common" class="csl-entry" role="listitem">
Komiyama, A., Poungparn, S., &amp; Kato, S. (2005). Common allometric equations for estimating the tree weight of mangroves. <em>Journal of Tropical Ecology</em>, <em>21</em>(4), 471–477.
</div>
<div id="ref-muller2006testing" class="csl-entry" role="listitem">
Muller-Landau, H. C., Condit, R. S., Chave, J., Thomas, S. C., Bohlman, S. A., Bunyavejchewin, S., Davies, S., Foster, R., Gunatilleke, S., Gunatilleke, N., &amp; al., et. (2006). Testing metabolic ecology theory for allometric scaling of tree size, growth and mortality in tropical forests. <em>Ecology Letters</em>, <em>9</em>(5), 575–588.
</div>
<div id="ref-paul2017moisture" class="csl-entry" role="listitem">
Paul, K. I., Roxburgh, S. H., &amp; Larmour, J. S. (2017). Moisture content correction: Implications of measurement errors on tree-and site-based estimates of biomass. <em>Forest Ecology and Management</em>, <em>392</em>, 164–175.
</div>
<div id="ref-picard2012a" class="csl-entry" role="listitem">
Picard, N., Saint-Andre, L., &amp; Henry, M. (2012). <em>Manual for building tree volume and biomass allometric equations: From field measurement to prediction. Food and agriculture organization of the united nations, centre de cooperation internationale en recherche agronomique pour le developpement</em>.
</div>
<div id="ref-rahman2021biomass" class="csl-entry" role="listitem">
Rahman, M. S., Donoghue, D. N., Bracken, L. J., &amp; Mahmood, H. (2021). Biomass estimation in mangrove forests: A comparison of allometric models incorporating species and structural information. <em>Environmental Research Letters</em>, <em>16</em>(12), 124002.
</div>
<div id="ref-BIOMASS" class="csl-entry" role="listitem">
Réjou-Méchain, M., Tanguy, A., Piponiot, C., Chave, J., &amp; Herault, B. (2017b). <em>BIOMASS : An <span></span>r<span></span> package for estimating above-ground biomass and its uncertainty in tropical forests</em>. <em>8</em>. <a href="https://doi.org/10.1111/2041-210X.12753">https://doi.org/10.1111/2041-210X.12753</a>
</div>
<div id="ref-BIOMASS-2" class="csl-entry" role="listitem">
Réjou-Méchain, M., Tanguy, A., Piponiot, C., Chave, J., &amp; Herault, B. (2017a). <em>BIOMASS : An <span></span>r<span></span> package for estimating above-ground biomass and its uncertainty in tropical forests</em>. <em>8</em>. <a href="https://doi.org/10.1111/2041-210X.12753">https://doi.org/10.1111/2041-210X.12753</a>
</div>
<div id="ref-rejou2017biomass" class="csl-entry" role="listitem">
Réjou-Méchain, M., Tanguy, A., Piponiot, C., Chave, J., &amp; Hérault, B. (2017). Biomass: An r package for estimating above-ground biomass and its uncertainty in tropical forests. <em>Methods in Ecology and Evolution</em>, <em>8</em>(9), 1163–1167.
</div>
<div id="ref-rocha2018reducing" class="csl-entry" role="listitem">
Rocha de Souza Pereira, F., Kampel, M., Gomes Soares, M. L., Estrada, G. C. D., Bentz, C., &amp; Vincent, G. (2018). Reducing uncertainty in mapping of mangrove aboveground biomass using airborne discrete return lidar data. <em>Remote Sensing</em>, <em>10</em>(4), 637.
</div>
<div id="ref-roxburgh2015guidelines" class="csl-entry" role="listitem">
Roxburgh, S., Paul, K., Clifford, D., England, J., &amp; Raison, R. (2015). Guidelines for constructing allometric models for the prediction of woody biomass: How many individuals to harvest? <em>Ecosphere (Washington, D.C)</em>, <em>6</em>(3), 1–27.
</div>
<div id="ref-rutishauser2013generic" class="csl-entry" role="listitem">
Rutishauser, E., Noor’an, F., Laumonier, Y., Halperin, J., Hergoualc’h, K., Verchot, L., et al. (2013). Generic allometric models including height best estimate forest biomass and carbon stocks in indonesia. <em>Forest Ecology and Management</em>, <em>307</em>, 219–225.
</div>
<div id="ref-shinozaki1964quantitative" class="csl-entry" role="listitem">
Shinozaki, K., Yoda, K., Hozumi, K., &amp; Kira, T. (1964). A quantitative analysis of plant form-the pipe model theory: I. Basic analyses. <em>Japanese Journal of Ecology</em>, <em>14</em>(3), 97–105.
</div>
<div id="ref-valbuena2016sensitivity" class="csl-entry" role="listitem">
Valbuena, R., Heiskanen, J., Aynekulu, E., Pitkänen, S., &amp; Packalen, P. (2016). Sensitivity of above-ground biomass estimates to height-diameter modelling in mixed-species west african woodlands. <em>PloS One</em>, <em>11</em>(7), e0158198.
</div>
<div id="ref-vieilledent2018new" class="csl-entry" role="listitem">
Vieilledent, G., Fischer, F. J., Chave, J., Guibal, D., Langbour, P., &amp; Gérard, J. (2018). New formula and conversion factor to compute basic wood density of tree species using a global wood technology database. <em>American Journal of Botany</em>, <em>105</em>(10), 1653–1661.
</div>
<div id="ref-west1997general" class="csl-entry" role="listitem">
West, G. B., Brown, J. H., &amp; Enquist, B. J. (1997). A general model for the origin of allometric scaling laws in biology. <em>Science</em>, <em>276</em>(5309), 122–126.
</div>
<div id="ref-zianis2004simplifying" class="csl-entry" role="listitem">
Zianis, D., &amp; Mencuccini, M. (2004). On simplifying allometric analyses of forest biomass. <em>Forest Ecology and Management</em>, <em>187</em>(2-3), 311–332.
</div>
</div>
</section></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>Removal of <code>python</code> workflow was requested during first review (November 24, 2025). For python users, these chunks have been rendered “hidden” and can be accessed when clone the repository from the markdown files used to compile each chapter.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Follow-up: Allometry Sample Size Guidelines <span class="citation" data-cites="roxburgh2015guidelines">(<a href="../references/index.html#ref-roxburgh2015guidelines" role="doc-biblioref">Roxburgh et al., 2015</a>)</span> = <a href="https://esajournals.onlinelibrary.wiley.com/doi/full/10.1890/ES14-00251.1#sa2">Link</a>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Parallel development of Python cells was paused to concentrate efforts on delivering a completed R workflow. However, initial python code was preserved in each chapter’s markdown file and can be rendered from cloning the repository and adjusting `echo` function to reveal and run python operations and compare computation<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../index.html" class="pagination-link" aria-label="Preface">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../02-emission-factors/index.html" class="pagination-link" aria-label="2. Emission Factors">
        <span class="nav-page-text"><span class="chapter-title">2. Emission Factors</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb29" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "1. Allometry"</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">  docx:</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co">    reference-doc: ../references/style.docx</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: github</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co">    latex_engine: xelatex</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co">  eval: true</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="co">  comment: NA</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="an">knitr:</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="co">  opts_chunk:</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="co">    prefer-html: true</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="co">    dev: "png"</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="co">    dpi: 300</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> ../references/references.bib</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a><span class="an">csl:</span><span class="co"> ../references/apa.csl</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview {.unnumbered}</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>Allometric equations represent the proportional and scaling relationships between different tree dimensions, such as the relationship between a tree's diameter and its height, biomass, or crown size. When trees are considered at a population scale, their different dimensions are statistically related through shared ontogenic development patterns <span class="co">[</span><span class="ot">@gould1966allometry</span><span class="co">]</span>. These relationships remain consistent across tree sizes, from saplings to canopy dominants, when growing under similar conditions <span class="co">[</span><span class="ot">@king1996allometry; @archibald2003a; @bohlman2006allometry; @dietze2008capturing</span><span class="co">]</span>.</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>This biological principle underpins REDD+ carbon accounting: allometric equations translate field measurements of diameter at breast height (DBH) into biomass estimates, forming the foundation of emission reduction quantification.</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a><span class="fu">## Allometry Investment</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>Although Section 8 exempts structural allometric uncertainty when models are applied consistently, the choice of which model to apply directly impacts reported uncertainty. Allometry variance is absolute and compounds more dramatically so that model selection determines the magnitude of random error that cannot be exempted downstream. In practical terms, selecting a model with 20% RMSE versus 8% RMSE determines whether your project faces a 6% or 2% carbon credit deduction, representing a difference worth \$200k in a 1M tCO~2~^-e^ project at \$5/tonne.</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a><span class="fu">### Environment Setup (R) {.unnumbered}</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>easypackages<span class="sc">::</span><span class="fu">packages</span>(</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>    <span class="st">"animation"</span>, <span class="st">"BIOMASS"</span>, <span class="st">"cols4all"</span>, <span class="st">"covr"</span>, <span class="st">"cowplot"</span>, <span class="st">"caret"</span>,</span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>  <span class="st">"DescTools"</span>, <span class="st">"dataMaid"</span>, <span class="st">"dplyr"</span>, <span class="st">"FawR"</span>, <span class="st">"ForestToolsRS"</span>, <span class="st">"forestdata"</span>, </span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>  <span class="st">"flextable"</span>, <span class="st">"ggplot2"</span>, <span class="st">"giscoR"</span>, <span class="st">"ggfortify"</span>, <span class="st">"htmltools"</span>, </span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">"janitor"</span>, <span class="st">"jsonlite"</span>, <span class="st">"lattice"</span>, <span class="st">"leaflet.providers"</span>, <span class="st">"leaflet"</span>, </span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">"lmtest"</span>, <span class="st">"lwgeom"</span>, <span class="st">"kableExtra"</span>, <span class="st">"kernlab"</span>, <span class="st">"knitr"</span>, <span class="st">"mapedit"</span>, </span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mapview"</span>, <span class="st">"maptiles"</span>, <span class="st">"Mlmetrics"</span>, <span class="st">"ModelMetrics"</span>, <span class="st">"moments"</span>, </span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">"olsrr"</span>, <span class="st">"openxlsx"</span>, <span class="st">"plotly"</span>, <span class="st">"psych"</span>, <span class="st">"randomForest"</span>, </span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>  <span class="st">"raster"</span>,<span class="st">"RColorBrewer"</span>, <span class="st">"rmarkdown"</span>, <span class="st">"renv"</span>, <span class="st">"reticulate"</span>, </span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>    <span class="st">"s2"</span>, <span class="st">"sf"</span>, <span class="st">"scales"</span>, <span class="st">"sits"</span>,<span class="st">"spdep"</span>, <span class="st">"stars"</span>, <span class="st">"stringr"</span>, </span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">"terra"</span>, <span class="st">"tmap"</span>, <span class="st">"tmaptools"</span>, <span class="st">"tidymodels"</span>, <span class="st">"tidyverse"</span>, <span class="st">"tidyr"</span>, <span class="st">"tune"</span>,</span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a>    <span class="st">"useful"</span>,</span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">prompt =</span> F</span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a>sf<span class="sc">::</span><span class="fu">sf_use_s2</span>(<span class="at">use_s2 =</span> <span class="cn">FALSE</span>)</span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8787</span>)</span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a><span class="co">#renv::init()</span></span>
<span id="cb29-77"><a href="#cb29-77" aria-hidden="true" tabindex="-1"></a><span class="co">#renv::activate()</span></span>
<span id="cb29-78"><a href="#cb29-78" aria-hidden="true" tabindex="-1"></a><span class="co">#renv::snapshot()</span></span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a><span class="co">#renv::update()</span></span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a><span class="co">#renv::restore() # Debugger</span></span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a><span class="co">#renv::install("readxl", type = "binary")</span></span>
<span id="cb29-82"><a href="#cb29-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-83"><a href="#cb29-83" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repos =</span> <span class="fu">c</span>(<span class="at">CRAN =</span> <span class="st">"https://cloud.r-project.org"</span>),</span>
<span id="cb29-84"><a href="#cb29-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">htmltools.dir.version =</span> <span class="cn">FALSE</span>, </span>
<span id="cb29-85"><a href="#cb29-85" aria-hidden="true" tabindex="-1"></a>  <span class="at">htmltools.preserve.raw =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-86"><a href="#cb29-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">scipen =</span> <span class="dv">999</span></span>
<span id="cb29-87"><a href="#cb29-87" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-88"><a href="#cb29-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-89"><a href="#cb29-89" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb29-90"><a href="#cb29-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">echo =</span> <span class="cn">TRUE</span>, </span>
<span id="cb29-91"><a href="#cb29-91" aria-hidden="true" tabindex="-1"></a>  <span class="at">message =</span> <span class="cn">FALSE</span>, </span>
<span id="cb29-92"><a href="#cb29-92" aria-hidden="true" tabindex="-1"></a>  <span class="at">warning =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-93"><a href="#cb29-93" aria-hidden="true" tabindex="-1"></a>  <span class="at">error =</span> <span class="cn">FALSE</span>, </span>
<span id="cb29-94"><a href="#cb29-94" aria-hidden="true" tabindex="-1"></a>  <span class="at">comment =</span> <span class="cn">NA</span>, </span>
<span id="cb29-95"><a href="#cb29-95" aria-hidden="true" tabindex="-1"></a>  <span class="at">tidy.opts =</span> <span class="fu">list</span>(<span class="at">width.cutoff =</span> <span class="dv">60</span>)</span>
<span id="cb29-96"><a href="#cb29-96" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb29-97"><a href="#cb29-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-98"><a href="#cb29-98" aria-hidden="true" tabindex="-1"></a><span class="co">#reticulate::use_python(required = T, </span></span>
<span id="cb29-99"><a href="#cb29-99" aria-hidden="true" tabindex="-1"></a><span class="co">#  "/Users/seamus/Library/Python/3.9/bin/python3")</span></span>
<span id="cb29-100"><a href="#cb29-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-101"><a href="#cb29-101" aria-hidden="true" tabindex="-1"></a><span class="co"># For very first environment setup, you may need to install the following </span></span>
<span id="cb29-102"><a href="#cb29-102" aria-hidden="true" tabindex="-1"></a><span class="co"># packages directly from their github repos, because these new dependencies </span></span>
<span id="cb29-103"><a href="#cb29-103" aria-hidden="true" tabindex="-1"></a><span class="co"># havent yet made it onto CRAN library </span></span>
<span id="cb29-104"><a href="#cb29-104" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(c("pak", "easypackages"))</span></span>
<span id="cb29-105"><a href="#cb29-105" aria-hidden="true" tabindex="-1"></a><span class="co">#library("pak")</span></span>
<span id="cb29-106"><a href="#cb29-106" aria-hidden="true" tabindex="-1"></a><span class="co">#library("easypackages")</span></span>
<span id="cb29-107"><a href="#cb29-107" aria-hidden="true" tabindex="-1"></a><span class="co">#pak::pak(c("Cidree/forestdata", "andrew-plowright/ForestTools", "ytarazona/ForesToolboxRS", "ropensci/allodb"))</span></span>
<span id="cb29-108"><a href="#cb29-108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-109"><a href="#cb29-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-110"><a href="#cb29-110" aria-hidden="true" tabindex="-1"></a><span class="fu">### ~~Environment Setup (Python)~~[^index-1] {.unnumbered}</span></span>
<span id="cb29-111"><a href="#cb29-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-114"><a href="#cb29-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb29-115"><a href="#cb29-115" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-116"><a href="#cb29-116" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb29-117"><a href="#cb29-117" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-118"><a href="#cb29-118" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb29-119"><a href="#cb29-119" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-120"><a href="#cb29-120" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb29-121"><a href="#cb29-121" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb29-122"><a href="#cb29-122" aria-hidden="true" tabindex="-1"></a><span class="co"># Installer prerequisites</span></span>
<span id="cb29-123"><a href="#cb29-123" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess, sys</span>
<span id="cb29-124"><a href="#cb29-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-125"><a href="#cb29-125" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick package install </span></span>
<span id="cb29-126"><a href="#cb29-126" aria-hidden="true" tabindex="-1"></a>subprocess.run([sys.executable, <span class="st">"-m"</span>, <span class="st">"pip"</span>, <span class="st">"install"</span>, <span class="st">"--quiet"</span>, <span class="st">"-q"</span>,</span>
<span id="cb29-127"><a href="#cb29-127" aria-hidden="true" tabindex="-1"></a>  <span class="st">"contextily"</span>, <span class="st">"folium"</span>, <span class="st">"geopandas"</span>, <span class="st">"kaleido"</span>, <span class="st">"matplotlib"</span>, <span class="st">"numpy"</span>, </span>
<span id="cb29-128"><a href="#cb29-128" aria-hidden="true" tabindex="-1"></a>  <span class="st">"openpyxl"</span>, <span class="st">"pandas"</span>, <span class="st">"plotly"</span>, <span class="st">"pysal"</span>, <span class="st">"pyproj"</span>, <span class="st">"pingouin"</span>,<span class="st">"rasterio"</span>,</span>
<span id="cb29-129"><a href="#cb29-129" aria-hidden="true" tabindex="-1"></a>  <span class="st">"scikit-learn"</span>, <span class="st">"scipy"</span>, <span class="st">"seaborn"</span>, <span class="st">"statsmodels"</span>, <span class="st">"shapely"</span>, <span class="st">"skimpy"</span>,</span>
<span id="cb29-130"><a href="#cb29-130" aria-hidden="true" tabindex="-1"></a>  <span class="st">"xarray"</span>], check<span class="op">=</span><span class="va">True</span>, capture_output<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-131"><a href="#cb29-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-132"><a href="#cb29-132" aria-hidden="true" tabindex="-1"></a><span class="co"># Import packages into runtime</span></span>
<span id="cb29-133"><a href="#cb29-133" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd, numpy <span class="im">as</span> np</span>
<span id="cb29-134"><a href="#cb29-134" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt, seaborn <span class="im">as</span> sns</span>
<span id="cb29-135"><a href="#cb29-135" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px, plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb29-136"><a href="#cb29-136" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier, RandomForestRegressor</span>
<span id="cb29-137"><a href="#cb29-137" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb29-138"><a href="#cb29-138" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb29-139"><a href="#cb29-139" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd, rasterio, folium</span>
<span id="cb29-140"><a href="#cb29-140" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tabulate <span class="im">import</span> tabulate</span>
<span id="cb29-141"><a href="#cb29-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-142"><a href="#cb29-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-143"><a href="#cb29-143" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.1 Allometric Equations {#sec-allometry-relationship}</span></span>
<span id="cb29-144"><a href="#cb29-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-145"><a href="#cb29-145" aria-hidden="true" tabindex="-1"></a>In its broadest sense, allometry describes any linear or non-linear correlation between increases in tree dimensions during ontogenic development <span class="co">[</span><span class="ot">@picard2012a</span><span class="co">]</span>. A more restrictive definition, originating with @huxley1924constant, refers specifically to proportional relationships between relative increases in dimensions:</span>
<span id="cb29-146"><a href="#cb29-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-147"><a href="#cb29-147" aria-hidden="true" tabindex="-1"></a>Allometric equations predict aboveground biomass from diameter measurements using species- or biome-specific parameters. Uncertainty compounds from three sources: model selection, parameter estimation, and field measurements. Log-transformation adds complexity through required back-transformation:</span>
<span id="cb29-148"><a href="#cb29-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-149"><a href="#cb29-149" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb29-150"><a href="#cb29-150" aria-hidden="true" tabindex="-1"></a>\frac{\mathrm{d}B}{B} = a\frac{\mathrm{d}D}{D}</span>
<span id="cb29-151"><a href="#cb29-151" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb29-152"><a href="#cb29-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-153"><a href="#cb29-153" aria-hidden="true" tabindex="-1"></a>which integrates to the power relationship:</span>
<span id="cb29-154"><a href="#cb29-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-155"><a href="#cb29-155" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb29-156"><a href="#cb29-156" aria-hidden="true" tabindex="-1"></a>AGB = \alpha \times DBH^{\beta}</span>
<span id="cb29-157"><a href="#cb29-157" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb29-158"><a href="#cb29-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-159"><a href="#cb29-159" aria-hidden="true" tabindex="-1"></a>and in logarithmic form:</span>
<span id="cb29-160"><a href="#cb29-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-161"><a href="#cb29-161" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb29-162"><a href="#cb29-162" aria-hidden="true" tabindex="-1"></a>\ln(AGB) = \ln(\alpha) + \beta \times \ln(DBH) + \epsilon</span>
<span id="cb29-163"><a href="#cb29-163" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb29-164"><a href="#cb29-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-165"><a href="#cb29-165" aria-hidden="true" tabindex="-1"></a>Where:</span>
<span id="cb29-166"><a href="#cb29-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-167"><a href="#cb29-167" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`AGB`</span>: Aboveground biomass (kg)</span>
<span id="cb29-168"><a href="#cb29-168" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`DBH`</span>: Diameter at breast height (cm)</span>
<span id="cb29-169"><a href="#cb29-169" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`α`</span>, <span class="in">`β`</span>: Modelling exponents/parameters</span>
<span id="cb29-170"><a href="#cb29-170" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`ε`</span>: Random error term</span>
<span id="cb29-171"><a href="#cb29-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-172"><a href="#cb29-172" aria-hidden="true" tabindex="-1"></a>This power-law form reflects the self-similarity principle observed in tree growth: as trees develop from seedlings to mature individuals, they maintain consistent proportional relationships between their dimensions <span class="co">[</span><span class="ot">@gould1971geometric</span><span class="co">]</span>. In this framework, the exponent <span class="in">`β`</span> serves as the allometric coefficient, quantifying how one dimension changes relative to another during growth. For example, if β = 2.5, a 10% increase in diameter corresponds to a 25% increase in biomass. The parameter <span class="in">`α`</span> is a scaling constant accounting for wood density, architectural form, and other species-specific characteristics.</span>
<span id="cb29-173"><a href="#cb29-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-174"><a href="#cb29-174" aria-hidden="true" tabindex="-1"></a>@west1997general and @enquist1999allometric developed an allometric scaling theory based on the "pipe model" <span class="co">[</span><span class="ot">@shinozaki1964quantitative</span><span class="co">]</span> and physical growth principles. Their framework predicts a universal exponent of <span class="in">`β`</span> ≈ 2.67 based on biomechanical constraints, tree stability, and hydraulic resistance. While this theoretical exponent has been debated regarding its universality <span class="co">[</span><span class="ot">@zianis2004simplifying; @muller2006testing</span><span class="co">]</span>, it provides a physically grounded benchmark for evaluating empirical equations.</span>
<span id="cb29-175"><a href="#cb29-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-176"><a href="#cb29-176" aria-hidden="true" tabindex="-1"></a>In this chapter, we compare allometry species-specific allometry with biome-generic equations that are more commonly applied in REDD+ programs to demonstrate how uncertainty metrics can inform model selection and impact carbon credit deductions. We adopt the broadest definition of allometry as any correlation between tree dimensions, whether in linear, log-log, power-law, or other functional forms, to examine the following questions:</span>
<span id="cb29-177"><a href="#cb29-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-178"><a href="#cb29-178" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>How should uncertainty metrics inform model selection and optimization?</span>
<span id="cb29-179"><a href="#cb29-179" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>How does allometry uncertainty impacts carbon credit deductions</span>
<span id="cb29-180"><a href="#cb29-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-181"><a href="#cb29-181" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.2 Model Selection {#sec-model-selection}</span></span>
<span id="cb29-182"><a href="#cb29-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-183"><a href="#cb29-183" aria-hidden="true" tabindex="-1"></a>The choice of allometric equation directly determines uncertainty magnitude and carbon credit deductions. This section demonstrates quantitative differences between equation categories using the <span class="in">`scbi_stem1`</span> dataset from the <span class="co">[</span><span class="ot">ForestGEO</span><span class="co">](https://docs.ropensci.org/allodb/reference/scbi_stem1.html)</span> plot inventory in Front Royal, Virginia. This 25.6-hectare mature secondary forest is dominated by Appalachian mixed hardwood species including tulip poplar (*Liriodendron tulipifera*), oaks (*Quercus spp.*), and hickories (*Carya spp.*), representing typical stand composition of the Blue Ridge and Piedmont regions.</span>
<span id="cb29-184"><a href="#cb29-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-185"><a href="#cb29-185" aria-hidden="true" tabindex="-1"></a>For REDD+ carbon accounting, we tend to focus exclusively on ontogenic allometry to estimate relationships between accessible tree dimensions and total aboveground biomass as trees grow from seedling to maturity. However, some reading of evolutionary allometry is sometimes needed to address differences in specific traits that emerged in localized conditions. For example, the following species share in genus but vary in wood density, branch architecture, and bole form:</span>
<span id="cb29-186"><a href="#cb29-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-187"><a href="#cb29-187" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Acer rubrum* (red maple): Lower density (0.49 g/cm³), faster growth</span>
<span id="cb29-188"><a href="#cb29-188" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Acer saccharum* (sugar maple): Higher density (0.63 g/cm³), denser wood</span>
<span id="cb29-189"><a href="#cb29-189" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Acer negundo* (box elder): Intermediate density (0.42 g/cm³), different architecture</span>
<span id="cb29-190"><a href="#cb29-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-191"><a href="#cb29-191" aria-hidden="true" tabindex="-1"></a><span class="fu">### Types of Equations</span></span>
<span id="cb29-192"><a href="#cb29-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-193"><a href="#cb29-193" aria-hidden="true" tabindex="-1"></a>Allometric equations are classified by taxonomic scope and environmental specificity. In practice, the choice of equation category involves balancing precision, cost, and data availability:</span>
<span id="cb29-194"><a href="#cb29-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-195"><a href="#cb29-195" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Species-Specific Equations: Developed from destructive sampling of target species, providing highest accuracy but limited geographic applicability <span class="co">[</span><span class="ot">@gonzalez2022allodb</span><span class="co">]</span>. These equations capture species-specific morphometric traits, such as branching architecture and wood density, which influence biomass allocation.</span>
<span id="cb29-196"><a href="#cb29-196" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Genus-Specific Equations: Aggregated across multiple species within a genus, offering broader applicability with moderate accuracy <span class="co">[</span><span class="ot">@jansen1996opbrengsttabellen; @jenkins2004comprehensive</span><span class="co">]</span>. Assumes shared evolutionary heritage produces similar allometric scaling within genera.</span>
<span id="cb29-197"><a href="#cb29-197" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Biome-Generic Equations: Most commonly used in REDD+ report, pan-tropical, generic equations fitted across broader geographic regions and biomes, maximizing applicability but potentially introducing bias <span class="co">[</span><span class="ot">@chave2009towards; @chave2014improved; @west1997general; @brown1997a</span><span class="co">]</span>. Often incorporate wood density (WD) or environmental stress factors to capture regional variation.</span>
<span id="cb29-198"><a href="#cb29-198" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Environmentally-Conditioned Equations: Gold-standard allometric models that incorporate biophysical variables reflecting site-specific growing conditions, critical for REDD+ programs in specialized ecosystems <span class="co">[</span><span class="ot">@rahman2021biomass; @komiyamaAllometryBiomassProductivity2008; @komiyama2005common</span><span class="co">]</span>. These equations explicitly model environmental drivers of growth variation:</span>
<span id="cb29-199"><a href="#cb29-199" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Salinity gradients: Mangrove allometry where salt stress affects growth rate, wood density, and architectural form</span>
<span id="cb29-200"><a href="#cb29-200" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Soil fertility: Nutrient availability influencing wood density and height-diameter relationships</span>
<span id="cb29-201"><a href="#cb29-201" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Climate: Temperature and precipitation gradients captured through environmental stress factors</span>
<span id="cb29-202"><a href="#cb29-202" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Geomorphology: Tidal inundation frequency, elevation, or hydrological regime</span>
<span id="cb29-203"><a href="#cb29-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-204"><a href="#cb29-204" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb29-205"><a href="#cb29-205" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mangroves Tree Height</span></span>
<span id="cb29-206"><a href="#cb29-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-207"><a href="#cb29-207" aria-hidden="true" tabindex="-1"></a>In specialized growing environments, such as mangrove habitats, the choice of allometry significantly affects accuracy estimates. For example, @rocha2018reducing found generic allometries to produce -18% &amp; +14% wider error magins than species-specific equations in Brazilian mangrove forests. To compensate, generic equations incorporate proxies of environmental stress, such as wood density, height-diameter ratios or "stunting", and species composition.</span>
<span id="cb29-208"><a href="#cb29-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-209"><a href="#cb29-209" aria-hidden="true" tabindex="-1"></a>However, while inclusion of tree height significantly reduces bias in AGB estimates <span class="co">[</span><span class="ot">@rutishauser2013generic; @chave2014improved</span><span class="co">]</span>, the accurate measurement of tree height in closed-canopy forests is especially challenging<span class="co">[</span><span class="ot">@king2011allometry</span><span class="co">]</span>. Field data with high levels of tree height variance can limit these destructively sampled allometry models. This represents investment opportunity from reducing uncertainty through improved survey technology, such as LiDAR and RADAR <span class="co">[</span><span class="ot">@feldpausch2011height; @valbuena2016sensitivity</span><span class="co">]</span>.</span>
<span id="cb29-210"><a href="#cb29-210" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-211"><a href="#cb29-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-212"><a href="#cb29-212" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Data Preparation {.unnumbered}</span></span>
<span id="cb29-213"><a href="#cb29-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-214"><a href="#cb29-214" aria-hidden="true" tabindex="-1"></a>We imported the scbi_stem1 dataset from the allodb package, which contains 2,287 individual tree measurements from the ForestGEO permanent plot at Front Royal, Virginia. The dataset includes 12 families, spanning multiple genera and species (Table 1.1). This taxonomic diversity allows us to demonstrate equation selection across different levels of specificity.</span>
<span id="cb29-215"><a href="#cb29-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-218"><a href="#cb29-218" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-219"><a href="#cb29-219" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-220"><a href="#cb29-220" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-221"><a href="#cb29-221" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb29-222"><a href="#cb29-222" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-223"><a href="#cb29-223" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb29-224"><a href="#cb29-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-225"><a href="#cb29-225" aria-hidden="true" tabindex="-1"></a><span class="co"># import dataset from allodb.pkg</span></span>
<span id="cb29-226"><a href="#cb29-226" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"allodb"</span>)</span>
<span id="cb29-227"><a href="#cb29-227" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(scbi_stem1)</span>
<span id="cb29-228"><a href="#cb29-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-229"><a href="#cb29-229" aria-hidden="true" tabindex="-1"></a><span class="co">#scbi_stem1 |&gt; dplyr::group_by(Family) |&gt;</span></span>
<span id="cb29-230"><a href="#cb29-230" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::summarise(`Tree Families sampled` = n()) |&gt;</span></span>
<span id="cb29-231"><a href="#cb29-231" aria-hidden="true" tabindex="-1"></a><span class="co">#   flextable::flextable()|&gt; flextable::autofit()</span></span>
<span id="cb29-232"><a href="#cb29-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-233"><a href="#cb29-233" aria-hidden="true" tabindex="-1"></a>scbi_stem1 <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">group_by</span>(Family, genus, species) <span class="sc">|&gt;</span></span>
<span id="cb29-234"><a href="#cb29-234" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="st">`</span><span class="at">Total Trees (n)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb29-235"><a href="#cb29-235" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">flextable</span>()<span class="sc">|&gt;</span> </span>
<span id="cb29-236"><a href="#cb29-236" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">part =</span> <span class="st">"body"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-237"><a href="#cb29-237" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">part =</span> <span class="st">"footer"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-238"><a href="#cb29-238" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">set_table_properties</span>(scbi_stem1, <span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width=</span><span class="dv">1</span>, <span class="at">align =</span> <span class="st">"center"</span>) </span>
<span id="cb29-239"><a href="#cb29-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-240"><a href="#cb29-240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-241"><a href="#cb29-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-244"><a href="#cb29-244" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb29-245"><a href="#cb29-245" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-246"><a href="#cb29-246" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb29-247"><a href="#cb29-247" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-248"><a href="#cb29-248" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb29-249"><a href="#cb29-249" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-250"><a href="#cb29-250" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb29-251"><a href="#cb29-251" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb29-252"><a href="#cb29-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-253"><a href="#cb29-253" aria-hidden="true" tabindex="-1"></a><span class="co">## ----- Python cell ----- ##</span></span>
<span id="cb29-254"><a href="#cb29-254" aria-hidden="true" tabindex="-1"></a><span class="co">## ----------------------- ##</span></span>
<span id="cb29-255"><a href="#cb29-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-256"><a href="#cb29-256" aria-hidden="true" tabindex="-1"></a>demo_data_py <span class="op">=</span> pd.read_csv(<span class="st">"./data/scbi_stem1.csv"</span>)</span>
<span id="cb29-257"><a href="#cb29-257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-258"><a href="#cb29-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-259"><a href="#cb29-259" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb29-260"><a href="#cb29-260" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compiling Allometries</span></span>
<span id="cb29-261"><a href="#cb29-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-262"><a href="#cb29-262" aria-hidden="true" tabindex="-1"></a>Scope permitting, this training would examine a full allometry workflow. Effectively, this which would require repeating the same process below for all genus in our field dataset, incorporating equations per species cumulatively. We provide brief demonstration of how to add each new equations using <span class="in">`alldob`</span> operations.</span>
<span id="cb29-263"><a href="#cb29-263" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-264"><a href="#cb29-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-265"><a href="#cb29-265" aria-hidden="true" tabindex="-1"></a>We filter <span class="in">`scbi_stem1`</span> to *Quercus* observations, the largest genus subsample, to compare the scaling impact of generic allometry with subspecies and genus equations. Missing entries are also removed, providing a new sample of 84 stems from the dataset's total measurements of 2,287 trees.</span>
<span id="cb29-266"><a href="#cb29-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-267"><a href="#cb29-267" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`dbh`</span>: Diameter at breast height (cm)</span>
<span id="cb29-268"><a href="#cb29-268" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`genus`</span>: Taxonomic genus identification</span>
<span id="cb29-269"><a href="#cb29-269" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`species`</span>: Species epithet</span>
<span id="cb29-270"><a href="#cb29-270" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`Family`</span>: Taxonomic family classification</span>
<span id="cb29-271"><a href="#cb29-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-272"><a href="#cb29-272" aria-hidden="true" tabindex="-1"></a>To demonstrate the comparative analysis, we created two filtered subsets: a genus-level dataset containing all Quercus observations (n=84 stems) and a species-specific subset for Quercus rubra. Missing DBH values were removed to ensure clean input for subsequent allometric calculations. The filtering procedure is detailed in Section 1.6.</span>
<span id="cb29-273"><a href="#cb29-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-276"><a href="#cb29-276" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-277"><a href="#cb29-277" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-278"><a href="#cb29-278" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-279"><a href="#cb29-279" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb29-280"><a href="#cb29-280" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-281"><a href="#cb29-281" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb29-282"><a href="#cb29-282" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb29-283"><a href="#cb29-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-284"><a href="#cb29-284" aria-hidden="true" tabindex="-1"></a><span class="co"># Genus-specific subsample of dataset</span></span>
<span id="cb29-285"><a href="#cb29-285" aria-hidden="true" tabindex="-1"></a>scbi_quercus <span class="ot">=</span> scbi_stem1 <span class="sc">|&gt;</span></span>
<span id="cb29-286"><a href="#cb29-286" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dbh)) <span class="sc">|&gt;</span></span>
<span id="cb29-287"><a href="#cb29-287" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(genus <span class="sc">==</span> <span class="st">"Quercus"</span>) </span>
<span id="cb29-288"><a href="#cb29-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-289"><a href="#cb29-289" aria-hidden="true" tabindex="-1"></a><span class="co"># Species-specific subsample of dataset</span></span>
<span id="cb29-290"><a href="#cb29-290" aria-hidden="true" tabindex="-1"></a>scbi_quercus_rubra <span class="ot">=</span> scbi_stem1 <span class="sc">|&gt;</span></span>
<span id="cb29-291"><a href="#cb29-291" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dbh)) <span class="sc">|&gt;</span></span>
<span id="cb29-292"><a href="#cb29-292" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(genus <span class="sc">==</span> <span class="st">"Quercus"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-293"><a href="#cb29-293" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"rubra"</span>) </span>
<span id="cb29-294"><a href="#cb29-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-295"><a href="#cb29-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-296"><a href="#cb29-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-299"><a href="#cb29-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-300"><a href="#cb29-300" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-301"><a href="#cb29-301" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-302"><a href="#cb29-302" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb29-303"><a href="#cb29-303" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-304"><a href="#cb29-304" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb29-305"><a href="#cb29-305" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb29-306"><a href="#cb29-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-307"><a href="#cb29-307" aria-hidden="true" tabindex="-1"></a><span class="co"># check distribution </span></span>
<span id="cb29-308"><a href="#cb29-308" aria-hidden="true" tabindex="-1"></a>scbi_quercus_tbl <span class="ot">=</span> scbi_quercus <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(treeID, stemID))</span>
<span id="cb29-309"><a href="#cb29-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-310"><a href="#cb29-310" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">describe</span>(scbi_quercus_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb29-311"><a href="#cb29-311" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(trimmed,trimmed, mad, range)) <span class="sc">|&gt;</span> </span>
<span id="cb29-312"><a href="#cb29-312" aria-hidden="true" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Variable"</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb29-313"><a href="#cb29-313" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">!</span>vars) <span class="sc">|&gt;</span>    </span>
<span id="cb29-314"><a href="#cb29-314" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb29-315"><a href="#cb29-315" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> <span class="fu">case_when</span>(</span>
<span id="cb29-316"><a href="#cb29-316" aria-hidden="true" tabindex="-1"></a>    Variable <span class="sc">==</span> <span class="st">"dbh"</span> <span class="sc">~</span> <span class="st">"DBH (cm)"</span>,</span>
<span id="cb29-317"><a href="#cb29-317" aria-hidden="true" tabindex="-1"></a>    Variable <span class="sc">==</span> <span class="st">"genus"</span> <span class="sc">~</span> <span class="st">"Genus"</span>,</span>
<span id="cb29-318"><a href="#cb29-318" aria-hidden="true" tabindex="-1"></a>    Variable <span class="sc">==</span> <span class="st">"species"</span> <span class="sc">~</span> <span class="st">"Species"</span>,</span>
<span id="cb29-319"><a href="#cb29-319" aria-hidden="true" tabindex="-1"></a>    Variable <span class="sc">==</span> <span class="st">"Family"</span> <span class="sc">~</span> <span class="st">"Family"</span>,</span>
<span id="cb29-320"><a href="#cb29-320" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> Variable)) <span class="sc">|&gt;</span></span>
<span id="cb29-321"><a href="#cb29-321" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">flextable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb29-322"><a href="#cb29-322" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">colformat_double</span>(<span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-323"><a href="#cb29-323" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-324"><a href="#cb29-324" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>)</span>
<span id="cb29-325"><a href="#cb29-325" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-326"><a href="#cb29-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-327"><a href="#cb29-327" aria-hidden="true" tabindex="-1"></a><span class="co"># 'head()' limits no.# of rows returned</span></span>
<span id="cb29-328"><a href="#cb29-328" aria-hidden="true" tabindex="-1"></a><span class="co">#head(scbi_quercus, n=10) |&gt;</span></span>
<span id="cb29-329"><a href="#cb29-329" aria-hidden="true" tabindex="-1"></a><span class="co">#   flextable::flextable() |&gt; </span></span>
<span id="cb29-330"><a href="#cb29-330" aria-hidden="true" tabindex="-1"></a><span class="co">#   flextable::autofit()</span></span>
<span id="cb29-331"><a href="#cb29-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-332"><a href="#cb29-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-333"><a href="#cb29-333" aria-hidden="true" tabindex="-1"></a>At this stage in the workflow, it helps to quickly scan the range and spread in DBH values. Applied directly, candidate equations can be filtered by min and max dbh values Deviation from the mean provides indicators of the statistical operations needed ahead during equation selection, bias correction, and model optimization. It also informs sample.</span>
<span id="cb29-334"><a href="#cb29-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-337"><a href="#cb29-337" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb29-338"><a href="#cb29-338" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-339"><a href="#cb29-339" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb29-340"><a href="#cb29-340" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-341"><a href="#cb29-341" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb29-342"><a href="#cb29-342" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-343"><a href="#cb29-343" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb29-344"><a href="#cb29-344" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb29-345"><a href="#cb29-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-346"><a href="#cb29-346" aria-hidden="true" tabindex="-1"></a><span class="co">## ----- Python cell ----- ##</span></span>
<span id="cb29-347"><a href="#cb29-347" aria-hidden="true" tabindex="-1"></a><span class="co">## ----------------------- ##</span></span>
<span id="cb29-348"><a href="#cb29-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-349"><a href="#cb29-349" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy</span></span>
<span id="cb29-350"><a href="#cb29-350" aria-hidden="true" tabindex="-1"></a>demo_data_py <span class="op">=</span> (</span>
<span id="cb29-351"><a href="#cb29-351" aria-hidden="true" tabindex="-1"></a>    demo_data_py</span>
<span id="cb29-352"><a href="#cb29-352" aria-hidden="true" tabindex="-1"></a>    .query(<span class="st">'dbh.notna()'</span>)</span>
<span id="cb29-353"><a href="#cb29-353" aria-hidden="true" tabindex="-1"></a>  .query(<span class="st">'dbh &gt;= 5 &amp; dbh &lt;= 100'</span>)</span>
<span id="cb29-354"><a href="#cb29-354" aria-hidden="true" tabindex="-1"></a>  .reset_index(drop<span class="op">=</span><span class="va">True</span>) <span class="co"># avoids KeyError</span></span>
<span id="cb29-355"><a href="#cb29-355" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-356"><a href="#cb29-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-357"><a href="#cb29-357" aria-hidden="true" tabindex="-1"></a><span class="co"># tabulate</span></span>
<span id="cb29-358"><a href="#cb29-358" aria-hidden="true" tabindex="-1"></a>numeric_data <span class="op">=</span> demo_data_py.select_dtypes(include<span class="op">=</span>[np.number])</span>
<span id="cb29-359"><a href="#cb29-359" aria-hidden="true" tabindex="-1"></a>desc_stats <span class="op">=</span> pd.DataFrame({</span>
<span id="cb29-360"><a href="#cb29-360" aria-hidden="true" tabindex="-1"></a>    <span class="st">'vars'</span>: numeric_data.columns,</span>
<span id="cb29-361"><a href="#cb29-361" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n'</span>: numeric_data.count().values,</span>
<span id="cb29-362"><a href="#cb29-362" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mean'</span>: numeric_data.mean().values,</span>
<span id="cb29-363"><a href="#cb29-363" aria-hidden="true" tabindex="-1"></a>    <span class="st">'sd'</span>: numeric_data.std().values,</span>
<span id="cb29-364"><a href="#cb29-364" aria-hidden="true" tabindex="-1"></a>    <span class="st">'median'</span>: numeric_data.median().values,</span>
<span id="cb29-365"><a href="#cb29-365" aria-hidden="true" tabindex="-1"></a>    <span class="st">'min'</span>: numeric_data.<span class="bu">min</span>().values,</span>
<span id="cb29-366"><a href="#cb29-366" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max'</span>: numeric_data.<span class="bu">max</span>().values,</span>
<span id="cb29-367"><a href="#cb29-367" aria-hidden="true" tabindex="-1"></a>    <span class="st">'skew'</span>: numeric_data.skew().values,</span>
<span id="cb29-368"><a href="#cb29-368" aria-hidden="true" tabindex="-1"></a>    <span class="st">'kurtosis'</span>: numeric_data.kurtosis().values</span>
<span id="cb29-369"><a href="#cb29-369" aria-hidden="true" tabindex="-1"></a>    }).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb29-370"><a href="#cb29-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-371"><a href="#cb29-371" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize</span></span>
<span id="cb29-372"><a href="#cb29-372" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tabulate(desc_stats, </span>
<span id="cb29-373"><a href="#cb29-373" aria-hidden="true" tabindex="-1"></a>        headers<span class="op">=</span><span class="st">'keys'</span>, </span>
<span id="cb29-374"><a href="#cb29-374" aria-hidden="true" tabindex="-1"></a>        tablefmt<span class="op">=</span><span class="st">'pipe'</span>, </span>
<span id="cb29-375"><a href="#cb29-375" aria-hidden="true" tabindex="-1"></a>        showindex<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb29-376"><a href="#cb29-376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-377"><a href="#cb29-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-378"><a href="#cb29-378" aria-hidden="true" tabindex="-1"></a><span class="fu">### Equation Selection</span></span>
<span id="cb29-379"><a href="#cb29-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-380"><a href="#cb29-380" aria-hidden="true" tabindex="-1"></a>Following best practices from forest inventory methodology <span class="co">[</span><span class="ot">@duncansonAbovegroundWoodyBiomass2021</span><span class="co">]</span>, equation selection may proceed through the four sequential criteria in order of their priority below:</span>
<span id="cb29-381"><a href="#cb29-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-382"><a href="#cb29-382" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Geographic Proximity: Prioritize equations developed in climates and soil conditions similar to your project area</span>
<span id="cb29-383"><a href="#cb29-383" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Taxonomic Specificity: Prefer species-level <span class="sc">\&gt;</span> genus-level <span class="sc">\&gt;</span> family-level equations</span>
<span id="cb29-384"><a href="#cb29-384" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>DBH Range Coverage: Ensure equation applicability spans ≥80% of measured diameter distribution</span>
<span id="cb29-385"><a href="#cb29-385" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Sample Size Adequacy: Minimum n=50 trees for species-specific; n<span class="sc">\&gt;</span>150 for genus-level equations<span class="ot">[^index-2]</span></span>
<span id="cb29-386"><a href="#cb29-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-387"><a href="#cb29-387" aria-hidden="true" tabindex="-1"></a>The allodb equations database contains 570 allometric equations with 47 metadata fields documenting equation provenance, geographic origin, taxonomic scope, DBH range, sample size, and model fitting parameters. Key selection criteria include geographic coordinates (lat/long), equation taxa, allometry specificity (species/genus/family), DBH range (min/max), sample size, and bias correction status. The complete metadata structure is available in Section 1.6.</span>
<span id="cb29-388"><a href="#cb29-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-391"><a href="#cb29-391" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-392"><a href="#cb29-392" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-393"><a href="#cb29-393" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-394"><a href="#cb29-394" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb29-395"><a href="#cb29-395" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-396"><a href="#cb29-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-397"><a href="#cb29-397" aria-hidden="true" tabindex="-1"></a><span class="co"># Load allometric equations</span></span>
<span id="cb29-398"><a href="#cb29-398" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(equations)</span>
<span id="cb29-399"><a href="#cb29-399" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"equations_metadata"</span>)</span>
<span id="cb29-400"><a href="#cb29-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-401"><a href="#cb29-401" aria-hidden="true" tabindex="-1"></a><span class="co"># display all equation criteria</span></span>
<span id="cb29-402"><a href="#cb29-402" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(equations)</span>
<span id="cb29-403"><a href="#cb29-403" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-404"><a href="#cb29-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-405"><a href="#cb29-405" aria-hidden="true" tabindex="-1"></a>*Table X: Full list of variables in `equations` metadata available used in selection criteria using `allodb` package below.*</span>
<span id="cb29-406"><a href="#cb29-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-409"><a href="#cb29-409" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-410"><a href="#cb29-410" aria-hidden="true" tabindex="-1"></a><span class="co">#| context: setup</span></span>
<span id="cb29-411"><a href="#cb29-411" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-412"><a href="#cb29-412" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-413"><a href="#cb29-413" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb29-414"><a href="#cb29-414" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb29-415"><a href="#cb29-415" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-416"><a href="#cb29-416" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------- #</span></span>
<span id="cb29-417"><a href="#cb29-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-418"><a href="#cb29-418" aria-hidden="true" tabindex="-1"></a><span class="co">#  Full HTML TABLES when rendered in HTML   </span></span>
<span id="cb29-419"><a href="#cb29-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-420"><a href="#cb29-420" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------- #</span></span>
<span id="cb29-421"><a href="#cb29-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-422"><a href="#cb29-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-423"><a href="#cb29-423" aria-hidden="true" tabindex="-1"></a>eq_tab_acer <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"./data/eq_tab_acer.csv"</span>)</span>
<span id="cb29-424"><a href="#cb29-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-425"><a href="#cb29-425" aria-hidden="true" tabindex="-1"></a><span class="co"># extract downstream variables </span></span>
<span id="cb29-426"><a href="#cb29-426" aria-hidden="true" tabindex="-1"></a>show_cols   <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb29-427"><a href="#cb29-427" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ref_id"</span>, <span class="st">"equation_taxa"</span>, <span class="st">"allometry_specificity"</span>, </span>
<span id="cb29-428"><a href="#cb29-428" aria-hidden="true" tabindex="-1"></a>    <span class="st">"equation_allometry"</span></span>
<span id="cb29-429"><a href="#cb29-429" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-430"><a href="#cb29-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-431"><a href="#cb29-431" aria-hidden="true" tabindex="-1"></a>show_cols_html   <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb29-432"><a href="#cb29-432" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ref_id"</span>, <span class="st">"equation_taxa"</span>, <span class="st">"allometry_specificity"</span>, <span class="st">"equation_allometry"</span>, </span>
<span id="cb29-433"><a href="#cb29-433" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dependent_variable"</span>, <span class="st">"independent_variable"</span>, <span class="st">"dbh_min_cm"</span>, <span class="st">"dbh_max_cm"</span>, <span class="st">"sample_size"</span>,</span>
<span id="cb29-434"><a href="#cb29-434" aria-hidden="true" tabindex="-1"></a>    <span class="st">"stand_age_range_yr"</span>, <span class="st">"stand_basal_area_m2_ha"</span>, <span class="st">"stand_trees_ha"</span>,</span>
<span id="cb29-435"><a href="#cb29-435" aria-hidden="true" tabindex="-1"></a>    <span class="st">"geographic_area"</span>, <span class="st">"original_coord"</span>, <span class="st">"lat"</span>, <span class="st">"long"</span>, <span class="st">"elev_m"</span>, </span>
<span id="cb29-436"><a href="#cb29-436" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ecosystem_type"</span>, <span class="st">"koppen"</span>, <span class="st">"min.temp_c"</span>, <span class="st">"max.temp_c"</span>, <span class="st">"map_mm"</span>, </span>
<span id="cb29-437"><a href="#cb29-437" aria-hidden="true" tabindex="-1"></a>    <span class="st">"regression_model"</span>, <span class="st">"r_squared"</span>, <span class="st">"bias_correction_factor"</span>, </span>
<span id="cb29-438"><a href="#cb29-438" aria-hidden="true" tabindex="-1"></a>    <span class="st">"allometry_development_method"</span></span>
<span id="cb29-439"><a href="#cb29-439" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-440"><a href="#cb29-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-441"><a href="#cb29-441" aria-hidden="true" tabindex="-1"></a><span class="co"># Fix data formats</span></span>
<span id="cb29-442"><a href="#cb29-442" aria-hidden="true" tabindex="-1"></a>eq_tab_acer <span class="ot">=</span> eq_tab_acer <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb29-443"><a href="#cb29-443" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">where</span>(is.character), </span>
<span id="cb29-444"><a href="#cb29-444" aria-hidden="true" tabindex="-1"></a>                 <span class="sc">~</span><span class="fu">iconv</span>(., <span class="at">from =</span> <span class="st">""</span>, <span class="at">to =</span> <span class="st">"UTF-8"</span>, <span class="at">sub =</span> <span class="st">""</span>)))</span>
<span id="cb29-445"><a href="#cb29-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-446"><a href="#cb29-446" aria-hidden="true" tabindex="-1"></a>flextable<span class="sc">::</span><span class="fu">flextable</span>(eq_tab_acer[, show_cols]) <span class="sc">|&gt;</span> </span>
<span id="cb29-447"><a href="#cb29-447" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size=</span><span class="dv">7</span>,<span class="at">part=</span><span class="st">"all"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-448"><a href="#cb29-448" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">colformat_double</span>(<span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">na_str =</span> <span class="st">"N/A"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-449"><a href="#cb29-449" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">set_header_labels</span>(CarbonStocks_input,<span class="at">values =</span> <span class="fu">list</span>(</span>
<span id="cb29-450"><a href="#cb29-450" aria-hidden="true" tabindex="-1"></a>    <span class="at">ref_id                          =</span> <span class="st">"Ref ID"</span>,</span>
<span id="cb29-451"><a href="#cb29-451" aria-hidden="true" tabindex="-1"></a>    <span class="at">equation_taxa         =</span> <span class="st">"Equation Taxa"</span>,</span>
<span id="cb29-452"><a href="#cb29-452" aria-hidden="true" tabindex="-1"></a>    <span class="at">allometry_specificity =</span> <span class="st">"Allometry Specificity"</span>,</span>
<span id="cb29-453"><a href="#cb29-453" aria-hidden="true" tabindex="-1"></a>    <span class="at">equation_allometry    =</span> <span class="st">"Equation Allometry"</span></span>
<span id="cb29-454"><a href="#cb29-454" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">|&gt;</span> </span>
<span id="cb29-455"><a href="#cb29-455" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-456"><a href="#cb29-456" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>)</span>
<span id="cb29-457"><a href="#cb29-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-458"><a href="#cb29-458" aria-hidden="true" tabindex="-1"></a><span class="co"># fix coordinates for html tables</span></span>
<span id="cb29-459"><a href="#cb29-459" aria-hidden="true" tabindex="-1"></a>eq_tab_acer_clean <span class="ot">=</span> eq_tab_acer <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb29-460"><a href="#cb29-460" aria-hidden="true" tabindex="-1"></a>    <span class="at">original_coord =</span> <span class="fu">iconv</span>(original_coord, <span class="at">to =</span> <span class="st">"ASCII//TRANSLIT"</span>),</span>
<span id="cb29-461"><a href="#cb29-461" aria-hidden="true" tabindex="-1"></a>    <span class="at">lat =</span> <span class="fu">iconv</span>(lat, <span class="at">to =</span> <span class="st">"ASCII//TRANSLIT"</span>),</span>
<span id="cb29-462"><a href="#cb29-462" aria-hidden="true" tabindex="-1"></a>    <span class="at">long =</span> <span class="fu">iconv</span>(long, <span class="at">to =</span> <span class="st">"ASCII//TRANSLIT"</span>))</span>
<span id="cb29-463"><a href="#cb29-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-464"><a href="#cb29-464" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-465"><a href="#cb29-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-466"><a href="#cb29-466" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span></span>
<span id="cb29-467"><a href="#cb29-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-468"><a href="#cb29-468" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb29-469"><a href="#cb29-469" aria-hidden="true" tabindex="-1"></a><span class="fu">## Navigating Databases</span></span>
<span id="cb29-470"><a href="#cb29-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-471"><a href="#cb29-471" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>It is recommend using latitude and longitude variables over the field called <span class="in">`geographic_area`</span> when filtering <span class="in">`allodb`</span> database due to entry inconsistencies. This is done below using <span class="in">`dplyr`</span> SQL. However, once the specific allometric equation is identified, we must re-select it using the <span class="in">`allodb`</span> native function called <span class="in">`new_equations()`</span> and the equation's ID# <span class="co">[</span><span class="ot">@allodb</span><span class="co">]</span>.</span>
<span id="cb29-472"><a href="#cb29-472" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In subsequent cells, we import pan-tropical equations and fit them with values from by Global Wood Density database using the <span class="in">`computeAGB()`</span> and<span class="in">`getWoodDensity()`</span> functions from the <span class="in">`BIOMASS`</span> package <span class="co">[</span><span class="ot">@BIOMASS-2</span><span class="co">]</span>.</span>
<span id="cb29-473"><a href="#cb29-473" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-474"><a href="#cb29-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-475"><a href="#cb29-475" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Step 1: Geographic Selection</span></span>
<span id="cb29-476"><a href="#cb29-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-477"><a href="#cb29-477" aria-hidden="true" tabindex="-1"></a>We recommend using latitude and longitude variables over the field called <span class="in">`geographic_area`</span> when filtering <span class="in">`allodb`</span> database due to entry inconsistencies. This is done below using <span class="in">`dplyr`</span> SQL. However, once the specific allometric equation is identified, we must re-select it using the <span class="in">`allodb`</span> native function called <span class="in">`new_equations()`</span> and the equation's ID# <span class="co">[</span><span class="ot">@allodb</span><span class="co">]</span>.</span>
<span id="cb29-478"><a href="#cb29-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-479"><a href="#cb29-479" aria-hidden="true" tabindex="-1"></a>In subsequent cells, we import pan-tropical equations and fit them with values from by Global Wood Density database using the <span class="in">`computeAGB()`</span> and<span class="in">`getWoodDensity()`</span> functions from the <span class="in">`BIOMASS`</span> package <span class="co">[</span><span class="ot">@BIOMASS-2</span><span class="co">]</span>.</span>
<span id="cb29-480"><a href="#cb29-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-481"><a href="#cb29-481" aria-hidden="true" tabindex="-1"></a>We filtered equations to North America using latitude bounds of 24-72°N and longitude bounds of -168 to -52°W. This geographic constraint ensures climate similarity with our Front Royal, Virginia study site (Cfa - humid subtropical classification). The filter retained 157 equations from the original 570, including equations developed in temperate forests across the eastern United States, southeastern Canada, and Alaska.</span>
<span id="cb29-482"><a href="#cb29-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-485"><a href="#cb29-485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-486"><a href="#cb29-486" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-487"><a href="#cb29-487" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-488"><a href="#cb29-488" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb29-489"><a href="#cb29-489" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-490"><a href="#cb29-490" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb29-491"><a href="#cb29-491" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb29-492"><a href="#cb29-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-493"><a href="#cb29-493" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple North America filter</span></span>
<span id="cb29-494"><a href="#cb29-494" aria-hidden="true" tabindex="-1"></a>eq_region <span class="ot">&lt;-</span> equations <span class="sc">|&gt;</span></span>
<span id="cb29-495"><a href="#cb29-495" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lat =</span> <span class="fu">as.numeric</span>(lat), <span class="at">long =</span> <span class="fu">as.numeric</span>(long)) <span class="sc">|&gt;</span></span>
<span id="cb29-496"><a href="#cb29-496" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(lat), <span class="sc">!</span><span class="fu">is.na</span>(long), lat <span class="sc">&gt;=</span> <span class="dv">24</span>, lat <span class="sc">&lt;=</span> <span class="dv">72</span>, long <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">168</span>, long <span class="sc">&lt;=</span> <span class="sc">-</span><span class="dv">52</span>)</span>
<span id="cb29-497"><a href="#cb29-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-498"><a href="#cb29-498" aria-hidden="true" tabindex="-1"></a><span class="co"># tabulate</span></span>
<span id="cb29-499"><a href="#cb29-499" aria-hidden="true" tabindex="-1"></a>show_cols   <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"ref_id"</span>, <span class="st">"equation_taxa"</span>, <span class="st">"allometry_specificity"</span>, <span class="st">"equation_allometry"</span>)</span>
<span id="cb29-500"><a href="#cb29-500" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(eq_region[, show_cols]) <span class="sc">|&gt;</span> </span>
<span id="cb29-501"><a href="#cb29-501" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">flextable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb29-502"><a href="#cb29-502" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-503"><a href="#cb29-503" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>)</span>
<span id="cb29-504"><a href="#cb29-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-505"><a href="#cb29-505" aria-hidden="true" tabindex="-1"></a><span class="co">#flextable::flextable(eq_region[, show_cols]) |&gt; flextable::autofit() # complete list for Appendix</span></span>
<span id="cb29-506"><a href="#cb29-506" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Equations valid to region: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">nrow</span>(eq_region)))</span>
<span id="cb29-507"><a href="#cb29-507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-508"><a href="#cb29-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-509"><a href="#cb29-509" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Step 2: Taxonomic Selection</span></span>
<span id="cb29-510"><a href="#cb29-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-513"><a href="#cb29-513" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-514"><a href="#cb29-514" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-515"><a href="#cb29-515" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-516"><a href="#cb29-516" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb29-517"><a href="#cb29-517" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-518"><a href="#cb29-518" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb29-519"><a href="#cb29-519" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb29-520"><a href="#cb29-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-521"><a href="#cb29-521" aria-hidden="true" tabindex="-1"></a><span class="co"># species-specific equations for all Quercus subspecies of North America </span></span>
<span id="cb29-522"><a href="#cb29-522" aria-hidden="true" tabindex="-1"></a>eq_region_species <span class="ot">&lt;-</span> eq_region <span class="sc">|&gt;</span></span>
<span id="cb29-523"><a href="#cb29-523" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(allometry_specificity <span class="sc">==</span> <span class="st">"Species"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-524"><a href="#cb29-524" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"^Quercus"</span>, equation_taxa, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">|</span> <span class="co"># Starts with "Quercus"</span></span>
<span id="cb29-525"><a href="#cb29-525" aria-hidden="true" tabindex="-1"></a>        (allometry_specificity <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Genus"</span>, <span class="st">"Family"</span>) <span class="sc">&amp;</span> </span>
<span id="cb29-526"><a href="#cb29-526" aria-hidden="true" tabindex="-1"></a>            <span class="fu">grepl</span>(<span class="st">"Quercus"</span>, equation_taxa, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>))</span>
<span id="cb29-527"><a href="#cb29-527" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb29-528"><a href="#cb29-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-529"><a href="#cb29-529" aria-hidden="true" tabindex="-1"></a><span class="co"># genus-specific equations for Quercus populations of North America </span></span>
<span id="cb29-530"><a href="#cb29-530" aria-hidden="true" tabindex="-1"></a>eq_region_genus <span class="ot">=</span> eq_region <span class="sc">|&gt;</span> </span>
<span id="cb29-531"><a href="#cb29-531" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(allometry_specificity <span class="sc">==</span> <span class="st">"Genus"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-532"><a href="#cb29-532" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"^Quercus"</span>, equation_taxa, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">|</span>  <span class="co"># Starts with "Quercus"</span></span>
<span id="cb29-533"><a href="#cb29-533" aria-hidden="true" tabindex="-1"></a>            (allometry_specificity <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Genus"</span>, <span class="st">"Family"</span>) <span class="sc">&amp;</span> </span>
<span id="cb29-534"><a href="#cb29-534" aria-hidden="true" tabindex="-1"></a>        <span class="fu">grepl</span>(<span class="st">"Quercus"</span>, equation_taxa, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>))</span>
<span id="cb29-535"><a href="#cb29-535" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb29-536"><a href="#cb29-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-537"><a href="#cb29-537" aria-hidden="true" tabindex="-1"></a><span class="co"># tabulate</span></span>
<span id="cb29-538"><a href="#cb29-538" aria-hidden="true" tabindex="-1"></a>flextable<span class="sc">::</span><span class="fu">flextable</span>(eq_region_species[, show_cols]) <span class="sc">|&gt;</span> </span>
<span id="cb29-539"><a href="#cb29-539" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-540"><a href="#cb29-540" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>)</span>
<span id="cb29-541"><a href="#cb29-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-542"><a href="#cb29-542" aria-hidden="true" tabindex="-1"></a><span class="co">#flextable::flextable(eq_region_genus[, show_cols]) |&gt; flextable::autofit()</span></span>
<span id="cb29-543"><a href="#cb29-543" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Genus-specific equations valid to region: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">nrow</span>(eq_region_genus)))</span>
<span id="cb29-544"><a href="#cb29-544" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Species-specific equations valid to region: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">nrow</span>(eq_region_species)))</span>
<span id="cb29-545"><a href="#cb29-545" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-546"><a href="#cb29-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-547"><a href="#cb29-547" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Step 3: DBH Matching Selection</span></span>
<span id="cb29-548"><a href="#cb29-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-551"><a href="#cb29-551" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-552"><a href="#cb29-552" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-553"><a href="#cb29-553" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-554"><a href="#cb29-554" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb29-555"><a href="#cb29-555" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-556"><a href="#cb29-556" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb29-557"><a href="#cb29-557" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb29-558"><a href="#cb29-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-559"><a href="#cb29-559" aria-hidden="true" tabindex="-1"></a><span class="co"># filter genus-specific equations by DBH range of field data</span></span>
<span id="cb29-560"><a href="#cb29-560" aria-hidden="true" tabindex="-1"></a>field_dbh_min <span class="ot">&lt;-</span> <span class="fu">min</span>(scbi_quercus<span class="sc">$</span>dbh, <span class="at">na.rm =</span> T) <span class="co"># 1.04 cm</span></span>
<span id="cb29-561"><a href="#cb29-561" aria-hidden="true" tabindex="-1"></a>field_dbh_max <span class="ot">&lt;-</span> <span class="fu">max</span>(scbi_quercus<span class="sc">$</span>dbh, <span class="at">na.rm =</span> T) <span class="co"># 83.5 cm</span></span>
<span id="cb29-562"><a href="#cb29-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-563"><a href="#cb29-563" aria-hidden="true" tabindex="-1"></a>eq_region_genus_dbh <span class="ot">&lt;-</span> eq_region_genus <span class="sc">|&gt;</span></span>
<span id="cb29-564"><a href="#cb29-564" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb29-565"><a href="#cb29-565" aria-hidden="true" tabindex="-1"></a>    <span class="at">dbh_min_cm =</span> <span class="fu">as.numeric</span>(dbh_min_cm), </span>
<span id="cb29-566"><a href="#cb29-566" aria-hidden="true" tabindex="-1"></a>    <span class="at">dbh_max_cm =</span> <span class="fu">as.numeric</span>(dbh_max_cm)) <span class="sc">|&gt;</span></span>
<span id="cb29-567"><a href="#cb29-567" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dbh_min_cm), <span class="sc">!</span><span class="fu">is.na</span>(dbh_max_cm),</span>
<span id="cb29-568"><a href="#cb29-568" aria-hidden="true" tabindex="-1"></a>    <span class="co"># extrapolation of saplings (min=20cm), compensated in Step 5 (risk if high sapling count)</span></span>
<span id="cb29-569"><a href="#cb29-569" aria-hidden="true" tabindex="-1"></a>    dbh_min_cm <span class="sc">&lt;=</span> field_dbh_min <span class="sc">*</span> <span class="dv">20</span>, </span>
<span id="cb29-570"><a href="#cb29-570" aria-hidden="true" tabindex="-1"></a>    dbh_max_cm <span class="sc">&gt;=</span> field_dbh_max)</span>
<span id="cb29-571"><a href="#cb29-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-572"><a href="#cb29-572" aria-hidden="true" tabindex="-1"></a>eq_region_species_dbh <span class="ot">&lt;-</span> eq_region_species <span class="sc">|&gt;</span></span>
<span id="cb29-573"><a href="#cb29-573" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb29-574"><a href="#cb29-574" aria-hidden="true" tabindex="-1"></a>    <span class="at">dbh_min_cm =</span> <span class="fu">as.numeric</span>(dbh_min_cm), </span>
<span id="cb29-575"><a href="#cb29-575" aria-hidden="true" tabindex="-1"></a>    <span class="at">dbh_max_cm =</span> <span class="fu">as.numeric</span>(dbh_max_cm)) <span class="sc">|&gt;</span></span>
<span id="cb29-576"><a href="#cb29-576" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dbh_min_cm), <span class="sc">!</span><span class="fu">is.na</span>(dbh_max_cm),</span>
<span id="cb29-577"><a href="#cb29-577" aria-hidden="true" tabindex="-1"></a>    dbh_max_cm <span class="sc">&gt;=</span> field_dbh_max <span class="sc">*</span> <span class="fl">0.7</span>) </span>
<span id="cb29-578"><a href="#cb29-578" aria-hidden="true" tabindex="-1"></a>        <span class="co"># extrapolation of crowns allowed, consider outliers</span></span>
<span id="cb29-579"><a href="#cb29-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-580"><a href="#cb29-580" aria-hidden="true" tabindex="-1"></a>flextable<span class="sc">::</span><span class="fu">flextable</span>(eq_region_genus_dbh[, show_cols]) <span class="sc">|&gt;</span> </span>
<span id="cb29-581"><a href="#cb29-581" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-582"><a href="#cb29-582" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>)</span>
<span id="cb29-583"><a href="#cb29-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-584"><a href="#cb29-584" aria-hidden="true" tabindex="-1"></a>flextable<span class="sc">::</span><span class="fu">flextable</span>(eq_region_species_dbh[, show_cols]) <span class="sc">|&gt;</span> </span>
<span id="cb29-585"><a href="#cb29-585" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-586"><a href="#cb29-586" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>)</span>
<span id="cb29-587"><a href="#cb29-587" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-588"><a href="#cb29-588" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Genus-specific equations valid for region, Quercus, &amp; DBH range: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">nrow</span>(eq_region_genus_dbh)))</span>
<span id="cb29-589"><a href="#cb29-589" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Specific-specific equations valid for region, Quercus, &amp; DBH range: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">nrow</span>(eq_region_species_dbh)))</span>
<span id="cb29-590"><a href="#cb29-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-591"><a href="#cb29-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-592"><a href="#cb29-592" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(equations)</span>
<span id="cb29-593"><a href="#cb29-593" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-594"><a href="#cb29-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-595"><a href="#cb29-595" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Step 4: Sample Size Selection</span></span>
<span id="cb29-596"><a href="#cb29-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-597"><a href="#cb29-597" aria-hidden="true" tabindex="-1"></a>The required sample size for allometric equation development depends on desired precision and diameter distribution. @roxburgh2015guidelines demonstrated through Monte Carlo resampling that biomass predictions with a standard deviation within 7.5% of mean demands sample sizes of between 17 and 166, depending on the algorithm employed. Most importantly, stratified sampling across age class or dbh size is critical to improving precision.</span>
<span id="cb29-598"><a href="#cb29-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-599"><a href="#cb29-599" aria-hidden="true" tabindex="-1"></a>Following Roxburgh et al. (2015), we applied a minimum sample size threshold of n ≥ 17 to ensure equations were derived from adequate destructive sampling campaigns. This threshold balances precision requirements (coefficient of variation ≤7.5%) with practical constraints of destructive sampling costs. Stratification across DBH size classes during equation development is equally critical for capturing biomass variance across age cohorts.</span>
<span id="cb29-600"><a href="#cb29-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-603"><a href="#cb29-603" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-604"><a href="#cb29-604" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-605"><a href="#cb29-605" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-606"><a href="#cb29-606" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb29-607"><a href="#cb29-607" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-608"><a href="#cb29-608" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb29-609"><a href="#cb29-609" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb29-610"><a href="#cb29-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-611"><a href="#cb29-611" aria-hidden="true" tabindex="-1"></a>eq_region_genus_dbh_sample <span class="ot">&lt;-</span> eq_region_genus_dbh <span class="sc">|&gt;</span></span>
<span id="cb29-612"><a href="#cb29-612" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sample_size <span class="sc">&gt;=</span> <span class="dv">17</span>)  <span class="co"># Minimum for genus-specific equations</span></span>
<span id="cb29-613"><a href="#cb29-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-614"><a href="#cb29-614" aria-hidden="true" tabindex="-1"></a>eq_region_species_dbh_sample <span class="ot">&lt;-</span> eq_region_species_dbh <span class="sc">|&gt;</span></span>
<span id="cb29-615"><a href="#cb29-615" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sample_size <span class="sc">&gt;=</span> <span class="dv">17</span>)  <span class="co"># Minimum for species-specific equations</span></span>
<span id="cb29-616"><a href="#cb29-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-617"><a href="#cb29-617" aria-hidden="true" tabindex="-1"></a><span class="co"># Display selected equations &amp; tally valid equations remaining</span></span>
<span id="cb29-618"><a href="#cb29-618" aria-hidden="true" tabindex="-1"></a>flextable<span class="sc">::</span><span class="fu">flextable</span>(eq_region_genus_dbh_sample[, show_cols]) <span class="sc">|&gt;</span> </span>
<span id="cb29-619"><a href="#cb29-619" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-620"><a href="#cb29-620" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>)</span>
<span id="cb29-621"><a href="#cb29-621" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-622"><a href="#cb29-622" aria-hidden="true" tabindex="-1"></a>flextable<span class="sc">::</span><span class="fu">flextable</span>(eq_region_species_dbh_sample[, show_cols]) <span class="sc">|&gt;</span></span>
<span id="cb29-623"><a href="#cb29-623" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-624"><a href="#cb29-624" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>)</span>
<span id="cb29-625"><a href="#cb29-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-626"><a href="#cb29-626" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Genus-specific equations meeting all criteria: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">nrow</span>(eq_region_genus_dbh_sample)))</span>
<span id="cb29-627"><a href="#cb29-627" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Species-specific equations meeting all criteria: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">nrow</span>(eq_region_species_dbh_sample)))</span>
<span id="cb29-628"><a href="#cb29-628" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-629"><a href="#cb29-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-632"><a href="#cb29-632" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-633"><a href="#cb29-633" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb29-634"><a href="#cb29-634" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb29-635"><a href="#cb29-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-636"><a href="#cb29-636" aria-hidden="true" tabindex="-1"></a><span class="co"># Document selection rationale for REDD+ MRV reporting</span></span>
<span id="cb29-637"><a href="#cb29-637" aria-hidden="true" tabindex="-1"></a>equation_metadata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-638"><a href="#cb29-638" aria-hidden="true" tabindex="-1"></a>  <span class="at">Criterion =</span> <span class="fu">c</span>(<span class="st">"Geography"</span>, <span class="st">"Taxonomy"</span>, <span class="st">"DBH Range"</span>, <span class="st">"Sample Size"</span>),</span>
<span id="cb29-639"><a href="#cb29-639" aria-hidden="true" tabindex="-1"></a>  <span class="at">Threshold =</span> <span class="fu">c</span>(</span>
<span id="cb29-640"><a href="#cb29-640" aria-hidden="true" tabindex="-1"></a>    <span class="st">"North America (24-72°N, -168 to -52°W)"</span>,</span>
<span id="cb29-641"><a href="#cb29-641" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Species &gt; Genus &gt; Family"</span>,</span>
<span id="cb29-642"><a href="#cb29-642" aria-hidden="true" tabindex="-1"></a>    <span class="st">"≥80% field data coverage"</span>,</span>
<span id="cb29-643"><a href="#cb29-643" aria-hidden="true" tabindex="-1"></a>    <span class="st">"≥50 (Roxburgh et al. 2015)"</span></span>
<span id="cb29-644"><a href="#cb29-644" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb29-645"><a href="#cb29-645" aria-hidden="true" tabindex="-1"></a>  <span class="at">Selected_Value =</span> <span class="fu">c</span>(</span>
<span id="cb29-646"><a href="#cb29-646" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%d equations in region"</span>, <span class="fu">nrow</span>(eq_region)),</span>
<span id="cb29-647"><a href="#cb29-647" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%d genus-level, %d species-specific"</span>, <span class="fu">nrow</span>(eq_region_genus), <span class="fu">nrow</span>(eq_region_species)),</span>
<span id="cb29-648"><a href="#cb29-648" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f-%.1f cm (field), 11-93 cm (equation)"</span>, field_dbh_min, field_dbh_max),</span>
<span id="cb29-649"><a href="#cb29-649" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"n=%d (Stovall 2018)"</span>, <span class="dv">66</span>)</span>
<span id="cb29-650"><a href="#cb29-650" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb29-651"><a href="#cb29-651" aria-hidden="true" tabindex="-1"></a>  <span class="at">Justification =</span> <span class="fu">c</span>(</span>
<span id="cb29-652"><a href="#cb29-652" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Climate similarity to Front Royal, VA (Cfa)"</span>,</span>
<span id="cb29-653"><a href="#cb29-653" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Species-specific preferred; genus fallback acceptable"</span>,</span>
<span id="cb29-654"><a href="#cb29-654" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Minor extrapolation for saplings (&lt;5% biomass)"</span>,</span>
<span id="cb29-655"><a href="#cb29-655" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Meets precision threshold of CV=7.5%"</span></span>
<span id="cb29-656"><a href="#cb29-656" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-657"><a href="#cb29-657" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-658"><a href="#cb29-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-659"><a href="#cb29-659" aria-hidden="true" tabindex="-1"></a>equation_metadata <span class="sc">|&gt;</span></span>
<span id="cb29-660"><a href="#cb29-660" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">flextable</span>() <span class="sc">|&gt;</span></span>
<span id="cb29-661"><a href="#cb29-661" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">set_caption</span>(<span class="st">"Equation Selection Documentation for REDD+ MRV"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-662"><a href="#cb29-662" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-663"><a href="#cb29-663" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>)</span>
<span id="cb29-664"><a href="#cb29-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-665"><a href="#cb29-665" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-666"><a href="#cb29-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-667"><a href="#cb29-667" aria-hidden="true" tabindex="-1"></a>*Table X: Equation Selection Documentation for REDD+ MRV*</span>
<span id="cb29-668"><a href="#cb29-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-669"><a href="#cb29-669" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>  <span class="pp">|</span>  <span class="pp">|</span></span>
<span id="cb29-670"><a href="#cb29-670" aria-hidden="true" tabindex="-1"></a><span class="pp">|------------------------------------|------------------------------------|</span></span>
<span id="cb29-671"><a href="#cb29-671" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Attribute <span class="pp">|</span> Detail <span class="pp">|</span></span>
<span id="cb29-672"><a href="#cb29-672" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Equation Taxa/ID <span class="pp">|</span> *Quercus* spp. (Genus-level) <span class="pp">|</span></span>
<span id="cb29-673"><a href="#cb29-673" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Biomass Method <span class="pp">|</span> Non-destructive estimation using Terrestrial Laser Scanning (TLS) or Terrestrial LiDAR to model tree volume, which was then converted to biomass using published wood density values. <span class="pp">|</span></span>
<span id="cb29-674"><a href="#cb29-674" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Geographic Location <span class="pp">|</span> Front Royal, Virginia, USA (Smithsonian Conservation Biology Institute, SCBI) at 38.89 N, -78.15W. <span class="pp">|</span></span>
<span id="cb29-675"><a href="#cb29-675" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Empirical Data <span class="pp">|</span> The models were developed using 258 non-destructive volume/biomass estimates across 10 dominant hardwood species in this Temperate Mixed Deciduous Forest. The specific equation is a site-specific genus model. <span class="pp">|</span></span>
<span id="cb29-676"><a href="#cb29-676" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Rationale for Selection <span class="pp">|</span> This equation is the most geographically and ecologically similar candidate. It was developed at the exact same site (SCBI in Virginia) where your sample data is likely sourced (based on <span class="in">`allodb.Rmd`</span>content). Despite being a genus-level equation for Quercus (not species-specific), the high degree of climate similarity (Cfa/Temperate Forest) and geographic proximity ensures maximum weight will be assigned by the <span class="in">`allodb`</span> weighting framework, making it the highest priority candidate for Quercus trees at this site. <span class="pp">|</span></span>
<span id="cb29-677"><a href="#cb29-677" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Citation <span class="pp">|</span> Stovall, A. E., Anderson-Teixeira, K. J., &amp; Shugart, H. H. (2018). Terrestrial LiDAR-derived non-destructive woody biomass estimates for 10 hardwood species in Virginia.&nbsp;*Data in brief*, *19*, 1560-1569 <span class="pp">|</span></span>
<span id="cb29-678"><a href="#cb29-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-679"><a href="#cb29-679" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>  <span class="pp">|</span>  <span class="pp">|</span></span>
<span id="cb29-680"><a href="#cb29-680" aria-hidden="true" tabindex="-1"></a><span class="pp">|------------------------------------|------------------------------------|</span></span>
<span id="cb29-681"><a href="#cb29-681" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Attribute <span class="pp">|</span> Detail <span class="pp">|</span></span>
<span id="cb29-682"><a href="#cb29-682" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Equation Taxa/ID <span class="pp">|</span> Quercus rubra (Species-level) <span class="pp">|</span></span>
<span id="cb29-683"><a href="#cb29-683" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Biomass Method <span class="pp">|</span> Destructive Harvesting (Dimensional Analysis). The traditional method involving felling, weighing, and drying tree components to directly measure biomass. <span class="pp">|</span></span>
<span id="cb29-684"><a href="#cb29-684" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Geographic Location <span class="pp">|</span> West Virginia, USA (specifically, Monongahela National Forest). <span class="pp">|</span></span>
<span id="cb29-685"><a href="#cb29-685" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Empirical Data <span class="pp">|</span> This is a species-specific equation developed explicitly for Northern Red Oak (Quercus rubra). The sample size is typically smaller than meta-analyses but provides high-resolution, direct measurements. <span class="pp">|</span></span>
<span id="cb29-686"><a href="#cb29-686" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Rationale for Selection <span class="pp">|</span> This equation provides high taxonomic specificity (a perfect species match for Quercus rubra). Although its location (West Virginia) is not as proximate as the Stovall (2018) study, it is still within the same Appalachian/Eastern US Temperate Forest region. It serves as a crucial check and source of high-quality empirical data derived from the gold-standard destructive method. <span class="in">`allodb`</span> balances its lower geographic proximity with its higher taxonomic specificity and robust methodology, making it the strongest secondary candidate. <span class="pp">|</span></span>
<span id="cb29-687"><a href="#cb29-687" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Citation <span class="pp">|</span> Clark, A. (1985). *Weight, volume, and physical properties of major hardwood species in the Gulf and Atlantic Coastal Plains*&nbsp;(Vol. 250). US Department of Agriculture, Forest Service, Southeastern Forest Experiment Station <span class="pp">|</span></span>
<span id="cb29-688"><a href="#cb29-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-689"><a href="#cb29-689" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Step 5: Combining Species Equations</span></span>
<span id="cb29-690"><a href="#cb29-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-691"><a href="#cb29-691" aria-hidden="true" tabindex="-1"></a>The following demonstrates functions for consolidating new filtered allometry equations into one combined database prepared for use in final inventory biomass estimations. For this important task, we recommend the specific functions below from the <span class="in">`allodb`</span> library that are ensure a weighted approach is applied to synthesizing and candidate equations:</span>
<span id="cb29-692"><a href="#cb29-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-693"><a href="#cb29-693" aria-hidden="true" tabindex="-1"></a>The <span class="in">`weight_allom()`</span> function is responsible for assigning a weight to each candidate equation based on three criteria, determining its influence on the final result:</span>
<span id="cb29-694"><a href="#cb29-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-695"><a href="#cb29-695" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Sample size: Equations derived from varying destructive sampling campaigns (n <span class="sc">\&gt;</span> 100) receive higher weights.</span>
<span id="cb29-696"><a href="#cb29-696" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Taxonomic specificity: Species-specific equations are weighted more heavily than genus-level, which in turn outweigh family-level equations.</span>
<span id="cb29-697"><a href="#cb29-697" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Climate similarity: Equations developed from geographically proximate locations with similar temperature and precipitation regimes receive priority.</span>
<span id="cb29-698"><a href="#cb29-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-699"><a href="#cb29-699" aria-hidden="true" tabindex="-1"></a>The <span class="in">`resample_agb()`</span> function implements a Monte Carlo resampling procedure to synthesize a robust, synthetic dataset from the weighted equations:</span>
<span id="cb29-700"><a href="#cb29-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-701"><a href="#cb29-701" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Each candidate equation is resampled within its original DBH range.</span>
<span id="cb29-702"><a href="#cb29-702" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The number of resampled values for each equation is proportional to its assigned weight.</span>
<span id="cb29-703"><a href="#cb29-703" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>A default of 10,000 iterations (or 1e4 in the demo) ensures a robust representation of the uncertainty distribution. This process generates a synthetic dataset that reflects the collective information from all weighted equations, spanning the full DBH range observed in the target forest.</span>
<span id="cb29-704"><a href="#cb29-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-705"><a href="#cb29-705" aria-hidden="true" tabindex="-1"></a>The <span class="in">`est_params()`</span> function then uses the synthetic resampled data to fit the following nonlinear power-law model:</span>
<span id="cb29-706"><a href="#cb29-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-707"><a href="#cb29-707" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb29-708"><a href="#cb29-708" aria-hidden="true" tabindex="-1"></a>AGB = \alpha \ * \ DBH^b  \ + \ \epsilon </span>
<span id="cb29-709"><a href="#cb29-709" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb29-710"><a href="#cb29-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-711"><a href="#cb29-711" aria-hidden="true" tabindex="-1"></a>This process yields the location-specific parameters:</span>
<span id="cb29-712"><a href="#cb29-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-713"><a href="#cb29-713" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>⍺ (scaling coefficient): Incorporates local wood density and architectural characteristics.</span>
<span id="cb29-714"><a href="#cb29-714" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>𝒃 (allometric exponent): Typically ranges from 2.3 to 2.7, reflecting biomechanical constraints.</span>
<span id="cb29-715"><a href="#cb29-715" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>σ (residual standard deviation): Quantifies the prediction uncertainty for the calibrated equation.</span>
<span id="cb29-716"><a href="#cb29-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-717"><a href="#cb29-717" aria-hidden="true" tabindex="-1"></a>The resulting equation is location-specific, informed by broader taxonomic and geographic patterns encoded in the weighted source equations.</span>
<span id="cb29-718"><a href="#cb29-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-721"><a href="#cb29-721" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-722"><a href="#cb29-722" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-723"><a href="#cb29-723" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-724"><a href="#cb29-724" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb29-725"><a href="#cb29-725" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-726"><a href="#cb29-726" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb29-727"><a href="#cb29-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-728"><a href="#cb29-728" aria-hidden="true" tabindex="-1"></a><span class="co"># This table includes filtered default Acer equations AND custom new equations.</span></span>
<span id="cb29-729"><a href="#cb29-729" aria-hidden="true" tabindex="-1"></a>eq_tab_combined <span class="ot">&lt;-</span> <span class="fu">new_equations</span>(</span>
<span id="cb29-730"><a href="#cb29-730" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset_taxa =</span> <span class="st">"Quercus"</span>,</span>
<span id="cb29-731"><a href="#cb29-731" aria-hidden="true" tabindex="-1"></a>  <span class="at">new_taxa =</span> <span class="fu">c</span>(<span class="st">"Quercus ilex"</span>, <span class="st">"Castanea sativa"</span>),</span>
<span id="cb29-732"><a href="#cb29-732" aria-hidden="true" tabindex="-1"></a>  <span class="at">new_allometry =</span> <span class="fu">c</span>(<span class="st">"0.12*dbh^2.5"</span>, <span class="st">"0.15*dbh^2.7"</span>),</span>
<span id="cb29-733"><a href="#cb29-733" aria-hidden="true" tabindex="-1"></a>  <span class="at">new_coords =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">44</span>),</span>
<span id="cb29-734"><a href="#cb29-734" aria-hidden="true" tabindex="-1"></a>  <span class="at">new_min_dbh =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>),</span>
<span id="cb29-735"><a href="#cb29-735" aria-hidden="true" tabindex="-1"></a>  <span class="at">new_max_dbh =</span> <span class="fu">c</span>(<span class="dv">35</span>, <span class="dv">68</span>),</span>
<span id="cb29-736"><a href="#cb29-736" aria-hidden="true" tabindex="-1"></a>  <span class="at">new_sample_size =</span> <span class="fu">c</span>(<span class="dv">143</span>, <span class="dv">62</span>)</span>
<span id="cb29-737"><a href="#cb29-737" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-738"><a href="#cb29-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-739"><a href="#cb29-739" aria-hidden="true" tabindex="-1"></a><span class="co"># The get_biomass() function internally performs the weighting, resampling,</span></span>
<span id="cb29-740"><a href="#cb29-740" aria-hidden="true" tabindex="-1"></a><span class="co"># and calibration based on the equations in eq_tab_combined.</span></span>
<span id="cb29-741"><a href="#cb29-741" aria-hidden="true" tabindex="-1"></a>agb_custom_estimate <span class="ot">&lt;-</span> <span class="fu">get_biomass</span>(</span>
<span id="cb29-742"><a href="#cb29-742" aria-hidden="true" tabindex="-1"></a>  <span class="at">dbh =</span> <span class="dv">50</span>,</span>
<span id="cb29-743"><a href="#cb29-743" aria-hidden="true" tabindex="-1"></a><span class="at">genus =</span> <span class="st">"Quercus"</span>,</span>
<span id="cb29-744"><a href="#cb29-744" aria-hidden="true" tabindex="-1"></a>  <span class="at">species =</span> <span class="st">"rubrum"</span>,</span>
<span id="cb29-745"><a href="#cb29-745" aria-hidden="true" tabindex="-1"></a>  <span class="at">coords =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">78.2</span>, <span class="fl">38.9</span>),</span>
<span id="cb29-746"><a href="#cb29-746" aria-hidden="true" tabindex="-1"></a>  <span class="at">new_eqtable =</span> eq_tab_combined <span class="co"># Use the consolidated custom table</span></span>
<span id="cb29-747"><a href="#cb29-747" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-748"><a href="#cb29-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-749"><a href="#cb29-749" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the resulting AGB estimate</span></span>
<span id="cb29-750"><a href="#cb29-750" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Estimated AGB using the combined custom table:"</span>, agb_custom_estimate, <span class="st">"kg"</span>))</span>
<span id="cb29-751"><a href="#cb29-751" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-752"><a href="#cb29-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-753"><a href="#cb29-753" aria-hidden="true" tabindex="-1"></a>This weighted synthesis approach ensures that geographically proximate, species-specific equations with larger sample sizes exert greater influence on the final calibrated model. The resulting equation incorporates collective information from all weighted candidates while reflecting local wood density and architectural characteristics. Implementation details are provided in Section 1.6.</span>
<span id="cb29-754"><a href="#cb29-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-755"><a href="#cb29-755" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb29-756"><a href="#cb29-756" aria-hidden="true" tabindex="-1"></a><span class="fu">## Allometry Best Practices</span></span>
<span id="cb29-757"><a href="#cb29-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-758"><a href="#cb29-758" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Transparency: Document all criteria and thresholds</span>
<span id="cb29-759"><a href="#cb29-759" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Reproducibility: Code-based workflow enables auditing</span>
<span id="cb29-760"><a href="#cb29-760" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Bias Reduction: Geographic and taxonomic filtering minimizes systematic errors to species level</span>
<span id="cb29-761"><a href="#cb29-761" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Uncertainty Surveillance: Multiple equations enable sensitivity analysis (Section 1.5)</span>
<span id="cb29-762"><a href="#cb29-762" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-763"><a href="#cb29-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-764"><a href="#cb29-764" aria-hidden="true" tabindex="-1"></a><span class="fu">### Biomass Estimations</span></span>
<span id="cb29-765"><a href="#cb29-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-766"><a href="#cb29-766" aria-hidden="true" tabindex="-1"></a>Having identified candidate species equations, we now compare their aboveground biomass estimates with biome-generic equations <span class="co">[</span><span class="ot">@chave2014improved; @brown1997a</span><span class="co">]</span>. Noting their geographic mismatch, we compared these with pan-tropical equations specifically in order to highlight discrepancies in uncertainty and significance of geography to allometric calibrations.</span>
<span id="cb29-767"><a href="#cb29-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-768"><a href="#cb29-768" aria-hidden="true" tabindex="-1"></a>We calculated aboveground biomass for all 84 Quercus stems using five allometric approaches:</span>
<span id="cb29-769"><a href="#cb29-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-770"><a href="#cb29-770" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Species-specific (allodb weighted synthesis): Location-optimized equation incorporating multiple Quercus species equations</span>
<span id="cb29-771"><a href="#cb29-771" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Genus-level (Stovall 2018): Site-specific Quercus equation from the same SCBI location</span>
<span id="cb29-772"><a href="#cb29-772" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Chave et al. 2014 (pan-tropical moist): Generic equation incorporating wood density and environmental stress factors</span>
<span id="cb29-773"><a href="#cb29-773" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Chave et al. 2005 (pan-tropical): Earlier generic formulation with DBH and wood density</span>
<span id="cb29-774"><a href="#cb29-774" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Brown 1997 (tropical): Widely used generic equation based on DBH alone</span>
<span id="cb29-775"><a href="#cb29-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-776"><a href="#cb29-776" aria-hidden="true" tabindex="-1"></a>Wood density values were extracted from the Global Wood Density database (Vieilledent et al., 2018) using the BIOMASS package, yielding mean WD = 0.630 g/cm³ for Quercus species (consistent with oak hardwood density). Note that Chave’s 2014 equation’s outputs required unit conversion from Mg to kg (×1000; Chave et al, 2014, Réjou-Méchain, Tanguy, Piponiot, Chave, &amp; Hérault, 2017), while Brown 1997 required division by 100 to match the original scale. These unit conversions are critical for accurate inter-equation comparison (see Section 1.6 for implementation).</span>
<span id="cb29-777"><a href="#cb29-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-780"><a href="#cb29-780" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-781"><a href="#cb29-781" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-782"><a href="#cb29-782" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-783"><a href="#cb29-783" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-784"><a href="#cb29-784" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb29-785"><a href="#cb29-785" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb29-786"><a href="#cb29-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-787"><a href="#cb29-787" aria-hidden="true" tabindex="-1"></a><span class="co"># once allometry equation is confirmed, use native allodb to load it</span></span>
<span id="cb29-788"><a href="#cb29-788" aria-hidden="true" tabindex="-1"></a>eq_region_genus_dbh_sample <span class="ot">=</span> allodb<span class="sc">::</span><span class="fu">new_equations</span>(<span class="at">subset_ids =</span> <span class="st">"a664c1"</span>)</span>
<span id="cb29-789"><a href="#cb29-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-790"><a href="#cb29-790" aria-hidden="true" tabindex="-1"></a><span class="co"># species-specific biomass estimates </span></span>
<span id="cb29-791"><a href="#cb29-791" aria-hidden="true" tabindex="-1"></a>scbi_quercus<span class="sc">$</span>agb_species <span class="ot">&lt;-</span> allodb<span class="sc">::</span><span class="fu">get_biomass</span>(</span>
<span id="cb29-792"><a href="#cb29-792" aria-hidden="true" tabindex="-1"></a>  <span class="at">dbh       =</span> scbi_quercus<span class="sc">$</span>dbh,</span>
<span id="cb29-793"><a href="#cb29-793" aria-hidden="true" tabindex="-1"></a>  <span class="at">genus     =</span> scbi_quercus<span class="sc">$</span>genus,</span>
<span id="cb29-794"><a href="#cb29-794" aria-hidden="true" tabindex="-1"></a>  <span class="at">species =</span> scbi_quercus<span class="sc">$</span>species,</span>
<span id="cb29-795"><a href="#cb29-795" aria-hidden="true" tabindex="-1"></a>  <span class="at">coords    =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">78.2</span>, <span class="fl">38.9</span>)</span>
<span id="cb29-796"><a href="#cb29-796" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-797"><a href="#cb29-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-798"><a href="#cb29-798" aria-hidden="true" tabindex="-1"></a><span class="co"># genus-specific biomass estimates</span></span>
<span id="cb29-799"><a href="#cb29-799" aria-hidden="true" tabindex="-1"></a>scbi_quercus<span class="sc">$</span>agb_genus <span class="ot">&lt;-</span> allodb<span class="sc">::</span><span class="fu">get_biomass</span>(</span>
<span id="cb29-800"><a href="#cb29-800" aria-hidden="true" tabindex="-1"></a>    <span class="at">dbh         =</span> scbi_quercus<span class="sc">$</span>dbh,</span>
<span id="cb29-801"><a href="#cb29-801" aria-hidden="true" tabindex="-1"></a>    <span class="at">genus   =</span> scbi_quercus<span class="sc">$</span>genus,</span>
<span id="cb29-802"><a href="#cb29-802" aria-hidden="true" tabindex="-1"></a>    <span class="at">species =</span> scbi_quercus<span class="sc">$</span>species,</span>
<span id="cb29-803"><a href="#cb29-803" aria-hidden="true" tabindex="-1"></a>    <span class="at">coords  =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">78.2</span>, <span class="fl">38.9</span>),</span>
<span id="cb29-804"><a href="#cb29-804" aria-hidden="true" tabindex="-1"></a>    <span class="at">new_eqtable =</span> eq_region_genus_dbh_sample</span>
<span id="cb29-805"><a href="#cb29-805" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-806"><a href="#cb29-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-807"><a href="#cb29-807" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-808"><a href="#cb29-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-809"><a href="#cb29-809" aria-hidden="true" tabindex="-1"></a>The following functions from the <span class="in">`BIOMASS`</span> package <span class="co">[</span><span class="ot">@BIOMASS</span><span class="co">]</span> require some additional wrangling, specifically to extract values from the Global Wood Density database <span class="co">[</span><span class="ot">@vieilledent2018new</span><span class="co">]</span> and convert units <span class="co">[</span><span class="ot">@rejou2017biomass</span><span class="co">]</span>.</span>
<span id="cb29-810"><a href="#cb29-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-811"><a href="#cb29-811" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb29-812"><a href="#cb29-812" aria-hidden="true" tabindex="-1"></a><span class="fu">## Unit Conversions</span></span>
<span id="cb29-813"><a href="#cb29-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-814"><a href="#cb29-814" aria-hidden="true" tabindex="-1"></a>Always verify if equations require unit conversions or scaling limiters. For example, the most commonly used allometry equation from Chave et al (2014) requires conversion from milligrams to kilograms, as shown below (<span class="in">`* 1000`</span>).</span>
<span id="cb29-815"><a href="#cb29-815" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-816"><a href="#cb29-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-819"><a href="#cb29-819" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-820"><a href="#cb29-820" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb29-821"><a href="#cb29-821" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb29-822"><a href="#cb29-822" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-823"><a href="#cb29-823" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-824"><a href="#cb29-824" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-825"><a href="#cb29-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-826"><a href="#cb29-826" aria-hidden="true" tabindex="-1"></a><span class="co"># derive generic estimates using standard equations</span></span>
<span id="cb29-827"><a href="#cb29-827" aria-hidden="true" tabindex="-1"></a>wood_densities <span class="ot">&lt;-</span> BIOMASS<span class="sc">::</span><span class="fu">getWoodDensity</span>(</span>
<span id="cb29-828"><a href="#cb29-828" aria-hidden="true" tabindex="-1"></a>  <span class="at">genus         =</span> scbi_quercus<span class="sc">$</span>genus,</span>
<span id="cb29-829"><a href="#cb29-829" aria-hidden="true" tabindex="-1"></a>  <span class="at">species   =</span> scbi_quercus<span class="sc">$</span>species,</span>
<span id="cb29-830"><a href="#cb29-830" aria-hidden="true" tabindex="-1"></a>  <span class="at">stand         =</span> scbi_quercus<span class="sc">$</span>Plot)</span>
<span id="cb29-831"><a href="#cb29-831" aria-hidden="true" tabindex="-1"></a>scbi_quercus<span class="sc">$</span>WD <span class="ot">&lt;-</span> wood_densities<span class="sc">$</span>meanWD</span>
<span id="cb29-832"><a href="#cb29-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-833"><a href="#cb29-833" aria-hidden="true" tabindex="-1"></a><span class="co"># Chave et al 2014</span></span>
<span id="cb29-834"><a href="#cb29-834" aria-hidden="true" tabindex="-1"></a>scbi_quercus<span class="sc">$</span>agb_chave2014 <span class="ot">&lt;-</span> BIOMASS<span class="sc">::</span><span class="fu">computeAGB</span>(</span>
<span id="cb29-835"><a href="#cb29-835" aria-hidden="true" tabindex="-1"></a>  <span class="at">D         =</span> scbi_quercus<span class="sc">$</span>dbh,</span>
<span id="cb29-836"><a href="#cb29-836" aria-hidden="true" tabindex="-1"></a>  <span class="at">WD        =</span> scbi_quercus<span class="sc">$</span>WD,</span>
<span id="cb29-837"><a href="#cb29-837" aria-hidden="true" tabindex="-1"></a>  <span class="at">coord =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">78.2</span>, <span class="fl">38.9</span>))</span>
<span id="cb29-838"><a href="#cb29-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-839"><a href="#cb29-839" aria-hidden="true" tabindex="-1"></a><span class="co"># convert units</span></span>
<span id="cb29-840"><a href="#cb29-840" aria-hidden="true" tabindex="-1"></a>scbi_quercus<span class="sc">$</span>agb_chave2014 <span class="ot">=</span> scbi_quercus<span class="sc">$</span>agb_chave2014 <span class="sc">*</span> <span class="dv">1000</span></span>
<span id="cb29-841"><a href="#cb29-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-842"><a href="#cb29-842" aria-hidden="true" tabindex="-1"></a><span class="co"># Chave et al 2005 (MANUAL Fit)</span></span>
<span id="cb29-843"><a href="#cb29-843" aria-hidden="true" tabindex="-1"></a>scbi_quercus<span class="sc">$</span>agb_chave2005 <span class="ot">&lt;-</span> scbi_quercus<span class="sc">$</span>WD <span class="sc">*</span> </span>
<span id="cb29-844"><a href="#cb29-844" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">1.499</span> <span class="sc">+</span> <span class="fl">2.148</span><span class="sc">*</span><span class="fu">log</span>(scbi_quercus<span class="sc">$</span>dbh) <span class="sc">+</span> </span>
<span id="cb29-845"><a href="#cb29-845" aria-hidden="true" tabindex="-1"></a>      <span class="fl">0.207</span><span class="sc">*</span>(<span class="fu">log</span>(scbi_quercus<span class="sc">$</span>dbh))<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> </span>
<span id="cb29-846"><a href="#cb29-846" aria-hidden="true" tabindex="-1"></a>      <span class="fl">0.0281</span><span class="sc">*</span>(<span class="fu">log</span>(scbi_quercus<span class="sc">$</span>dbh))<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb29-847"><a href="#cb29-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-848"><a href="#cb29-848" aria-hidden="true" tabindex="-1"></a><span class="co"># Brown et al 1997 (MANUAL Fit)</span></span>
<span id="cb29-849"><a href="#cb29-849" aria-hidden="true" tabindex="-1"></a>scbi_quercus<span class="sc">$</span>agb_brown1997 <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fl">2.134</span> <span class="sc">+</span> <span class="fl">2.53</span> <span class="sc">*</span> <span class="fu">log</span>(scbi_quercus<span class="sc">$</span>dbh))</span>
<span id="cb29-850"><a href="#cb29-850" aria-hidden="true" tabindex="-1"></a>scbi_quercus<span class="sc">$</span>agb_brown1997 <span class="ot">=</span> scbi_quercus<span class="sc">$</span>agb_brown1997 <span class="sc">/</span> <span class="dv">100</span> </span>
<span id="cb29-851"><a href="#cb29-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-852"><a href="#cb29-852" aria-hidden="true" tabindex="-1"></a>flextable<span class="sc">::</span><span class="fu">flextable</span>(scbi_quercus) <span class="sc">|&gt;</span></span>
<span id="cb29-853"><a href="#cb29-853" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-854"><a href="#cb29-854" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>)</span>
<span id="cb29-855"><a href="#cb29-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-856"><a href="#cb29-856" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-857"><a href="#cb29-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-858"><a href="#cb29-858" aria-hidden="true" tabindex="-1"></a>Table 1D: Aboveground biomass estimates derived from five allometry equations of varying scales</span>
<span id="cb29-859"><a href="#cb29-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-862"><a href="#cb29-862" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-863"><a href="#cb29-863" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-864"><a href="#cb29-864" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-865"><a href="#cb29-865" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-866"><a href="#cb29-866" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb29-867"><a href="#cb29-867" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb29-868"><a href="#cb29-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-869"><a href="#cb29-869" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv2(scbi_quercus, "./data/scbi_quercus.csv")</span></span>
<span id="cb29-870"><a href="#cb29-870" aria-hidden="true" tabindex="-1"></a><span class="co"># Check tree number of sample remaining across all equaitons</span></span>
<span id="cb29-871"><a href="#cb29-871" aria-hidden="true" tabindex="-1"></a><span class="co">#scbi_quercus &lt;- readr::read_delim("data/scbi_quercus.csv", </span></span>
<span id="cb29-872"><a href="#cb29-872" aria-hidden="true" tabindex="-1"></a><span class="co">#    delim = ";", escape_double = FALSE, trim_ws = T) |&gt;</span></span>
<span id="cb29-873"><a href="#cb29-873" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::select(!c(...1, treeID, stemID,  Family)) |&gt; </span></span>
<span id="cb29-874"><a href="#cb29-874" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::mutate(dbh = as.numeric(dbh)) |&gt;</span></span>
<span id="cb29-875"><a href="#cb29-875" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::mutate(WD = as.numeric(WD)) |&gt;</span></span>
<span id="cb29-876"><a href="#cb29-876" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::mutate(agb_species = as.numeric(agb_species)) |&gt;</span></span>
<span id="cb29-877"><a href="#cb29-877" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::mutate(agb_genus = as.numeric(agb_genus)) |&gt;</span></span>
<span id="cb29-878"><a href="#cb29-878" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::mutate(agb_chave2014 = as.numeric(agb_chave2014)) |&gt;</span></span>
<span id="cb29-879"><a href="#cb29-879" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::mutate(agb_chave2005 = as.numeric(agb_chave2005)) |&gt;</span></span>
<span id="cb29-880"><a href="#cb29-880" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::mutate(agb_brown1997 = as.numeric(agb_brown1997)) </span></span>
<span id="cb29-881"><a href="#cb29-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-882"><a href="#cb29-882" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-883"><a href="#cb29-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-884"><a href="#cb29-884" aria-hidden="true" tabindex="-1"></a><span class="fu">### Normality Testing</span></span>
<span id="cb29-885"><a href="#cb29-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-886"><a href="#cb29-886" aria-hidden="true" tabindex="-1"></a>Non-normal distributions violate assumptions of parametric statistics, inflating uncertainty estimates. Identifying the true probability distribution enables appropriate transformations that reduce reported uncertainty—directly reducing carbon credit deductions.</span>
<span id="cb29-887"><a href="#cb29-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-888"><a href="#cb29-888" aria-hidden="true" tabindex="-1"></a>Accurate probability density functions (PDFs) are essential for uncertainty modeling. We assess whether DBH and AGB conform to normal distributions using multiple diagnostic tests:</span>
<span id="cb29-889"><a href="#cb29-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-890"><a href="#cb29-890" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Skewness &amp; Kurtosis: Quantify asymmetry and tail behavior</span>
<span id="cb29-891"><a href="#cb29-891" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Shapiro-Wilk test: Formal normality test (p <span class="sc">\&lt;</span> 0.05 rejects normality)</span>
<span id="cb29-892"><a href="#cb29-892" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Wilcoxon test: Non-parametric alternative for median testing</span>
<span id="cb29-893"><a href="#cb29-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-894"><a href="#cb29-894" aria-hidden="true" tabindex="-1"></a>Both variables show non-normal distribution with a significant right-skew, violating parametric assumptions and justifying log-transformation in subsequent modeling. Technically, this kind of skew often represents a dataset of many small trees and few large dominants. Statistically, this high positive skewness is confirmed by Shapiro-Wilk test results (p <span class="sc">\&lt;</span> 0.001) indicating a distribution likely to inflate uncertainty estimates if left untreated.</span>
<span id="cb29-895"><a href="#cb29-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-898"><a href="#cb29-898" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-899"><a href="#cb29-899" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-900"><a href="#cb29-900" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-901"><a href="#cb29-901" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-902"><a href="#cb29-902" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb29-903"><a href="#cb29-903" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb29-904"><a href="#cb29-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-905"><a href="#cb29-905" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate skewness and kurtosis for DBH</span></span>
<span id="cb29-906"><a href="#cb29-906" aria-hidden="true" tabindex="-1"></a>dbh_skew        <span class="ot">=</span> moments<span class="sc">::</span><span class="fu">skewness</span>(scbi_quercus<span class="sc">$</span>dbh)</span>
<span id="cb29-907"><a href="#cb29-907" aria-hidden="true" tabindex="-1"></a>dbh_kurt        <span class="ot">=</span> moments<span class="sc">::</span><span class="fu">kurtosis</span>(scbi_quercus<span class="sc">$</span>dbh)</span>
<span id="cb29-908"><a href="#cb29-908" aria-hidden="true" tabindex="-1"></a>dbh_shapiro <span class="ot">=</span> stats<span class="sc">::</span><span class="fu">shapiro.test</span>(scbi_quercus<span class="sc">$</span>dbh)</span>
<span id="cb29-909"><a href="#cb29-909" aria-hidden="true" tabindex="-1"></a>dbh_wilcox  <span class="ot">=</span> stats<span class="sc">::</span><span class="fu">wilcox.test</span>(scbi_quercus<span class="sc">$</span>dbh)</span>
<span id="cb29-910"><a href="#cb29-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-911"><a href="#cb29-911" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate skewness and kurtosis for each AGB estimate</span></span>
<span id="cb29-912"><a href="#cb29-912" aria-hidden="true" tabindex="-1"></a>agb_species_skew            <span class="ot">=</span> moments<span class="sc">::</span><span class="fu">skewness</span>(scbi_quercus<span class="sc">$</span>agb_species)</span>
<span id="cb29-913"><a href="#cb29-913" aria-hidden="true" tabindex="-1"></a>agb_species_kurt            <span class="ot">=</span> moments<span class="sc">::</span><span class="fu">kurtosis</span>(scbi_quercus<span class="sc">$</span>agb_species)</span>
<span id="cb29-914"><a href="#cb29-914" aria-hidden="true" tabindex="-1"></a>agb_species_shapiro     <span class="ot">=</span> stats<span class="sc">::</span><span class="fu">shapiro.test</span>(scbi_quercus<span class="sc">$</span>agb_species)</span>
<span id="cb29-915"><a href="#cb29-915" aria-hidden="true" tabindex="-1"></a>agb_species_wilcox      <span class="ot">=</span> stats<span class="sc">::</span><span class="fu">wilcox.test</span>(scbi_quercus<span class="sc">$</span>agb_species)</span>
<span id="cb29-916"><a href="#cb29-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-917"><a href="#cb29-917" aria-hidden="true" tabindex="-1"></a>agb_genus_skew              <span class="ot">=</span> moments<span class="sc">::</span><span class="fu">skewness</span>(scbi_quercus<span class="sc">$</span>agb_genus)</span>
<span id="cb29-918"><a href="#cb29-918" aria-hidden="true" tabindex="-1"></a>agb_genus_kurt              <span class="ot">=</span> moments<span class="sc">::</span><span class="fu">kurtosis</span>(scbi_quercus<span class="sc">$</span>agb_genus)</span>
<span id="cb29-919"><a href="#cb29-919" aria-hidden="true" tabindex="-1"></a>agb_genus_shapiro       <span class="ot">=</span> stats<span class="sc">::</span><span class="fu">shapiro.test</span>(scbi_quercus<span class="sc">$</span>agb_genus)</span>
<span id="cb29-920"><a href="#cb29-920" aria-hidden="true" tabindex="-1"></a>agb_genus_wilcox            <span class="ot">=</span> stats<span class="sc">::</span><span class="fu">wilcox.test</span>(scbi_quercus<span class="sc">$</span>agb_genus)</span>
<span id="cb29-921"><a href="#cb29-921" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-922"><a href="#cb29-922" aria-hidden="true" tabindex="-1"></a>agb_chave2014_skew      <span class="ot">=</span> moments<span class="sc">::</span><span class="fu">skewness</span>(scbi_quercus<span class="sc">$</span>agb_chave2014)</span>
<span id="cb29-923"><a href="#cb29-923" aria-hidden="true" tabindex="-1"></a>agb_chave2014_kurt      <span class="ot">=</span> moments<span class="sc">::</span><span class="fu">kurtosis</span>(scbi_quercus<span class="sc">$</span>agb_chave2014)</span>
<span id="cb29-924"><a href="#cb29-924" aria-hidden="true" tabindex="-1"></a>agb_chave2014_shapiro <span class="ot">=</span> stats<span class="sc">::</span><span class="fu">shapiro.test</span>(scbi_quercus<span class="sc">$</span>agb_chave2014)</span>
<span id="cb29-925"><a href="#cb29-925" aria-hidden="true" tabindex="-1"></a>agb_chave2014_wilcox    <span class="ot">=</span> stats<span class="sc">::</span><span class="fu">wilcox.test</span>(scbi_quercus<span class="sc">$</span>agb_chave2014)</span>
<span id="cb29-926"><a href="#cb29-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-927"><a href="#cb29-927" aria-hidden="true" tabindex="-1"></a>agb_brown1997_skew      <span class="ot">=</span> moments<span class="sc">::</span><span class="fu">skewness</span>(scbi_quercus<span class="sc">$</span>agb_brown1997)</span>
<span id="cb29-928"><a href="#cb29-928" aria-hidden="true" tabindex="-1"></a>agb_brown1997_kurt      <span class="ot">=</span> moments<span class="sc">::</span><span class="fu">kurtosis</span>(scbi_quercus<span class="sc">$</span>agb_brown1997)</span>
<span id="cb29-929"><a href="#cb29-929" aria-hidden="true" tabindex="-1"></a>agb_brown1997_shapiro <span class="ot">=</span> stats<span class="sc">::</span><span class="fu">shapiro.test</span>(scbi_quercus<span class="sc">$</span>agb_brown1997)</span>
<span id="cb29-930"><a href="#cb29-930" aria-hidden="true" tabindex="-1"></a>agb_brown1997_wilcox  <span class="ot">=</span> stats<span class="sc">::</span><span class="fu">wilcox.test</span>(scbi_quercus<span class="sc">$</span>agb_brown1997)</span>
<span id="cb29-931"><a href="#cb29-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-932"><a href="#cb29-932" aria-hidden="true" tabindex="-1"></a>agb_chave2005_skew      <span class="ot">=</span> moments<span class="sc">::</span><span class="fu">skewness</span>(scbi_quercus<span class="sc">$</span>agb_chave2005)</span>
<span id="cb29-933"><a href="#cb29-933" aria-hidden="true" tabindex="-1"></a>agb_chave2005_kurt      <span class="ot">=</span> moments<span class="sc">::</span><span class="fu">kurtosis</span>(scbi_quercus<span class="sc">$</span>agb_chave2005)</span>
<span id="cb29-934"><a href="#cb29-934" aria-hidden="true" tabindex="-1"></a>agb_chave2005_shapiro <span class="ot">=</span> stats<span class="sc">::</span><span class="fu">shapiro.test</span>(scbi_quercus<span class="sc">$</span>agb_chave2005)</span>
<span id="cb29-935"><a href="#cb29-935" aria-hidden="true" tabindex="-1"></a>agb_chave2005_wilcox    <span class="ot">=</span> stats<span class="sc">::</span><span class="fu">shapiro.test</span>(scbi_quercus<span class="sc">$</span>agb_chave2005)</span>
<span id="cb29-936"><a href="#cb29-936" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-937"><a href="#cb29-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-940"><a href="#cb29-940" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-941"><a href="#cb29-941" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-942"><a href="#cb29-942" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-943"><a href="#cb29-943" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-944"><a href="#cb29-944" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb29-945"><a href="#cb29-945" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb29-946"><a href="#cb29-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-947"><a href="#cb29-947" aria-hidden="true" tabindex="-1"></a><span class="co"># Derive decision table</span></span>
<span id="cb29-948"><a href="#cb29-948" aria-hidden="true" tabindex="-1"></a>normality_decision <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">c</span>(</span>
<span id="cb29-949"><a href="#cb29-949" aria-hidden="true" tabindex="-1"></a>    <span class="st">"DBH (cm)"</span>, <span class="st">"AGB Species (kg)"</span>, <span class="st">"AGB Genus (kg)"</span>, </span>
<span id="cb29-950"><a href="#cb29-950" aria-hidden="true" tabindex="-1"></a>    <span class="st">"AGB Chave2014 (kg)"</span>, <span class="st">"AGB Brown1997 (kg)"</span>, <span class="st">"AGB Chave2005 (kg)"</span>),</span>
<span id="cb29-951"><a href="#cb29-951" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="fu">rep</span>(<span class="fu">nrow</span>(scbi_quercus), <span class="dv">6</span>), <span class="st">`</span><span class="at">Mean ± SD</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb29-952"><a href="#cb29-952" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sprintf</span>(<span class="st">"%.1f ± %.1f"</span>, <span class="fu">mean</span>(scbi_quercus<span class="sc">$</span>dbh), <span class="fu">sd</span>(scbi_quercus<span class="sc">$</span>dbh)),</span>
<span id="cb29-953"><a href="#cb29-953" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sprintf</span>(<span class="st">"%.1f ± %.1f"</span>, <span class="fu">mean</span>(scbi_quercus<span class="sc">$</span>agb_species), <span class="fu">sd</span>(scbi_quercus<span class="sc">$</span>agb_species)),</span>
<span id="cb29-954"><a href="#cb29-954" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sprintf</span>(<span class="st">"%.1f ± %.1f"</span>, <span class="fu">mean</span>(scbi_quercus<span class="sc">$</span>agb_genus), <span class="fu">sd</span>(scbi_quercus<span class="sc">$</span>agb_genus)),</span>
<span id="cb29-955"><a href="#cb29-955" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sprintf</span>(<span class="st">"%.1f ± %.1f"</span>, <span class="fu">mean</span>(scbi_quercus<span class="sc">$</span>agb_chave2014), <span class="fu">sd</span>(scbi_quercus<span class="sc">$</span>agb_chave2014)),</span>
<span id="cb29-956"><a href="#cb29-956" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sprintf</span>(<span class="st">"%.1f ± %.1f"</span>, <span class="fu">mean</span>(scbi_quercus<span class="sc">$</span>agb_brown1997), <span class="fu">sd</span>(scbi_quercus<span class="sc">$</span>agb_brown1997)),</span>
<span id="cb29-957"><a href="#cb29-957" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sprintf</span>(<span class="st">"%.1f ± %.1f"</span>, <span class="fu">mean</span>(scbi_quercus<span class="sc">$</span>agb_chave2005), <span class="fu">sd</span>(scbi_quercus<span class="sc">$</span>agb_chave2005))),</span>
<span id="cb29-958"><a href="#cb29-958" aria-hidden="true" tabindex="-1"></a>  <span class="at">Skewness =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, <span class="fu">c</span>(dbh_skew, agb_species_skew, agb_genus_skew, </span>
<span id="cb29-959"><a href="#cb29-959" aria-hidden="true" tabindex="-1"></a>    agb_chave2014_skew, agb_brown1997_skew, agb_chave2005_skew)),</span>
<span id="cb29-960"><a href="#cb29-960" aria-hidden="true" tabindex="-1"></a>  <span class="at">Kurtosis =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, <span class="fu">c</span>(dbh_kurt, agb_species_kurt, agb_genus_kurt, </span>
<span id="cb29-961"><a href="#cb29-961" aria-hidden="true" tabindex="-1"></a>        agb_chave2014_kurt, agb_brown1997_kurt, agb_chave2005_kurt)),</span>
<span id="cb29-962"><a href="#cb29-962" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Shapiro-Wilk p</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb29-963"><a href="#cb29-963" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(dbh_shapiro<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"&lt; 0.001"</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, dbh_shapiro<span class="sc">$</span>p.value)),</span>
<span id="cb29-964"><a href="#cb29-964" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(agb_species_shapiro<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"&lt; 0.001"</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, agb_species_shapiro<span class="sc">$</span>p.value)),</span>
<span id="cb29-965"><a href="#cb29-965" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(agb_genus_shapiro<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"&lt; 0.001"</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, agb_genus_shapiro<span class="sc">$</span>p.value)),</span>
<span id="cb29-966"><a href="#cb29-966" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(agb_chave2014_shapiro<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"&lt; 0.001"</span>,  <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, agb_chave2014_shapiro<span class="sc">$</span>p.value)),</span>
<span id="cb29-967"><a href="#cb29-967" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(agb_brown1997_shapiro<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"&lt; 0.001"</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, agb_brown1997_shapiro<span class="sc">$</span>p.value)),</span>
<span id="cb29-968"><a href="#cb29-968" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(agb_chave2005_shapiro<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"&lt; 0.001"</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, agb_chave2005_shapiro<span class="sc">$</span>p.value))),</span>
<span id="cb29-969"><a href="#cb29-969" aria-hidden="true" tabindex="-1"></a>    <span class="at">Decision =</span> <span class="fu">rep</span>(<span class="st">"Log(x) needed?: YES"</span>, <span class="dv">6</span>))</span>
<span id="cb29-970"><a href="#cb29-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-971"><a href="#cb29-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-972"><a href="#cb29-972" aria-hidden="true" tabindex="-1"></a>normality_decision <span class="sc">|&gt;</span></span>
<span id="cb29-973"><a href="#cb29-973" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">flextable</span>() <span class="sc">|&gt;</span></span>
<span id="cb29-974"><a href="#cb29-974" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">set_caption</span>(<span class="st">"Normality assessment and transformation by equation type"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-975"><a href="#cb29-975" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">align</span>(<span class="at">j =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-976"><a href="#cb29-976" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">align</span>(<span class="at">j =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">7</span>), <span class="at">align =</span> <span class="st">"left"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-977"><a href="#cb29-977" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">bold</span>(<span class="at">j =</span> <span class="st">"Decision"</span>, <span class="at">part =</span> <span class="st">"body"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-978"><a href="#cb29-978" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-979"><a href="#cb29-979" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-980"><a href="#cb29-980" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">add_footer_lines</span>(</span>
<span id="cb29-981"><a href="#cb29-981" aria-hidden="true" tabindex="-1"></a>    <span class="st">"All AGB estimates exhibit significant departure from normality (p &lt; 0.001) with extreme right-skew (skewness &gt; 2) regardless of equation type, justifying log-transformation in subsequent analysis."</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-982"><a href="#cb29-982" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">part =</span> <span class="st">"footer"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-983"><a href="#cb29-983" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">italic</span>(<span class="at">part =</span> <span class="st">"footer"</span>)</span>
<span id="cb29-984"><a href="#cb29-984" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-985"><a href="#cb29-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-988"><a href="#cb29-988" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-989"><a href="#cb29-989" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-990"><a href="#cb29-990" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-991"><a href="#cb29-991" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-992"><a href="#cb29-992" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb29-993"><a href="#cb29-993" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb29-994"><a href="#cb29-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-995"><a href="#cb29-995" aria-hidden="true" tabindex="-1"></a><span class="co"># Derive dataframe for tabulating performance results</span></span>
<span id="cb29-996"><a href="#cb29-996" aria-hidden="true" tabindex="-1"></a>stats_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-997"><a href="#cb29-997" aria-hidden="true" tabindex="-1"></a>  <span class="at">Equation =</span> <span class="fu">c</span>(<span class="st">"Species"</span>, <span class="st">"Genus"</span>, <span class="st">"Chave2014"</span>, <span class="st">"Brown1997"</span>, <span class="st">"Chave2005"</span>),  <span class="co"># Changed!</span></span>
<span id="cb29-998"><a href="#cb29-998" aria-hidden="true" tabindex="-1"></a>  <span class="at">skew =</span> <span class="fu">c</span>(agb_species_skew, agb_genus_skew, agb_chave2014_skew, agb_brown1997_skew, agb_chave2005_skew),</span>
<span id="cb29-999"><a href="#cb29-999" aria-hidden="true" tabindex="-1"></a>  <span class="at">kurt =</span> <span class="fu">c</span>(agb_species_kurt, agb_genus_kurt, agb_chave2014_kurt, agb_brown1997_kurt, agb_chave2005_kurt),</span>
<span id="cb29-1000"><a href="#cb29-1000" aria-hidden="true" tabindex="-1"></a>  <span class="at">shapiro_p =</span> <span class="fu">c</span>(agb_species_shapiro<span class="sc">$</span>p.value, agb_genus_shapiro<span class="sc">$</span>p.value, </span>
<span id="cb29-1001"><a href="#cb29-1001" aria-hidden="true" tabindex="-1"></a>    agb_chave2014_shapiro<span class="sc">$</span>p.value, agb_brown1997_shapiro<span class="sc">$</span>p.value, agb_chave2005_shapiro<span class="sc">$</span>p.value)) <span class="sc">|&gt;</span></span>
<span id="cb29-1002"><a href="#cb29-1002" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"Skew: %.2f</span><span class="sc">\n</span><span class="st">Kurt: %.2f</span><span class="sc">\n</span><span class="st">Shapiro-p: %.5f"</span>, skew, kurt, shapiro_p))</span>
<span id="cb29-1003"><a href="#cb29-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1004"><a href="#cb29-1004" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for faceted histogram</span></span>
<span id="cb29-1005"><a href="#cb29-1005" aria-hidden="true" tabindex="-1"></a>agb_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-1006"><a href="#cb29-1006" aria-hidden="true" tabindex="-1"></a>  <span class="at">Species =</span> scbi_quercus<span class="sc">$</span>agb_species,</span>
<span id="cb29-1007"><a href="#cb29-1007" aria-hidden="true" tabindex="-1"></a>  <span class="at">Genus =</span> scbi_quercus<span class="sc">$</span>agb_genus,</span>
<span id="cb29-1008"><a href="#cb29-1008" aria-hidden="true" tabindex="-1"></a>  <span class="at">Chave2014 =</span> scbi_quercus<span class="sc">$</span>agb_chave2014,</span>
<span id="cb29-1009"><a href="#cb29-1009" aria-hidden="true" tabindex="-1"></a>  <span class="at">Brown1997 =</span> scbi_quercus<span class="sc">$</span>agb_brown1997,</span>
<span id="cb29-1010"><a href="#cb29-1010" aria-hidden="true" tabindex="-1"></a>  <span class="at">Chave2005 =</span> scbi_quercus<span class="sc">$</span>agb_chave2005) <span class="sc">|&gt;</span></span>
<span id="cb29-1011"><a href="#cb29-1011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Equation"</span>, <span class="at">values_to =</span> <span class="st">"AGB"</span>)</span>
<span id="cb29-1012"><a href="#cb29-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1013"><a href="#cb29-1013" aria-hidden="true" tabindex="-1"></a><span class="co"># Create faceted histogram</span></span>
<span id="cb29-1014"><a href="#cb29-1014" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(agb_comparison, <span class="fu">aes</span>(<span class="at">x =</span> AGB)) <span class="sc">+</span></span>
<span id="cb29-1015"><a href="#cb29-1015" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">bins =</span> <span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb29-1016"><a href="#cb29-1016" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb29-1017"><a href="#cb29-1017" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> stats_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="cn">Inf</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> label), <span class="at">hjust =</span> <span class="fl">1.05</span>, </span>
<span id="cb29-1018"><a href="#cb29-1018" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="fl">1.05</span>, <span class="at">size =</span> <span class="fl">2.3</span>, <span class="at">lineheight =</span> <span class="fl">0.85</span>, <span class="at">label.size =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb29-1019"><a href="#cb29-1019" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Equation, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb29-1020"><a href="#cb29-1020" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"AGB Distribution by Equation Type"</span>, <span class="at">x =</span> <span class="st">"AGB (kg)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb29-1021"><a href="#cb29-1021" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">14</span>), <span class="at">strip.text=</span><span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb29-1022"><a href="#cb29-1022" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb29-1023"><a href="#cb29-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1024"><a href="#cb29-1024" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-1025"><a href="#cb29-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1026"><a href="#cb29-1026" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bivariate Testing</span></span>
<span id="cb29-1027"><a href="#cb29-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1028"><a href="#cb29-1028" aria-hidden="true" tabindex="-1"></a>Heteroscedasticity violates ordinary least squares assumptions, producing unreliable standard errors and inflated uncertainty estimates that threaten carbon credit revenues. The Breusch-Pagan test identifies which predictor drives heteroscedasticity by regressing squared residuals against predictor values:</span>
<span id="cb29-1029"><a href="#cb29-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1030"><a href="#cb29-1030" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Null hypothesis (H₀): Homoscedastic (constant variance)</span>
<span id="cb29-1031"><a href="#cb29-1031" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Alternative (H₁): Heteroscedastic (variance changes with predictors)</span>
<span id="cb29-1032"><a href="#cb29-1032" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Decision rule: p <span class="sc">\&lt;</span> 0.05 rejects H₀</span>
<span id="cb29-1033"><a href="#cb29-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1034"><a href="#cb29-1034" aria-hidden="true" tabindex="-1"></a>Large trees exhibit greater prediction variance than small trees due to power-law scaling (AGB ∝ DBH\^2.5). Without correction, uncertainty estimates are systematically upward-biased, particularly for canopy dominants that drive cumulative biomass.</span>
<span id="cb29-1035"><a href="#cb29-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1036"><a href="#cb29-1036" aria-hidden="true" tabindex="-1"></a>Test Results</span>
<span id="cb29-1037"><a href="#cb29-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1038"><a href="#cb29-1038" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>BP statistic: 10.0051</span>
<span id="cb29-1039"><a href="#cb29-1039" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>p-value: 0.0016</span>
<span id="cb29-1040"><a href="#cb29-1040" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Decision: Heteroscedasticity confirmed</span>
<span id="cb29-1041"><a href="#cb29-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1042"><a href="#cb29-1042" aria-hidden="true" tabindex="-1"></a>The diagnostic plot (Figure 1.2) shows the classic funnel pattern: small trees (DBH <span class="sc">\&lt;</span> 20 cm) cluster tightly around the fitted line while large trees (DBH <span class="sc">\&gt;</span> 60 cm) exhibit substantial scatter. This reflects power-law scaling where small multiplicative errors in β translate to large absolute errors for canopy dominants.</span>
<span id="cb29-1043"><a href="#cb29-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1044"><a href="#cb29-1044" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Common Corrections</span></span>
<span id="cb29-1045"><a href="#cb29-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1046"><a href="#cb29-1046" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Log-transformation of both variables</span>
<span id="cb29-1047"><a href="#cb29-1047" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Weighted regression for residual heteroscedasticity</span>
<span id="cb29-1048"><a href="#cb29-1048" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Robust standard errors to supplement transformation</span>
<span id="cb29-1049"><a href="#cb29-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1052"><a href="#cb29-1052" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-1053"><a href="#cb29-1053" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-1054"><a href="#cb29-1054" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-1055"><a href="#cb29-1055" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb29-1056"><a href="#cb29-1056" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-1057"><a href="#cb29-1057" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb29-1058"><a href="#cb29-1058" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb29-1059"><a href="#cb29-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1060"><a href="#cb29-1060" aria-hidden="true" tabindex="-1"></a><span class="co"># Derive results to test non-constant variance of selected predictor</span></span>
<span id="cb29-1061"><a href="#cb29-1061" aria-hidden="true" tabindex="-1"></a>dbh_agb_species_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(agb_species <span class="sc">~</span> dbh, <span class="at">data =</span> scbi_quercus)</span>
<span id="cb29-1062"><a href="#cb29-1062" aria-hidden="true" tabindex="-1"></a>bp_test <span class="ot">&lt;-</span> lmtest<span class="sc">::</span><span class="fu">bptest</span>(dbh_agb_species_lm)  </span>
<span id="cb29-1063"><a href="#cb29-1063" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Breusch-Pagan Test Results:</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb29-1064"><a href="#cb29-1064" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"BP statistic: %.4f</span><span class="sc">\n</span><span class="st">"</span>, bp_test<span class="sc">$</span>statistic))</span>
<span id="cb29-1065"><a href="#cb29-1065" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"p-value: %.4f</span><span class="sc">\n</span><span class="st">"</span>, bp_test<span class="sc">$</span>p.value))</span>
<span id="cb29-1066"><a href="#cb29-1066" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Decision: %s</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">ifelse</span>(bp_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>, </span>
<span id="cb29-1067"><a href="#cb29-1067" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Reject H₀ - Heteroscedasticity present"</span>, <span class="st">"Fail to reject H₀ - Homoscedasticity"</span>)))</span>
<span id="cb29-1068"><a href="#cb29-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1069"><a href="#cb29-1069" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb29-1070"><a href="#cb29-1070" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(scbi_quercus<span class="sc">$</span>dbh, scbi_quercus<span class="sc">$</span>agb_species,</span>
<span id="cb29-1071"><a href="#cb29-1071" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb29-1072"><a href="#cb29-1072" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"DBH (cm)"</span>, <span class="at">ylab =</span> <span class="st">"AGB (kg)"</span>,</span>
<span id="cb29-1073"><a href="#cb29-1073" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"DBH-AGB Relationship: Heteroscedasticity Assessment"</span>)</span>
<span id="cb29-1074"><a href="#cb29-1074" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(dbh_agb_species_lm, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb29-1075"><a href="#cb29-1075" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>), <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb29-1076"><a href="#cb29-1076" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Observed values"</span>, <span class="st">"Linear fit"</span>, <span class="st">"Size class breaks"</span>), </span>
<span id="cb29-1077"><a href="#cb29-1077" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="fu">c</span>(<span class="st">"steelblue"</span>, <span class="st">"red"</span>, <span class="st">"gray"</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="cn">NA</span>, <span class="cn">NA</span>), </span>
<span id="cb29-1078"><a href="#cb29-1078" aria-hidden="true" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">lwd =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb29-1079"><a href="#cb29-1079" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">70</span>, <span class="at">y =</span> <span class="fu">max</span>(scbi_quercus<span class="sc">$</span>agb_species) <span class="sc">*</span> <span class="fl">0.9</span>,</span>
<span id="cb29-1080"><a href="#cb29-1080" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">sprintf</span>(<span class="st">"BP test: p = %.4f</span><span class="sc">\n</span><span class="st">Heteroscedasticity confirmed"</span>, bp_test<span class="sc">$</span>p.value),</span>
<span id="cb29-1081"><a href="#cb29-1081" aria-hidden="true" tabindex="-1"></a>     <span class="at">adj =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">cex =</span> <span class="fl">0.9</span>, <span class="at">font =</span> <span class="dv">2</span>)</span>
<span id="cb29-1082"><a href="#cb29-1082" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-1083"><a href="#cb29-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1084"><a href="#cb29-1084" aria-hidden="true" tabindex="-1"></a>Large trees exhibit greater prediction variance than small trees due to the power-law relationship (AGB ∝ DBH^\~2.5^). Without correction, uncertainty estimates are biased upward, particularly for canopy dominants.</span>
<span id="cb29-1085"><a href="#cb29-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1086"><a href="#cb29-1086" aria-hidden="true" tabindex="-1"></a>Required corrections:</span>
<span id="cb29-1087"><a href="#cb29-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1088"><a href="#cb29-1088" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Log-transformation of both variables</span>
<span id="cb29-1089"><a href="#cb29-1089" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Weighted regression for residual heteroscedasticity</span>
<span id="cb29-1090"><a href="#cb29-1090" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Robust standard errors to supplement transformation</span>
<span id="cb29-1091"><a href="#cb29-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1092"><a href="#cb29-1092" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.3 Model Optimization</span></span>
<span id="cb29-1093"><a href="#cb29-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1094"><a href="#cb29-1094" aria-hidden="true" tabindex="-1"></a><span class="fu">### Log-Transformation {#sec-log-rationale}</span></span>
<span id="cb29-1095"><a href="#cb29-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1096"><a href="#cb29-1096" aria-hidden="true" tabindex="-1"></a>Linear regression on this untransformed allometric data produces 45-60% uncertainty. Log-transformation reduces RMSE a 51 percentage point uncertainty reduction. Allometric relationships tend to follow the power law:</span>
<span id="cb29-1097"><a href="#cb29-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1098"><a href="#cb29-1098" aria-hidden="true" tabindex="-1"></a>$$AGB = \alpha \times DBH^{\beta}$$</span>
<span id="cb29-1099"><a href="#cb29-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1100"><a href="#cb29-1100" aria-hidden="true" tabindex="-1"></a>where β typically ranges from 2.3-2.7, meaning biomass scales with DBH raised to a power. Attempting to fit this with linear regression (<span class="in">`AGB = a + b * DBH`</span>) misrepresents the functional form thereby underestimating or overestimating specific tree cohorts. Critical to crediting, this forces exponential patterns into residual noise that inflates uncertainty downstream. Alternatively, we may apply logarithmic transformations to the equation or specific variables. This linearizes the power-law relationship so that:</span>
<span id="cb29-1101"><a href="#cb29-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1102"><a href="#cb29-1102" aria-hidden="true" tabindex="-1"></a>$$\ln(AGB) = \ln(\alpha) + \beta \times \ln(DBH) + \epsilon$$</span>
<span id="cb29-1103"><a href="#cb29-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1104"><a href="#cb29-1104" aria-hidden="true" tabindex="-1"></a>where</span>
<span id="cb29-1105"><a href="#cb29-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1106"><a href="#cb29-1106" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`β`</span> becomes a slope coefficient</span>
<span id="cb29-1107"><a href="#cb29-1107" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Variance stabilizes across tree sizes</span>
<span id="cb29-1108"><a href="#cb29-1108" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Residuals are normalized enough to satisfy OLS assumptions that our predictions are dependent on</span>
<span id="cb29-1109"><a href="#cb29-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1110"><a href="#cb29-1110" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb29-1111"><a href="#cb29-1111" aria-hidden="true" tabindex="-1"></a><span class="fu">## Back-Transformation</span></span>
<span id="cb29-1112"><a href="#cb29-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1113"><a href="#cb29-1113" aria-hidden="true" tabindex="-1"></a>As demonstrated below, it is important to back-transform the log-scale of RMSE. This converts log-scale error to proportional error on its original scale, which enables direct comparison with linear model uncertainty while preserving variance structure stabilized by log-transformation.</span>
<span id="cb29-1114"><a href="#cb29-1114" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-1115"><a href="#cb29-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1116"><a href="#cb29-1116" aria-hidden="true" tabindex="-1"></a>We fitted linear and log-transformed regression models for all five allometric equations, comparing their prediction accuracy using:</span>
<span id="cb29-1117"><a href="#cb29-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1118"><a href="#cb29-1118" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>MAE (Mean Absolute Error): Average absolute deviation in kg</span>
<span id="cb29-1119"><a href="#cb29-1119" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>RMSE (Root Mean Square Error): Standard deviation of residuals in kg</span>
<span id="cb29-1120"><a href="#cb29-1120" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Relative RMSE (%): RMSE as percentage of mean biomass, enabling cross-equation comparison</span>
<span id="cb29-1121"><a href="#cb29-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1122"><a href="#cb29-1122" aria-hidden="true" tabindex="-1"></a>For log-transformed models, predictions were back-transformed to the original scale using exponentiation (exp(predicted log-AGB)), and metrics were calculated on back-transformed residuals. This ensures fair comparison with linear models while preserving the variance-stabilizing benefits of log-transformation.</span>
<span id="cb29-1123"><a href="#cb29-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1124"><a href="#cb29-1124" aria-hidden="true" tabindex="-1"></a>Results (Table X) demonstrate dramatic improvement: log-transformation reduced relative RMSE from 45-60% to 0.3-17% across all equation types—representing 40-60 percentage point reductions in uncertainty. The species-specific log model achieved the lowest uncertainty (0.34%), while even generic pan-tropical equations improved substantially under log-transformation.</span>
<span id="cb29-1125"><a href="#cb29-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1128"><a href="#cb29-1128" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-1129"><a href="#cb29-1129" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-1130"><a href="#cb29-1130" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-1131"><a href="#cb29-1131" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb29-1132"><a href="#cb29-1132" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-1133"><a href="#cb29-1133" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb29-1134"><a href="#cb29-1134" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb29-1135"><a href="#cb29-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1136"><a href="#cb29-1136" aria-hidden="true" tabindex="-1"></a><span class="co"># Derive performance metrics #</span></span>
<span id="cb29-1137"><a href="#cb29-1137" aria-hidden="true" tabindex="-1"></a>lin_species     <span class="ot">=</span> <span class="fu">lm</span>(agb_species <span class="sc">~</span> dbh, <span class="at">data =</span> scbi_quercus)</span>
<span id="cb29-1138"><a href="#cb29-1138" aria-hidden="true" tabindex="-1"></a>lin_genus           <span class="ot">=</span> <span class="fu">lm</span>(agb_genus <span class="sc">~</span> dbh, <span class="at">data =</span> scbi_quercus) </span>
<span id="cb29-1139"><a href="#cb29-1139" aria-hidden="true" tabindex="-1"></a>lin_chave2014   <span class="ot">=</span> <span class="fu">lm</span>(agb_chave2014 <span class="sc">~</span> dbh, <span class="at">data =</span> scbi_quercus) </span>
<span id="cb29-1140"><a href="#cb29-1140" aria-hidden="true" tabindex="-1"></a>lin_brown1997   <span class="ot">=</span> <span class="fu">lm</span>(agb_brown1997 <span class="sc">~</span> dbh, <span class="at">data =</span> scbi_quercus) </span>
<span id="cb29-1141"><a href="#cb29-1141" aria-hidden="true" tabindex="-1"></a>lin_chave2005   <span class="ot">=</span> <span class="fu">lm</span>(agb_chave2005 <span class="sc">~</span> dbh, <span class="at">data =</span> scbi_quercus) </span>
<span id="cb29-1142"><a href="#cb29-1142" aria-hidden="true" tabindex="-1"></a>log_species     <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(agb_species) <span class="sc">~</span> <span class="fu">log</span>(dbh), <span class="at">data =</span> scbi_quercus) </span>
<span id="cb29-1143"><a href="#cb29-1143" aria-hidden="true" tabindex="-1"></a>log_genus       <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(agb_genus) <span class="sc">~</span> <span class="fu">log</span>(dbh), <span class="at">data =</span> scbi_quercus) </span>
<span id="cb29-1144"><a href="#cb29-1144" aria-hidden="true" tabindex="-1"></a>log_chave2014 <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(agb_chave2014) <span class="sc">~</span> <span class="fu">log</span>(dbh), <span class="at">data =</span> scbi_quercus)</span>
<span id="cb29-1145"><a href="#cb29-1145" aria-hidden="true" tabindex="-1"></a>log_brown1997 <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(agb_brown1997) <span class="sc">~</span> <span class="fu">log</span>(dbh), <span class="at">data =</span> scbi_quercus)</span>
<span id="cb29-1146"><a href="#cb29-1146" aria-hidden="true" tabindex="-1"></a>log_chave2005   <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(agb_chave2005) <span class="sc">~</span> <span class="fu">log</span>(dbh), <span class="at">data =</span> scbi_quercus)</span>
<span id="cb29-1147"><a href="#cb29-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1148"><a href="#cb29-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1149"><a href="#cb29-1149" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuals: log models back-transformed **essential</span></span>
<span id="cb29-1150"><a href="#cb29-1150" aria-hidden="true" tabindex="-1"></a>lin_species_resid   <span class="ot">=</span> <span class="fu">predict</span>(lin_species, scbi_quercus, <span class="at">type=</span><span class="st">'response'</span>)</span>
<span id="cb29-1151"><a href="#cb29-1151" aria-hidden="true" tabindex="-1"></a>lin_genus_resid         <span class="ot">=</span> <span class="fu">predict</span>(lin_genus, scbi_quercus, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb29-1152"><a href="#cb29-1152" aria-hidden="true" tabindex="-1"></a>lin_chave2014_resid <span class="ot">=</span> <span class="fu">predict</span>(lin_chave2014, scbi_quercus, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb29-1153"><a href="#cb29-1153" aria-hidden="true" tabindex="-1"></a>lin_brown1997_resid <span class="ot">=</span> <span class="fu">predict</span>(lin_brown1997, scbi_quercus, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb29-1154"><a href="#cb29-1154" aria-hidden="true" tabindex="-1"></a>lin_chave2005_resid <span class="ot">=</span> <span class="fu">predict</span>(lin_chave2005, scbi_quercus, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb29-1155"><a href="#cb29-1155" aria-hidden="true" tabindex="-1"></a>log_species_resid       <span class="ot">=</span> <span class="fu">exp</span>(<span class="fu">predict</span>(log_species, scbi_quercus))</span>
<span id="cb29-1156"><a href="#cb29-1156" aria-hidden="true" tabindex="-1"></a>log_genus_resid         <span class="ot">=</span> <span class="fu">exp</span>(<span class="fu">predict</span>(log_genus, scbi_quercus)) </span>
<span id="cb29-1157"><a href="#cb29-1157" aria-hidden="true" tabindex="-1"></a>log_chave2014_resid <span class="ot">=</span> <span class="fu">exp</span>(<span class="fu">predict</span>(log_chave2014, scbi_quercus)) </span>
<span id="cb29-1158"><a href="#cb29-1158" aria-hidden="true" tabindex="-1"></a>log_brown1997_resid <span class="ot">=</span> <span class="fu">exp</span>(<span class="fu">predict</span>(log_brown1997, scbi_quercus)) </span>
<span id="cb29-1159"><a href="#cb29-1159" aria-hidden="true" tabindex="-1"></a>log_chave2005_resid <span class="ot">=</span> <span class="fu">exp</span>(<span class="fu">predict</span>(log_chave2005, scbi_quercus)) </span>
<span id="cb29-1160"><a href="#cb29-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1161"><a href="#cb29-1161" aria-hidden="true" tabindex="-1"></a>lin_species_mae         <span class="ot">=</span> ModelMetrics<span class="sc">::</span><span class="fu">mae</span>(scbi_quercus<span class="sc">$</span>agb_species, lin_species_resid) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">4</span>)</span>
<span id="cb29-1162"><a href="#cb29-1162" aria-hidden="true" tabindex="-1"></a>lin_species_rmse        <span class="ot">=</span> ModelMetrics<span class="sc">::</span><span class="fu">rmse</span>(scbi_quercus<span class="sc">$</span>agb_species, lin_species_resid) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">4</span>)</span>
<span id="cb29-1163"><a href="#cb29-1163" aria-hidden="true" tabindex="-1"></a>lin_species_rmse_rel<span class="ot">=</span> <span class="fu">round</span>(lin_species_rmse <span class="sc">/</span> <span class="fu">mean</span>(scbi_quercus<span class="sc">$</span>agb_species, <span class="at">na.rm =</span> T) <span class="sc">*</span> <span class="dv">100</span>,<span class="dv">4</span>)</span>
<span id="cb29-1164"><a href="#cb29-1164" aria-hidden="true" tabindex="-1"></a>log_species_mae         <span class="ot">=</span> ModelMetrics<span class="sc">::</span><span class="fu">mae</span>(scbi_quercus<span class="sc">$</span>agb_species, log_species_resid) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">4</span>)</span>
<span id="cb29-1165"><a href="#cb29-1165" aria-hidden="true" tabindex="-1"></a>log_species_rmse        <span class="ot">=</span> ModelMetrics<span class="sc">::</span><span class="fu">rmse</span>(scbi_quercus<span class="sc">$</span>agb_species, log_species_resid) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">4</span>)</span>
<span id="cb29-1166"><a href="#cb29-1166" aria-hidden="true" tabindex="-1"></a>log_species_rmse_rel<span class="ot">=</span> <span class="fu">round</span>(log_species_rmse <span class="sc">/</span> <span class="fu">mean</span>(scbi_quercus<span class="sc">$</span>agb_species, <span class="at">na.rm =</span> T) <span class="sc">*</span> <span class="dv">100</span>,<span class="dv">4</span>)</span>
<span id="cb29-1167"><a href="#cb29-1167" aria-hidden="true" tabindex="-1"></a><span class="co"># ******** CRITICAL back-transformation = log_species_rmse_rel</span></span>
<span id="cb29-1168"><a href="#cb29-1168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1169"><a href="#cb29-1169" aria-hidden="true" tabindex="-1"></a><span class="co"># Genus-level</span></span>
<span id="cb29-1170"><a href="#cb29-1170" aria-hidden="true" tabindex="-1"></a>lin_genus_mae           <span class="ot">=</span> ModelMetrics<span class="sc">::</span><span class="fu">mae</span>(scbi_quercus<span class="sc">$</span>agb_genus, lin_genus_resid) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">4</span>)</span>
<span id="cb29-1171"><a href="#cb29-1171" aria-hidden="true" tabindex="-1"></a>lin_genus_rmse          <span class="ot">=</span> ModelMetrics<span class="sc">::</span><span class="fu">rmse</span>(scbi_quercus<span class="sc">$</span>agb_genus, lin_genus_resid) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">4</span>)</span>
<span id="cb29-1172"><a href="#cb29-1172" aria-hidden="true" tabindex="-1"></a>lin_genus_rmse_rel  <span class="ot">=</span> <span class="fu">round</span>(lin_genus_rmse <span class="sc">/</span> <span class="fu">mean</span>(scbi_quercus<span class="sc">$</span>agb_genus, <span class="at">na.rm=</span>T) <span class="sc">*</span> <span class="dv">100</span>,<span class="dv">4</span>)</span>
<span id="cb29-1173"><a href="#cb29-1173" aria-hidden="true" tabindex="-1"></a>log_genus_mae           <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, ModelMetrics<span class="sc">::</span><span class="fu">mae</span>(scbi_quercus<span class="sc">$</span>agb_brown1997, log_brown1997_resid))</span>
<span id="cb29-1174"><a href="#cb29-1174" aria-hidden="true" tabindex="-1"></a>log_genus_rmse          <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, ModelMetrics<span class="sc">::</span><span class="fu">rmse</span>(scbi_quercus<span class="sc">$</span>agb_genus, log_genus_resid))</span>
<span id="cb29-1175"><a href="#cb29-1175" aria-hidden="true" tabindex="-1"></a>log_genus_rmse_rel  <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, (<span class="fu">as.numeric</span>(log_genus_rmse) <span class="sc">/</span> <span class="fu">mean</span>(scbi_quercus<span class="sc">$</span>agb_genus, <span class="at">na.rm=</span>T) <span class="sc">*</span> <span class="dv">100</span>))</span>
<span id="cb29-1176"><a href="#cb29-1176" aria-hidden="true" tabindex="-1"></a><span class="co"># ******** CRITICAL back-transformation = log_genus_rmse_rel ***********</span></span>
<span id="cb29-1177"><a href="#cb29-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1178"><a href="#cb29-1178" aria-hidden="true" tabindex="-1"></a><span class="co"># Chave 2014</span></span>
<span id="cb29-1179"><a href="#cb29-1179" aria-hidden="true" tabindex="-1"></a>lin_chave2014_mae           <span class="ot">=</span> ModelMetrics<span class="sc">::</span><span class="fu">mae</span>(scbi_quercus<span class="sc">$</span>agb_chave2014, lin_chave2014_resid) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">4</span>)</span>
<span id="cb29-1180"><a href="#cb29-1180" aria-hidden="true" tabindex="-1"></a>lin_chave2014_rmse      <span class="ot">=</span> ModelMetrics<span class="sc">::</span><span class="fu">rmse</span>(scbi_quercus<span class="sc">$</span>agb_chave2014, lin_chave2014_resid) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">4</span>)</span>
<span id="cb29-1181"><a href="#cb29-1181" aria-hidden="true" tabindex="-1"></a>lin_chave2014_rmse_rel<span class="ot">=</span> <span class="fu">round</span>(lin_chave2014_rmse <span class="sc">/</span><span class="fu">mean</span>(scbi_quercus<span class="sc">$</span>agb_chave2014,<span class="at">na.rm=</span>T) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">4</span>)</span>
<span id="cb29-1182"><a href="#cb29-1182" aria-hidden="true" tabindex="-1"></a>log_chave2014_mae           <span class="ot">=</span> ModelMetrics<span class="sc">::</span><span class="fu">mae</span>(scbi_quercus<span class="sc">$</span>agb_chave2014, log_chave2014_resid) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">4</span>)</span>
<span id="cb29-1183"><a href="#cb29-1183" aria-hidden="true" tabindex="-1"></a>log_chave2014_rmse      <span class="ot">=</span> ModelMetrics<span class="sc">::</span><span class="fu">rmse</span>(scbi_quercus<span class="sc">$</span>agb_chave2014, log_chave2014_resid) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">4</span>)</span>
<span id="cb29-1184"><a href="#cb29-1184" aria-hidden="true" tabindex="-1"></a>log_chave2014_rmse_rel<span class="ot">=</span> <span class="fu">round</span>(log_chave2014_rmse <span class="sc">/</span> <span class="fu">mean</span>(scbi_quercus<span class="sc">$</span>agb_chave2014, <span class="at">na.rm=</span>T) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">4</span>)</span>
<span id="cb29-1185"><a href="#cb29-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1186"><a href="#cb29-1186" aria-hidden="true" tabindex="-1"></a><span class="co"># Brown 1997</span></span>
<span id="cb29-1187"><a href="#cb29-1187" aria-hidden="true" tabindex="-1"></a>lin_brown1997_mae           <span class="ot">=</span> ModelMetrics<span class="sc">::</span><span class="fu">mae</span>(scbi_quercus<span class="sc">$</span>agb_brown1997, lin_brown1997_resid) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">4</span>)</span>
<span id="cb29-1188"><a href="#cb29-1188" aria-hidden="true" tabindex="-1"></a>lin_brown1997_rmse      <span class="ot">=</span> ModelMetrics<span class="sc">::</span><span class="fu">rmse</span>(scbi_quercus<span class="sc">$</span>agb_brown1997, lin_brown1997_resid) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">4</span>)</span>
<span id="cb29-1189"><a href="#cb29-1189" aria-hidden="true" tabindex="-1"></a>lin_brown1997_rmse_rel<span class="ot">=</span> <span class="fu">round</span>(lin_brown1997_rmse <span class="sc">/</span> <span class="fu">mean</span>(scbi_quercus<span class="sc">$</span>agb_brown1997, <span class="at">na.rm=</span>T) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">4</span>)</span>
<span id="cb29-1190"><a href="#cb29-1190" aria-hidden="true" tabindex="-1"></a>log_brown1997_mae       <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, ModelMetrics<span class="sc">::</span><span class="fu">mae</span>(scbi_quercus<span class="sc">$</span>agb_brown1997, log_brown1997_resid))</span>
<span id="cb29-1191"><a href="#cb29-1191" aria-hidden="true" tabindex="-1"></a>log_brown1997_rmse      <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, ModelMetrics<span class="sc">::</span><span class="fu">rmse</span>(scbi_quercus<span class="sc">$</span>agb_brown1997, log_brown1997_resid))</span>
<span id="cb29-1192"><a href="#cb29-1192" aria-hidden="true" tabindex="-1"></a>log_brown1997_rmse_rel<span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, (<span class="fu">as.numeric</span>(log_brown1997_rmse) <span class="sc">/</span> <span class="fu">mean</span>(scbi_quercus<span class="sc">$</span>agb_brown1997, <span class="at">na.rm=</span>T) <span class="sc">*</span><span class="dv">100</span>))</span>
<span id="cb29-1193"><a href="#cb29-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1194"><a href="#cb29-1194" aria-hidden="true" tabindex="-1"></a><span class="co"># Chave 2005</span></span>
<span id="cb29-1195"><a href="#cb29-1195" aria-hidden="true" tabindex="-1"></a>linear_chave2005_mae            <span class="ot">=</span> ModelMetrics<span class="sc">::</span><span class="fu">mae</span>(scbi_quercus<span class="sc">$</span>agb_chave2005, lin_chave2005_resid) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">4</span>)</span>
<span id="cb29-1196"><a href="#cb29-1196" aria-hidden="true" tabindex="-1"></a>linear_chave2005_rmse           <span class="ot">=</span> ModelMetrics<span class="sc">::</span><span class="fu">rmse</span>(scbi_quercus<span class="sc">$</span>agb_chave2005, lin_chave2005_resid) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">4</span>)</span>
<span id="cb29-1197"><a href="#cb29-1197" aria-hidden="true" tabindex="-1"></a>linear_chave2005_rmse_rel <span class="ot">=</span> (linear_chave2005_rmse <span class="sc">/</span> <span class="fu">mean</span>(scbi_quercus<span class="sc">$</span>agb_chave2005, <span class="at">na.rm=</span>T) <span class="sc">*</span> <span class="dv">100</span>)<span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb29-1198"><a href="#cb29-1198" aria-hidden="true" tabindex="-1"></a>log_chave2005_mae               <span class="ot">=</span> ModelMetrics<span class="sc">::</span><span class="fu">mae</span>(scbi_quercus<span class="sc">$</span>agb_chave2005, log_chave2005_resid) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">4</span>)</span>
<span id="cb29-1199"><a href="#cb29-1199" aria-hidden="true" tabindex="-1"></a>log_chave2005_rmse              <span class="ot">=</span> ModelMetrics<span class="sc">::</span><span class="fu">rmse</span>(scbi_quercus<span class="sc">$</span>agb_chave2005, log_chave2005_resid) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">4</span>)</span>
<span id="cb29-1200"><a href="#cb29-1200" aria-hidden="true" tabindex="-1"></a>log_chave2005_rmse_rel      <span class="ot">=</span> (log_chave2005_rmse <span class="sc">/</span> <span class="fu">mean</span>(scbi_quercus<span class="sc">$</span>agb_chave2005, <span class="at">na.rm=</span>T) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">4</span>)</span>
<span id="cb29-1201"><a href="#cb29-1201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1202"><a href="#cb29-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1203"><a href="#cb29-1203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-1204"><a href="#cb29-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1207"><a href="#cb29-1207" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-1208"><a href="#cb29-1208" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-1209"><a href="#cb29-1209" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-1210"><a href="#cb29-1210" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb29-1211"><a href="#cb29-1211" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-1212"><a href="#cb29-1212" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb29-1213"><a href="#cb29-1213" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb29-1214"><a href="#cb29-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1215"><a href="#cb29-1215" aria-hidden="true" tabindex="-1"></a><span class="co"># Build data frame directly</span></span>
<span id="cb29-1216"><a href="#cb29-1216" aria-hidden="true" tabindex="-1"></a>transformation_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-1217"><a href="#cb29-1217" aria-hidden="true" tabindex="-1"></a>  <span class="at">Equation      =</span> <span class="fu">c</span>(<span class="st">"Species-specific"</span>, <span class="st">"Genus-level"</span>, <span class="st">"Chave 2014"</span>, <span class="st">"Brown 1997"</span>, <span class="st">"Chave 2005"</span>),</span>
<span id="cb29-1218"><a href="#cb29-1218" aria-hidden="true" tabindex="-1"></a>  <span class="at">MAE_Lin           =</span> <span class="fu">c</span>(lin_species_mae, lin_genus_mae, lin_chave2014_mae, lin_brown1997_mae, lin_chave2014_mae),</span>
<span id="cb29-1219"><a href="#cb29-1219" aria-hidden="true" tabindex="-1"></a>  <span class="at">MAE_Log       =</span> <span class="fu">c</span>(log_species_mae, log_genus_mae, log_chave2014_mae, log_brown1997_mae, log_chave2005_mae),</span>
<span id="cb29-1220"><a href="#cb29-1220" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE_Lin      =</span> <span class="fu">c</span>(lin_species_rmse, lin_genus_rmse, lin_chave2014_rmse, lin_brown1997_rmse, lin_brown1997_rmse),</span>
<span id="cb29-1221"><a href="#cb29-1221" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE_Log      =</span> <span class="fu">c</span>(log_species_rmse, log_genus_rmse, log_chave2014_rmse, log_brown1997_rmse, log_chave2005_rmse),</span>
<span id="cb29-1222"><a href="#cb29-1222" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE_Lin_rel=</span> <span class="fu">c</span>(lin_species_rmse_rel, lin_genus_rmse_rel, lin_chave2014_rmse_rel, lin_brown1997_rmse_rel, linear_chave2005_rmse_rel),</span>
<span id="cb29-1223"><a href="#cb29-1223" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE_Log_rel=</span> <span class="fu">c</span>(log_species_rmse_rel, log_genus_rmse_rel, log_chave2014_rmse_rel, log_brown1997_rmse_rel, log_chave2005_rmse_rel),</span>
<span id="cb29-1224"><a href="#cb29-1224" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> F)</span>
<span id="cb29-1225"><a href="#cb29-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1226"><a href="#cb29-1226" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate reduction</span></span>
<span id="cb29-1227"><a href="#cb29-1227" aria-hidden="true" tabindex="-1"></a>transformation_comparison<span class="sc">$</span>Reduction <span class="ot">=</span> transformation_comparison<span class="sc">$</span>RMSE_Lin_rel <span class="sc">-</span> </span>
<span id="cb29-1228"><a href="#cb29-1228" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(transformation_comparison<span class="sc">$</span>RMSE_Log_rel) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb29-1229"><a href="#cb29-1229" aria-hidden="true" tabindex="-1"></a>transformation_comparison <span class="sc">|&gt;</span> </span>
<span id="cb29-1230"><a href="#cb29-1230" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">flextable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb29-1231"><a href="#cb29-1231" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1232"><a href="#cb29-1232" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>)</span>
<span id="cb29-1233"><a href="#cb29-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1234"><a href="#cb29-1234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-1235"><a href="#cb29-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1236"><a href="#cb29-1236" aria-hidden="true" tabindex="-1"></a>Results shown in two previous tables provides the necessary justification for designing the cross-validation workflow in the next section, where we implement log-transformed models and quantify the uncertainty reduction according to different bias corrections and hyper-parameter tuning.</span>
<span id="cb29-1237"><a href="#cb29-1237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1238"><a href="#cb29-1238" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Age-Class Stratification Split {.unnumbered}</span></span>
<span id="cb29-1239"><a href="#cb29-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1240"><a href="#cb29-1240" aria-hidden="true" tabindex="-1"></a>Stratification by size class or age cohort involves a critical component in forest biomass modeling. This ensures proportional representation of diameter classes, which effectively prevents bias from the systematic under-sampling of large trees <span class="co">[</span><span class="ot">@paul2017moisture; @duncansonAbovegroundWoodyBiomass2021, pp. 100</span><span class="co">]</span>.</span>
<span id="cb29-1241"><a href="#cb29-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1244"><a href="#cb29-1244" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-1245"><a href="#cb29-1245" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-1246"><a href="#cb29-1246" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-1247"><a href="#cb29-1247" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-1248"><a href="#cb29-1248" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb29-1249"><a href="#cb29-1249" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb29-1250"><a href="#cb29-1250" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) </span>
<span id="cb29-1251"><a href="#cb29-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1252"><a href="#cb29-1252" aria-hidden="true" tabindex="-1"></a>age_class <span class="ot">=</span> scbi_quercus <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb29-1253"><a href="#cb29-1253" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(dbh), <span class="sc">!</span><span class="fu">is.na</span>(agb_genus)) <span class="sc">|&gt;</span></span>
<span id="cb29-1254"><a href="#cb29-1254" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">dbh_class =</span> <span class="fu">cut</span>(dbh, </span>
<span id="cb29-1255"><a href="#cb29-1255" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">100</span>),</span>
<span id="cb29-1256"><a href="#cb29-1256" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0-10"</span>, <span class="st">"10-20"</span>, <span class="st">"20-30"</span>, <span class="st">"30-40"</span>, <span class="st">"40-50"</span>, <span class="st">"&gt;50"</span>)))</span>
<span id="cb29-1257"><a href="#cb29-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1258"><a href="#cb29-1258" aria-hidden="true" tabindex="-1"></a><span class="co"># Check raw distribution across size classes</span></span>
<span id="cb29-1259"><a href="#cb29-1259" aria-hidden="true" tabindex="-1"></a>age_class_distribution <span class="ot">=</span> age_class <span class="sc">|&gt;</span></span>
<span id="cb29-1260"><a href="#cb29-1260" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(dbh_class) <span class="sc">|&gt;</span></span>
<span id="cb29-1261"><a href="#cb29-1261" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb29-1262"><a href="#cb29-1262" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_dbh =</span> <span class="fu">mean</span>(dbh), <span class="at">mean_agb =</span> <span class="fu">mean</span>(agb_genus),</span>
<span id="cb29-1263"><a href="#cb29-1263" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_biomass_pct =</span> <span class="fu">sum</span>(agb_genus) <span class="sc">/</span> <span class="fu">sum</span>(age_class<span class="sc">$</span>agb_genus) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb29-1264"><a href="#cb29-1264" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb29-1265"><a href="#cb29-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1266"><a href="#cb29-1266" aria-hidden="true" tabindex="-1"></a><span class="co"># Check 80:20% to maintain proportional representation</span></span>
<span id="cb29-1267"><a href="#cb29-1267" aria-hidden="true" tabindex="-1"></a>train_idx <span class="ot">&lt;-</span> age_class <span class="sc">|&gt;</span></span>
<span id="cb29-1268"><a href="#cb29-1268" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">row_id =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb29-1269"><a href="#cb29-1269" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(dbh_class) <span class="sc">|&gt;</span></span>
<span id="cb29-1270"><a href="#cb29-1270" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">prop =</span> <span class="fl">0.8</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1271"><a href="#cb29-1271" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(row_id)</span>
<span id="cb29-1272"><a href="#cb29-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1273"><a href="#cb29-1273" aria-hidden="true" tabindex="-1"></a>calibration_data <span class="ot">&lt;-</span> age_class[train_idx, ]</span>
<span id="cb29-1274"><a href="#cb29-1274" aria-hidden="true" tabindex="-1"></a>validation_data <span class="ot">&lt;-</span> age_class[<span class="sc">-</span>train_idx, ]</span>
<span id="cb29-1275"><a href="#cb29-1275" aria-hidden="true" tabindex="-1"></a>cal_props <span class="ot">&lt;-</span> calibration_data <span class="sc">|&gt;</span></span>
<span id="cb29-1276"><a href="#cb29-1276" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">count</span>(dbh_class) <span class="sc">|&gt;</span></span>
<span id="cb29-1277"><a href="#cb29-1277" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">cal_pct =</span> <span class="fu">round</span>((n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb29-1278"><a href="#cb29-1278" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">cal_n =</span> n)</span>
<span id="cb29-1279"><a href="#cb29-1279" aria-hidden="true" tabindex="-1"></a>val_props <span class="ot">&lt;-</span> validation_data <span class="sc">|&gt;</span></span>
<span id="cb29-1280"><a href="#cb29-1280" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">count</span>(dbh_class) <span class="sc">|&gt;</span></span>
<span id="cb29-1281"><a href="#cb29-1281" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">val_pct =</span> <span class="fu">round</span>((n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb29-1282"><a href="#cb29-1282" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">val_n =</span> n)</span>
<span id="cb29-1283"><a href="#cb29-1283" aria-hidden="true" tabindex="-1"></a>split_verification <span class="ot">&lt;-</span> cal_props <span class="sc">|&gt;</span></span>
<span id="cb29-1284"><a href="#cb29-1284" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(val_props, <span class="at">by =</span> <span class="st">"dbh_class"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1285"><a href="#cb29-1285" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Total_n =</span> cal_n <span class="sc">+</span> val_n, <span class="at">Difference_pct =</span> <span class="fu">abs</span>(cal_pct <span class="sc">-</span> val_pct)) <span class="sc">|&gt;</span></span>
<span id="cb29-1286"><a href="#cb29-1286" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(dbh_class, cal_n, cal_pct, val_n, val_pct, Total_n, Difference_pct)</span>
<span id="cb29-1287"><a href="#cb29-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1288"><a href="#cb29-1288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-1289"><a href="#cb29-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1292"><a href="#cb29-1292" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-1293"><a href="#cb29-1293" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb29-1294"><a href="#cb29-1294" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-1295"><a href="#cb29-1295" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-1296"><a href="#cb29-1296" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb29-1297"><a href="#cb29-1297" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb29-1298"><a href="#cb29-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1299"><a href="#cb29-1299" aria-hidden="true" tabindex="-1"></a>split_verification <span class="sc">|&gt;</span></span>
<span id="cb29-1300"><a href="#cb29-1300" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">flextable</span>() <span class="sc">|&gt;</span></span>
<span id="cb29-1301"><a href="#cb29-1301" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">set_header_labels</span>(</span>
<span id="cb29-1302"><a href="#cb29-1302" aria-hidden="true" tabindex="-1"></a>    <span class="at">dbh_class =</span> <span class="st">"DBH Class (cm)"</span>,</span>
<span id="cb29-1303"><a href="#cb29-1303" aria-hidden="true" tabindex="-1"></a>    <span class="at">cal_n =</span> <span class="st">"Calibration (n)"</span>,</span>
<span id="cb29-1304"><a href="#cb29-1304" aria-hidden="true" tabindex="-1"></a>    <span class="at">cal_pct =</span> <span class="st">"Cal. % of Total"</span>,</span>
<span id="cb29-1305"><a href="#cb29-1305" aria-hidden="true" tabindex="-1"></a>    <span class="at">val_n =</span> <span class="st">"Validation (n)"</span>,</span>
<span id="cb29-1306"><a href="#cb29-1306" aria-hidden="true" tabindex="-1"></a>    <span class="at">val_pct =</span> <span class="st">"Val. % of Total"</span>,</span>
<span id="cb29-1307"><a href="#cb29-1307" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_n =</span> <span class="st">"Total (n)"</span>,</span>
<span id="cb29-1308"><a href="#cb29-1308" aria-hidden="true" tabindex="-1"></a>    <span class="at">Difference_pct =</span> <span class="st">"Δ (%)"</span></span>
<span id="cb29-1309"><a href="#cb29-1309" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb29-1310"><a href="#cb29-1310" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">align</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">align =</span> <span class="st">"left"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1311"><a href="#cb29-1311" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">align</span>(<span class="at">j =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1312"><a href="#cb29-1312" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">colformat_double</span>(<span class="at">j =</span> <span class="fu">c</span>(<span class="st">"cal_pct"</span>, <span class="st">"val_pct"</span>, <span class="st">"Difference_pct"</span>), <span class="at">digits =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1313"><a href="#cb29-1313" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1314"><a href="#cb29-1314" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">part =</span> <span class="st">"footer"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1315"><a href="#cb29-1315" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1316"><a href="#cb29-1316" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">add_footer_lines</span>(</span>
<span id="cb29-1317"><a href="#cb29-1317" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Stratified sampling ensures DBH class proportions remain similar between datasets. 'Cal. % of Total' and 'Val. % of Total' show each class as % of its respective dataset. Δ shows absolute difference - values &lt;2% indicate good proportionality preservation."</span></span>
<span id="cb29-1318"><a href="#cb29-1318" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb29-1319"><a href="#cb29-1319" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">italic</span>(<span class="at">part =</span> <span class="st">"footer"</span>)</span>
<span id="cb29-1320"><a href="#cb29-1320" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-1321"><a href="#cb29-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1322"><a href="#cb29-1322" aria-hidden="true" tabindex="-1"></a>*Table X: Calibration and Validation SubSet Proportionality Check*</span>
<span id="cb29-1323"><a href="#cb29-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1324"><a href="#cb29-1324" aria-hidden="true" tabindex="-1"></a>The above example showcases a successful outcome, where all size classes show <span class="sc">\&lt;</span>3% difference between calibration and validation sets, confirming successful stratification. This prevents over-representation of small trees and under-representation of large trees in model training.</span>
<span id="cb29-1325"><a href="#cb29-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1326"><a href="#cb29-1326" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.4 Cross-Validation</span></span>
<span id="cb29-1327"><a href="#cb29-1327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1328"><a href="#cb29-1328" aria-hidden="true" tabindex="-1"></a>Cross-validation quantifies out-of-sample prediction error, preventing over-fitting and providing realistic uncertainty estimates for REDD+ carbon credit deductions. We employ Monte Carlo Leave-Group-Out Cross-Validation (LGOCV) training regime using the <span class="in">`caret`</span> library to demonstrate the following:</span>
<span id="cb29-1329"><a href="#cb29-1329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1330"><a href="#cb29-1330" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Assess generalization: Test model performance on unseen data</span>
<span id="cb29-1331"><a href="#cb29-1331" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Quantify uncertainty: Calculate robust RMSE estimates</span>
<span id="cb29-1332"><a href="#cb29-1332" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Compare models: Select best-performing equation type</span>
<span id="cb29-1333"><a href="#cb29-1333" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Meet MRV standards: Demonstrate compliance with ART-TREES/VCS requirements</span>
<span id="cb29-1334"><a href="#cb29-1334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1335"><a href="#cb29-1335" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Monte Carlo Simulation Design:</span></span>
<span id="cb29-1336"><a href="#cb29-1336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1337"><a href="#cb29-1337" aria-hidden="true" tabindex="-1"></a>We implemented 100-iteration Monte Carlo cross-validation to quantify out-of-sample prediction error and prevent over-fitting. Each iteration:</span>
<span id="cb29-1338"><a href="#cb29-1338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1339"><a href="#cb29-1339" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Randomly splits data into 80% calibration / 20% validation (stratified by DBH class)</span>
<span id="cb29-1340"><a href="#cb29-1340" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Fits the model on calibration data</span>
<span id="cb29-1341"><a href="#cb29-1341" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Predicts validation data</span>
<span id="cb29-1342"><a href="#cb29-1342" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Calculates performance metrics (MAE, RMSE, R²)</span>
<span id="cb29-1343"><a href="#cb29-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1344"><a href="#cb29-1344" aria-hidden="true" tabindex="-1"></a>This process was repeated for all 10 model configurations:</span>
<span id="cb29-1345"><a href="#cb29-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1346"><a href="#cb29-1346" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>5 allometric equations (Species-specific, Genus, Chave 2014, Brown 1997, Chave 2005)</span>
<span id="cb29-1347"><a href="#cb29-1347" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>2 transformations each (Linear, Log-transformed)</span>
<span id="cb29-1348"><a href="#cb29-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1349"><a href="#cb29-1349" aria-hidden="true" tabindex="-1"></a>Across 100 iterations, we accumulated validation predictions per model, providing robust uncertainty estimates that reflect true generalization performance rather than training-set over-fitting. The Monte Carlo approach is particularly valuable for small datasets (n=84), where a single train-test split might yield unrepresentative results due to sampling variance.</span>
<span id="cb29-1350"><a href="#cb29-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1353"><a href="#cb29-1353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-1354"><a href="#cb29-1354" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb29-1355"><a href="#cb29-1355" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-1356"><a href="#cb29-1356" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-1357"><a href="#cb29-1357" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true  </span></span>
<span id="cb29-1358"><a href="#cb29-1358" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb29-1359"><a href="#cb29-1359" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb29-1360"><a href="#cb29-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1361"><a href="#cb29-1361" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Monte Carlo cross-validation parameters</span></span>
<span id="cb29-1362"><a href="#cb29-1362" aria-hidden="true" tabindex="-1"></a>monte_carlo_100 <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">trainControl</span>(</span>
<span id="cb29-1363"><a href="#cb29-1363" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"LGOCV"</span>,</span>
<span id="cb29-1364"><a href="#cb29-1364" aria-hidden="true" tabindex="-1"></a>  <span class="at">number =</span> <span class="dv">100</span>,     <span class="co"># no.# of full cycle resamples</span></span>
<span id="cb29-1365"><a href="#cb29-1365" aria-hidden="true" tabindex="-1"></a>  <span class="at">p =</span> <span class="fl">0.8</span>,              <span class="co"># percentage of full cycle resampled </span></span>
<span id="cb29-1366"><a href="#cb29-1366" aria-hidden="true" tabindex="-1"></a>  <span class="at">savePredictions =</span> <span class="st">"final"</span></span>
<span id="cb29-1367"><a href="#cb29-1367" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-1368"><a href="#cb29-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1369"><a href="#cb29-1369" aria-hidden="true" tabindex="-1"></a><span class="co"># Species-Specific Model: Linear model tuned at species level with un-transformed covs</span></span>
<span id="cb29-1370"><a href="#cb29-1370" aria-hidden="true" tabindex="-1"></a>lin_species_mc <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(</span>
<span id="cb29-1371"><a href="#cb29-1371" aria-hidden="true" tabindex="-1"></a>  agb_species <span class="sc">~</span> dbh,</span>
<span id="cb29-1372"><a href="#cb29-1372" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> scbi_quercus,</span>
<span id="cb29-1373"><a href="#cb29-1373" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb29-1374"><a href="#cb29-1374" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.omit,</span>
<span id="cb29-1375"><a href="#cb29-1375" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> monte_carlo_100</span>
<span id="cb29-1376"><a href="#cb29-1376" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-1377"><a href="#cb29-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1378"><a href="#cb29-1378" aria-hidden="true" tabindex="-1"></a><span class="co"># Species-Specific Model: Logarithmic model tuned at species level withg log-transformed covs</span></span>
<span id="cb29-1379"><a href="#cb29-1379" aria-hidden="true" tabindex="-1"></a>log_species_mc <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(</span>
<span id="cb29-1380"><a href="#cb29-1380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(agb_species) <span class="sc">~</span> <span class="fu">log</span>(dbh),</span>
<span id="cb29-1381"><a href="#cb29-1381" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> scbi_quercus,</span>
<span id="cb29-1382"><a href="#cb29-1382" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb29-1383"><a href="#cb29-1383" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.omit,</span>
<span id="cb29-1384"><a href="#cb29-1384" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> monte_carlo_100</span>
<span id="cb29-1385"><a href="#cb29-1385" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-1386"><a href="#cb29-1386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1387"><a href="#cb29-1387" aria-hidden="true" tabindex="-1"></a><span class="co"># Genus-Specific Model: LINEAR  model tuned at genus level with un-transformed covs</span></span>
<span id="cb29-1388"><a href="#cb29-1388" aria-hidden="true" tabindex="-1"></a>lin_genus_mc <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(</span>
<span id="cb29-1389"><a href="#cb29-1389" aria-hidden="true" tabindex="-1"></a>  agb_genus <span class="sc">~</span> dbh,</span>
<span id="cb29-1390"><a href="#cb29-1390" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> scbi_quercus,</span>
<span id="cb29-1391"><a href="#cb29-1391" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb29-1392"><a href="#cb29-1392" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.omit,</span>
<span id="cb29-1393"><a href="#cb29-1393" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> monte_carlo_100</span>
<span id="cb29-1394"><a href="#cb29-1394" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-1395"><a href="#cb29-1395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1396"><a href="#cb29-1396" aria-hidden="true" tabindex="-1"></a><span class="co"># Genus-Specific Model: LOG model tuned at genus level with un-transformed covs</span></span>
<span id="cb29-1397"><a href="#cb29-1397" aria-hidden="true" tabindex="-1"></a>log_genus_mc <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(</span>
<span id="cb29-1398"><a href="#cb29-1398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(agb_genus) <span class="sc">~</span> <span class="fu">log</span>(dbh),</span>
<span id="cb29-1399"><a href="#cb29-1399" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> scbi_quercus,</span>
<span id="cb29-1400"><a href="#cb29-1400" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb29-1401"><a href="#cb29-1401" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.omit,</span>
<span id="cb29-1402"><a href="#cb29-1402" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> monte_carlo_100</span>
<span id="cb29-1403"><a href="#cb29-1403" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-1404"><a href="#cb29-1404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1405"><a href="#cb29-1405" aria-hidden="true" tabindex="-1"></a><span class="co"># Chave 2014 models: Generic scaled </span></span>
<span id="cb29-1406"><a href="#cb29-1406" aria-hidden="true" tabindex="-1"></a>lin_chave2014_mc <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(</span>
<span id="cb29-1407"><a href="#cb29-1407" aria-hidden="true" tabindex="-1"></a>  agb_chave2014 <span class="sc">~</span> dbh,</span>
<span id="cb29-1408"><a href="#cb29-1408" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> scbi_quercus,</span>
<span id="cb29-1409"><a href="#cb29-1409" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb29-1410"><a href="#cb29-1410" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.omit,</span>
<span id="cb29-1411"><a href="#cb29-1411" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> monte_carlo_100</span>
<span id="cb29-1412"><a href="#cb29-1412" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-1413"><a href="#cb29-1413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1414"><a href="#cb29-1414" aria-hidden="true" tabindex="-1"></a>log_chave2014_mc <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(</span>
<span id="cb29-1415"><a href="#cb29-1415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(agb_chave2014) <span class="sc">~</span> <span class="fu">log</span>(dbh),</span>
<span id="cb29-1416"><a href="#cb29-1416" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> scbi_quercus,</span>
<span id="cb29-1417"><a href="#cb29-1417" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb29-1418"><a href="#cb29-1418" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.omit,</span>
<span id="cb29-1419"><a href="#cb29-1419" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> monte_carlo_100</span>
<span id="cb29-1420"><a href="#cb29-1420" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-1421"><a href="#cb29-1421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1422"><a href="#cb29-1422" aria-hidden="true" tabindex="-1"></a><span class="co"># Brown 1997 models</span></span>
<span id="cb29-1423"><a href="#cb29-1423" aria-hidden="true" tabindex="-1"></a>lin_brown1997_mc <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(</span>
<span id="cb29-1424"><a href="#cb29-1424" aria-hidden="true" tabindex="-1"></a>  agb_brown1997 <span class="sc">~</span> dbh,</span>
<span id="cb29-1425"><a href="#cb29-1425" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> scbi_quercus,</span>
<span id="cb29-1426"><a href="#cb29-1426" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb29-1427"><a href="#cb29-1427" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.omit,</span>
<span id="cb29-1428"><a href="#cb29-1428" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> monte_carlo_100</span>
<span id="cb29-1429"><a href="#cb29-1429" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-1430"><a href="#cb29-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1431"><a href="#cb29-1431" aria-hidden="true" tabindex="-1"></a>log_brown1997_mc <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(</span>
<span id="cb29-1432"><a href="#cb29-1432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(agb_brown1997) <span class="sc">~</span> <span class="fu">log</span>(dbh),</span>
<span id="cb29-1433"><a href="#cb29-1433" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> scbi_quercus,</span>
<span id="cb29-1434"><a href="#cb29-1434" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb29-1435"><a href="#cb29-1435" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.omit,</span>
<span id="cb29-1436"><a href="#cb29-1436" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> monte_carlo_100</span>
<span id="cb29-1437"><a href="#cb29-1437" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-1438"><a href="#cb29-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1439"><a href="#cb29-1439" aria-hidden="true" tabindex="-1"></a><span class="co"># Chave 2005 models</span></span>
<span id="cb29-1440"><a href="#cb29-1440" aria-hidden="true" tabindex="-1"></a>lin_chave2005_mc <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(</span>
<span id="cb29-1441"><a href="#cb29-1441" aria-hidden="true" tabindex="-1"></a>  agb_chave2005 <span class="sc">~</span> dbh,</span>
<span id="cb29-1442"><a href="#cb29-1442" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> scbi_quercus,</span>
<span id="cb29-1443"><a href="#cb29-1443" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb29-1444"><a href="#cb29-1444" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.omit,</span>
<span id="cb29-1445"><a href="#cb29-1445" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> monte_carlo_100</span>
<span id="cb29-1446"><a href="#cb29-1446" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-1447"><a href="#cb29-1447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1448"><a href="#cb29-1448" aria-hidden="true" tabindex="-1"></a>log_chave2005_mc <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(</span>
<span id="cb29-1449"><a href="#cb29-1449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(agb_chave2005) <span class="sc">~</span> <span class="fu">log</span>(dbh),</span>
<span id="cb29-1450"><a href="#cb29-1450" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> scbi_quercus,</span>
<span id="cb29-1451"><a href="#cb29-1451" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb29-1452"><a href="#cb29-1452" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.omit,</span>
<span id="cb29-1453"><a href="#cb29-1453" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> monte_carlo_100</span>
<span id="cb29-1454"><a href="#cb29-1454" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-1455"><a href="#cb29-1455" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-1456"><a href="#cb29-1456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1457"><a href="#cb29-1457" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.5 Allometric Uncertainty</span></span>
<span id="cb29-1458"><a href="#cb29-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1459"><a href="#cb29-1459" aria-hidden="true" tabindex="-1"></a><span class="fu">### Uncertainty Calculation</span></span>
<span id="cb29-1460"><a href="#cb29-1460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1461"><a href="#cb29-1461" aria-hidden="true" tabindex="-1"></a>We evaluate models using metrics aligned with REDD+ MRV requirements:</span>
<span id="cb29-1462"><a href="#cb29-1462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1463"><a href="#cb29-1463" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>RMSE (Root Mean Square Error): Primary uncertainty metric for ART-TREES deductions</span>
<span id="cb29-1464"><a href="#cb29-1464" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Relative RMSE (%): RMSE as percentage of mean, enabling cross-equation comparison</span>
<span id="cb29-1465"><a href="#cb29-1465" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>MAE (Mean Absolute Error): Robust alternative less sensitive to outliers</span>
<span id="cb29-1466"><a href="#cb29-1466" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>R² (Coefficient of Determination): Proportion of variance explained</span>
<span id="cb29-1467"><a href="#cb29-1467" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Shapiro-Wilk p-value: Tests residual normality (OLS assumption verification)</span>
<span id="cb29-1468"><a href="#cb29-1468" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Deduction (%): Carbon credit deduction rate per ART-TREES Equation 11</span>
<span id="cb29-1469"><a href="#cb29-1469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1470"><a href="#cb29-1470" aria-hidden="true" tabindex="-1"></a>For log-transformed models, all metrics were calculated on back-transformed predictions to ensure fair comparison with linear models. Back-transformation applies exp() to log-scale predictions, restoring values to the original kg scale while preserving the variance structure stabilized by log-transformation.</span>
<span id="cb29-1471"><a href="#cb29-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1474"><a href="#cb29-1474" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-1475"><a href="#cb29-1475" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb29-1476"><a href="#cb29-1476" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-1477"><a href="#cb29-1477" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-1478"><a href="#cb29-1478" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb29-1479"><a href="#cb29-1479" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb29-1480"><a href="#cb29-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1481"><a href="#cb29-1481" aria-hidden="true" tabindex="-1"></a><span class="co"># Model performance metrics</span></span>
<span id="cb29-1482"><a href="#cb29-1482" aria-hidden="true" tabindex="-1"></a>evaluate_model <span class="ot">&lt;-</span> <span class="cf">function</span>(model, equation_name, model_type, agb_mean) {</span>
<span id="cb29-1483"><a href="#cb29-1483" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> model<span class="sc">$</span>pred</span>
<span id="cb29-1484"><a href="#cb29-1484" aria-hidden="true" tabindex="-1"></a>  residuals <span class="ot">&lt;-</span> pred<span class="sc">$</span>obs <span class="sc">-</span> pred<span class="sc">$</span>pred</span>
<span id="cb29-1485"><a href="#cb29-1485" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-1486"><a href="#cb29-1486" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Test residual normality</span></span>
<span id="cb29-1487"><a href="#cb29-1487" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(residuals) <span class="sc">&gt;</span> <span class="dv">5000</span>) {shapiro_test <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(<span class="fu">sample</span>(residuals, <span class="dv">5000</span>))</span>
<span id="cb29-1488"><a href="#cb29-1488" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {shapiro_test <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(residuals)}</span>
<span id="cb29-1489"><a href="#cb29-1489" aria-hidden="true" tabindex="-1"></a>  shapiro_p <span class="ot">&lt;-</span> shapiro_test<span class="sc">$</span>p.value</span>
<span id="cb29-1490"><a href="#cb29-1490" aria-hidden="true" tabindex="-1"></a>  mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(residuals))</span>
<span id="cb29-1491"><a href="#cb29-1491" aria-hidden="true" tabindex="-1"></a>  rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(residuals<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb29-1492"><a href="#cb29-1492" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-1493"><a href="#cb29-1493" aria-hidden="true" tabindex="-1"></a>  <span class="co"># back-transform to original scale</span></span>
<span id="cb29-1494"><a href="#cb29-1494" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (model_type <span class="sc">==</span> <span class="st">"Log"</span>) {</span>
<span id="cb29-1495"><a href="#cb29-1495" aria-hidden="true" tabindex="-1"></a>    pred_original <span class="ot">&lt;-</span> <span class="fu">exp</span>(pred<span class="sc">$</span>pred)</span>
<span id="cb29-1496"><a href="#cb29-1496" aria-hidden="true" tabindex="-1"></a>    obs_original <span class="ot">&lt;-</span> <span class="fu">exp</span>(pred<span class="sc">$</span>obs)</span>
<span id="cb29-1497"><a href="#cb29-1497" aria-hidden="true" tabindex="-1"></a>    mae_original <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(obs_original <span class="sc">-</span> pred_original))</span>
<span id="cb29-1498"><a href="#cb29-1498" aria-hidden="true" tabindex="-1"></a>    rmse_original <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((obs_original <span class="sc">-</span> pred_original)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb29-1499"><a href="#cb29-1499" aria-hidden="true" tabindex="-1"></a>    rel_rmse <span class="ot">&lt;-</span> (rmse_original <span class="sc">/</span> agb_mean) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb29-1500"><a href="#cb29-1500" aria-hidden="true" tabindex="-1"></a>    r2 <span class="ot">&lt;-</span> <span class="fu">cor</span>(obs_original, pred_original)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb29-1501"><a href="#cb29-1501" aria-hidden="true" tabindex="-1"></a>    mae_display <span class="ot">&lt;-</span> mae_original</span>
<span id="cb29-1502"><a href="#cb29-1502" aria-hidden="true" tabindex="-1"></a>    rmse_display <span class="ot">&lt;-</span> rmse_original</span>
<span id="cb29-1503"><a href="#cb29-1503" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-1504"><a href="#cb29-1504" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb29-1505"><a href="#cb29-1505" aria-hidden="true" tabindex="-1"></a>    rel_rmse <span class="ot">&lt;-</span> (rmse <span class="sc">/</span> agb_mean) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb29-1506"><a href="#cb29-1506" aria-hidden="true" tabindex="-1"></a>    r2 <span class="ot">&lt;-</span> <span class="fu">cor</span>(pred<span class="sc">$</span>obs, pred<span class="sc">$</span>pred)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb29-1507"><a href="#cb29-1507" aria-hidden="true" tabindex="-1"></a>    mae_display <span class="ot">&lt;-</span> mae</span>
<span id="cb29-1508"><a href="#cb29-1508" aria-hidden="true" tabindex="-1"></a>    rmse_display <span class="ot">&lt;-</span> rmse</span>
<span id="cb29-1509"><a href="#cb29-1509" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-1510"><a href="#cb29-1510" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-1511"><a href="#cb29-1511" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate ART-TREES uncertainty deduction</span></span>
<span id="cb29-1512"><a href="#cb29-1512" aria-hidden="true" tabindex="-1"></a>  hw_90_pct <span class="ot">&lt;-</span> rel_rmse <span class="sc">/</span> <span class="dv">100</span></span>
<span id="cb29-1513"><a href="#cb29-1513" aria-hidden="true" tabindex="-1"></a>  ua_factor <span class="ot">&lt;-</span> <span class="fl">0.524417</span> <span class="sc">*</span> (hw_90_pct <span class="sc">/</span> <span class="fl">1.645006</span>)</span>
<span id="cb29-1514"><a href="#cb29-1514" aria-hidden="true" tabindex="-1"></a>  credit_deduction <span class="ot">&lt;-</span> ua_factor <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb29-1515"><a href="#cb29-1515" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-1516"><a href="#cb29-1516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(</span>
<span id="cb29-1517"><a href="#cb29-1517" aria-hidden="true" tabindex="-1"></a>    <span class="at">Equation =</span> equation_name,</span>
<span id="cb29-1518"><a href="#cb29-1518" aria-hidden="true" tabindex="-1"></a>    <span class="at">Model_Type =</span> model_type,</span>
<span id="cb29-1519"><a href="#cb29-1519" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">nrow</span>(pred),</span>
<span id="cb29-1520"><a href="#cb29-1520" aria-hidden="true" tabindex="-1"></a>    <span class="at">Shapiro_p =</span> shapiro_p,</span>
<span id="cb29-1521"><a href="#cb29-1521" aria-hidden="true" tabindex="-1"></a>    <span class="at">MAE =</span> mae_display,</span>
<span id="cb29-1522"><a href="#cb29-1522" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMSE =</span> rmse_display,</span>
<span id="cb29-1523"><a href="#cb29-1523" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rel_RMSE_pct =</span> rel_rmse,</span>
<span id="cb29-1524"><a href="#cb29-1524" aria-hidden="true" tabindex="-1"></a>    <span class="at">R2 =</span> r2,</span>
<span id="cb29-1525"><a href="#cb29-1525" aria-hidden="true" tabindex="-1"></a>    <span class="at">Credit_Deduction_pct =</span> credit_deduction</span>
<span id="cb29-1526"><a href="#cb29-1526" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb29-1527"><a href="#cb29-1527" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1528"><a href="#cb29-1528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1529"><a href="#cb29-1529" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate mean AGB for each equation type</span></span>
<span id="cb29-1530"><a href="#cb29-1530" aria-hidden="true" tabindex="-1"></a>mean_agb_species <span class="ot">&lt;-</span> <span class="fu">mean</span>(scbi_quercus<span class="sc">$</span>agb_species, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-1531"><a href="#cb29-1531" aria-hidden="true" tabindex="-1"></a>mean_agb_genus <span class="ot">&lt;-</span> <span class="fu">mean</span>(scbi_quercus<span class="sc">$</span>agb_genus, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-1532"><a href="#cb29-1532" aria-hidden="true" tabindex="-1"></a>mean_agb_chave2014 <span class="ot">&lt;-</span> <span class="fu">mean</span>(scbi_quercus<span class="sc">$</span>agb_chave2014, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-1533"><a href="#cb29-1533" aria-hidden="true" tabindex="-1"></a>mean_agb_brown1997 <span class="ot">&lt;-</span> <span class="fu">mean</span>(scbi_quercus<span class="sc">$</span>agb_brown1997, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-1534"><a href="#cb29-1534" aria-hidden="true" tabindex="-1"></a>mean_agb_chave2005 <span class="ot">&lt;-</span> <span class="fu">mean</span>(scbi_quercus<span class="sc">$</span>agb_chave2005, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-1535"><a href="#cb29-1535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1536"><a href="#cb29-1536" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate all models</span></span>
<span id="cb29-1537"><a href="#cb29-1537" aria-hidden="true" tabindex="-1"></a>mc_performance <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb29-1538"><a href="#cb29-1538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">evaluate_model</span>(lin_species_mc, <span class="st">"Species-specific"</span>, <span class="st">"Linear"</span>, mean_agb_species),</span>
<span id="cb29-1539"><a href="#cb29-1539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">evaluate_model</span>(log_species_mc, <span class="st">"Species-specific"</span>, <span class="st">"Log"</span>, mean_agb_species),</span>
<span id="cb29-1540"><a href="#cb29-1540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">evaluate_model</span>(lin_genus_mc, <span class="st">"Genus-level"</span>, <span class="st">"Linear"</span>, mean_agb_genus),</span>
<span id="cb29-1541"><a href="#cb29-1541" aria-hidden="true" tabindex="-1"></a>  <span class="fu">evaluate_model</span>(log_genus_mc, <span class="st">"Genus-level"</span>, <span class="st">"Log"</span>, mean_agb_genus),</span>
<span id="cb29-1542"><a href="#cb29-1542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">evaluate_model</span>(lin_chave2014_mc, <span class="st">"Chave 2014"</span>, <span class="st">"Linear"</span>, mean_agb_chave2014),</span>
<span id="cb29-1543"><a href="#cb29-1543" aria-hidden="true" tabindex="-1"></a>  <span class="fu">evaluate_model</span>(log_chave2014_mc, <span class="st">"Chave 2014"</span>, <span class="st">"Log"</span>, mean_agb_chave2014),</span>
<span id="cb29-1544"><a href="#cb29-1544" aria-hidden="true" tabindex="-1"></a>  <span class="fu">evaluate_model</span>(lin_brown1997_mc, <span class="st">"Brown 1997"</span>, <span class="st">"Linear"</span>, mean_agb_brown1997),</span>
<span id="cb29-1545"><a href="#cb29-1545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">evaluate_model</span>(log_brown1997_mc, <span class="st">"Brown 1997"</span>, <span class="st">"Log"</span>, mean_agb_brown1997),</span>
<span id="cb29-1546"><a href="#cb29-1546" aria-hidden="true" tabindex="-1"></a>  <span class="fu">evaluate_model</span>(lin_chave2005_mc, <span class="st">"Chave 2005"</span>, <span class="st">"Linear"</span>, mean_agb_chave2005),</span>
<span id="cb29-1547"><a href="#cb29-1547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">evaluate_model</span>(log_chave2005_mc, <span class="st">"Chave 2005"</span>, <span class="st">"Log"</span>, mean_agb_chave2005)</span>
<span id="cb29-1548"><a href="#cb29-1548" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-1549"><a href="#cb29-1549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1550"><a href="#cb29-1550" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-1551"><a href="#cb29-1551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1554"><a href="#cb29-1554" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-1555"><a href="#cb29-1555" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-1556"><a href="#cb29-1556" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb29-1557"><a href="#cb29-1557" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-1558"><a href="#cb29-1558" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb29-1559"><a href="#cb29-1559" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb29-1560"><a href="#cb29-1560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1561"><a href="#cb29-1561" aria-hidden="true" tabindex="-1"></a><span class="co"># Display performance table with proper formatting</span></span>
<span id="cb29-1562"><a href="#cb29-1562" aria-hidden="true" tabindex="-1"></a>mc_performance <span class="sc">|&gt;</span></span>
<span id="cb29-1563"><a href="#cb29-1563" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb29-1564"><a href="#cb29-1564" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Format scientific notation for small values</span></span>
<span id="cb29-1565"><a href="#cb29-1565" aria-hidden="true" tabindex="-1"></a>    <span class="at">Shapiro_p =</span> <span class="fu">ifelse</span>(Shapiro_p <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, Shapiro_p), <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, Shapiro_p)),</span>
<span id="cb29-1566"><a href="#cb29-1566" aria-hidden="true" tabindex="-1"></a>    <span class="at">MAE =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, MAE),</span>
<span id="cb29-1567"><a href="#cb29-1567" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMSE =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, RMSE),</span>
<span id="cb29-1568"><a href="#cb29-1568" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rel_RMSE_pct =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, Rel_RMSE_pct),</span>
<span id="cb29-1569"><a href="#cb29-1569" aria-hidden="true" tabindex="-1"></a>    <span class="at">R2 =</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, R2),</span>
<span id="cb29-1570"><a href="#cb29-1570" aria-hidden="true" tabindex="-1"></a>    <span class="at">Credit_Deduction_pct =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, Credit_Deduction_pct)</span>
<span id="cb29-1571"><a href="#cb29-1571" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb29-1572"><a href="#cb29-1572" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">flextable</span>() <span class="sc">|&gt;</span></span>
<span id="cb29-1573"><a href="#cb29-1573" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">set_caption</span>(<span class="st">"Monte Carlo Cross-Validation Performance Comparison"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1574"><a href="#cb29-1574" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">set_header_labels</span>(</span>
<span id="cb29-1575"><a href="#cb29-1575" aria-hidden="true" tabindex="-1"></a>    <span class="at">Equation =</span> <span class="st">"Equation Type"</span>,</span>
<span id="cb29-1576"><a href="#cb29-1576" aria-hidden="true" tabindex="-1"></a>    <span class="at">Model_Type =</span> <span class="st">"Transform"</span>,</span>
<span id="cb29-1577"><a href="#cb29-1577" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="st">"n"</span>,</span>
<span id="cb29-1578"><a href="#cb29-1578" aria-hidden="true" tabindex="-1"></a>    <span class="at">Shapiro_p =</span> <span class="st">"Shapiro p"</span>,</span>
<span id="cb29-1579"><a href="#cb29-1579" aria-hidden="true" tabindex="-1"></a>    <span class="at">MAE =</span> <span class="st">"MAE (kg)"</span>,</span>
<span id="cb29-1580"><a href="#cb29-1580" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMSE =</span> <span class="st">"RMSE (kg)"</span>,</span>
<span id="cb29-1581"><a href="#cb29-1581" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rel_RMSE_pct =</span> <span class="st">"RMSE (%)"</span>,</span>
<span id="cb29-1582"><a href="#cb29-1582" aria-hidden="true" tabindex="-1"></a>    <span class="at">R2 =</span> <span class="st">"R²"</span>,</span>
<span id="cb29-1583"><a href="#cb29-1583" aria-hidden="true" tabindex="-1"></a>    <span class="at">Credit_Deduction_pct =</span> <span class="st">"Deduction (%)"</span></span>
<span id="cb29-1584"><a href="#cb29-1584" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb29-1585"><a href="#cb29-1585" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">align</span>(<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">align =</span> <span class="st">"left"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1586"><a href="#cb29-1586" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">align</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1587"><a href="#cb29-1587" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">bold</span>(<span class="at">j =</span> <span class="fu">c</span>(<span class="st">"Rel_RMSE_pct"</span>, <span class="st">"Credit_Deduction_pct"</span>), <span class="at">part =</span> <span class="st">"body"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1588"><a href="#cb29-1588" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1589"><a href="#cb29-1589" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">part =</span> <span class="st">"footer"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1590"><a href="#cb29-1590" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1591"><a href="#cb29-1591" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">add_footer_lines</span>(<span class="st">"Monte Carlo LGOCV (100 iterations, 80/20 split). Shapiro p &lt; 0.001 displayed in scientific notation. Green highlighting: RMSE &lt;20% (acceptable); red: RMSE ≥50% (poor). Log models show back-transformed metrics on original scale."</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1592"><a href="#cb29-1592" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">italic</span>(<span class="at">part =</span> <span class="st">"footer"</span>)</span>
<span id="cb29-1593"><a href="#cb29-1593" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-1594"><a href="#cb29-1594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1595"><a href="#cb29-1595" aria-hidden="true" tabindex="-1"></a>*Table 1.X: Monte Carlo LGOCV results demonstrate superiority of log-transformed models. Species-specific log model achieves lowest uncertainty RMSE = 15.2%, deduction = 4.8%), while linear models exceed 60% uncertainty, risking a deduction of \&gt;20%.*</span>
<span id="cb29-1596"><a href="#cb29-1596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1597"><a href="#cb29-1597" aria-hidden="true" tabindex="-1"></a><span class="fu">### Uncertainty Evaluation</span></span>
<span id="cb29-1598"><a href="#cb29-1598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1599"><a href="#cb29-1599" aria-hidden="true" tabindex="-1"></a>We ranked the five log-transformed models by relative RMSE (%), showing their performance hierarchy and financial implications for a hypothetical 1M tCO₂e REDD+ project at \$5/tonne carbon price:</span>
<span id="cb29-1600"><a href="#cb29-1600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1601"><a href="#cb29-1601" aria-hidden="true" tabindex="-1"></a>The ranking reveals that genus-level and Brown 1997 models achieved perfect fits (RMSE = 0.00%, R² = 1.000), which likely indicates over-fitting given the small sample size. The species-specific model provides a more realistic uncertainty estimate (0.35% RMSE, \$11k deduction), while pan-tropical equations show higher but acceptable uncertainty (11-17% RMSE, \$350-541k deductions).</span>
<span id="cb29-1602"><a href="#cb29-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1605"><a href="#cb29-1605" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-1606"><a href="#cb29-1606" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-1607"><a href="#cb29-1607" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb29-1608"><a href="#cb29-1608" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-1609"><a href="#cb29-1609" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb29-1610"><a href="#cb29-1610" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb29-1611"><a href="#cb29-1611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1612"><a href="#cb29-1612" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract log-transformed models as best performers</span></span>
<span id="cb29-1613"><a href="#cb29-1613" aria-hidden="true" tabindex="-1"></a>log_models_ranked <span class="ot">&lt;-</span> mc_performance <span class="sc">|&gt;</span></span>
<span id="cb29-1614"><a href="#cb29-1614" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Model_Type <span class="sc">==</span> <span class="st">"Log"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1615"><a href="#cb29-1615" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(Rel_RMSE_pct) <span class="sc">|&gt;</span></span>
<span id="cb29-1616"><a href="#cb29-1616" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb29-1617"><a href="#cb29-1617" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rank =</span> <span class="fu">row_number</span>(),</span>
<span id="cb29-1618"><a href="#cb29-1618" aria-hidden="true" tabindex="-1"></a>    <span class="at">Financial_Impact_1M =</span> <span class="fu">sprintf</span>(<span class="st">"$%.0fk"</span>, Credit_Deduction_pct <span class="sc">*</span> <span class="dv">10000</span> <span class="sc">/</span> <span class="dv">100</span>)</span>
<span id="cb29-1619"><a href="#cb29-1619" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb29-1620"><a href="#cb29-1620" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Rank, Equation, Rel_RMSE_pct, R2, Credit_Deduction_pct, Financial_Impact_1M)</span>
<span id="cb29-1621"><a href="#cb29-1621" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-1622"><a href="#cb29-1622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1625"><a href="#cb29-1625" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-1626"><a href="#cb29-1626" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-1627"><a href="#cb29-1627" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb29-1628"><a href="#cb29-1628" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-1629"><a href="#cb29-1629" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb29-1630"><a href="#cb29-1630" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb29-1631"><a href="#cb29-1631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1632"><a href="#cb29-1632" aria-hidden="true" tabindex="-1"></a>log_models_ranked <span class="sc">|&gt;</span></span>
<span id="cb29-1633"><a href="#cb29-1633" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb29-1634"><a href="#cb29-1634" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rel_RMSE_pct =</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, Rel_RMSE_pct), </span>
<span id="cb29-1635"><a href="#cb29-1635" aria-hidden="true" tabindex="-1"></a>    <span class="at">R2 =</span> <span class="fu">round</span>(R2, <span class="dv">4</span>),</span>
<span id="cb29-1636"><a href="#cb29-1636" aria-hidden="true" tabindex="-1"></a>    <span class="at">Credit_Deduction_pct =</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, Credit_Deduction_pct),</span>
<span id="cb29-1637"><a href="#cb29-1637" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb29-1638"><a href="#cb29-1638" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">flextable</span>() <span class="sc">|&gt;</span></span>
<span id="cb29-1639"><a href="#cb29-1639" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">set_caption</span>(<span class="st">"Equation ranking for REDD+ application among log-transformed models)"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1640"><a href="#cb29-1640" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">set_header_labels</span>(</span>
<span id="cb29-1641"><a href="#cb29-1641" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rank =</span> <span class="st">"Rank"</span>,</span>
<span id="cb29-1642"><a href="#cb29-1642" aria-hidden="true" tabindex="-1"></a>    <span class="at">Equation =</span> <span class="st">"Equation Type"</span>,</span>
<span id="cb29-1643"><a href="#cb29-1643" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rel_RMSE_pct =</span> <span class="st">"RMSE (%)"</span>,</span>
<span id="cb29-1644"><a href="#cb29-1644" aria-hidden="true" tabindex="-1"></a>    <span class="at">R2 =</span> <span class="st">"R²"</span>,</span>
<span id="cb29-1645"><a href="#cb29-1645" aria-hidden="true" tabindex="-1"></a>    <span class="at">Credit_Deduction_pct =</span> <span class="st">"Deduction (%)"</span>,</span>
<span id="cb29-1646"><a href="#cb29-1646" aria-hidden="true" tabindex="-1"></a>    <span class="at">Financial_Impact_1M =</span> <span class="st">"Impact @ 1M tCO₂e"</span></span>
<span id="cb29-1647"><a href="#cb29-1647" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb29-1648"><a href="#cb29-1648" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">align</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1649"><a href="#cb29-1649" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">align</span>(<span class="at">j =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"left"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1650"><a href="#cb29-1650" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">align</span>(<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1651"><a href="#cb29-1651" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1652"><a href="#cb29-1652" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">part =</span> <span class="st">"footer"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1653"><a href="#cb29-1653" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1654"><a href="#cb29-1654" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">bold</span>(<span class="at">i =</span> <span class="dv">1</span>, <span class="at">part =</span> <span class="st">"body"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1655"><a href="#cb29-1655" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">add_footer_lines</span>(<span class="st">"Financial impact calculated assuming $5/tonne carbon price. Species-specific equation recommended for Quercus-dominated stands; genus-level provides acceptable alternative when species identification uncertain."</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1656"><a href="#cb29-1656" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">italic</span>(<span class="at">part =</span> <span class="st">"footer"</span>)</span>
<span id="cb29-1657"><a href="#cb29-1657" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-1658"><a href="#cb29-1658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1659"><a href="#cb29-1659" aria-hidden="true" tabindex="-1"></a><span class="fu">### Uncertainty Deductions</span></span>
<span id="cb29-1660"><a href="#cb29-1660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1661"><a href="#cb29-1661" aria-hidden="true" tabindex="-1"></a>Following ART-TREES Equation 11, we calculated the carbon credit deduction for the best-performing model (genus-level log-transformed). The deduction formula converts relative RMSE into a half-width 90% confidence interval, then applies the UA (uncertainty adjustment) factor: $$</span>
<span id="cb29-1662"><a href="#cb29-1662" aria-hidden="true" tabindex="-1"></a>UA_t = 0.524417 \times \frac{HW_{90\%}}{1.645006}</span>
<span id="cb29-1663"><a href="#cb29-1663" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb29-1664"><a href="#cb29-1664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1665"><a href="#cb29-1665" aria-hidden="true" tabindex="-1"></a>Where:</span>
<span id="cb29-1666"><a href="#cb29-1666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1667"><a href="#cb29-1667" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Half-width 90% CI = RMSE (%) / 100</span>
<span id="cb29-1668"><a href="#cb29-1668" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The constant 1.645006 is the z-score for 90% confidence</span>
<span id="cb29-1669"><a href="#cb29-1669" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The constant 0.524417 converts to ART-TREES deduction rate</span>
<span id="cb29-1670"><a href="#cb29-1670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1671"><a href="#cb29-1671" aria-hidden="true" tabindex="-1"></a>For a hypothetical 1M tCO₂e project at \$5/tonne, the calculation proceeds as shown in the output below. Note that the genus-level model's 0.00% RMSE yields zero deduction, which highlights the over-fitting concern mentioned previously. In practice, species-specific or validated generic equations would be more appropriate for MRV reporting. We demonstrate the ART-TREES uncertainty deduction calculationin following section 1.6.</span>
<span id="cb29-1672"><a href="#cb29-1672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1675"><a href="#cb29-1675" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-1676"><a href="#cb29-1676" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-1677"><a href="#cb29-1677" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb29-1678"><a href="#cb29-1678" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-1679"><a href="#cb29-1679" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb29-1680"><a href="#cb29-1680" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb29-1681"><a href="#cb29-1681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1682"><a href="#cb29-1682" aria-hidden="true" tabindex="-1"></a><span class="co"># Select best-performing model (species-specific log)</span></span>
<span id="cb29-1683"><a href="#cb29-1683" aria-hidden="true" tabindex="-1"></a>best_model <span class="ot">&lt;-</span> log_models_ranked[<span class="dv">1</span>, ]</span>
<span id="cb29-1684"><a href="#cb29-1684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1685"><a href="#cb29-1685" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract metrics</span></span>
<span id="cb29-1686"><a href="#cb29-1686" aria-hidden="true" tabindex="-1"></a>rmse_pct <span class="ot">&lt;-</span> best_model<span class="sc">$</span>Rel_RMSE_pct</span>
<span id="cb29-1687"><a href="#cb29-1687" aria-hidden="true" tabindex="-1"></a>hw_90_pct <span class="ot">&lt;-</span> rmse_pct <span class="sc">/</span> <span class="dv">100</span>  <span class="co"># Half-width 90% CI as proportion</span></span>
<span id="cb29-1688"><a href="#cb29-1688" aria-hidden="true" tabindex="-1"></a>ua_factor <span class="ot">&lt;-</span> <span class="fl">0.524417</span> <span class="sc">*</span> (hw_90_pct <span class="sc">/</span> <span class="fl">1.645006</span>)  <span class="co"># ART Equation 11</span></span>
<span id="cb29-1689"><a href="#cb29-1689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1690"><a href="#cb29-1690" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate financial impact for example project</span></span>
<span id="cb29-1691"><a href="#cb29-1691" aria-hidden="true" tabindex="-1"></a>project_tonnes <span class="ot">&lt;-</span> <span class="dv">1000000</span>  <span class="co"># 1M tCO₂e</span></span>
<span id="cb29-1692"><a href="#cb29-1692" aria-hidden="true" tabindex="-1"></a>price_per_tonne <span class="ot">&lt;-</span> <span class="dv">5</span>       <span class="co"># $5/tonne</span></span>
<span id="cb29-1693"><a href="#cb29-1693" aria-hidden="true" tabindex="-1"></a>total_value <span class="ot">&lt;-</span> project_tonnes <span class="sc">*</span> price_per_tonne</span>
<span id="cb29-1694"><a href="#cb29-1694" aria-hidden="true" tabindex="-1"></a>deduction_value <span class="ot">&lt;-</span> total_value <span class="sc">*</span> ua_factor</span>
<span id="cb29-1695"><a href="#cb29-1695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1696"><a href="#cb29-1696" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"=== REDD+ Uncertainty Deduction Example ===</span><span class="sc">\n\n</span><span class="st">"</span>))</span>
<span id="cb29-1697"><a href="#cb29-1697" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Selected Model: %s (log-transformed)</span><span class="sc">\n</span><span class="st">"</span>, best_model<span class="sc">$</span>Equation))</span>
<span id="cb29-1698"><a href="#cb29-1698" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Relative RMSE: %.1f%%</span><span class="sc">\n</span><span class="st">"</span>, rmse_pct))</span>
<span id="cb29-1699"><a href="#cb29-1699" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Half-width 90%% CI: %.4f</span><span class="sc">\n</span><span class="st">"</span>, hw_90_pct))</span>
<span id="cb29-1700"><a href="#cb29-1700" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"UA factor (ART Eq.11): %.6f</span><span class="sc">\n\n</span><span class="st">"</span>, ua_factor))</span>
<span id="cb29-1701"><a href="#cb29-1701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1702"><a href="#cb29-1702" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Project Parameters:</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb29-1703"><a href="#cb29-1703" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"  Total credits: %s tCO₂e</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">format</span>(project_tonnes, <span class="at">big.mark =</span> <span class="st">","</span>)))</span>
<span id="cb29-1704"><a href="#cb29-1704" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"  Carbon price: $%.2f/tonne</span><span class="sc">\n</span><span class="st">"</span>, price_per_tonne))</span>
<span id="cb29-1705"><a href="#cb29-1705" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"  Gross value: $%s</span><span class="sc">\n\n</span><span class="st">"</span>, <span class="fu">format</span>(total_value, <span class="at">big.mark =</span> <span class="st">","</span>)))</span>
<span id="cb29-1706"><a href="#cb29-1706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1707"><a href="#cb29-1707" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Uncertainty Deduction:</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb29-1708"><a href="#cb29-1708" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"  Deduction rate: %.2f%%</span><span class="sc">\n</span><span class="st">"</span>, ua_factor <span class="sc">*</span> <span class="dv">100</span>))</span>
<span id="cb29-1709"><a href="#cb29-1709" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"  Credits deducted: %s tCO₂e</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb29-1710"><a href="#cb29-1710" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(project_tonnes <span class="sc">*</span> ua_factor), <span class="at">big.mark =</span> <span class="st">","</span>)))</span>
<span id="cb29-1711"><a href="#cb29-1711" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"  Revenue loss: $%s</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb29-1712"><a href="#cb29-1712" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(deduction_value), <span class="at">big.mark =</span> <span class="st">","</span>)))</span>
<span id="cb29-1713"><a href="#cb29-1713" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"  Net credited value: $%s</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb29-1714"><a href="#cb29-1714" aria-hidden="true" tabindex="-1"></a>            <span class="fu">format</span>(<span class="fu">round</span>(total_value <span class="sc">-</span> deduction_value), <span class="at">big.mark =</span> <span class="st">","</span>)))</span>
<span id="cb29-1715"><a href="#cb29-1715" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-1716"><a href="#cb29-1716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1717"><a href="#cb29-1717" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb29-1718"><a href="#cb29-1718" aria-hidden="true" tabindex="-1"></a><span class="fu">## Financial Impact</span></span>
<span id="cb29-1719"><a href="#cb29-1719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1720"><a href="#cb29-1720" aria-hidden="true" tabindex="-1"></a>Selecting species-specific over generic equation:</span>
<span id="cb29-1721"><a href="#cb29-1721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1722"><a href="#cb29-1722" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>RMSE improvement: 18.9% =<span class="sc">\&gt;</span> 15.2% (3.7 percentage points)</span>
<span id="cb29-1723"><a href="#cb29-1723" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Deduction reduction: 6.0% =<span class="sc">\&gt;</span> 4.8% (1.2 percentage points)</span>
<span id="cb29-1724"><a href="#cb29-1724" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Revenue protected: \~\$12,000 per million tCO₂e // \$5/tonne</span>
<span id="cb29-1725"><a href="#cb29-1725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1726"><a href="#cb29-1726" aria-hidden="true" tabindex="-1"></a>Over a 30-year REDD+ project crediting period with 100,000 tCO₂e/year:</span>
<span id="cb29-1727"><a href="#cb29-1727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1728"><a href="#cb29-1728" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Total protected revenue: \~\$360,000</span>
<span id="cb29-1729"><a href="#cb29-1729" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Additional cost: \~\$15-30k for species-specific equation development</span>
<span id="cb29-1730"><a href="#cb29-1730" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Return on investment: 12-24x</span>
<span id="cb29-1731"><a href="#cb29-1731" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb29-1732"><a href="#cb29-1732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1733"><a href="#cb29-1733" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.6 Reproducible Workflow[^index-3] {.unnumbered}</span></span>
<span id="cb29-1734"><a href="#cb29-1734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1735"><a href="#cb29-1735" aria-hidden="true" tabindex="-1"></a>This section contains all executable code referenced throughout Chapter 1, organized sequentially to match the conceptual flow of Sections 1.2-1.5. Please note that the entire training and its four chapters markdown can be downloaded as completed scripts from the project’s code repository here and live eBook here.</span>
<span id="cb29-1736"><a href="#cb29-1736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1739"><a href="#cb29-1739" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-1740"><a href="#cb29-1740" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb29-1741"><a href="#cb29-1741" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb29-1742"><a href="#cb29-1742" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb29-1743"><a href="#cb29-1743" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb29-1744"><a href="#cb29-1744" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb29-1745"><a href="#cb29-1745" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb29-1746"><a href="#cb29-1746" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.6.1 Environment Setup</span></span>
<span id="cb29-1747"><a href="#cb29-1747" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb29-1748"><a href="#cb29-1748" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load required packages</span></span>
<span id="cb29-1749"><a href="#cb29-1749" aria-hidden="true" tabindex="-1"></a>easypackages<span class="sc">::</span><span class="fu">packages</span>(</span>
<span id="cb29-1750"><a href="#cb29-1750" aria-hidden="true" tabindex="-1"></a><span class="st">"animation"</span>, <span class="st">"BIOMASS"</span>, <span class="st">"cols4all"</span>, <span class="st">"covr"</span>, <span class="st">"cowplot"</span>, <span class="st">"caret"</span>,</span>
<span id="cb29-1751"><a href="#cb29-1751" aria-hidden="true" tabindex="-1"></a><span class="st">"DescTools"</span>, <span class="st">"dataMaid"</span>, <span class="st">"dplyr"</span>, <span class="st">"FawR"</span>, <span class="st">"ForestToolsRS"</span>, <span class="st">"forestdata"</span>,</span>
<span id="cb29-1752"><a href="#cb29-1752" aria-hidden="true" tabindex="-1"></a><span class="st">"flextable"</span>, <span class="st">"ggplot2"</span>, <span class="st">"giscoR"</span>, <span class="st">"ggfortify"</span>, <span class="st">"htmltools"</span>, <span class="st">"janitor"</span>, <span class="st">"jsonlite"</span>, <span class="st">"lattice"</span>,</span>
<span id="cb29-1753"><a href="#cb29-1753" aria-hidden="true" tabindex="-1"></a><span class="st">"leaflet.providers"</span>, <span class="st">"leaflet"</span>, <span class="st">"lmtest"</span>, <span class="st">"lwgeom"</span>, <span class="st">"kableExtra"</span>, <span class="st">"kernlab"</span>, <span class="st">"knitr"</span>, <span class="st">"mapedit"</span>,</span>
<span id="cb29-1754"><a href="#cb29-1754" aria-hidden="true" tabindex="-1"></a><span class="st">"mapview"</span>, <span class="st">"maptiles"</span>, <span class="st">"Mlmetrics"</span>, <span class="st">"ModelMetrics"</span>, <span class="st">"moments"</span>, <span class="st">"olsrr"</span>, <span class="st">"openxlsx"</span>,</span>
<span id="cb29-1755"><a href="#cb29-1755" aria-hidden="true" tabindex="-1"></a><span class="st">"plotly"</span>, <span class="st">"psych"</span>, <span class="st">"randomForest"</span>, <span class="st">"raster"</span>,<span class="st">"RColorBrewer"</span>, <span class="st">"rmarkdown"</span>, <span class="st">"renv"</span>, <span class="st">"reticulate"</span>,</span>
<span id="cb29-1756"><a href="#cb29-1756" aria-hidden="true" tabindex="-1"></a><span class="st">"s2"</span>, <span class="st">"sf"</span>, <span class="st">"scales"</span>, <span class="st">"sits"</span>,<span class="st">"spdep"</span>, <span class="st">"stars"</span>, <span class="st">"stringr"</span>, <span class="st">"terra"</span>, <span class="st">"tmap"</span>, <span class="st">"tmaptools"</span>,</span>
<span id="cb29-1757"><a href="#cb29-1757" aria-hidden="true" tabindex="-1"></a><span class="st">"tidymodels"</span>, <span class="st">"tidyverse"</span>, <span class="st">"tidyr"</span>, <span class="st">"tune"</span>, <span class="st">"useful"</span>,</span>
<span id="cb29-1758"><a href="#cb29-1758" aria-hidden="true" tabindex="-1"></a><span class="at">prompt =</span> F)</span>
<span id="cb29-1759"><a href="#cb29-1759" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb29-1760"><a href="#cb29-1760" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.6.2 Data Import and Preparation (Section 1.2)</span></span>
<span id="cb29-1761"><a href="#cb29-1761" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb29-1762"><a href="#cb29-1762" aria-hidden="true" tabindex="-1"></a><span class="co"># import dataset from allodb.pkg</span></span>
<span id="cb29-1763"><a href="#cb29-1763" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"allodb"</span>)</span>
<span id="cb29-1764"><a href="#cb29-1764" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(scbi_stem1)</span>
<span id="cb29-1765"><a href="#cb29-1765" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> Parallel development of Python cells was paused to concentrate efforts on delivering a completed R workflow. However, initial</span>
<span id="cb29-1766"><a href="#cb29-1766" aria-hidden="true" tabindex="-1"></a>python code was preserved <span class="cf">in</span> each chapter’s markdown file and can be rendered from cloning the repository and adjusting <span class="st">`</span><span class="at">echo</span><span class="st">`</span></span>
<span id="cb29-1767"><a href="#cb29-1767" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> to reveal and run python operations and compare computations.</span>
<span id="cb29-1768"><a href="#cb29-1768" aria-hidden="true" tabindex="-1"></a><span class="dv">24</span></span>
<span id="cb29-1769"><a href="#cb29-1769" aria-hidden="true" tabindex="-1"></a>scbi_stem1 <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">group_by</span>(Family, genus, species) <span class="sc">|&gt;</span></span>
<span id="cb29-1770"><a href="#cb29-1770" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="st">`</span><span class="at">Total Trees (n)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb29-1771"><a href="#cb29-1771" aria-hidden="true" tabindex="-1"></a>flextable<span class="sc">::</span><span class="fu">flextable</span>()<span class="sc">|&gt;</span> </span>
<span id="cb29-1772"><a href="#cb29-1772" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1773"><a href="#cb29-1773" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">part =</span> <span class="st">"footer"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1774"><a href="#cb29-1774" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width=</span><span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">head</span>() <span class="co"># top10 rows only</span></span>
<span id="cb29-1775"><a href="#cb29-1775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1776"><a href="#cb29-1776" aria-hidden="true" tabindex="-1"></a><span class="co"># Genus-specific subsample of dataset</span></span>
<span id="cb29-1777"><a href="#cb29-1777" aria-hidden="true" tabindex="-1"></a>scbi_quercus <span class="ot">=</span> scbi_stem1 <span class="sc">|&gt;</span></span>
<span id="cb29-1778"><a href="#cb29-1778" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dbh)) <span class="sc">|&gt;</span></span>
<span id="cb29-1779"><a href="#cb29-1779" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(genus <span class="sc">==</span> <span class="st">"Quercus"</span>)</span>
<span id="cb29-1780"><a href="#cb29-1780" aria-hidden="true" tabindex="-1"></a><span class="co"># Species-specific subsample of dataset</span></span>
<span id="cb29-1781"><a href="#cb29-1781" aria-hidden="true" tabindex="-1"></a>scbi_quercus_rubra <span class="ot">=</span> scbi_stem1 <span class="sc">|&gt;</span></span>
<span id="cb29-1782"><a href="#cb29-1782" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dbh)) <span class="sc">|&gt;</span></span>
<span id="cb29-1783"><a href="#cb29-1783" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(genus <span class="sc">==</span> <span class="st">"Quercus"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-1784"><a href="#cb29-1784" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"rubra"</span>)</span>
<span id="cb29-1785"><a href="#cb29-1785" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb29-1786"><a href="#cb29-1786" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.6.3 Equation Selection (Section 1.2)</span></span>
<span id="cb29-1787"><a href="#cb29-1787" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------------------------------------------</span></span>
<span id="cb29-1788"><a href="#cb29-1788" aria-hidden="true" tabindex="-1"></a><span class="co"># Load allometric equations</span></span>
<span id="cb29-1789"><a href="#cb29-1789" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(equations)</span>
<span id="cb29-1790"><a href="#cb29-1790" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"equations_metadata"</span>)</span>
<span id="cb29-1791"><a href="#cb29-1791" aria-hidden="true" tabindex="-1"></a><span class="co"># display all equation criteria</span></span>
<span id="cb29-1792"><a href="#cb29-1792" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(equations)</span>
<span id="cb29-1793"><a href="#cb29-1793" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> Rows<span class="sc">:</span> <span class="dv">570</span></span>
<span id="cb29-1794"><a href="#cb29-1794" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> Columns<span class="sc">:</span> <span class="dv">47</span></span>
<span id="cb29-1795"><a href="#cb29-1795" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">$</span> ref_id <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="st">"barney_1977_bdac"</span>, <span class="st">"baskerville_1966_dmp…</span></span>
<span id="cb29-1796"><a href="#cb29-1796" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ equation_id &lt;chr&gt; "</span><span class="dv">4</span>b4063<span class="st">", "</span>e2c7c7<span class="st">", "</span>e42e41<span class="st">", "</span><span class="dv">2</span>bc879<span class="st">", "</span>…</span>
<span id="cb29-1797"><a href="#cb29-1797" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">$</span> equation_allometry <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="st">"exp(3.63+2.54*log(dbh))"</span>, <span class="st">"exp(0.15+2.48…</span></span>
<span id="cb29-1798"><a href="#cb29-1798" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ equation_form &lt;chr&gt; "</span><span class="fu">exp</span>(a<span class="sc">+</span>b<span class="sc">*</span><span class="fu">log</span>(dbh))<span class="st">", "</span><span class="fu">exp</span>(a<span class="sc">+</span>b<span class="sc">*</span>(<span class="fu">log</span>(dbh))<span class="st">"…</span></span>
<span id="cb29-1799"><a href="#cb29-1799" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ dependent_variable &lt;chr&gt; "</span>Total aboveground biomass<span class="st">", "</span>Total above…</span>
<span id="cb29-1800"><a href="#cb29-1800" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">$</span> independent_variable <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="st">"DBH"</span>, <span class="st">"DBH"</span>, <span class="st">"DBH"</span>, <span class="st">"DBH"</span>, <span class="st">"DBH"</span>, <span class="st">"DBH"</span>,…</span>
<span id="cb29-1801"><a href="#cb29-1801" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">$</span> equation_taxa <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="st">"Picea mariana"</span>, <span class="st">"Picea glauca"</span>, <span class="st">"Betula"</span>…</span>
<span id="cb29-1802"><a href="#cb29-1802" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">$</span> allometry_specificity <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="st">"Species"</span>, <span class="st">"Species"</span>, <span class="st">"Genus"</span>, <span class="st">"Genus"</span>, <span class="st">"…</span></span>
<span id="cb29-1803"><a href="#cb29-1803" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ equation_categ &lt;chr&gt; "</span>sp_spec<span class="st">", "</span>sp_spec<span class="st">", "</span>generic<span class="st">", "</span>generic…</span>
<span id="cb29-1804"><a href="#cb29-1804" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="sc">$</span> geographic_area <span class="sc">&lt;</span>chr<span class="sc">&gt;</span> <span class="st">"Alaska, USA"</span>, <span class="st">"New Brunswick, Canada"</span>, <span class="st">"…</span></span>
<span id="cb29-1805"><a href="#cb29-1805" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ original_coord &lt;chr&gt; "</span><span class="dv">64</span>\xb0 <span class="dv">45</span><span class="st">', 148</span><span class="sc">\xb0</span><span class="st"> 15'", "</span><span class="dv">47</span>\xb051<span class="st">' N, …</span></span>
<span id="cb29-1806"><a href="#cb29-1806" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ lat &lt;chr&gt; "65.75", "47.9", "NRA", "NRA", "NRA", "NR…</span></span>
<span id="cb29-1807"><a href="#cb29-1807" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ long &lt;chr&gt; "-148.25", "-68.3", "NRA", "NRA", "NRA", …</span></span>
<span id="cb29-1808"><a href="#cb29-1808" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ elev_m &lt;chr&gt; "167-470", "500", "NRA", "NRA", "NRA", "N…</span></span>
<span id="cb29-1809"><a href="#cb29-1809" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ geography_notes &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</span></span>
<span id="cb29-1810"><a href="#cb29-1810" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ mat_C &lt;chr&gt; "NI", "2.2", "NRA", "NRA", "NRA", "NRA", …</span></span>
<span id="cb29-1811"><a href="#cb29-1811" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ min.temp_C &lt;chr&gt; "NI", "NI", "NRA", "NRA", "NRA", "NRA", "…</span></span>
<span id="cb29-1812"><a href="#cb29-1812" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ max.temp_C &lt;chr&gt; "NI", "NI", "NRA", "NRA", "NRA", "NRA", "…</span></span>
<span id="cb29-1813"><a href="#cb29-1813" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ map_mm &lt;chr&gt; "NI", "1069", "NRA", "NRA", "NRA", "NRA",…</span></span>
<span id="cb29-1814"><a href="#cb29-1814" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ frost_free_period_days &lt;chr&gt; "NI", "110", "NRA", "NRA", "NRA", "NRA", …</span></span>
<span id="cb29-1815"><a href="#cb29-1815" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ climate_notes &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</span></span>
<span id="cb29-1816"><a href="#cb29-1816" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ stand_age_range_yr &lt;chr&gt; "51-55 yrs", "35-48 yrs", "NRA", "NRA", "…</span></span>
<span id="cb29-1817"><a href="#cb29-1817" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ stand_age_history &lt;chr&gt; "Recent fires in 1977", "Stand originated…</span></span>
<span id="cb29-1818"><a href="#cb29-1818" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ stand_basal_area_m2_ha &lt;chr&gt; "NI", "NI", "NRA", "NRA", "NRA", "NRA", "…</span></span>
<span id="cb29-1819"><a href="#cb29-1819" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ stand_trees_ha &lt;chr&gt; "NI", "NI", "NRA", "NRA", "NRA", "NRA", "…</span></span>
<span id="cb29-1820"><a href="#cb29-1820" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ forest_description &lt;chr&gt; "Typical lowland and upland stands domina…</span></span>
<span id="cb29-1821"><a href="#cb29-1821" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ ecosystem_type &lt;chr&gt; "Temperate forest", "Boreal forest", "Tem…</span></span>
<span id="cb29-1822"><a href="#cb29-1822" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ koppen &lt;chr&gt; "Dfc", "Dfb", "Dfb; Cfa", "Dfb; Cfa", "Df…</span></span>
<span id="cb29-1823"><a href="#cb29-1823" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ dbh_min_cm &lt;chr&gt; "1.5", "2.54", "5", "NRA", "5", "NRA", "5…</span></span>
<span id="cb29-1824"><a href="#cb29-1824" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ dbh_max_cm &lt;chr&gt; "13", "25.4", "NRA", "NRA", "NRA", "NRA",…</span></span>
<span id="cb29-1825"><a href="#cb29-1825" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ sample_size &lt;chr&gt; "18", "13", "NRA", "NRA", "NRA", "NRA", "…</span></span>
<span id="cb29-1826"><a href="#cb29-1826" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ collection_year &lt;chr&gt; "1973", "1965", "1971, 1995", "1971, 1995…</span></span>
<span id="cb29-1827"><a href="#cb29-1827" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ dbh_units_original &lt;chr&gt; "cm", "inch", "cm", "cm", "cm", "cm", "cm…</span></span>
<span id="cb29-1828"><a href="#cb29-1828" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ dbh_unit_CF &lt;chr&gt; "1", "0.393701", "1", "1", "1", "1", "1",…</span></span>
<span id="cb29-1829"><a href="#cb29-1829" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ output_units_original &lt;chr&gt; "g", "lbs", "metric_ton", "m", "metric_to…</span></span>
<span id="cb29-1830"><a href="#cb29-1830" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ output_units_CF &lt;chr&gt; "0.001", "0.453592", "1000", "1", "1000",…</span></span>
<span id="cb29-1831"><a href="#cb29-1831" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ allometry_development_method &lt;chr&gt; "harvest", "harvest", "harvest?", "harves…</span></span>
<span id="cb29-1832"><a href="#cb29-1832" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ regression_model &lt;chr&gt; "log-transformed", "log-transformed", NA,…</span></span>
<span id="cb29-1833"><a href="#cb29-1833" aria-hidden="true" tabindex="-1"></a><span class="st">25</span></span>
<span id="cb29-1834"><a href="#cb29-1834" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ r_squared &lt;chr&gt; "0.91", "0.99", "NI", "NI", "NI", "NI", "…</span></span>
<span id="cb29-1835"><a href="#cb29-1835" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ other_equations_tested &lt;chr&gt; "NI", "NI", "NRA", "NRA", "NRA", "NRA", "…</span></span>
<span id="cb29-1836"><a href="#cb29-1836" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ log_biomass &lt;chr&gt; "1", "1", "1", "0", "1", "0", "1", "0", "…</span></span>
<span id="cb29-1837"><a href="#cb29-1837" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ bias_corrected &lt;chr&gt; "0", "0", NA, NA, NA, NA, NA, NA, NA, NA,…</span></span>
<span id="cb29-1838"><a href="#cb29-1838" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ bias_correction_factor &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</span></span>
<span id="cb29-1839"><a href="#cb29-1839" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ notes_fitting_model &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</span></span>
<span id="cb29-1840"><a href="#cb29-1840" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ original_equation_id &lt;chr&gt; "Upland black spruce", NA, NA, NA, NA, NA…</span></span>
<span id="cb29-1841"><a href="#cb29-1841" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ original_data_availability &lt;chr&gt; "NRA", "NRA", "NRA", "NRA", "NRA", "NRA",…</span></span>
<span id="cb29-1842"><a href="#cb29-1842" aria-hidden="true" tabindex="-1"></a><span class="st">NA $ equation_notes &lt;chr&gt; NA, NA, "Proved difficult to obtain origi…</span></span>
<span id="cb29-1843"><a href="#cb29-1843" aria-hidden="true" tabindex="-1"></a><span class="st"># Simple North America filter</span></span>
<span id="cb29-1844"><a href="#cb29-1844" aria-hidden="true" tabindex="-1"></a><span class="st">eq_region &lt;- equations |&gt;</span></span>
<span id="cb29-1845"><a href="#cb29-1845" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::mutate(lat = as.numeric(lat), long = as.numeric(long)) |&gt;</span></span>
<span id="cb29-1846"><a href="#cb29-1846" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::filter(!is.na(lat), !is.na(long), lat &gt;= 24, lat &lt;= 72, long &gt;= -168, long &lt;= -52)</span></span>
<span id="cb29-1847"><a href="#cb29-1847" aria-hidden="true" tabindex="-1"></a><span class="st"># tabulate</span></span>
<span id="cb29-1848"><a href="#cb29-1848" aria-hidden="true" tabindex="-1"></a><span class="st">show_cols = c("ref_id", "equation_taxa", "allometry_specificity", "equation_allometry")</span></span>
<span id="cb29-1849"><a href="#cb29-1849" aria-hidden="true" tabindex="-1"></a><span class="st">head(eq_region[, show_cols]) |&gt; flextable::flextable() |&gt; flextable::autofit() # top six rows only</span></span>
<span id="cb29-1850"><a href="#cb29-1850" aria-hidden="true" tabindex="-1"></a><span class="st"># species-specific equations for all Quercus subspecies of North America</span></span>
<span id="cb29-1851"><a href="#cb29-1851" aria-hidden="true" tabindex="-1"></a><span class="st">eq_region_species &lt;- eq_region |&gt;</span></span>
<span id="cb29-1852"><a href="#cb29-1852" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::filter(allometry_specificity == "Species") |&gt;</span></span>
<span id="cb29-1853"><a href="#cb29-1853" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::filter(grepl("^Quercus", equation_taxa, ignore.case = TRUE) | # Starts with "Quercus"</span></span>
<span id="cb29-1854"><a href="#cb29-1854" aria-hidden="true" tabindex="-1"></a><span class="st">(allometry_specificity %in% c("Genus", "Family") &amp;</span></span>
<span id="cb29-1855"><a href="#cb29-1855" aria-hidden="true" tabindex="-1"></a><span class="st">grepl("Quercus", equation_taxa, ignore.case = TRUE))</span></span>
<span id="cb29-1856"><a href="#cb29-1856" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb29-1857"><a href="#cb29-1857" aria-hidden="true" tabindex="-1"></a><span class="st"># genus-specific equations for Quercus populations of North America</span></span>
<span id="cb29-1858"><a href="#cb29-1858" aria-hidden="true" tabindex="-1"></a><span class="st">eq_region_genus = eq_region |&gt;</span></span>
<span id="cb29-1859"><a href="#cb29-1859" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::filter(allometry_specificity == "Genus") |&gt;</span></span>
<span id="cb29-1860"><a href="#cb29-1860" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::filter(grepl("^Quercus", equation_taxa, ignore.case = TRUE) | # Starts with "Quercus"</span></span>
<span id="cb29-1861"><a href="#cb29-1861" aria-hidden="true" tabindex="-1"></a><span class="st">(allometry_specificity %in% c("Genus", "Family") &amp;</span></span>
<span id="cb29-1862"><a href="#cb29-1862" aria-hidden="true" tabindex="-1"></a><span class="st">grepl("Quercus", equation_taxa, ignore.case = TRUE))</span></span>
<span id="cb29-1863"><a href="#cb29-1863" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb29-1864"><a href="#cb29-1864" aria-hidden="true" tabindex="-1"></a><span class="st"># tabulate</span></span>
<span id="cb29-1865"><a href="#cb29-1865" aria-hidden="true" tabindex="-1"></a><span class="st">flextable::flextable(eq_region_species[, show_cols]) |&gt; flextable::autofit()</span></span>
<span id="cb29-1866"><a href="#cb29-1866" aria-hidden="true" tabindex="-1"></a><span class="st"># filter genus-specific equations by DBH range of field data</span></span>
<span id="cb29-1867"><a href="#cb29-1867" aria-hidden="true" tabindex="-1"></a><span class="st">field_dbh_min &lt;- min(scbi_quercus$dbh, na.rm = T) # 1.04 cm</span></span>
<span id="cb29-1868"><a href="#cb29-1868" aria-hidden="true" tabindex="-1"></a><span class="st">field_dbh_max &lt;- max(scbi_quercus$dbh, na.rm = T) # 83.5 cm</span></span>
<span id="cb29-1869"><a href="#cb29-1869" aria-hidden="true" tabindex="-1"></a><span class="st">eq_region_genus_dbh &lt;- eq_region_genus |&gt;</span></span>
<span id="cb29-1870"><a href="#cb29-1870" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::mutate(</span></span>
<span id="cb29-1871"><a href="#cb29-1871" aria-hidden="true" tabindex="-1"></a><span class="st">dbh_min_cm = as.numeric(dbh_min_cm),</span></span>
<span id="cb29-1872"><a href="#cb29-1872" aria-hidden="true" tabindex="-1"></a><span class="st">dbh_max_cm = as.numeric(dbh_max_cm)) |&gt;</span></span>
<span id="cb29-1873"><a href="#cb29-1873" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::filter(!is.na(dbh_min_cm), !is.na(dbh_max_cm),</span></span>
<span id="cb29-1874"><a href="#cb29-1874" aria-hidden="true" tabindex="-1"></a><span class="st"># extrapolation of saplings (min=20cm), compensated below (Audit risk if sapling count is high)</span></span>
<span id="cb29-1875"><a href="#cb29-1875" aria-hidden="true" tabindex="-1"></a><span class="st">dbh_min_cm &lt;= field_dbh_min * 20,</span></span>
<span id="cb29-1876"><a href="#cb29-1876" aria-hidden="true" tabindex="-1"></a><span class="st">dbh_max_cm &gt;= field_dbh_max)</span></span>
<span id="cb29-1877"><a href="#cb29-1877" aria-hidden="true" tabindex="-1"></a><span class="st">eq_region_species_dbh &lt;- eq_region_species |&gt;</span></span>
<span id="cb29-1878"><a href="#cb29-1878" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::mutate(</span></span>
<span id="cb29-1879"><a href="#cb29-1879" aria-hidden="true" tabindex="-1"></a><span class="st">dbh_min_cm = as.numeric(dbh_min_cm),</span></span>
<span id="cb29-1880"><a href="#cb29-1880" aria-hidden="true" tabindex="-1"></a><span class="st">dbh_max_cm = as.numeric(dbh_max_cm)) |&gt;</span></span>
<span id="cb29-1881"><a href="#cb29-1881" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::filter(!is.na(dbh_min_cm), !is.na(dbh_max_cm),</span></span>
<span id="cb29-1882"><a href="#cb29-1882" aria-hidden="true" tabindex="-1"></a><span class="st">dbh_max_cm &gt;= field_dbh_max * 0.7)</span></span>
<span id="cb29-1883"><a href="#cb29-1883" aria-hidden="true" tabindex="-1"></a><span class="st">26</span></span>
<span id="cb29-1884"><a href="#cb29-1884" aria-hidden="true" tabindex="-1"></a><span class="st"># extrapolation of crowns allowed, consider outliers</span></span>
<span id="cb29-1885"><a href="#cb29-1885" aria-hidden="true" tabindex="-1"></a><span class="st">flextable::flextable(eq_region_genus_dbh[, show_cols]) |&gt; flextable::autofit()</span></span>
<span id="cb29-1886"><a href="#cb29-1886" aria-hidden="true" tabindex="-1"></a><span class="st">flextable::flextable(eq_region_species_dbh[, show_cols]) |&gt; flextable::autofit()</span></span>
<span id="cb29-1887"><a href="#cb29-1887" aria-hidden="true" tabindex="-1"></a><span class="st"># Sample size filtering</span></span>
<span id="cb29-1888"><a href="#cb29-1888" aria-hidden="true" tabindex="-1"></a><span class="st">eq_region_genus_dbh_sample &lt;- eq_region_genus_dbh |&gt;</span></span>
<span id="cb29-1889"><a href="#cb29-1889" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::filter(sample_size &gt;= 17) # Minimum for genus-specific equations</span></span>
<span id="cb29-1890"><a href="#cb29-1890" aria-hidden="true" tabindex="-1"></a><span class="st">eq_region_species_dbh_sample &lt;- eq_region_species_dbh |&gt;</span></span>
<span id="cb29-1891"><a href="#cb29-1891" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::filter(sample_size &gt;= 17) # Minimum for species-specific equations</span></span>
<span id="cb29-1892"><a href="#cb29-1892" aria-hidden="true" tabindex="-1"></a><span class="st"># Display selected equations &amp; tally valid equations remaining</span></span>
<span id="cb29-1893"><a href="#cb29-1893" aria-hidden="true" tabindex="-1"></a><span class="st">flextable::flextable(eq_region_genus_dbh_sample[, show_cols]) |&gt; flextable::autofit()</span></span>
<span id="cb29-1894"><a href="#cb29-1894" aria-hidden="true" tabindex="-1"></a><span class="st">flextable::flextable(eq_region_species_dbh_sample[, show_cols]) |&gt; flextable::autofit()</span></span>
<span id="cb29-1895"><a href="#cb29-1895" aria-hidden="true" tabindex="-1"></a><span class="st"># This table includes filtered default Acer equations AND custom new equations.</span></span>
<span id="cb29-1896"><a href="#cb29-1896" aria-hidden="true" tabindex="-1"></a><span class="st">eq_tab_combined &lt;- new_equations(</span></span>
<span id="cb29-1897"><a href="#cb29-1897" aria-hidden="true" tabindex="-1"></a><span class="st">subset_taxa = "Quercus",</span></span>
<span id="cb29-1898"><a href="#cb29-1898" aria-hidden="true" tabindex="-1"></a><span class="st">new_taxa = c("Quercus ilex", "Castanea sativa"),</span></span>
<span id="cb29-1899"><a href="#cb29-1899" aria-hidden="true" tabindex="-1"></a><span class="st">new_allometry = c("0.12*dbh^2.5", "0.15*dbh^2.7"),</span></span>
<span id="cb29-1900"><a href="#cb29-1900" aria-hidden="true" tabindex="-1"></a><span class="st">new_coords = c(4, 44),</span></span>
<span id="cb29-1901"><a href="#cb29-1901" aria-hidden="true" tabindex="-1"></a><span class="st">new_min_dbh = c(5, 10),</span></span>
<span id="cb29-1902"><a href="#cb29-1902" aria-hidden="true" tabindex="-1"></a><span class="st">new_max_dbh = c(35, 68),</span></span>
<span id="cb29-1903"><a href="#cb29-1903" aria-hidden="true" tabindex="-1"></a><span class="st">new_sample_size = c(143, 62)</span></span>
<span id="cb29-1904"><a href="#cb29-1904" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb29-1905"><a href="#cb29-1905" aria-hidden="true" tabindex="-1"></a><span class="st"># The get_biomass() function internally performs the weighting, resampling,</span></span>
<span id="cb29-1906"><a href="#cb29-1906" aria-hidden="true" tabindex="-1"></a><span class="st"># and calibration based on the equations in eq_tab_combined.</span></span>
<span id="cb29-1907"><a href="#cb29-1907" aria-hidden="true" tabindex="-1"></a><span class="st">agb_custom_estimate &lt;- get_biomass(</span></span>
<span id="cb29-1908"><a href="#cb29-1908" aria-hidden="true" tabindex="-1"></a><span class="st">dbh = 50,</span></span>
<span id="cb29-1909"><a href="#cb29-1909" aria-hidden="true" tabindex="-1"></a><span class="st">genus = "Quercus",</span></span>
<span id="cb29-1910"><a href="#cb29-1910" aria-hidden="true" tabindex="-1"></a><span class="st">species = "rubrum",</span></span>
<span id="cb29-1911"><a href="#cb29-1911" aria-hidden="true" tabindex="-1"></a><span class="st">coords = c(-78.2, 38.9),</span></span>
<span id="cb29-1912"><a href="#cb29-1912" aria-hidden="true" tabindex="-1"></a><span class="st">new_eqtable = eq_tab_combined # Use the consolidated custom table</span></span>
<span id="cb29-1913"><a href="#cb29-1913" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb29-1914"><a href="#cb29-1914" aria-hidden="true" tabindex="-1"></a><span class="st"># Print the resulting AGB estimate</span></span>
<span id="cb29-1915"><a href="#cb29-1915" aria-hidden="true" tabindex="-1"></a><span class="st">print(paste("Estimated AGB using the combined custom table:", agb_custom_estimate, "kg"))</span></span>
<span id="cb29-1916"><a href="#cb29-1916" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb29-1917"><a href="#cb29-1917" aria-hidden="true" tabindex="-1"></a><span class="st"># 1.6.4 Biomass Estimation (Section 1.2)</span></span>
<span id="cb29-1918"><a href="#cb29-1918" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb29-1919"><a href="#cb29-1919" aria-hidden="true" tabindex="-1"></a><span class="st"># once allometry equation is confirmed, use native allodb to load it</span></span>
<span id="cb29-1920"><a href="#cb29-1920" aria-hidden="true" tabindex="-1"></a><span class="st">eq_region_genus_dbh_sample = allodb::new_equations(subset_ids = "a664c1")</span></span>
<span id="cb29-1921"><a href="#cb29-1921" aria-hidden="true" tabindex="-1"></a><span class="st"># species-specific biomass estimates</span></span>
<span id="cb29-1922"><a href="#cb29-1922" aria-hidden="true" tabindex="-1"></a><span class="st">scbi_quercus$agb_species &lt;- allodb::get_biomass(</span></span>
<span id="cb29-1923"><a href="#cb29-1923" aria-hidden="true" tabindex="-1"></a><span class="st">dbh = scbi_quercus$dbh,</span></span>
<span id="cb29-1924"><a href="#cb29-1924" aria-hidden="true" tabindex="-1"></a><span class="st">genus = scbi_quercus$genus,</span></span>
<span id="cb29-1925"><a href="#cb29-1925" aria-hidden="true" tabindex="-1"></a><span class="st">species = scbi_quercus$species,</span></span>
<span id="cb29-1926"><a href="#cb29-1926" aria-hidden="true" tabindex="-1"></a><span class="st">coords = c(-78.2, 38.9)</span></span>
<span id="cb29-1927"><a href="#cb29-1927" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb29-1928"><a href="#cb29-1928" aria-hidden="true" tabindex="-1"></a><span class="st"># genus-specific biomass estimates</span></span>
<span id="cb29-1929"><a href="#cb29-1929" aria-hidden="true" tabindex="-1"></a><span class="st">scbi_quercus$agb_genus &lt;- allodb::get_biomass(</span></span>
<span id="cb29-1930"><a href="#cb29-1930" aria-hidden="true" tabindex="-1"></a><span class="st">dbh = scbi_quercus$dbh,</span></span>
<span id="cb29-1931"><a href="#cb29-1931" aria-hidden="true" tabindex="-1"></a><span class="st">genus = scbi_quercus$genus,</span></span>
<span id="cb29-1932"><a href="#cb29-1932" aria-hidden="true" tabindex="-1"></a><span class="st">species = scbi_quercus$species,</span></span>
<span id="cb29-1933"><a href="#cb29-1933" aria-hidden="true" tabindex="-1"></a><span class="st">27</span></span>
<span id="cb29-1934"><a href="#cb29-1934" aria-hidden="true" tabindex="-1"></a><span class="st">coords = c(-78.2, 38.9),</span></span>
<span id="cb29-1935"><a href="#cb29-1935" aria-hidden="true" tabindex="-1"></a><span class="st">new_eqtable = eq_region_genus_dbh_sample</span></span>
<span id="cb29-1936"><a href="#cb29-1936" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb29-1937"><a href="#cb29-1937" aria-hidden="true" tabindex="-1"></a><span class="st"># derive generic estimates using standard equations</span></span>
<span id="cb29-1938"><a href="#cb29-1938" aria-hidden="true" tabindex="-1"></a><span class="st">wood_densities &lt;- BIOMASS::getWoodDensity(</span></span>
<span id="cb29-1939"><a href="#cb29-1939" aria-hidden="true" tabindex="-1"></a><span class="st">genus = scbi_quercus$genus,</span></span>
<span id="cb29-1940"><a href="#cb29-1940" aria-hidden="true" tabindex="-1"></a><span class="st">species = scbi_quercus$species,</span></span>
<span id="cb29-1941"><a href="#cb29-1941" aria-hidden="true" tabindex="-1"></a><span class="st">stand = scbi_quercus$Plot)</span></span>
<span id="cb29-1942"><a href="#cb29-1942" aria-hidden="true" tabindex="-1"></a><span class="st">scbi_quercus$WD &lt;- wood_densities$meanWD</span></span>
<span id="cb29-1943"><a href="#cb29-1943" aria-hidden="true" tabindex="-1"></a><span class="st"># Chave et al 2014</span></span>
<span id="cb29-1944"><a href="#cb29-1944" aria-hidden="true" tabindex="-1"></a><span class="st">scbi_quercus$agb_chave2014 &lt;- BIOMASS::computeAGB(</span></span>
<span id="cb29-1945"><a href="#cb29-1945" aria-hidden="true" tabindex="-1"></a><span class="st">D = scbi_quercus$dbh,</span></span>
<span id="cb29-1946"><a href="#cb29-1946" aria-hidden="true" tabindex="-1"></a><span class="st">WD = scbi_quercus$WD,</span></span>
<span id="cb29-1947"><a href="#cb29-1947" aria-hidden="true" tabindex="-1"></a><span class="st">coord = c(-78.2, 38.9))</span></span>
<span id="cb29-1948"><a href="#cb29-1948" aria-hidden="true" tabindex="-1"></a><span class="st"># convert units</span></span>
<span id="cb29-1949"><a href="#cb29-1949" aria-hidden="true" tabindex="-1"></a><span class="st">scbi_quercus$agb_chave2014 = scbi_quercus$agb_chave2014 * 1000</span></span>
<span id="cb29-1950"><a href="#cb29-1950" aria-hidden="true" tabindex="-1"></a><span class="st"># Chave et al 2005 (MANUAL Fit)</span></span>
<span id="cb29-1951"><a href="#cb29-1951" aria-hidden="true" tabindex="-1"></a><span class="st">scbi_quercus$agb_chave2005 &lt;- scbi_quercus$WD *</span></span>
<span id="cb29-1952"><a href="#cb29-1952" aria-hidden="true" tabindex="-1"></a><span class="st">exp(-1.499 + 2.148*log(scbi_quercus$dbh) +</span></span>
<span id="cb29-1953"><a href="#cb29-1953" aria-hidden="true" tabindex="-1"></a><span class="st">0.207*(log(scbi_quercus$dbh))^2 -</span></span>
<span id="cb29-1954"><a href="#cb29-1954" aria-hidden="true" tabindex="-1"></a><span class="st">0.0281*(log(scbi_quercus$dbh))^3)</span></span>
<span id="cb29-1955"><a href="#cb29-1955" aria-hidden="true" tabindex="-1"></a><span class="st"># Brown et al 1997 (MANUAL Fit)</span></span>
<span id="cb29-1956"><a href="#cb29-1956" aria-hidden="true" tabindex="-1"></a><span class="st">scbi_quercus$agb_brown1997 &lt;- exp(2.134 + 2.53 * log(scbi_quercus$dbh))</span></span>
<span id="cb29-1957"><a href="#cb29-1957" aria-hidden="true" tabindex="-1"></a><span class="st">scbi_quercus$agb_brown1997 = scbi_quercus$agb_brown1997 / 100</span></span>
<span id="cb29-1958"><a href="#cb29-1958" aria-hidden="true" tabindex="-1"></a><span class="st">flextable::flextable(scbi_quercus) |&gt;</span></span>
<span id="cb29-1959"><a href="#cb29-1959" aria-hidden="true" tabindex="-1"></a><span class="st">flextable::autofit() |&gt; head() |&gt;</span></span>
<span id="cb29-1960"><a href="#cb29-1960" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb29-1961"><a href="#cb29-1961" aria-hidden="true" tabindex="-1"></a><span class="st"># 1.6.5 Normality Testing (Section 1.3)</span></span>
<span id="cb29-1962"><a href="#cb29-1962" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb29-1963"><a href="#cb29-1963" aria-hidden="true" tabindex="-1"></a><span class="st"># Calculate skewness and kurtosis for DBH</span></span>
<span id="cb29-1964"><a href="#cb29-1964" aria-hidden="true" tabindex="-1"></a><span class="st">dbh_skew = moments::skewness(scbi_quercus$dbh)</span></span>
<span id="cb29-1965"><a href="#cb29-1965" aria-hidden="true" tabindex="-1"></a><span class="st">dbh_kurt = moments::kurtosis(scbi_quercus$dbh)</span></span>
<span id="cb29-1966"><a href="#cb29-1966" aria-hidden="true" tabindex="-1"></a><span class="st">dbh_shapiro = stats::shapiro.test(scbi_quercus$dbh)</span></span>
<span id="cb29-1967"><a href="#cb29-1967" aria-hidden="true" tabindex="-1"></a><span class="st">dbh_wilcox = stats::wilcox.test(scbi_quercus$dbh)</span></span>
<span id="cb29-1968"><a href="#cb29-1968" aria-hidden="true" tabindex="-1"></a><span class="st"># Calculate skewness and kurtosis for each AGB estimate</span></span>
<span id="cb29-1969"><a href="#cb29-1969" aria-hidden="true" tabindex="-1"></a><span class="st">agb_species_skew = moments::skewness(scbi_quercus$agb_species)</span></span>
<span id="cb29-1970"><a href="#cb29-1970" aria-hidden="true" tabindex="-1"></a><span class="st">agb_species_kurt = moments::kurtosis(scbi_quercus$agb_species)</span></span>
<span id="cb29-1971"><a href="#cb29-1971" aria-hidden="true" tabindex="-1"></a><span class="st">agb_species_shapiro = stats::shapiro.test(scbi_quercus$agb_species)</span></span>
<span id="cb29-1972"><a href="#cb29-1972" aria-hidden="true" tabindex="-1"></a><span class="st">agb_species_wilcox = stats::wilcox.test(scbi_quercus$agb_species)</span></span>
<span id="cb29-1973"><a href="#cb29-1973" aria-hidden="true" tabindex="-1"></a><span class="st">agb_genus_skew = moments::skewness(scbi_quercus$agb_genus)</span></span>
<span id="cb29-1974"><a href="#cb29-1974" aria-hidden="true" tabindex="-1"></a><span class="st">agb_genus_kurt = moments::kurtosis(scbi_quercus$agb_genus)</span></span>
<span id="cb29-1975"><a href="#cb29-1975" aria-hidden="true" tabindex="-1"></a><span class="st">agb_genus_shapiro = stats::shapiro.test(scbi_quercus$agb_genus)</span></span>
<span id="cb29-1976"><a href="#cb29-1976" aria-hidden="true" tabindex="-1"></a><span class="st">agb_genus_wilcox = stats::wilcox.test(scbi_quercus$agb_genus)</span></span>
<span id="cb29-1977"><a href="#cb29-1977" aria-hidden="true" tabindex="-1"></a><span class="st">agb_chave2014_skew = moments::skewness(scbi_quercus$agb_chave2014)</span></span>
<span id="cb29-1978"><a href="#cb29-1978" aria-hidden="true" tabindex="-1"></a><span class="st">agb_chave2014_kurt = moments::kurtosis(scbi_quercus$agb_chave2014)</span></span>
<span id="cb29-1979"><a href="#cb29-1979" aria-hidden="true" tabindex="-1"></a><span class="st">agb_chave2014_shapiro = stats::shapiro.test(scbi_quercus$agb_chave2014)</span></span>
<span id="cb29-1980"><a href="#cb29-1980" aria-hidden="true" tabindex="-1"></a><span class="st">agb_chave2014_wilcox = stats::wilcox.test(scbi_quercus$agb_chave2014)</span></span>
<span id="cb29-1981"><a href="#cb29-1981" aria-hidden="true" tabindex="-1"></a><span class="st">agb_brown1997_skew = moments::skewness(scbi_quercus$agb_brown1997)</span></span>
<span id="cb29-1982"><a href="#cb29-1982" aria-hidden="true" tabindex="-1"></a><span class="st">agb_brown1997_kurt = moments::kurtosis(scbi_quercus$agb_brown1997)</span></span>
<span id="cb29-1983"><a href="#cb29-1983" aria-hidden="true" tabindex="-1"></a><span class="st">28</span></span>
<span id="cb29-1984"><a href="#cb29-1984" aria-hidden="true" tabindex="-1"></a><span class="st">agb_brown1997_shapiro= stats::shapiro.test(scbi_quercus$agb_brown1997)</span></span>
<span id="cb29-1985"><a href="#cb29-1985" aria-hidden="true" tabindex="-1"></a><span class="st">agb_brown1997_wilcox = stats::wilcox.test(scbi_quercus$agb_brown1997)</span></span>
<span id="cb29-1986"><a href="#cb29-1986" aria-hidden="true" tabindex="-1"></a><span class="st">agb_chave2005_skew = moments::skewness(scbi_quercus$agb_chave2005)</span></span>
<span id="cb29-1987"><a href="#cb29-1987" aria-hidden="true" tabindex="-1"></a><span class="st">agb_chave2005_kurt = moments::kurtosis(scbi_quercus$agb_chave2005)</span></span>
<span id="cb29-1988"><a href="#cb29-1988" aria-hidden="true" tabindex="-1"></a><span class="st">agb_chave2005_shapiro= stats::shapiro.test(scbi_quercus$agb_chave2005)</span></span>
<span id="cb29-1989"><a href="#cb29-1989" aria-hidden="true" tabindex="-1"></a><span class="st">agb_chave2005_wilcox = stats::shapiro.test(scbi_quercus$agb_chave2005)</span></span>
<span id="cb29-1990"><a href="#cb29-1990" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb29-1991"><a href="#cb29-1991" aria-hidden="true" tabindex="-1"></a><span class="st"># 1.6.6 Heteroscedasticity Testing (Section 1.3)</span></span>
<span id="cb29-1992"><a href="#cb29-1992" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb29-1993"><a href="#cb29-1993" aria-hidden="true" tabindex="-1"></a><span class="st"># Derive results to test non-constant variance of selected predictor</span></span>
<span id="cb29-1994"><a href="#cb29-1994" aria-hidden="true" tabindex="-1"></a><span class="st">dbh_agb_species_lm &lt;- lm(agb_species ~ dbh, data = scbi_quercus)</span></span>
<span id="cb29-1995"><a href="#cb29-1995" aria-hidden="true" tabindex="-1"></a><span class="st">bp_test &lt;- lmtest::bptest(dbh_agb_species_lm)</span></span>
<span id="cb29-1996"><a href="#cb29-1996" aria-hidden="true" tabindex="-1"></a><span class="st">cat(sprintf("Breusch-Pagan Test Results:</span><span class="sc">\n</span><span class="st">"))</span></span>
<span id="cb29-1997"><a href="#cb29-1997" aria-hidden="true" tabindex="-1"></a><span class="st">NA Breusch-Pagan Test Results:</span></span>
<span id="cb29-1998"><a href="#cb29-1998" aria-hidden="true" tabindex="-1"></a><span class="st">cat(sprintf("BP statistic: %.4f</span><span class="sc">\n</span><span class="st">", bp_test$statistic))</span></span>
<span id="cb29-1999"><a href="#cb29-1999" aria-hidden="true" tabindex="-1"></a><span class="st">NA BP statistic: 10.0051</span></span>
<span id="cb29-2000"><a href="#cb29-2000" aria-hidden="true" tabindex="-1"></a><span class="st">cat(sprintf("p-value: %.4f</span><span class="sc">\n</span><span class="st">", bp_test$p.value))</span></span>
<span id="cb29-2001"><a href="#cb29-2001" aria-hidden="true" tabindex="-1"></a><span class="st">NA p-value: 0.0016</span></span>
<span id="cb29-2002"><a href="#cb29-2002" aria-hidden="true" tabindex="-1"></a><span class="st">cat(sprintf("Decision: %s</span><span class="sc">\n</span><span class="st">"</span></span>
<span id="cb29-2003"><a href="#cb29-2003" aria-hidden="true" tabindex="-1"></a><span class="st">, ifelse(bp_test$p.value &lt; 0.05,</span></span>
<span id="cb29-2004"><a href="#cb29-2004" aria-hidden="true" tabindex="-1"></a><span class="st">"Reject H₀ - Heteroscedasticity present", "Fail to reject H₀ - Homoscedasticity")))</span></span>
<span id="cb29-2005"><a href="#cb29-2005" aria-hidden="true" tabindex="-1"></a><span class="st">NA Decision: Reject H₀ - Heteroscedasticity present</span></span>
<span id="cb29-2006"><a href="#cb29-2006" aria-hidden="true" tabindex="-1"></a><span class="st"># Visualize</span></span>
<span id="cb29-2007"><a href="#cb29-2007" aria-hidden="true" tabindex="-1"></a><span class="st">plot(scbi_quercus$dbh, scbi_quercus$agb_species,</span></span>
<span id="cb29-2008"><a href="#cb29-2008" aria-hidden="true" tabindex="-1"></a><span class="st">pch = 16, cex = 0.8, col = "steelblue",</span></span>
<span id="cb29-2009"><a href="#cb29-2009" aria-hidden="true" tabindex="-1"></a><span class="st">xlab = "DBH (cm)", ylab = "AGB (kg)",</span></span>
<span id="cb29-2010"><a href="#cb29-2010" aria-hidden="true" tabindex="-1"></a><span class="st">main = "DBH-AGB Relationship: Heteroscedasticity Assessment")</span></span>
<span id="cb29-2011"><a href="#cb29-2011" aria-hidden="true" tabindex="-1"></a><span class="st">abline(dbh_agb_species_lm, col = "red", lwd = 2)</span></span>
<span id="cb29-2012"><a href="#cb29-2012" aria-hidden="true" tabindex="-1"></a><span class="st">abline(v = c(20, 40, 60), col = "gray", lty = 2)</span></span>
<span id="cb29-2013"><a href="#cb29-2013" aria-hidden="true" tabindex="-1"></a><span class="st">legend("topleft",legend=c("Observed values", "Linear fit", "Size class breaks"),</span></span>
<span id="cb29-2014"><a href="#cb29-2014" aria-hidden="true" tabindex="-1"></a><span class="st">col=c("steelblue", "red", "gray"), pch = c(16, NA, NA),</span></span>
<span id="cb29-2015"><a href="#cb29-2015" aria-hidden="true" tabindex="-1"></a><span class="st">lty = c(NA, 1, 2), lwd = c(NA, 2, 1), bty = "n", cex = 0.8)</span></span>
<span id="cb29-2016"><a href="#cb29-2016" aria-hidden="true" tabindex="-1"></a><span class="st">text(x = 70, y = max(scbi_quercus$agb_species) * 0.9,</span></span>
<span id="cb29-2017"><a href="#cb29-2017" aria-hidden="true" tabindex="-1"></a><span class="st">labels = sprintf("BP test: p = %.4f</span><span class="sc">\n</span><span class="st">Heteroscedasticity confirmed", bp_test$p.value),</span></span>
<span id="cb29-2018"><a href="#cb29-2018" aria-hidden="true" tabindex="-1"></a><span class="st">adj = c(0, 1), cex = 0.9, font = 2)</span></span>
<span id="cb29-2019"><a href="#cb29-2019" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb29-2020"><a href="#cb29-2020" aria-hidden="true" tabindex="-1"></a><span class="st"># 1.6.7 Log-Transformation Performance (Section 1.3)</span></span>
<span id="cb29-2021"><a href="#cb29-2021" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb29-2022"><a href="#cb29-2022" aria-hidden="true" tabindex="-1"></a><span class="st"># Derive performance metrics #</span></span>
<span id="cb29-2023"><a href="#cb29-2023" aria-hidden="true" tabindex="-1"></a><span class="st">lin_species = lm(agb_species ~ dbh, data = scbi_quercus)</span></span>
<span id="cb29-2024"><a href="#cb29-2024" aria-hidden="true" tabindex="-1"></a><span class="st">lin_genus = lm(agb_genus ~ dbh, data = scbi_quercus)</span></span>
<span id="cb29-2025"><a href="#cb29-2025" aria-hidden="true" tabindex="-1"></a><span class="st">lin_chave2014 = lm(agb_chave2014 ~ dbh, data = scbi_quercus)</span></span>
<span id="cb29-2026"><a href="#cb29-2026" aria-hidden="true" tabindex="-1"></a><span class="st">lin_brown1997 = lm(agb_brown1997 ~ dbh, data = scbi_quercus)</span></span>
<span id="cb29-2027"><a href="#cb29-2027" aria-hidden="true" tabindex="-1"></a><span class="st">lin_chave2005 = lm(agb_chave2005 ~ dbh, data = scbi_quercus)</span></span>
<span id="cb29-2028"><a href="#cb29-2028" aria-hidden="true" tabindex="-1"></a><span class="st">log_species = lm(log(agb_species) ~ log(dbh), data = scbi_quercus)</span></span>
<span id="cb29-2029"><a href="#cb29-2029" aria-hidden="true" tabindex="-1"></a><span class="st">log_genus = lm(log(agb_genus) ~ log(dbh), data = scbi_quercus)</span></span>
<span id="cb29-2030"><a href="#cb29-2030" aria-hidden="true" tabindex="-1"></a><span class="st">log_chave2014 = lm(log(agb_chave2014) ~ log(dbh), data = scbi_quercus)</span></span>
<span id="cb29-2031"><a href="#cb29-2031" aria-hidden="true" tabindex="-1"></a><span class="st">log_brown1997 = lm(log(agb_brown1997) ~ log(dbh), data = scbi_quercus)</span></span>
<span id="cb29-2032"><a href="#cb29-2032" aria-hidden="true" tabindex="-1"></a><span class="st">log_chave2005 = lm(log(agb_chave2005) ~ log(dbh), data = scbi_quercus)</span></span>
<span id="cb29-2033"><a href="#cb29-2033" aria-hidden="true" tabindex="-1"></a><span class="st"># Residuals: log models back-transformed **essential</span></span>
<span id="cb29-2034"><a href="#cb29-2034" aria-hidden="true" tabindex="-1"></a><span class="st">lin_species_resid = predict(lin_species, scbi_quercus, type='</span>response<span class="st">')</span></span>
<span id="cb29-2035"><a href="#cb29-2035" aria-hidden="true" tabindex="-1"></a><span class="st">lin_genus_resid = predict(lin_genus, scbi_quercus, type="response")</span></span>
<span id="cb29-2036"><a href="#cb29-2036" aria-hidden="true" tabindex="-1"></a><span class="st">lin_chave2014_resid = predict(lin_chave2014, scbi_quercus, type="response")</span></span>
<span id="cb29-2037"><a href="#cb29-2037" aria-hidden="true" tabindex="-1"></a><span class="st">29</span></span>
<span id="cb29-2038"><a href="#cb29-2038" aria-hidden="true" tabindex="-1"></a><span class="st">lin_brown1997_resid = predict(lin_brown1997, scbi_quercus, type="response")</span></span>
<span id="cb29-2039"><a href="#cb29-2039" aria-hidden="true" tabindex="-1"></a><span class="st">lin_chave2005_resid = predict(lin_chave2005, scbi_quercus, type="response")</span></span>
<span id="cb29-2040"><a href="#cb29-2040" aria-hidden="true" tabindex="-1"></a><span class="st">log_species_resid = exp(predict(log_species, scbi_quercus))</span></span>
<span id="cb29-2041"><a href="#cb29-2041" aria-hidden="true" tabindex="-1"></a><span class="st">log_genus_resid = exp(predict(log_genus, scbi_quercus))</span></span>
<span id="cb29-2042"><a href="#cb29-2042" aria-hidden="true" tabindex="-1"></a><span class="st">log_chave2014_resid = exp(predict(log_chave2014, scbi_quercus))</span></span>
<span id="cb29-2043"><a href="#cb29-2043" aria-hidden="true" tabindex="-1"></a><span class="st">log_brown1997_resid = exp(predict(log_brown1997, scbi_quercus))</span></span>
<span id="cb29-2044"><a href="#cb29-2044" aria-hidden="true" tabindex="-1"></a><span class="st">log_chave2005_resid = exp(predict(log_chave2005, scbi_quercus))</span></span>
<span id="cb29-2045"><a href="#cb29-2045" aria-hidden="true" tabindex="-1"></a><span class="st">lin_species_mae = ModelMetrics::mae(scbi_quercus$agb_species, lin_species_resid) |&gt; round(4)</span></span>
<span id="cb29-2046"><a href="#cb29-2046" aria-hidden="true" tabindex="-1"></a><span class="st">lin_species_rmse = ModelMetrics::rmse(scbi_quercus$agb_species, lin_species_resid) |&gt; round(4)</span></span>
<span id="cb29-2047"><a href="#cb29-2047" aria-hidden="true" tabindex="-1"></a><span class="st">lin_species_rmse_rel= round(lin_species_rmse / mean(scbi_quercus$agb_species, na.rm = T) * 100,4)</span></span>
<span id="cb29-2048"><a href="#cb29-2048" aria-hidden="true" tabindex="-1"></a><span class="st">log_species_mae = ModelMetrics::mae(scbi_quercus$agb_species, log_species_resid) |&gt; round(4)</span></span>
<span id="cb29-2049"><a href="#cb29-2049" aria-hidden="true" tabindex="-1"></a><span class="st">log_species_rmse = ModelMetrics::rmse(scbi_quercus$agb_species, log_species_resid) |&gt; round(4)</span></span>
<span id="cb29-2050"><a href="#cb29-2050" aria-hidden="true" tabindex="-1"></a><span class="st">log_species_rmse_rel= round(log_species_rmse / mean(scbi_quercus$agb_species, na.rm = T) * 100,4)</span></span>
<span id="cb29-2051"><a href="#cb29-2051" aria-hidden="true" tabindex="-1"></a><span class="st"># ******** CRITICAL back-transformation = log_species_rmse_rel</span></span>
<span id="cb29-2052"><a href="#cb29-2052" aria-hidden="true" tabindex="-1"></a><span class="st"># Genus-level</span></span>
<span id="cb29-2053"><a href="#cb29-2053" aria-hidden="true" tabindex="-1"></a><span class="st">lin_genus_mae = ModelMetrics::mae(scbi_quercus$agb_genus, lin_genus_resid) |&gt; round(4)</span></span>
<span id="cb29-2054"><a href="#cb29-2054" aria-hidden="true" tabindex="-1"></a><span class="st">lin_genus_rmse = ModelMetrics::rmse(scbi_quercus$agb_genus, lin_genus_resid) |&gt; round(4)</span></span>
<span id="cb29-2055"><a href="#cb29-2055" aria-hidden="true" tabindex="-1"></a><span class="st">lin_genus_rmse_rel = round(lin_genus_rmse / mean(scbi_quercus$agb_genus, na.rm=T) * 100,4)</span></span>
<span id="cb29-2056"><a href="#cb29-2056" aria-hidden="true" tabindex="-1"></a><span class="st">log_genus_mae = sprintf("%.2e", ModelMetrics::mae(scbi_quercus$agb_brown1997, log_brown1997_resid))</span></span>
<span id="cb29-2057"><a href="#cb29-2057" aria-hidden="true" tabindex="-1"></a><span class="st">log_genus_rmse = sprintf("%.2e", ModelMetrics::rmse(scbi_quercus$agb_genus, log_genus_resid))</span></span>
<span id="cb29-2058"><a href="#cb29-2058" aria-hidden="true" tabindex="-1"></a><span class="st">log_genus_rmse_rel = sprintf("%.2e", (as.numeric(log_genus_rmse)/mean(scbi_quercus$agb_genus, na.rm=T) *100))</span></span>
<span id="cb29-2059"><a href="#cb29-2059" aria-hidden="true" tabindex="-1"></a><span class="st"># --------- CRITICAL back-transformation = log_genus_rmse_rel --------- #</span></span>
<span id="cb29-2060"><a href="#cb29-2060" aria-hidden="true" tabindex="-1"></a><span class="st"># Chave 2014</span></span>
<span id="cb29-2061"><a href="#cb29-2061" aria-hidden="true" tabindex="-1"></a><span class="st">lin_chave2014_mae = ModelMetrics::mae(scbi_quercus$agb_chave2014, lin_chave2014_resid) |&gt; round(4)</span></span>
<span id="cb29-2062"><a href="#cb29-2062" aria-hidden="true" tabindex="-1"></a><span class="st">lin_chave2014_rmse = ModelMetrics::rmse(scbi_quercus$agb_chave2014, lin_chave2014_resid) |&gt; round(4)</span></span>
<span id="cb29-2063"><a href="#cb29-2063" aria-hidden="true" tabindex="-1"></a><span class="st">lin_chave2014_rmse_rel = round(lin_chave2014_rmse /mean(scbi_quercus$agb_chave2014,na.rm=T) * 100, 4)</span></span>
<span id="cb29-2064"><a href="#cb29-2064" aria-hidden="true" tabindex="-1"></a><span class="st">log_chave2014_mae = ModelMetrics::mae(scbi_quercus$agb_chave2014, log_chave2014_resid) |&gt; round(4)</span></span>
<span id="cb29-2065"><a href="#cb29-2065" aria-hidden="true" tabindex="-1"></a><span class="st">log_chave2014_rmse = ModelMetrics::rmse(scbi_quercus$agb_chave2014, log_chave2014_resid) |&gt; round(4)</span></span>
<span id="cb29-2066"><a href="#cb29-2066" aria-hidden="true" tabindex="-1"></a><span class="st">log_chave2014_rmse_rel = round(log_chave2014_rmse / mean(scbi_quercus$agb_chave2014, na.rm=T) * 100, 4)</span></span>
<span id="cb29-2067"><a href="#cb29-2067" aria-hidden="true" tabindex="-1"></a><span class="st"># Brown 1997</span></span>
<span id="cb29-2068"><a href="#cb29-2068" aria-hidden="true" tabindex="-1"></a><span class="st">lin_brown1997_mae = ModelMetrics::mae(scbi_quercus$agb_brown1997, lin_brown1997_resid) |&gt; round(4)</span></span>
<span id="cb29-2069"><a href="#cb29-2069" aria-hidden="true" tabindex="-1"></a><span class="st">lin_brown1997_rmse = ModelMetrics::rmse(scbi_quercus$agb_brown1997, lin_brown1997_resid) |&gt; round(4)</span></span>
<span id="cb29-2070"><a href="#cb29-2070" aria-hidden="true" tabindex="-1"></a><span class="st">lin_brown1997_rmse_rel = round(lin_brown1997_rmse / mean(scbi_quercus$agb_brown1997, na.rm=T) * 100, 4)</span></span>
<span id="cb29-2071"><a href="#cb29-2071" aria-hidden="true" tabindex="-1"></a><span class="st">log_brown1997_mae = sprintf("%.2e", ModelMetrics::mae(scbi_quercus$agb_brown1997, log_brown1997_resid))</span></span>
<span id="cb29-2072"><a href="#cb29-2072" aria-hidden="true" tabindex="-1"></a><span class="st">log_brown1997_rmse = sprintf("%.2e", ModelMetrics::rmse(scbi_quercus$agb_brown1997, log_brown1997_resid))</span></span>
<span id="cb29-2073"><a href="#cb29-2073" aria-hidden="true" tabindex="-1"></a><span class="st">log_brown1997_rmse_rel = sprintf("%.2e", (as.numeric(log_brown1997_rmse) / mean(scbi_quercus$agb_brown1997, na.r</span></span>
<span id="cb29-2074"><a href="#cb29-2074" aria-hidden="true" tabindex="-1"></a><span class="st">m=T) *100))</span></span>
<span id="cb29-2075"><a href="#cb29-2075" aria-hidden="true" tabindex="-1"></a><span class="st"># Chave 2005</span></span>
<span id="cb29-2076"><a href="#cb29-2076" aria-hidden="true" tabindex="-1"></a><span class="st">linear_chave2005_mae = ModelMetrics::mae(scbi_quercus$agb_chave2005, lin_chave2005_resid) |&gt; round(4)</span></span>
<span id="cb29-2077"><a href="#cb29-2077" aria-hidden="true" tabindex="-1"></a><span class="st">linear_chave2005_rmse = ModelMetrics::rmse(scbi_quercus$agb_chave2005, lin_chave2005_resid) |&gt; round(4)</span></span>
<span id="cb29-2078"><a href="#cb29-2078" aria-hidden="true" tabindex="-1"></a><span class="st">linear_chave2005_rmse_rel= (linear_chave2005_rmse/mean(scbi_quercus$agb_chave2005, na.rm=T) * 100)|&gt; round(2)</span></span>
<span id="cb29-2079"><a href="#cb29-2079" aria-hidden="true" tabindex="-1"></a><span class="st">log_chave2005_mae = ModelMetrics::mae(scbi_quercus$agb_chave2005, log_chave2005_resid) |&gt; round(4)</span></span>
<span id="cb29-2080"><a href="#cb29-2080" aria-hidden="true" tabindex="-1"></a><span class="st">log_chave2005_rmse = ModelMetrics::rmse(scbi_quercus$agb_chave2005, log_chave2005_resid) |&gt; round(4)</span></span>
<span id="cb29-2081"><a href="#cb29-2081" aria-hidden="true" tabindex="-1"></a><span class="st">log_chave2005_rmse_rel = (log_chave2005_rmse / mean(scbi_quercus$agb_chave2005, na.rm=T) * 100) |&gt; round(4)</span></span>
<span id="cb29-2082"><a href="#cb29-2082" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb29-2083"><a href="#cb29-2083" aria-hidden="true" tabindex="-1"></a><span class="st"># 1.6.8 Stratified Sampling (Section 1.3)</span></span>
<span id="cb29-2084"><a href="#cb29-2084" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb29-2085"><a href="#cb29-2085" aria-hidden="true" tabindex="-1"></a><span class="st">set.seed(123)</span></span>
<span id="cb29-2086"><a href="#cb29-2086" aria-hidden="true" tabindex="-1"></a><span class="st">age_class = scbi_quercus |&gt; dplyr::filter(</span></span>
<span id="cb29-2087"><a href="#cb29-2087" aria-hidden="true" tabindex="-1"></a><span class="st">!is.na(dbh), !is.na(agb_genus)) |&gt;</span></span>
<span id="cb29-2088"><a href="#cb29-2088" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::mutate(dbh_class = cut(dbh,</span></span>
<span id="cb29-2089"><a href="#cb29-2089" aria-hidden="true" tabindex="-1"></a><span class="st">30</span></span>
<span id="cb29-2090"><a href="#cb29-2090" aria-hidden="true" tabindex="-1"></a><span class="st">breaks = c(0, 10, 20, 30, 40, 50, 100),</span></span>
<span id="cb29-2091"><a href="#cb29-2091" aria-hidden="true" tabindex="-1"></a><span class="st">labels = c("0-10", "10-20", "20-30", "30-40", "40-50", "&gt;50")))</span></span>
<span id="cb29-2092"><a href="#cb29-2092" aria-hidden="true" tabindex="-1"></a><span class="st"># Check raw distribution across size classes</span></span>
<span id="cb29-2093"><a href="#cb29-2093" aria-hidden="true" tabindex="-1"></a><span class="st">age_class_distribution = age_class |&gt;</span></span>
<span id="cb29-2094"><a href="#cb29-2094" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::group_by(dbh_class) |&gt;</span></span>
<span id="cb29-2095"><a href="#cb29-2095" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::summarise(n = n(),</span></span>
<span id="cb29-2096"><a href="#cb29-2096" aria-hidden="true" tabindex="-1"></a><span class="st">mean_dbh = mean(dbh), mean_agb = mean(agb_genus),</span></span>
<span id="cb29-2097"><a href="#cb29-2097" aria-hidden="true" tabindex="-1"></a><span class="st">total_biomass_pct = sum(agb_genus) / sum(age_class$agb_genus) * 100,</span></span>
<span id="cb29-2098"><a href="#cb29-2098" aria-hidden="true" tabindex="-1"></a><span class="st">.groups = '</span>drop<span class="st">')</span></span>
<span id="cb29-2099"><a href="#cb29-2099" aria-hidden="true" tabindex="-1"></a><span class="st"># Check 80:20% to maintain proportional representation</span></span>
<span id="cb29-2100"><a href="#cb29-2100" aria-hidden="true" tabindex="-1"></a><span class="st">train_idx &lt;- age_class |&gt;</span></span>
<span id="cb29-2101"><a href="#cb29-2101" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::mutate(row_id = row_number()) |&gt;</span></span>
<span id="cb29-2102"><a href="#cb29-2102" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::group_by(dbh_class) |&gt;</span></span>
<span id="cb29-2103"><a href="#cb29-2103" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::slice_sample(prop = 0.8) |&gt;</span></span>
<span id="cb29-2104"><a href="#cb29-2104" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::pull(row_id)</span></span>
<span id="cb29-2105"><a href="#cb29-2105" aria-hidden="true" tabindex="-1"></a><span class="st">calibration_data &lt;- age_class[train_idx, ]</span></span>
<span id="cb29-2106"><a href="#cb29-2106" aria-hidden="true" tabindex="-1"></a><span class="st">validation_data &lt;- age_class[-train_idx, ]</span></span>
<span id="cb29-2107"><a href="#cb29-2107" aria-hidden="true" tabindex="-1"></a><span class="st">cal_props &lt;- calibration_data |&gt;</span></span>
<span id="cb29-2108"><a href="#cb29-2108" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::count(dbh_class) |&gt;</span></span>
<span id="cb29-2109"><a href="#cb29-2109" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::mutate(cal_pct = round((n / sum(n)) * 100, 1)) |&gt;</span></span>
<span id="cb29-2110"><a href="#cb29-2110" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::rename(cal_n = n)</span></span>
<span id="cb29-2111"><a href="#cb29-2111" aria-hidden="true" tabindex="-1"></a><span class="st">val_props &lt;- validation_data |&gt;</span></span>
<span id="cb29-2112"><a href="#cb29-2112" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::count(dbh_class) |&gt;</span></span>
<span id="cb29-2113"><a href="#cb29-2113" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::mutate(val_pct = round((n / sum(n)) * 100, 1)) |&gt;</span></span>
<span id="cb29-2114"><a href="#cb29-2114" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::rename(val_n = n)</span></span>
<span id="cb29-2115"><a href="#cb29-2115" aria-hidden="true" tabindex="-1"></a><span class="st">split_verification &lt;- cal_props |&gt;</span></span>
<span id="cb29-2116"><a href="#cb29-2116" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::left_join(val_props, by = "dbh_class") |&gt;</span></span>
<span id="cb29-2117"><a href="#cb29-2117" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::mutate(Total_n = cal_n + val_n, Difference_pct = abs(cal_pct - val_pct)) |&gt;</span></span>
<span id="cb29-2118"><a href="#cb29-2118" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::select(dbh_class, cal_n, cal_pct, val_n, val_pct, Total_n, Difference_pct)</span></span>
<span id="cb29-2119"><a href="#cb29-2119" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb29-2120"><a href="#cb29-2120" aria-hidden="true" tabindex="-1"></a><span class="st"># 1.6.9 Monte Carlo Cross-Validation (Section 1.4)</span></span>
<span id="cb29-2121"><a href="#cb29-2121" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb29-2122"><a href="#cb29-2122" aria-hidden="true" tabindex="-1"></a><span class="st"># Define Monte Carlo cross-validation parameters</span></span>
<span id="cb29-2123"><a href="#cb29-2123" aria-hidden="true" tabindex="-1"></a><span class="st">monte_carlo_100 &lt;- caret::trainControl(</span></span>
<span id="cb29-2124"><a href="#cb29-2124" aria-hidden="true" tabindex="-1"></a><span class="st">method = "LGOCV",</span></span>
<span id="cb29-2125"><a href="#cb29-2125" aria-hidden="true" tabindex="-1"></a><span class="st">number = 100, # no.# of full cycle resamples</span></span>
<span id="cb29-2126"><a href="#cb29-2126" aria-hidden="true" tabindex="-1"></a><span class="st">p = 0.8, # percentage of full cycle resampled</span></span>
<span id="cb29-2127"><a href="#cb29-2127" aria-hidden="true" tabindex="-1"></a><span class="st">savePredictions = "final"</span></span>
<span id="cb29-2128"><a href="#cb29-2128" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb29-2129"><a href="#cb29-2129" aria-hidden="true" tabindex="-1"></a><span class="st"># Species-Specific Model: Linear model tuned at species level with un-transformed covs</span></span>
<span id="cb29-2130"><a href="#cb29-2130" aria-hidden="true" tabindex="-1"></a><span class="st">lin_species_mc &lt;- caret::train(</span></span>
<span id="cb29-2131"><a href="#cb29-2131" aria-hidden="true" tabindex="-1"></a><span class="st">agb_species ~ dbh,</span></span>
<span id="cb29-2132"><a href="#cb29-2132" aria-hidden="true" tabindex="-1"></a><span class="st">data = scbi_quercus,</span></span>
<span id="cb29-2133"><a href="#cb29-2133" aria-hidden="true" tabindex="-1"></a><span class="st">method = "lm",</span></span>
<span id="cb29-2134"><a href="#cb29-2134" aria-hidden="true" tabindex="-1"></a><span class="st">na.action = na.omit,</span></span>
<span id="cb29-2135"><a href="#cb29-2135" aria-hidden="true" tabindex="-1"></a><span class="st">trControl = monte_carlo_100</span></span>
<span id="cb29-2136"><a href="#cb29-2136" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb29-2137"><a href="#cb29-2137" aria-hidden="true" tabindex="-1"></a><span class="st"># Species-Specific Model: Logarithmic model tuned at species level withg log-transformed covs</span></span>
<span id="cb29-2138"><a href="#cb29-2138" aria-hidden="true" tabindex="-1"></a><span class="st">log_species_mc &lt;- caret::train(</span></span>
<span id="cb29-2139"><a href="#cb29-2139" aria-hidden="true" tabindex="-1"></a><span class="st">log(agb_species) ~ log(dbh),</span></span>
<span id="cb29-2140"><a href="#cb29-2140" aria-hidden="true" tabindex="-1"></a><span class="st">data = scbi_quercus,</span></span>
<span id="cb29-2141"><a href="#cb29-2141" aria-hidden="true" tabindex="-1"></a><span class="st">method = "lm",</span></span>
<span id="cb29-2142"><a href="#cb29-2142" aria-hidden="true" tabindex="-1"></a><span class="st">na.action = na.omit,</span></span>
<span id="cb29-2143"><a href="#cb29-2143" aria-hidden="true" tabindex="-1"></a><span class="st">trControl = monte_carlo_100</span></span>
<span id="cb29-2144"><a href="#cb29-2144" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb29-2145"><a href="#cb29-2145" aria-hidden="true" tabindex="-1"></a><span class="st"># Genus-Specific Model: LINEAR model tuned at genus level with un-transformed covs</span></span>
<span id="cb29-2146"><a href="#cb29-2146" aria-hidden="true" tabindex="-1"></a><span class="st">31</span></span>
<span id="cb29-2147"><a href="#cb29-2147" aria-hidden="true" tabindex="-1"></a><span class="st">lin_genus_mc &lt;- caret::train(</span></span>
<span id="cb29-2148"><a href="#cb29-2148" aria-hidden="true" tabindex="-1"></a><span class="st">agb_genus ~ dbh,</span></span>
<span id="cb29-2149"><a href="#cb29-2149" aria-hidden="true" tabindex="-1"></a><span class="st">data = scbi_quercus,</span></span>
<span id="cb29-2150"><a href="#cb29-2150" aria-hidden="true" tabindex="-1"></a><span class="st">method = "lm",</span></span>
<span id="cb29-2151"><a href="#cb29-2151" aria-hidden="true" tabindex="-1"></a><span class="st">na.action = na.omit,</span></span>
<span id="cb29-2152"><a href="#cb29-2152" aria-hidden="true" tabindex="-1"></a><span class="st">trControl = monte_carlo_100</span></span>
<span id="cb29-2153"><a href="#cb29-2153" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb29-2154"><a href="#cb29-2154" aria-hidden="true" tabindex="-1"></a><span class="st"># Genus-Specific Model: LOG model tuned at genus level with un-transformed covs</span></span>
<span id="cb29-2155"><a href="#cb29-2155" aria-hidden="true" tabindex="-1"></a><span class="st">log_genus_mc &lt;- caret::train(</span></span>
<span id="cb29-2156"><a href="#cb29-2156" aria-hidden="true" tabindex="-1"></a><span class="st">log(agb_genus) ~ log(dbh),</span></span>
<span id="cb29-2157"><a href="#cb29-2157" aria-hidden="true" tabindex="-1"></a><span class="st">data = scbi_quercus,</span></span>
<span id="cb29-2158"><a href="#cb29-2158" aria-hidden="true" tabindex="-1"></a><span class="st">method = "lm",</span></span>
<span id="cb29-2159"><a href="#cb29-2159" aria-hidden="true" tabindex="-1"></a><span class="st">na.action = na.omit,</span></span>
<span id="cb29-2160"><a href="#cb29-2160" aria-hidden="true" tabindex="-1"></a><span class="st">trControl = monte_carlo_100</span></span>
<span id="cb29-2161"><a href="#cb29-2161" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb29-2162"><a href="#cb29-2162" aria-hidden="true" tabindex="-1"></a><span class="st"># Chave 2014 models: Generic scaled</span></span>
<span id="cb29-2163"><a href="#cb29-2163" aria-hidden="true" tabindex="-1"></a><span class="st">lin_chave2014_mc &lt;- caret::train(</span></span>
<span id="cb29-2164"><a href="#cb29-2164" aria-hidden="true" tabindex="-1"></a><span class="st">agb_chave2014 ~ dbh,</span></span>
<span id="cb29-2165"><a href="#cb29-2165" aria-hidden="true" tabindex="-1"></a><span class="st">data = scbi_quercus,</span></span>
<span id="cb29-2166"><a href="#cb29-2166" aria-hidden="true" tabindex="-1"></a><span class="st">method = "lm",</span></span>
<span id="cb29-2167"><a href="#cb29-2167" aria-hidden="true" tabindex="-1"></a><span class="st">na.action = na.omit,</span></span>
<span id="cb29-2168"><a href="#cb29-2168" aria-hidden="true" tabindex="-1"></a><span class="st">trControl = monte_carlo_100)</span></span>
<span id="cb29-2169"><a href="#cb29-2169" aria-hidden="true" tabindex="-1"></a><span class="st">log_chave2014_mc &lt;- caret::train(</span></span>
<span id="cb29-2170"><a href="#cb29-2170" aria-hidden="true" tabindex="-1"></a><span class="st">log(agb_chave2014) ~ log(dbh),</span></span>
<span id="cb29-2171"><a href="#cb29-2171" aria-hidden="true" tabindex="-1"></a><span class="st">data = scbi_quercus,</span></span>
<span id="cb29-2172"><a href="#cb29-2172" aria-hidden="true" tabindex="-1"></a><span class="st">method = "lm",</span></span>
<span id="cb29-2173"><a href="#cb29-2173" aria-hidden="true" tabindex="-1"></a><span class="st">na.action = na.omit,</span></span>
<span id="cb29-2174"><a href="#cb29-2174" aria-hidden="true" tabindex="-1"></a><span class="st">trControl = monte_carlo_100)</span></span>
<span id="cb29-2175"><a href="#cb29-2175" aria-hidden="true" tabindex="-1"></a><span class="st"># Brown 1997 models</span></span>
<span id="cb29-2176"><a href="#cb29-2176" aria-hidden="true" tabindex="-1"></a><span class="st">lin_brown1997_mc &lt;- caret::train(</span></span>
<span id="cb29-2177"><a href="#cb29-2177" aria-hidden="true" tabindex="-1"></a><span class="st">agb_brown1997 ~ dbh,</span></span>
<span id="cb29-2178"><a href="#cb29-2178" aria-hidden="true" tabindex="-1"></a><span class="st">data = scbi_quercus,</span></span>
<span id="cb29-2179"><a href="#cb29-2179" aria-hidden="true" tabindex="-1"></a><span class="st">method = "lm",</span></span>
<span id="cb29-2180"><a href="#cb29-2180" aria-hidden="true" tabindex="-1"></a><span class="st">na.action = na.omit,</span></span>
<span id="cb29-2181"><a href="#cb29-2181" aria-hidden="true" tabindex="-1"></a><span class="st">trControl = monte_carlo_100</span></span>
<span id="cb29-2182"><a href="#cb29-2182" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb29-2183"><a href="#cb29-2183" aria-hidden="true" tabindex="-1"></a><span class="st">log_brown1997_mc &lt;- caret::train(</span></span>
<span id="cb29-2184"><a href="#cb29-2184" aria-hidden="true" tabindex="-1"></a><span class="st">log(agb_brown1997) ~ log(dbh),</span></span>
<span id="cb29-2185"><a href="#cb29-2185" aria-hidden="true" tabindex="-1"></a><span class="st">data = scbi_quercus,</span></span>
<span id="cb29-2186"><a href="#cb29-2186" aria-hidden="true" tabindex="-1"></a><span class="st">method = "lm",</span></span>
<span id="cb29-2187"><a href="#cb29-2187" aria-hidden="true" tabindex="-1"></a><span class="st">na.action = na.omit,</span></span>
<span id="cb29-2188"><a href="#cb29-2188" aria-hidden="true" tabindex="-1"></a><span class="st">trControl = monte_carlo_100)</span></span>
<span id="cb29-2189"><a href="#cb29-2189" aria-hidden="true" tabindex="-1"></a><span class="st"># Chave 2005 models</span></span>
<span id="cb29-2190"><a href="#cb29-2190" aria-hidden="true" tabindex="-1"></a><span class="st">lin_chave2005_mc &lt;- caret::train(</span></span>
<span id="cb29-2191"><a href="#cb29-2191" aria-hidden="true" tabindex="-1"></a><span class="st">agb_chave2005 ~ dbh,</span></span>
<span id="cb29-2192"><a href="#cb29-2192" aria-hidden="true" tabindex="-1"></a><span class="st">data = scbi_quercus,</span></span>
<span id="cb29-2193"><a href="#cb29-2193" aria-hidden="true" tabindex="-1"></a><span class="st">method = "lm",</span></span>
<span id="cb29-2194"><a href="#cb29-2194" aria-hidden="true" tabindex="-1"></a><span class="st">na.action = na.omit,</span></span>
<span id="cb29-2195"><a href="#cb29-2195" aria-hidden="true" tabindex="-1"></a><span class="st">trControl = monte_carlo_100)</span></span>
<span id="cb29-2196"><a href="#cb29-2196" aria-hidden="true" tabindex="-1"></a><span class="st">log_chave2005_mc &lt;- caret::train(</span></span>
<span id="cb29-2197"><a href="#cb29-2197" aria-hidden="true" tabindex="-1"></a><span class="st">log(agb_chave2005) ~ log(dbh),</span></span>
<span id="cb29-2198"><a href="#cb29-2198" aria-hidden="true" tabindex="-1"></a><span class="st">data = scbi_quercus,</span></span>
<span id="cb29-2199"><a href="#cb29-2199" aria-hidden="true" tabindex="-1"></a><span class="st">method = "lm",</span></span>
<span id="cb29-2200"><a href="#cb29-2200" aria-hidden="true" tabindex="-1"></a><span class="st">na.action = na.omit,</span></span>
<span id="cb29-2201"><a href="#cb29-2201" aria-hidden="true" tabindex="-1"></a><span class="st">trControl = monte_carlo_100</span></span>
<span id="cb29-2202"><a href="#cb29-2202" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb29-2203"><a href="#cb29-2203" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb29-2204"><a href="#cb29-2204" aria-hidden="true" tabindex="-1"></a><span class="st"># 1.6.10 Model Ranking and Deduction Calculation (Section 1.5)</span></span>
<span id="cb29-2205"><a href="#cb29-2205" aria-hidden="true" tabindex="-1"></a><span class="st"># ----------------------------------------------------------------------------</span></span>
<span id="cb29-2206"><a href="#cb29-2206" aria-hidden="true" tabindex="-1"></a><span class="st">32</span></span>
<span id="cb29-2207"><a href="#cb29-2207" aria-hidden="true" tabindex="-1"></a><span class="st"># Extract log-transformed models as best performers</span></span>
<span id="cb29-2208"><a href="#cb29-2208" aria-hidden="true" tabindex="-1"></a><span class="st">log_models_ranked &lt;- mc_performance |&gt;</span></span>
<span id="cb29-2209"><a href="#cb29-2209" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::filter(Model_Type == "Log") |&gt;</span></span>
<span id="cb29-2210"><a href="#cb29-2210" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::arrange(Rel_RMSE_pct) |&gt;</span></span>
<span id="cb29-2211"><a href="#cb29-2211" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::mutate(</span></span>
<span id="cb29-2212"><a href="#cb29-2212" aria-hidden="true" tabindex="-1"></a><span class="st">Rank = row_number(),</span></span>
<span id="cb29-2213"><a href="#cb29-2213" aria-hidden="true" tabindex="-1"></a><span class="st">Financial_Impact_1M = sprintf("$%.0fk", Credit_Deduction_pct * 10000 / 100)) |&gt;</span></span>
<span id="cb29-2214"><a href="#cb29-2214" aria-hidden="true" tabindex="-1"></a><span class="st">dplyr::select(Rank, Equation, Rel_RMSE_pct, R2, Credit_Deduction_pct, Financial_Impact_1M)</span></span>
<span id="cb29-2215"><a href="#cb29-2215" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb29-2216"><a href="#cb29-2216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2217"><a href="#cb29-2217" aria-hidden="true" tabindex="-1"></a><span class="st">## </span></span>
<span id="cb29-2218"><a href="#cb29-2218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2219"><a href="#cb29-2219" aria-hidden="true" tabindex="-1"></a><span class="st">1.7 Chapter Summary</span></span>
<span id="cb29-2220"><a href="#cb29-2220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2221"><a href="#cb29-2221" aria-hidden="true" tabindex="-1"></a><span class="st">### Key Findings</span></span>
<span id="cb29-2222"><a href="#cb29-2222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2223"><a href="#cb29-2223" aria-hidden="true" tabindex="-1"></a><span class="st">-   Distribution: Data exhibits right-skew (p \&lt; 0.001) across equations, violating parametric assumptions</span></span>
<span id="cb29-2224"><a href="#cb29-2224" aria-hidden="true" tabindex="-1"></a><span class="st">-   Heteroscedasticity confirmed: Breusch-Pagan test (p \&lt; 0.001) shows variance increasing with tree size</span></span>
<span id="cb29-2225"><a href="#cb29-2225" aria-hidden="true" tabindex="-1"></a><span class="st">-   Transformation: Log-transformation reduces uncertainty RMSE \&gt;50 percentage points</span></span>
<span id="cb29-2226"><a href="#cb29-2226" aria-hidden="true" tabindex="-1"></a><span class="st">-   Equation performance:</span></span>
<span id="cb29-2227"><a href="#cb29-2227" aria-hidden="true" tabindex="-1"></a><span class="st">    -   Species-specific (log): 15.2% RMSE, 4.8% deduction</span></span>
<span id="cb29-2228"><a href="#cb29-2228" aria-hidden="true" tabindex="-1"></a><span class="st">    -   Genus-level (log): 16.3% RMSE, 5.2% deduction</span></span>
<span id="cb29-2229"><a href="#cb29-2229" aria-hidden="true" tabindex="-1"></a><span class="st">    -   Pan-tropical (log): 17-19% RMSE, 5.4-6.0% deduction</span></span>
<span id="cb29-2230"><a href="#cb29-2230" aria-hidden="true" tabindex="-1"></a><span class="st">-   Cross-Validation: 100-iteration Monte Carlo LGOCV confirms log-transformed models outperform across equations.</span></span>
<span id="cb29-2231"><a href="#cb29-2231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2232"><a href="#cb29-2232" aria-hidden="true" tabindex="-1"></a><span class="st">### REDD+ Best Practices</span></span>
<span id="cb29-2233"><a href="#cb29-2233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2234"><a href="#cb29-2234" aria-hidden="true" tabindex="-1"></a><span class="st">To achieve commercially viable uncertainty levels (\&lt;20% RMSE) and minimize carbon credit deductions:</span></span>
<span id="cb29-2235"><a href="#cb29-2235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2236"><a href="#cb29-2236" aria-hidden="true" tabindex="-1"></a><span class="st">1.  Log-transformation (CRITICAL): Achieves 90-95% of possible uncertainty reduction at zero marginal cost</span></span>
<span id="cb29-2237"><a href="#cb29-2237" aria-hidden="true" tabindex="-1"></a><span class="st">2.  Species-specific: Reduces RMSE by 3-4 percentage points vs. genus-level, protecting \$10-15k per million tCO₂e</span></span>
<span id="cb29-2238"><a href="#cb29-2238" aria-hidden="true" tabindex="-1"></a><span class="st">3.  Stratified: Ensures proportional representation across DBH classes, preventing bias from undersampling large trees</span></span>
<span id="cb29-2239"><a href="#cb29-2239" aria-hidden="true" tabindex="-1"></a><span class="st">4.  Cross-Validation: Quantifies out-of-sample error, avoiding overfitting and providing defensible uncertainty estimates</span></span>
<span id="cb29-2240"><a href="#cb29-2240" aria-hidden="true" tabindex="-1"></a><span class="st">5.  Sample Size: Minimum n≥50 trees per equation (Roxburgh et al. 2015), with stratification across ln(DBH) range</span></span>
<span id="cb29-2241"><a href="#cb29-2241" aria-hidden="true" tabindex="-1"></a><span class="st">6.  Measurement precision: Target ±0.5 cm DBH error through calibrated instruments and trained field crews</span></span>
<span id="cb29-2242"><a href="#cb29-2242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2243"><a href="#cb29-2243" aria-hidden="true" tabindex="-1"></a><span class="st">### Investment Priorities</span></span>
<span id="cb29-2244"><a href="#cb29-2244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2245"><a href="#cb29-2245" aria-hidden="true" tabindex="-1"></a><span class="st">| Intervention | Cost | Uncertainty Reduction | Revenue Protected\* |</span></span>
<span id="cb29-2246"><a href="#cb29-2246" aria-hidden="true" tabindex="-1"></a><span class="st">|----|----|----|----|</span></span>
<span id="cb29-2247"><a href="#cb29-2247" aria-hidden="true" tabindex="-1"></a><span class="st">| Log-transformation | \$0 | 50-55 pp | \$250-275k |</span></span>
<span id="cb29-2248"><a href="#cb29-2248" aria-hidden="true" tabindex="-1"></a><span class="st">| Species-specific equations | \$15-30k | 3-4 pp | \$10-15k |</span></span>
<span id="cb29-2249"><a href="#cb29-2249" aria-hidden="true" tabindex="-1"></a><span class="st">| Cross-validation workflow | \$5-10k | 2-3 pp | \$8-12k |</span></span>
<span id="cb29-2250"><a href="#cb29-2250" aria-hidden="true" tabindex="-1"></a><span class="st">| Improved DBH measurement | \$2-5k | 1-2 pp | \$4-8k |</span></span>
<span id="cb29-2251"><a href="#cb29-2251" aria-hidden="true" tabindex="-1"></a><span class="st">| Destructive sampling | \$50-100k | 5-10 pp | \$20-40k |</span></span>
<span id="cb29-2252"><a href="#cb29-2252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2253"><a href="#cb29-2253" aria-hidden="true" tabindex="-1"></a><span class="st">: *\*Assumes 1M tCO₂e project \@ \$5/tonne; pp = percentage points*</span></span>
<span id="cb29-2254"><a href="#cb29-2254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2255"><a href="#cb29-2255" aria-hidden="true" tabindex="-1"></a><span class="st">Strategic recommendation: Log-transformation delivers the largest uncertainty reduction at zero cost. Master this technique before investing in field campaigns or destructive sampling.</span></span>
<span id="cb29-2256"><a href="#cb29-2256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2257"><a href="#cb29-2257" aria-hidden="true" tabindex="-1"></a><span class="st">### Documentation Requirements</span></span>
<span id="cb29-2258"><a href="#cb29-2258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2259"><a href="#cb29-2259" aria-hidden="true" tabindex="-1"></a><span class="st">For REDD+ MRV reporting under ART-TREES/VCS, include:</span></span>
<span id="cb29-2260"><a href="#cb29-2260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2261"><a href="#cb29-2261" aria-hidden="true" tabindex="-1"></a><span class="st">-   Equation: Document geographic and taxonomic specificity, DBH range and sample size</span></span>
<span id="cb29-2262"><a href="#cb29-2262" aria-hidden="true" tabindex="-1"></a><span class="st">-   Transformation: Demonstrate non-normality (Shapiro-Wilk), heteroscedasticity (Breusch-Pagan), RMSE reduction</span></span>
<span id="cb29-2263"><a href="#cb29-2263" aria-hidden="true" tabindex="-1"></a><span class="st">-   Cross-Validation: Report RMSE, relative RMSE, R², Shapiro-Wilk on residuals from Monte Carlo LGOCV</span></span>
<span id="cb29-2264"><a href="#cb29-2264" aria-hidden="true" tabindex="-1"></a><span class="st">-   Uncertainty: Show ART Equation 11 application with half-width 90% CI derivation</span></span>
<span id="cb29-2265"><a href="#cb29-2265" aria-hidden="true" tabindex="-1"></a><span class="st">-   Stratification: Confirm proportional representation across DBH classes in calibration/validation splits</span></span>
<span id="cb29-2266"><a href="#cb29-2266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2267"><a href="#cb29-2267" aria-hidden="true" tabindex="-1"></a><span class="st">### Next Steps</span></span>
<span id="cb29-2268"><a href="#cb29-2268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2269"><a href="#cb29-2269" aria-hidden="true" tabindex="-1"></a><span class="st">Chapter 2: Emission Factors will address:</span></span>
<span id="cb29-2270"><a href="#cb29-2270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2271"><a href="#cb29-2271" aria-hidden="true" tabindex="-1"></a><span class="st">-   IPCC default uncertainties (CH₄: ±30-40%, N₂O: ±50-60%)</span></span>
<span id="cb29-2272"><a href="#cb29-2272" aria-hidden="true" tabindex="-1"></a><span class="st">-   Combustion completeness and fire intensity effects</span></span>
<span id="cb29-2273"><a href="#cb29-2273" aria-hidden="true" tabindex="-1"></a><span class="st">-   Gas-specific emission ratios (CO₂, CH₄, N₂O)</span></span>
<span id="cb29-2274"><a href="#cb29-2274" aria-hidden="true" tabindex="-1"></a><span class="st">-   Field measurement protocols (FTIR, eddy covariance)</span></span>
<span id="cb29-2275"><a href="#cb29-2275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2276"><a href="#cb29-2276" aria-hidden="true" tabindex="-1"></a><span class="st">[^index-1]: Removal of `python` workflow was requested during first review (November 24, 2025). For python users, these chunks have been rendered "hidden" and can be accessed when clone the repository from the markdown files used to compile each chapter.</span></span>
<span id="cb29-2277"><a href="#cb29-2277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2278"><a href="#cb29-2278" aria-hidden="true" tabindex="-1"></a><span class="st">[^index-2]: Follow-up: Allometry Sample Size Guidelines [@roxburgh2015guidelines] = [Link](https://esajournals.onlinelibrary.wiley.com/doi/full/10.1890/ES14-00251.1#sa2).</span></span>
<span id="cb29-2279"><a href="#cb29-2279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2280"><a href="#cb29-2280" aria-hidden="true" tabindex="-1"></a><span class="st">[^index-3]: Parallel development of Python cells was paused to concentrate efforts on delivering a completed R workflow. However, initial python code was preserved in each chapter’s markdown file and can be rendered from cloning the repository and adjusting \`echo\` function to reveal and run python operations and compare computation</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><a href="https://github.com/training-resource/uncertainty">Source</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/training-resource/uncertainty/edit/main/01-allometry/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/training-resource/uncertainty/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>