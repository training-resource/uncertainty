[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "REDD+ Uncertainty Training",
    "section": "",
    "text": "Preface\nThis training resource was commissioned by Winrock International under its JTAP portfolio (20065-2025-ICA-03) as a Foundation Module for uncertainty quantification training in jurisdictional REDD+ carbon accounting. The following training curriculum provides methodological guidance for quantifying, reporting, and reducing uncertainty in REDD+ carbon accounting in accordance with ART-TREES Standard (V2.0) requirements and the IPCC 2019 guidelines (ART, 2021; IPCC, 2019).\nRather than viewing estimation uncertainty as a penalty to manage, this framework treats it as a strategic metric for identifying dominant error sources and optimizing credit issuance (Camara et al., 2024; Duncanson et al., 2021; Simoes et al., 2021). Projects investing in targeted uncertainty reduction can achieve improved crediting revenue through minimizing penalty deductions, as well as through stronger pricing from enhanced credibility and lower verification and monitoring costs (Köhler & Huth, 2010).",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#uncertainty-potential",
    "href": "index.html#uncertainty-potential",
    "title": "REDD+ Uncertainty Training",
    "section": "Uncertainty Potential",
    "text": "Uncertainty Potential\nRecent analyses have identified opportunities to strengthen uncertainty reporting across REDD+ programs. According to Butler et al. (2024), while 91% of participating countries report activity data uncertainty, only 4-14% report emission factor and allometric uncertainty. This pattern presents an opportunity for jurisdictions to enhance methodological completeness and improve credit issuance outcomes. Research demonstrates that comprehensive uncertainty quantification, including emission factors and modeling assumptions contribute to significant variance across reference levels ranging from 4.2% to 262.2% (Pelletier et al., 2013).\nComprehensive uncertainty reporting serves multiple strategic objectives beyond regulatory compliance. When jurisdictions systematically quantify and report all uncertainty sources, they establish baseline metrics for improvement and unlock pathways to enhanced credit revenue. Butler et al. (2024) note that comprehensive assessment can initially produce wider confidence intervals, but this transparency enables targeted methodological refinements that systematically reduce actual uncertainty over time, a process that directly increases credit issuance and revenue. Recognizing the importance of incentivizing comprehensive reporting, results-based payment programs have implemented supportive mechanisms. The FCPF Carbon Fund uses a capped uncertainty deduction schedule that removes disincentives for comprehensive reporting:\nFCPF Uncertainty Deduction Conservativeness Factors:1\n\nNo deduction if uncertainty is ≤15%\n4% deduction if uncertainty is 15–30%\n8% deduction if uncertainty is 30–60%\n12% deduction if uncertainty is 60–100%\n15% maximum deduction if uncertainty is &gt;100%\n\nThis structure ensures that programs with very high initial uncertainty face the same maximum 15% deduction, removing the penalty for reporting comprehensive uncertainty while maintaining incentives to improve. The ART-TREES Standard goes further by allowing participants to recover over-deducted credits when cumulative uncertainty decreases across multi-year crediting periods (Section 8, V2.0). These provisions reward demonstrable improvements and create positive incentives for methodological investment.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#uncertainty-compliance",
    "href": "index.html#uncertainty-compliance",
    "title": "REDD+ Uncertainty Training",
    "section": "Uncertainty Compliance",
    "text": "Uncertainty Compliance\nSection 8 of the ART Standard V2.0 mandates the following criteria (ART, 2021, p. 45):\n\nMonte Carlo simulations: Minimum 10,000 iterations for uncertainty propagation\n90% confidence intervals: Half-width calculation for adjustment factors\nConservative bias: Systematic underestimation acceptable, overestimation prohibited\nWhole-chain integration: Combine activity data + emission factor uncertainties\nCrediting period aggregation: Flexibility to sum uncertainty deductions across years\nAllometry Exemption: Allometric modelling uncertainty is excluded as non-mandatory.\n\nEquation 10: Uncertainty deduction\n\\[\nUNC_t = (GHGER_t + GHGREMV_t) \\times UA_t\n\\]\nEquation 11: Uncertainty adjustment factor\n\\[\nUA_t = 0.524417 \\times \\frac{HW_{90\\%}}{1.645006}\n\\]",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#primer-on-uncertainty-statistics",
    "href": "index.html#primer-on-uncertainty-statistics",
    "title": "REDD+ Uncertainty Training",
    "section": "Primer on Uncertainty Statistics",
    "text": "Primer on Uncertainty Statistics\nForest carbon inventory fundamentally relies on making inferences about true population estimates from limited samples of observed data. But a forest is complex, and our measuring tools and samples are never perfect. For example, when we measure 50 field plots across a million-hectare jurisdiction, we expect that our sample mean will vary from the true mean. Uncertainty is simply how much doubt we have that our measured average is close to the true average.\nFundamentally, this difference between our sampled average and the assumed true population average2 is what informs the metrics of statistical uncertainty. For instance, this dispersion in estimates is computed using:\n\nStandard deviation (DescTools::SD()):3 Measures the spread of observed points around the sample mean, a property of our field sample itself describing how spread out our observations are from one another and their mean.\nStandard error (DescTools::MeanSE()): Measures how much the sample mean is expected to deviate from the true population estimates that are assumed to follow the universal law of large numbers when at critical mass. In effect, this property characterizes our subsample’s precision according to that assumed truth. Expressed as \\(\\text{se} = \\frac{\\sigma}{\\sqrt{n}}\\), this also implies standard errors will ultimately decrease the more we increase our sample size.\n\nThe distinction is critical: standard deviation quantifies data variability, while standard error quantifies estimation precision. For example, under the ART-TREES Standard (V2.0), the 90% confidence interval uses a z-value of 1.645, meaning we can be 90% confident the true mean lies within ±1.645 standard errors of our sample mean.\nRoot Mean Squared Error (DescTools::RMSE(); Armstrong (1978)) measures a slightly different dimension of uncertainty by estimating prediction accuracy rather than sampling precision. While standard error decreases with larger sample sizes, RMSE measures model performance and remains constant unless the model itself improves:\n\\[\nRMSE = \\sqrt{\\frac{1}{n} \\sum_{i=1}^{n} (\\text{ref}_i - x_i)^2}\n\\]\nIn forest carbon accounting, RMSE quantifies how much model predictions deviate from observed reference values. Common applications include allometric equations, remote sensing models predicting forest attributes, and land cover classification accuracy assessments. While ART-TREES v2.0 exempts allometric uncertainty from mandatory reporting, RMSE values inform emission factor uncertainty and sampling design decisions.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#primer-on-monte-carlo-methods",
    "href": "index.html#primer-on-monte-carlo-methods",
    "title": "REDD+ Uncertainty Training",
    "section": "Primer on Monte Carlo Methods",
    "text": "Primer on Monte Carlo Methods\nMonte Carlo simulation traces its roots to the Markov Chain, developed by Andrey Markov in the early 1900s (Sheynin, 1989). At the time, Markov publicly feuded with Pavel Nekrasov, who claimed statistical laws required independent events, arguing this supported divine free will. To disprove this, Markov analyzed the first 20,000 letters of a poem by Pushkin finding 8,638 vowels and 11,362 consonants. He demonstrated that the probability of the next letter depends on the current letter, vowels tend to follow consonants and vice versa, yet aggregated over thousands of letter sequences, the system still converged to a stable distribution (43% vowels, 57% consonants). This proved statistical predictability holds even with strong causal dependence.\nThe technique remained theoretical until 1948, when Nicholas Metropolis, John von Neumann, and Stanislaw Ulam at Los Alamos developed the Monte Carlo method and named it after Ulam’s uncle’s love for the roulette casions of Monte Carlo (Metropolis & Ulam, 1949). Metropolis rewired the ENIAC computer to perform the first Monte Carlo simulations of nuclear core criticality. They discovered that rather than generating random configurations and weighting by the Boltzmann factors, they sampled configurations with probability and weighted globally dramatically reducing computational cost.\nA key to its success in nuclear science related to its distinction of one-sided and two-sided error distributions that enabled the design of false-biased simulation algorithms. Specifically, the study of nuclear reactivity required false-bias metrics to more definitively estimate critical levels of neuron activity for achieving a nuclear chain reaction. It is worth noting how the Monte Carlo method emerged from the statistics of critical systems where different rules of dependency are assumed. Critical systems are characterized by self-organizing populations that exist dynamically between steady-state thresholds and unpredictable tipping points, such as in patterns of mega-fires, the spread of beetle outbreaks, or in disease epidemics (Sornette, 2006) where assumption of causal dependence prevails. These approaches also play an increasing role in the spatial and temporal modelling of plant ecology and remote sensing of forest ecosystems (Schrodt et al., 2025).\nOperationally, the Monte Carlo method involves three core mathematical principles:\n\nPseudo-random Number Generation\nMarkov-Rule of Memory-less Dependence\nLaw of Large Numbers & Convergence\n\nPseudo-random Number Generation: Monte Carlo simulations use pseudo-random number generators (PRNG’s) producing deterministic sequences that appear random. The mathematical foundation mirrors prime number distributions, simulating local unpredictability combined with global statistical regularity. There are four different kinds of randomization algorithms that meet Monte Carlo simulation requirements. Randomization compliance can be verified using primality tests published as coded scripts (Baillie & Wagstaff, 1980; Murray, 2003; Solovay & Strassen, 1977).\nMarkov Property Memory-less Dependence: The system “remembers” only the immediate previous state. For example, this limits temporal bounds of resampling so that each year’s carbon stock projection requires only the current year’s state, not 30 years of history, dramatically reducing computational complexity.\n\\[\nP(X_{t+1} | X_t, X_{t-1}, ...) = P(X_{t+1} | X_t)\n\\]\nLaw of Large Numbers: As iterations increase, sample statistics converge to population parameters. Standard error decreases by \\(\\sqrt{m}\\) when samples increase by factor \\(m\\). This informs ART requirement for minimum 10,000 iterations.\n\n\n\n\n\n\nCausal Dependence Trends of Forests\n\n\n\nThis concept of causal dependence is crucial in forest carbon science because ecosystems are not a series of independent coin flips. They are dynamic systems where the state of the forest in Year t+1 is heavily dependent on the state in Year t.\n\nTipping Points and Disturbances: Markovian principles model system transitions, which are vital for understanding disturbance regimes, such as wildfire and pest outbreaks, and potential for ecological tipping points. For example, the probability of a forest transitioning to a degraded state this year is dependent on its current health, not its health 50 years ago.\nModeling Uncertainty: By incorporating these dependent, causal relationships, Monte Carlo models can more realistically simulate the path-dependent uncertainty of carbon stocks over time, rather than treating all uncertainty sources as randomly independent variables",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#training-curriculum",
    "href": "index.html#training-curriculum",
    "title": "REDD+ Uncertainty Training",
    "section": "Training Curriculum",
    "text": "Training Curriculum\nThis curriculum addresses the four primary sources of uncertainty in REDD+ carbon accounting: allometric equations, emission factors, activity data, and their combined error propagation. Winrock International works with partner jurisdictions to implement targeted interventions using Monte Carlo simulation frameworks tailred to each domain. The curriculum draws on real-world examples and practical exercises from this ongoing work:\n\nChapter 1 Allometric Uncertainty: Strategic interventions in allometric estimation are presented that reduce uncertainty by 30-50%, including: development of localized equations (Tier 2) through destructive sampling; model ensemble approaches using Bayesian averaging; integration of wood density and height data from LiDAR or field measurements; and implementation of standardized measurement protocols with quality assurance/quality control (QA/QC) procedures.\nChapter 2 Emission Factor Uncertainty: Multiple methodological interventions and strategic data selections offer important uncertainty reductions in emission factors, including: field validation campaigns, laboratory quantification of organic carbon and soil profiles; seasonal modelling of fuel loads, moisture content, and disturbance severity sampling; and analysis of stand regeneration and updated growth curves. Additionally, the strategic selection of IPCC default emission factors across land conversions represents an often-overlooked resource in emissions accounting. This chapter presents typical default emission factors ranked by their associated uncertainty levels.\nChapter 3 Activity Data Uncertainty: Significant uncertainty reductions can be achieved through: enhanced reference data collection; improved image classification algorithms; multi-temporal validation datasets; systematic accuracy assessment protocols; and integration of high-resolution imagery or LiDAR for forest/non-forest mapping.\nChapter 4 Monte Carlo Aggregation: Effective Monte Carlo simulation frameworks incorporate sensitivity analyses to identify uncertainty sources and quantify their contribution to overall credit deductions. Winrock provides technical assistance in implementing these strategies, drawing on use cases to help jurisdictions prioritize cost-effective improvements and quality assurance measures tailored to their specific forest conditions and monitoring infrastructure.\n\n\n\n\n\n\n\nArmstrong, J. S. (1978). Long-range forecasting: From crystal ball to computer (2nd ed.). Wiley.\n\n\nART. (2021). The REDD+ environmental excellence standard (2.0 ed.). https://www.artredd.org/wp-content/uploads/2021/12/TREES-2.0-August-2021-Clean.pdf\n\n\nBaillie, R., & Wagstaff, S. S. (1980). Lucas pseudoprimes. Mathematics of Computation, 35(152), 1391–1417.\n\n\nButler, B. J., Sass, E. M., Gamarra, J. G., Campbell, J. L., Wayson, C., Olguıń, M., Carrillo, O., & Yanai, R. D. (2024). Uncertainty in REDD+ carbon accounting: A survey of experts involved in REDD+ reporting. Carbon Balance and Management, 19(1), 22.\n\n\nCamara, G., Simoes, R., Souza, F., Menino, F., Pelletier, C., Andrade, P. R., Ferreira, K., & Queiroz, G. (2024). Uncertainty and active learning analysis. In Satellite time series on earth observation data cubes. https://e-sensing.github.io/sitsbook/uncertainty-and-active-learning.html#uncertainty-and-active-learning\n\n\nDuncanson, L., Disney, M., Armston, J., Nickeson, J., Minor, D., & Camacho, F. (2021). Aboveground woody biomass product validation good practices protocol. https://doi.org/10.5067/DOC/CEOSWGCV/LPV/AGB.001\n\n\nIPCC. (2019). 2019 refinement to the 2006 IPCC guidelines for national greenhouse gas inventories (Agriculture, Forestry and Other Land Use, Vol. 4). Intergovernmental Panel on Climate Change. https://www.ipcc-nggip.iges.or.jp/public/2019rf/vol4.html\n\n\nKöhler, P., & Huth, A. (2010). Towards ground-truthing of spaceborne estimates of above-ground life biomass and leaf area index in tropical rain forests. Biogeosciences (Online), 7(8), 2531–2543.\n\n\nMetropolis, N., & Ulam, S. (1949). The monte carlo method. Journal of the American Statistical Association, 44(247), 335–341.\n\n\nMurray, S. H. (2003). The schreier-sims algorithm. Essay Submitted to the Department of Mathematics of the Australian National University.\n\n\nPelletier, J., Martin, D., & Potvin, C. (2013). REDD+ emissions estimation and reporting: Dealing with uncertainty. Environmental Research Letters, 8(3), 034009.\n\n\nSchrodt, F., Beck, M., Estopinan, J., Bowler, D. E., Fontaine, C., Gaüzère, P., Goury, R., Grenié, M., Martins, I. S., Morueta-Holme, N., & al., et. (2025). Advancing causal inference in ecology: Pathways for biodiversity change detection and attribution. Methods in Ecology and Evolution, 16(10), 2276–2304.\n\n\nSheynin, O. B. (1989). AA markov’s work on probability. Archive for History of Exact Sciences, 39(4), 337–377.\n\n\nSimoes, R., Camara, G., Queiroz, G., Souza, F., Andrade, P. R., Santos, L., Carvalho, A., & Ferreira, K. (2021). Satellite image time series analysis for big earth observation data. Remote Sensing, 13(13), 2428.\n\n\nSolovay, R., & Strassen, V. (1977). A fast monte-carlo test for primality. SIAM Journal on Computing, 6(1), 84–85.\n\n\nSornette, D. (2006). Critical phenomena in natural sciences: Chaos, fractals, selforganization and disorder: Concepts and tools. Springer.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#footnotes",
    "href": "index.html#footnotes",
    "title": "REDD+ Uncertainty Training",
    "section": "",
    "text": "https://www.forestcarbonpartnership.org/sites/default/files/documents/fcpf_buffer_guidelines_v4.2_clean_cf28.pdf↩︎\nThe fundamentals of parametric statistics are all based on the calculation of mean estimates of large populations. Key to this, however, is the empirical assumption that true populations, when large enough numbers are sampled, all begin to converge around a specific shape in distribution that follows the dimensions of a bell-curve.↩︎\nThe package::function()notation (e.g., DescTools::SD()) explicitly identifies which package each function belongs to, helping users verify package installations and resolve naming conflicts.↩︎",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "01-allometry/index.html",
    "href": "01-allometry/index.html",
    "title": "1. Allometry",
    "section": "",
    "text": "Overview\nAllometric equations represent the proportional and scaling relationships between different tree dimensions, such as the relationship between a tree’s diameter and its height, biomass, or crown size. When trees are considered at a population scale, their different dimensions are statistically related through shared ontogenic development patterns (Gould, 1966). These relationships remain consistent across tree sizes, from saplings to canopy dominants, when growing under similar conditions (Archibald & Bond, 2003; Bohlman & O’Brien, 2006; Dietze et al., 2008; King, 1996).\nThis biological principle underpins REDD+ carbon accounting: allometric equations translate field measurements of diameter at breast height (DBH) into biomass estimates, forming the foundation of emission reduction quantification.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>1. Allometry</span>"
    ]
  },
  {
    "objectID": "01-allometry/index.html#overview",
    "href": "01-allometry/index.html#overview",
    "title": "1. Allometry",
    "section": "",
    "text": "Allometry Investment\n\n\n\nAlthough Section 8 exempts structural allometric uncertainty when models are applied consistently, the choice of which model to apply directly impacts reported uncertainty. Allometry variance is absolute and compounds more dramatically so that model selection determines the magnitude of random error that cannot be exempted downstream. In practical terms, selecting a model with 20% RMSE versus 8% RMSE determines whether your project faces a 6% or 2% carbon credit deduction, representing a difference worth $200k in a 1M tCO2-e project at $5/tonne.\n\n\n\nEnvironment Setup (R)\n\neasypackages::packages(\n    \"animation\", \"BIOMASS\", \"cols4all\", \"covr\", \"cowplot\", \"caret\",\n  \"DescTools\", \"dataMaid\", \"dplyr\", \"FawR\", \"ForestToolsRS\", \"forestdata\", \n  \"flextable\", \"ggplot2\", \"giscoR\", \"ggfortify\", \"htmltools\", \n    \"janitor\", \"jsonlite\", \"lattice\", \"leaflet.providers\", \"leaflet\", \n    \"lmtest\", \"lwgeom\", \"kableExtra\", \"kernlab\", \"knitr\", \"mapedit\", \n    \"mapview\", \"maptiles\", \"Mlmetrics\", \"ModelMetrics\", \"moments\", \n    \"olsrr\", \"openxlsx\", \"plotly\", \"psych\", \"randomForest\", \n  \"raster\",\"RColorBrewer\", \"rmarkdown\", \"renv\", \"reticulate\", \n    \"s2\", \"sf\", \"scales\", \"sits\",\"spdep\", \"stars\", \"stringr\", \n    \"terra\", \"tmap\", \"tmaptools\", \"tidymodels\", \"tidyverse\", \"tidyr\", \"tune\",\n    \"useful\",\n  prompt = F\n  )\n\n\nEnvironment Setup (Python)1",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>1. Allometry</span>"
    ]
  },
  {
    "objectID": "01-allometry/index.html#sec-allometry-relationship",
    "href": "01-allometry/index.html#sec-allometry-relationship",
    "title": "1. Allometry",
    "section": "1.1 Allometric Equations",
    "text": "1.1 Allometric Equations\nIn its broadest sense, allometry describes any linear or non-linear correlation between increases in tree dimensions during ontogenic development (Picard et al., 2012). A more restrictive definition, originating with Huxley (1924), refers specifically to proportional relationships between relative increases in dimensions:\nAllometric equations predict aboveground biomass from diameter measurements using species- or biome-specific parameters. Uncertainty compounds from three sources: model selection, parameter estimation, and field measurements. Log-transformation adds complexity through required back-transformation:\n\\[\n\\frac{\\mathrm{d}B}{B} = a\\frac{\\mathrm{d}D}{D}\n\\]\nwhich integrates to the power relationship:\n\\[\nAGB = \\alpha \\times DBH^{\\beta}\n\\]\nand in logarithmic form:\n\\[\n\\ln(AGB) = \\ln(\\alpha) + \\beta \\times \\ln(DBH) + \\epsilon\n\\]\nWhere:\n\n\nAGB: Aboveground biomass (kg)\n\nDBH: Diameter at breast height (cm)\n\nα, β: Modelling exponents/parameters\n\nε: Random error term\n\nThis power-law form reflects the self-similarity principle observed in tree growth: as trees develop from seedlings to mature individuals, they maintain consistent proportional relationships between their dimensions (Gould, 1971). In this framework, the exponent β serves as the allometric coefficient, quantifying how one dimension changes relative to another during growth. For example, if β = 2.5, a 10% increase in diameter corresponds to a 25% increase in biomass. The parameter α is a scaling constant accounting for wood density, architectural form, and other species-specific characteristics.\nWest et al. (1997) and Enquist et al. (1999) developed an allometric scaling theory based on the “pipe model” (Shinozaki et al., 1964) and physical growth principles. Their framework predicts a universal exponent of β ≈ 2.67 based on biomechanical constraints, tree stability, and hydraulic resistance. While this theoretical exponent has been debated regarding its universality (Muller-Landau et al., 2006; Zianis & Mencuccini, 2004), it provides a physically grounded benchmark for evaluating empirical equations.\nIn this chapter, we compare allometry species-specific allometry with biome-generic equations that are more commonly applied in REDD+ programs to demonstrate how uncertainty metrics can inform model selection and impact carbon credit deductions. We adopt the broadest definition of allometry as any correlation between tree dimensions, whether in linear, log-log, power-law, or other functional forms, to examine the following questions:\n\nHow should uncertainty metrics inform model selection and optimization?\nHow does allometry uncertainty impacts carbon credit deductions",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>1. Allometry</span>"
    ]
  },
  {
    "objectID": "01-allometry/index.html#sec-model-selection",
    "href": "01-allometry/index.html#sec-model-selection",
    "title": "1. Allometry",
    "section": "1.2 Model Selection",
    "text": "1.2 Model Selection\nThe choice of allometric equation directly determines uncertainty magnitude and carbon credit deductions. This section demonstrates quantitative differences between equation categories using the scbi_stem1 dataset from the ForestGEO plot inventory in Front Royal, Virginia. This 25.6-hectare mature secondary forest is dominated by Appalachian mixed hardwood species including tulip poplar (Liriodendron tulipifera), oaks (Quercus spp.), and hickories (Carya spp.), representing typical stand composition of the Blue Ridge and Piedmont regions.\nFor REDD+ carbon accounting, we tend to focus exclusively on ontogenic allometry to estimate relationships between accessible tree dimensions and total aboveground biomass as trees grow from seedling to maturity. However, some reading of evolutionary allometry is sometimes needed to address differences in specific traits that emerged in localized conditions. For example, the following species share in genus but vary in wood density, branch architecture, and bole form:\n\n\nAcer rubrum (red maple): Lower density (0.49 g/cm³), faster growth\n\nAcer saccharum (sugar maple): Higher density (0.63 g/cm³), denser wood\n\nAcer negundo (box elder): Intermediate density (0.42 g/cm³), different architecture\n\nTypes of Equations\nAllometric equations are classified by taxonomic scope and environmental specificity. In practice, the choice of equation category involves balancing precision, cost, and data availability:\n\nSpecies-Specific Equations: Developed from destructive sampling of target species, providing highest accuracy but limited geographic applicability (Gonzalez-Akre et al., 2022). These equations capture species-specific morphometric traits, such as branching architecture and wood density, which influence biomass allocation.\nGenus-Specific Equations: Aggregated across multiple species within a genus, offering broader applicability with moderate accuracy (Jansen et al., 1996; Jenkins, 2004). Assumes shared evolutionary heritage produces similar allometric scaling within genera.\nBiome-Generic Equations: Most commonly used in REDD+ report, pan-tropical, generic equations fitted across broader geographic regions and biomes, maximizing applicability but potentially introducing bias (Brown, 1997; Chave et al., 2009; Chave et al., 2014; West et al., 1997). Often incorporate wood density (WD) or environmental stress factors to capture regional variation.\nEnvironmentally-Conditioned Equations: Gold-standard allometric models that incorporate biophysical variables reflecting site-specific growing conditions, critical for REDD+ programs in specialized ecosystems (Komiyama et al., 2005, 2008; Rahman et al., 2021). These equations explicitly model environmental drivers of growth variation:\n\nSalinity gradients: Mangrove allometry where salt stress affects growth rate, wood density, and architectural form\nSoil fertility: Nutrient availability influencing wood density and height-diameter relationships\nClimate: Temperature and precipitation gradients captured through environmental stress factors\nGeomorphology: Tidal inundation frequency, elevation, or hydrological regime\n\n\n\n\n\n\n\n\n\n\nMangroves Tree Height\n\n\n\nIn specialized growing environments, such as mangrove habitats, the choice of allometry significantly affects accuracy estimates. For example, Rocha de Souza Pereira et al. (2018) found generic allometries to produce -18% & +14% wider error magins than species-specific equations in Brazilian mangrove forests. To compensate, generic equations incorporate proxies of environmental stress, such as wood density, height-diameter ratios or “stunting”, and species composition.\nHowever, while inclusion of tree height significantly reduces bias in AGB estimates (Chave et al., 2014; Rutishauser et al., 2013), the accurate measurement of tree height in closed-canopy forests is especially challenging(King & Clark, 2011). Field data with high levels of tree height variance can limit these destructively sampled allometry models. This represents investment opportunity from reducing uncertainty through improved survey technology, such as LiDAR and RADAR (Feldpausch et al., 2011; Valbuena et al., 2016).\n\n\n\nData Preparation\n\n# import dataset from allodb.pkg\nlibrary(\"allodb\")\ndata(scbi_stem1)\n\n#scbi_stem1 |&gt; dplyr::group_by(Family) |&gt;\n#   dplyr::summarise(`Tree Families sampled` = n()) |&gt;\n#   flextable::flextable()|&gt; flextable::autofit()\n\nscbi_stem1 |&gt; dplyr::group_by(Family, genus, species) |&gt;\n    dplyr::summarise(`Total Trees (n)` = n()) |&gt;\n    flextable::flextable()|&gt; flextable::autofit() |&gt;\n    flextable::fontsize(size = 9, part = \"all\")\n\n\n\n\n\nFamily\ngenus\nspecies\nTotal Trees (n)\n\n\n\nAdoxaceae\nSambucus\ncanadensis\n20\n\n\nAdoxaceae\nViburnum\nprunifolium\n19\n\n\nAdoxaceae\nViburnum\nrecognitum\n2\n\n\nAnnonaceae\nAsimina\ntriloba\n14\n\n\nAquifoliaceae\nIlex\nverticillata\n32\n\n\nBetulaceae\nCarpinus\ncaroliniana\n57\n\n\nBetulaceae\nCorylus\namericana\n1\n\n\nCannabaceae\nCeltis\noccidentalis\n24\n\n\nCaprifoliaceae\nLonicera\nmaackii\n1\n\n\nCornaceae\nCornus\nflorida\n24\n\n\nElaeagnaceae\nElaeagnus\numbellata\n1\n\n\nFabaceae\nCercis\ncanadensis\n25\n\n\nFagaceae\nFagus\ngrandifolia\n27\n\n\nFagaceae\nQuercus\nalba\n14\n\n\nFagaceae\nQuercus\nmichauxii\n1\n\n\nFagaceae\nQuercus\nprinus\n35\n\n\nFagaceae\nQuercus\nrubra\n26\n\n\nFagaceae\nQuercus\nvelutina\n8\n\n\nHamamelidaceae\nHamamelis\nvirginiana\n107\n\n\nJuglandaceae\nCarya\ncordiformis\n30\n\n\nJuglandaceae\nCarya\nglabra\n64\n\n\nJuglandaceae\nCarya\novalis\n16\n\n\nJuglandaceae\nCarya\nsp\n3\n\n\nJuglandaceae\nCarya\ntomentosa\n24\n\n\nJuglandaceae\nJuglans\nnigra\n13\n\n\nLauraceae\nLindera\nbenzoin\n1,201\n\n\nLauraceae\nSassafras\nalbidum\n8\n\n\nMagnoliaceae\nLiriodendron\ntulipifera\n17\n\n\nMalvaceae\nTilia\namericana\n2\n\n\nNyssaceae\nNyssa\nsylvatica\n10\n\n\nOleaceae\nChionanthus\nvirginicus\n3\n\n\nOleaceae\nFraxinus\namericana\n52\n\n\nOleaceae\nFraxinus\nnigra\n22\n\n\nOleaceae\nFraxinus\npennsylvanica\n1\n\n\nOleaceae\nFraxinus\nsp\n1\n\n\nPlatanaceae\nPlatanus\noccidentalis\n6\n\n\nRosaceae\nAmelanchier\narborea\n123\n\n\nRosaceae\nPrunus\navium\n6\n\n\nRosaceae\nPrunus\nserotina\n4\n\n\nRosaceae\nRosa\nmultiflora\n151\n\n\nRosaceae\nRubus\nallegheniensis\n6\n\n\nRosaceae\nRubus\npensilvanicus\n2\n\n\nRosaceae\nRubus\nphoenicolasius\n17\n\n\nSapindaceae\nAcer\nnegundo\n15\n\n\nSapindaceae\nAcer\nrubrum\n17\n\n\nSimaroubaceae\nAilanthus\naltissima\n1\n\n\nUlmaceae\nUlmus\namericana\n2\n\n\nUlmaceae\nUlmus\nrubra\n20\n\n\nUlmaceae\nUlmus\nsp\n12\n\n\n\n\n\n\n\n\n\n\n\n\nCompiling Species’ Allometries\n\n\n\nScope permitting, this training would examine a full allometry worflow. Effectively, this which would require repeating the same process below for all genus in our field dataset, incorporating equations per species cumulatively. We provide brief demonstration of how to add each new equations using alldob operations.\n\n\nWe filter scbi_stem1 to Quercus observations, the largest genus subsample, to compare the scaling impact of generic allometry with subspecies and genus equations. Missing entries are also removed, providing a new sample of 84 stems from the dataset’s total measurements of 2,287 trees.\n\n\ndbh: Diameter at breast height (cm)\n\ngenus: Taxonomic genus identification\n\nspecies: Species epithet\n\nFamily: Taxonomic family classification\n\n\n# Genus-specific subsample of dataset\nscbi_quercus = scbi_stem1 |&gt;\n  dplyr::filter(!is.na(dbh)) |&gt;\n    dplyr::filter(genus == \"Quercus\") \n\n# Species-specific subsample of dataset\nscbi_quercus_rubra = scbi_stem1 |&gt;\n  dplyr::filter(!is.na(dbh)) |&gt;\n    dplyr::filter(genus == \"Quercus\") |&gt;\n    dplyr::filter(species == \"rubra\") \n\n\n\n\n\n\n\nVariable\nn\nmean\nsd\nmedian\nmin\nmax\nskew\nkurtosis\nse\n\n\n\nDBH (cm)\n84.000\n27.795\n20.177\n25.980\n1.040\n83.500\n0.438\n-0.719\n2.202\n\n\ngenus*\n84.000\n1.000\n0.000\n1.000\n1.000\n1.000\n\n\n0.000\n\n\nspecies*\n84.000\n3.155\n1.167\n3.000\n1.000\n5.000\n-0.568\n-0.369\n0.127\n\n\nFamily*\n84.000\n1.000\n0.000\n1.000\n1.000\n1.000\n\n\n0.000\n\n\n\n\n\n\n\n\n\n\n\n\n\nDBH Spread\n\n\n\nAt this early stage in the workflow, it helps to quickly scan the range and spread in DBH values. Applied directly, candidate equations can be filtered by min and max dbh values Deviation from the mean provides indicators of the statistical operations needed ahead during equation selection, bias correction, and model optimization. It also informs sample\n\n\n\nEquation Selection\nFollowing best practices from forest inventory methodology (Duncanson et al., 2021), equation selection may proceed through the four sequential criteria in order of their priority below:\n\nGeographic Proximity: Prioritize equations developed in climates and soil conditions similar to your project area\nTaxonomic Specificity: Prefer species-level &gt; genus-level &gt; family-level equations\nDBH Range Coverage: Ensure equation applicability spans ≥80% of measured diameter distribution\nSample Size Adequacy: Minimum n=50 trees for species-specific; n&gt;150 for genus-level equations2\n\n\n\n# Load allometric equations\ndata(equations)\ndata(\"equations_metadata\")\n\n# display all equation criteria\ndplyr::glimpse(equations)\nNA Rows: 570\nNA Columns: 47\nNA $ ref_id                       &lt;chr&gt; \"barney_1977_bdac\", \"baskerville_1966_dmp…\nNA $ equation_id                  &lt;chr&gt; \"4b4063\", \"e2c7c7\", \"e42e41\", \"2bc879\", \"…\nNA $ equation_allometry           &lt;chr&gt; \"exp(3.63+2.54*log(dbh))\", \"exp(0.15+2.48…\nNA $ equation_form                &lt;chr&gt; \"exp(a+b*log(dbh))\", \"exp(a+b*(log(dbh))\"…\nNA $ dependent_variable           &lt;chr&gt; \"Total aboveground biomass\", \"Total above…\nNA $ independent_variable         &lt;chr&gt; \"DBH\", \"DBH\", \"DBH\", \"DBH\", \"DBH\", \"DBH\",…\nNA $ equation_taxa                &lt;chr&gt; \"Picea mariana\", \"Picea glauca\", \"Betula\"…\nNA $ allometry_specificity        &lt;chr&gt; \"Species\", \"Species\", \"Genus\", \"Genus\", \"…\nNA $ equation_categ               &lt;chr&gt; \"sp_spec\", \"sp_spec\", \"generic\", \"generic…\nNA $ geographic_area              &lt;chr&gt; \"Alaska, USA\", \"New Brunswick, Canada\", \"…\nNA $ original_coord               &lt;chr&gt; \"64\\xb0 45', 148\\xb0 15'\", \"47\\xb051' N, …\nNA $ lat                          &lt;chr&gt; \"65.75\", \"47.9\", \"NRA\", \"NRA\", \"NRA\", \"NR…\nNA $ long                         &lt;chr&gt; \"-148.25\", \"-68.3\", \"NRA\", \"NRA\", \"NRA\", …\nNA $ elev_m                       &lt;chr&gt; \"167-470\", \"500\", \"NRA\", \"NRA\", \"NRA\", \"N…\nNA $ geography_notes              &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\nNA $ mat_C                        &lt;chr&gt; \"NI\", \"2.2\", \"NRA\", \"NRA\", \"NRA\", \"NRA\", …\nNA $ min.temp_C                   &lt;chr&gt; \"NI\", \"NI\", \"NRA\", \"NRA\", \"NRA\", \"NRA\", \"…\nNA $ max.temp_C                   &lt;chr&gt; \"NI\", \"NI\", \"NRA\", \"NRA\", \"NRA\", \"NRA\", \"…\nNA $ map_mm                       &lt;chr&gt; \"NI\", \"1069\", \"NRA\", \"NRA\", \"NRA\", \"NRA\",…\nNA $ frost_free_period_days       &lt;chr&gt; \"NI\", \"110\", \"NRA\", \"NRA\", \"NRA\", \"NRA\", …\nNA $ climate_notes                &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\nNA $ stand_age_range_yr           &lt;chr&gt; \"51-55 yrs\", \"35-48 yrs\", \"NRA\", \"NRA\", \"…\nNA $ stand_age_history            &lt;chr&gt; \"Recent fires in 1977\", \"Stand originated…\nNA $ stand_basal_area_m2_ha       &lt;chr&gt; \"NI\", \"NI\", \"NRA\", \"NRA\", \"NRA\", \"NRA\", \"…\nNA $ stand_trees_ha               &lt;chr&gt; \"NI\", \"NI\", \"NRA\", \"NRA\", \"NRA\", \"NRA\", \"…\nNA $ forest_description           &lt;chr&gt; \"Typical lowland and upland stands domina…\nNA $ ecosystem_type               &lt;chr&gt; \"Temperate forest\", \"Boreal forest\", \"Tem…\nNA $ koppen                       &lt;chr&gt; \"Dfc\", \"Dfb\", \"Dfb; Cfa\", \"Dfb; Cfa\", \"Df…\nNA $ dbh_min_cm                   &lt;chr&gt; \"1.5\", \"2.54\", \"5\", \"NRA\", \"5\", \"NRA\", \"5…\nNA $ dbh_max_cm                   &lt;chr&gt; \"13\", \"25.4\", \"NRA\", \"NRA\", \"NRA\", \"NRA\",…\nNA $ sample_size                  &lt;chr&gt; \"18\", \"13\", \"NRA\", \"NRA\", \"NRA\", \"NRA\", \"…\nNA $ collection_year              &lt;chr&gt; \"1973\", \"1965\", \"1971, 1995\", \"1971, 1995…\nNA $ dbh_units_original           &lt;chr&gt; \"cm\", \"inch\", \"cm\", \"cm\", \"cm\", \"cm\", \"cm…\nNA $ dbh_unit_CF                  &lt;chr&gt; \"1\", \"0.393701\", \"1\", \"1\", \"1\", \"1\", \"1\",…\nNA $ output_units_original        &lt;chr&gt; \"g\", \"lbs\", \"metric_ton\", \"m\", \"metric_to…\nNA $ output_units_CF              &lt;chr&gt; \"0.001\", \"0.453592\", \"1000\", \"1\", \"1000\",…\nNA $ allometry_development_method &lt;chr&gt; \"harvest\", \"harvest\", \"harvest?\", \"harves…\nNA $ regression_model             &lt;chr&gt; \"log-transformed\", \"log-transformed\", NA,…\nNA $ r_squared                    &lt;chr&gt; \"0.91\", \"0.99\", \"NI\", \"NI\", \"NI\", \"NI\", \"…\nNA $ other_equations_tested       &lt;chr&gt; \"NI\", \"NI\", \"NRA\", \"NRA\", \"NRA\", \"NRA\", \"…\nNA $ log_biomass                  &lt;chr&gt; \"1\", \"1\", \"1\", \"0\", \"1\", \"0\", \"1\", \"0\", \"…\nNA $ bias_corrected               &lt;chr&gt; \"0\", \"0\", NA, NA, NA, NA, NA, NA, NA, NA,…\nNA $ bias_correction_factor       &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\nNA $ notes_fitting_model          &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\nNA $ original_equation_id         &lt;chr&gt; \"Upland black spruce\", NA, NA, NA, NA, NA…\nNA $ original_data_availability   &lt;chr&gt; \"NRA\", \"NRA\", \"NRA\", \"NRA\", \"NRA\", \"NRA\",…\nNA $ equation_notes               &lt;chr&gt; NA, NA, \"Proved difficult to obtain origi…\n\nTable X: Full list of variables in equations metadata available used in selection criteria using allodb package below.\n\n\n\n\n\n\n\n\nNavigating Databases\n\n\n\n\nIt is recommend using latitude and longitude variables over the field called geographic_area when filtering allodb database due to entry inconsistencies. This is done below using dplyr SQL. However, once the specific allometric equation is identified, we must re-select it using the allodb native function called new_equations() and the equation’s ID# (Gonzalez-Akre et al., 2025).\nIn subsequent cells, we import pan-tropical equations and fit them with values from by Global Wood Density database using the computeAGB() andgetWoodDensity() functions from the BIOMASS package (Réjou-Méchain, Tanguy, Piponiot, Chave, & Herault, 2017a).\n\n\n\n\nStep 1: Geographic Selection\n\n# Simple North America filter\neq_region &lt;- equations |&gt;\n  dplyr::mutate(lat = as.numeric(lat), long = as.numeric(long)) |&gt;\n  dplyr::filter(!is.na(lat), !is.na(long), lat &gt;= 24, lat &lt;= 72, long &gt;= -168, long &lt;= -52)\n\n# tabulate\nshow_cols   = c(\"ref_id\", \"equation_taxa\", \"allometry_specificity\", \"equation_allometry\")\nhead(eq_region[, show_cols]) |&gt; flextable::flextable() |&gt; flextable::autofit() # top six rows only\n\n\n\n\n\nref_id\nequation_taxa\nallometry_specificity\nequation_allometry\n\n\n\nbarney_1977_bdac\nPicea mariana\nSpecies\nexp(3.63+2.54*log(dbh))\n\n\nbaskerville_1966_dmpi\nPicea glauca\nSpecies\nexp(0.15+2.48*log(dbh))\n\n\nbond-lamberty_2002_aabb\nLarix laricina\nSpecies\n10^(2.648+0.715*(log10(dbh)))\n\n\nbond-lamberty_2002_aabb\nSalix\nGenus\n10^(2.481+1.19*(log10(dbh)))\n\n\nbridge_1979_fpom\nQuercus velutina\nSpecies\nexp(-0.34052+2.65803*log(dbh))\n\n\nbrown_1976_esbf\nJuniperus communis\nSpecies\nexp(4.081+2.202*(0.36738 + 0.94932*log(dbh)))\n\n\n\n\n\n#flextable::flextable(eq_region[, show_cols]) |&gt; flextable::autofit() # complete list for Appendix\ncat(sprintf(\"Equations valid to region: %d\\n\", nrow(eq_region)))\nNA Equations valid to region: 157\n\nStep 2: Taxonomic Selection\n\n# species-specific equations for all Quercus subspecies of North America \neq_region_species &lt;- eq_region |&gt;\n    dplyr::filter(allometry_specificity == \"Species\") |&gt;\n    dplyr::filter(grepl(\"^Quercus\", equation_taxa, ignore.case = TRUE) | # Starts with \"Quercus\"\n        (allometry_specificity %in% c(\"Genus\", \"Family\") & \n            grepl(\"Quercus\", equation_taxa, ignore.case = TRUE))\n        )\n\n# genus-specific equations for Quercus populations of North America \neq_region_genus = eq_region |&gt; \n    dplyr::filter(allometry_specificity == \"Genus\") |&gt;\n    dplyr::filter(grepl(\"^Quercus\", equation_taxa, ignore.case = TRUE) |  # Starts with \"Quercus\"\n            (allometry_specificity %in% c(\"Genus\", \"Family\") & \n        grepl(\"Quercus\", equation_taxa, ignore.case = TRUE))\n            )\n\n# tabulate\nflextable::flextable(eq_region_species[, show_cols]) |&gt; flextable::autofit()\n\n\n\n\n\nref_id\nequation_taxa\nallometry_specificity\nequation_allometry\n\n\n\nbridge_1979_fpom\nQuercus velutina\nSpecies\nexp(-0.34052+2.65803*log(dbh))\n\n\nchapman_1991_apac\nQuercus rubra\nSpecies\nexp(-2.972-0.017*dbh+2.873*(log(dbh)))\n\n\nclark_1986b_wvap\nQuercus alba\nSpecies\n1.73738*(dbh^2)^1.33404\n\n\nclark_1986b_wvap\nQuercus alba\nSpecies\n1.69511*(dbh^2)^1.33917\n\n\nclark_1986b_wvap\nQuercus coccinea\nSpecies\n1.62952*(dbh^2)^1.34103\n\n\nclark_1986b_wvap\nQuercus coccinea\nSpecies\n2.94915*(dbh^2)^1.21733\n\n\nclark_1986b_wvap\nQuercus prinus\nSpecies\n0.86674*(dbh^2)^1.47585\n\n\nclark_1986b_wvap\nQuercus prinus\nSpecies\n3.40602*(dbh^2)^1.19049\n\n\nclark_1986b_wvap\nQuercus rubra\nSpecies\n3.06739*(dbh^2)^1.22338\n\n\nclark_1986b_wvap\nQuercus rubra\nSpecies\n3.28071*(dbh^2)^1.20936\n\n\nclark_1986b_wvap\nQuercus velutina\nSpecies\n1.2927*(dbh^2)^1.36723\n\n\nclark_1986b_wvap\nQuercus velutina\nSpecies\n2.5465*(dbh^2)^1.22586\n\n\nmartin_1998_aban\nQuercus alba\nSpecies\n10^(-1.266+2.613*(log10(dbh)))\n\n\nmartin_1998_aban\nQuercus coccinea\nSpecies\n10^(-1.283+2.685*(log10(dbh)))\n\n\nmartin_1998_aban\nQuercus prinus\nSpecies\n10^(-1.587+2.910*(log10(dbh)))\n\n\nmartin_1998_aban\nQuercus rubra\nSpecies\n10^(-1.259+2.644*(log10(dbh)))\n\n\nperala_1994_abef\nQuercus rubra\nSpecies\n0.1335*(dbh^2.422)*((3.706*dbh^0.4932)^0.4389)\n\n\nthis_study\nQuercus agrifolia\nSpecies\n24.2*(1-exp(-0.0466*dbh^0.8183))\n\n\nthis_study\nQuercus parvula\nSpecies\n1.8219*dbh^0.6332\n\n\n\n\n\n#flextable::flextable(eq_region_genus[, show_cols]) |&gt; flextable::autofit()\ncat(sprintf(\"Genus-specific equations valid to region: %d\\n\", nrow(eq_region_genus)))\nNA Genus-specific equations valid to region: 1\ncat(sprintf(\"Species-specific equations valid to region: %d\\n\", nrow(eq_region_species)))\nNA Species-specific equations valid to region: 19\n\nStep 3: DBH Matching Selection\n\n# filter genus-specific equations by DBH range of field data\nfield_dbh_min &lt;- min(scbi_quercus$dbh, na.rm = T) # 1.04 cm\nfield_dbh_max &lt;- max(scbi_quercus$dbh, na.rm = T) # 83.5 cm\n\neq_region_genus_dbh &lt;- eq_region_genus |&gt;\n  dplyr::mutate(\n    dbh_min_cm = as.numeric(dbh_min_cm), \n    dbh_max_cm = as.numeric(dbh_max_cm)) |&gt;\n  dplyr::filter(!is.na(dbh_min_cm), !is.na(dbh_max_cm),\n    # extrapolation of saplings (min=20cm), compensated in Step 5 (risk if high sapling count)\n    dbh_min_cm &lt;= field_dbh_min * 20, \n    dbh_max_cm &gt;= field_dbh_max)\n\neq_region_species_dbh &lt;- eq_region_species |&gt;\n  dplyr::mutate(\n    dbh_min_cm = as.numeric(dbh_min_cm), \n    dbh_max_cm = as.numeric(dbh_max_cm)) |&gt;\n  dplyr::filter(!is.na(dbh_min_cm), !is.na(dbh_max_cm),\n    dbh_max_cm &gt;= field_dbh_max * 0.7) \n        # extrapolation of crowns allowed, consider outliers\n\nflextable::flextable(eq_region_genus_dbh[, show_cols]) |&gt; flextable::autofit()\n\n\n\n\n\nref_id\nequation_taxa\nallometry_specificity\nequation_allometry\n\n\nstovall_2018_ibca\nQuercus sp.\nGenus\nexp(-1.5091+2.3237*log(dbh))+0.24\n\n\n\n\nflextable::flextable(eq_region_species_dbh[, show_cols]) |&gt; flextable::autofit()\n\n\n\n\n\nref_id\nequation_taxa\nallometry_specificity\nequation_allometry\n\n\n\nchapman_1991_apac\nQuercus rubra\nSpecies\nexp(-2.972-0.017*dbh+2.873*(log(dbh)))\n\n\nclark_1986b_wvap\nQuercus rubra\nSpecies\n3.28071*(dbh^2)^1.20936\n\n\nmartin_1998_aban\nQuercus alba\nSpecies\n10^(-1.266+2.613*(log10(dbh)))\n\n\nthis_study\nQuercus agrifolia\nSpecies\n24.2*(1-exp(-0.0466*dbh^0.8183))\n\n\n\n\n\ncat(sprintf(\"Genus-specific equations valid for region, Quercus, & DBH range: %d\\n\", nrow(eq_region_genus_dbh)))\nNA Genus-specific equations valid for region, Quercus, & DBH range: 1\ncat(sprintf(\"Specific-specific equations valid for region, Quercus, & DBH range: %d\\n\", nrow(eq_region_species_dbh)))\nNA Specific-specific equations valid for region, Quercus, & DBH range: 4\n\n\nview(equations)\n\nStep 4: Sample Size Selection\nThe required sample size for allometric equation development depends on desired precision and diameter distribution. Roxburgh et al. (2015) demonstrated through Monte Carlo resampling that biomass predictions with a standard deviation within 7.5% of mean demands sample sizes of between 17 and 166, depending on the algorithm employed. Most importantly, stratified sampling across age class or dbh size is critical to improving precision.\n\neq_region_genus_dbh_sample &lt;- eq_region_genus_dbh |&gt;\n  dplyr::filter(sample_size &gt;= 17)  # Minimum for genus-specific equations\n\neq_region_species_dbh_sample &lt;- eq_region_species_dbh |&gt;\n  dplyr::filter(sample_size &gt;= 17)  # Minimum for species-specific equations\n\n# Display selected equations & tally valid equations remaining\nflextable::flextable(eq_region_genus_dbh_sample[, show_cols]) |&gt; flextable::autofit()\n\n\n\n\n\nref_id\nequation_taxa\nallometry_specificity\nequation_allometry\n\n\nstovall_2018_ibca\nQuercus sp.\nGenus\nexp(-1.5091+2.3237*log(dbh))+0.24\n\n\n\n\nflextable::flextable(eq_region_species_dbh_sample[, show_cols]) |&gt; flextable::autofit()\n\n\n\n\n\nref_id\nequation_taxa\nallometry_specificity\nequation_allometry\n\n\n\nclark_1986b_wvap\nQuercus rubra\nSpecies\n3.28071*(dbh^2)^1.20936\n\n\nthis_study\nQuercus agrifolia\nSpecies\n24.2*(1-exp(-0.0466*dbh^0.8183))\n\n\n\n\n\ncat(sprintf(\"Genus-specific equations meeting all criteria: %d\\n\", nrow(eq_region_genus_dbh_sample)))\nNA Genus-specific equations meeting all criteria: 1\ncat(sprintf(\"Species-specific equations meeting all criteria: %d\\n\", nrow(eq_region_species_dbh_sample)))\nNA Species-specific equations meeting all criteria: 2\n\n\n\n\n\n\n\nCriterion\nThreshold\nSelected_Value\nJustification\n\n\n\nGeography\nNorth America (24-72°N, -168 to -52°W)\n157 equations in region\nClimate similarity to Front Royal, VA (Cfa)\n\n\nTaxonomy\nSpecies &gt; Genus &gt; Family\n1 genus-level, 19 species-specific\nSpecies-specific preferred; genus fallback acceptable\n\n\nDBH Range\n≥80% field data coverage\n1.0-83.5 cm (field), 11-93 cm (equation)\nMinor extrapolation for saplings (&lt;5% biomass)\n\n\nSample Size\n≥50 (Roxburgh et al. 2015)\nn=66 (Stovall 2018)\nMeets precision threshold of CV=7.5%\n\n\n\n\n\n\nTable X: Equation Selection Documentation for REDD+ MRV\n\n\n\n\n\n\n\nAttribute\nDetail\n\n\nEquation Taxa/ID\n\nQuercus spp. (Genus-level)\n\n\nBiomass Method\nNon-destructive estimation using Terrestrial Laser Scanning (TLS) or Terrestrial LiDAR to model tree volume, which was then converted to biomass using published wood density values.\n\n\nGeographic Location\nFront Royal, Virginia, USA (Smithsonian Conservation Biology Institute, SCBI) at 38.89 N, -78.15W.\n\n\nEmpirical Data\nThe models were developed using 258 non-destructive volume/biomass estimates across 10 dominant hardwood species in this Temperate Mixed Deciduous Forest. The specific equation is a site-specific genus model.\n\n\nRationale for Selection\nThis equation is the most geographically and ecologically similar candidate. It was developed at the exact same site (SCBI in Virginia) where your sample data is likely sourced (based on allodb.Rmdcontent). Despite being a genus-level equation for Quercus (not species-specific), the high degree of climate similarity (Cfa/Temperate Forest) and geographic proximity ensures maximum weight will be assigned by the allodb weighting framework, making it the highest priority candidate for Quercus trees at this site.\n\n\nCitation\nStovall, A. E., Anderson-Teixeira, K. J., & Shugart, H. H. (2018). Terrestrial LiDAR-derived non-destructive woody biomass estimates for 10 hardwood species in Virginia. Data in brief, 19, 1560-1569\n\n\n\n\n\n\n\n\n\n\nAttribute\nDetail\n\n\nEquation Taxa/ID\nQuercus rubra (Species-level)\n\n\nBiomass Method\nDestructive Harvesting (Dimensional Analysis). The traditional method involving felling, weighing, and drying tree components to directly measure biomass.\n\n\nGeographic Location\nWest Virginia, USA (specifically, Monongahela National Forest).\n\n\nEmpirical Data\nThis is a species-specific equation developed explicitly for Northern Red Oak (Quercus rubra). The sample size is typically smaller than meta-analyses but provides high-resolution, direct measurements.\n\n\nRationale for Selection\nThis equation provides high taxonomic specificity (a perfect species match for Quercus rubra). Although its location (West Virginia) is not as proximate as the Stovall (2018) study, it is still within the same Appalachian/Eastern US Temperate Forest region. It serves as a crucial check and source of high-quality empirical data derived from the gold-standard destructive method. allodb balances its lower geographic proximity with its higher taxonomic specificity and robust methodology, making it the strongest secondary candidate.\n\n\nCitation\nClark, A. (1985). Weight, volume, and physical properties of major hardwood species in the Gulf and Atlantic Coastal Plains (Vol. 250). US Department of Agriculture, Forest Service, Southeastern Forest Experiment Station\n\n\n\n\n\nAttribute\nDetail\n\n\n\nChave et al 2014\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAttribute\nDetail\n\n\n\nBrown et al 1996\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nStep 5: Combining Species Equations\nThe following demonstrates functions for consolidating new filtered allometry equations into one combined database prepared for use in final inventory biomass estimations. For this important task, we recommend the specific functions below from the allodb library that are ensure a weighted approach is applied to synthesizing and candidate equations:\nThe weight_allom() function is responsible for assigning a weight to each candidate equation based on three criteria, determining its influence on the final result:\n\nSample size: Equations derived from varying destructive sampling campaigns (n &gt; 100) receive higher weights.\nTaxonomic specificity: Species-specific equations are weighted more heavily than genus-level, which in turn outweigh family-level equations.\nClimate similarity: Equations developed from geographically proximate locations with similar temperature and precipitation regimes receive priority.\n\nThe resample_agb() function implements a Monte Carlo resampling procedure to synthesize a robust, synthetic dataset from the weighted equations:\n\nEach candidate equation is resampled within its original DBH range.\nThe number of resampled values for each equation is proportional to its assigned weight.\nA default of 10,000 iterations (or 1e4 in the demo) ensures a robust representation of the uncertainty distribution. This process generates a synthetic dataset that reflects the collective information from all weighted equations, spanning the full DBH range observed in the target forest.\n\nThe est_params() function then uses the synthetic resampled data to fit the following nonlinear power-law model:\n\\[\nAGB = \\alpha \\ * \\ DBH^b  \\ + \\ \\epsilon\n\\]\nThis process yields the location-specific parameters:\n\n⍺ (scaling coefficient): Incorporates local wood density and architectural characteristics.\n𝒃 (allometric exponent): Typically ranges from 2.3 to 2.7, reflecting biomechanical constraints.\nσ (residual standard deviation): Quantifies the prediction uncertainty for the calibrated equation.\n\nThe resulting equation is location-specific, informed by broader taxonomic and geographic patterns encoded in the weighted source equations.\n\n\n# This table includes filtered default Acer equations AND custom new equations.\neq_tab_combined &lt;- new_equations(\n  subset_taxa = \"Quercus\",\n  new_taxa = c(\"Quercus ilex\", \"Castanea sativa\"),\n  new_allometry = c(\"0.12*dbh^2.5\", \"0.15*dbh^2.7\"),\n  new_coords = c(4, 44),\n  new_min_dbh = c(5, 10),\n  new_max_dbh = c(35, 68),\n  new_sample_size = c(143, 62)\n)\n\n# The get_biomass() function internally performs the weighting, resampling,\n# and calibration based on the equations in eq_tab_combined.\nagb_custom_estimate &lt;- get_biomass(\n  dbh = 50,\ngenus = \"Quercus\",\n  species = \"rubrum\",\n  coords = c(-78.2, 38.9),\n  new_eqtable = eq_tab_combined # Use the consolidated custom table\n)\n\n# Print the resulting AGB estimate\nprint(paste(\"Estimated AGB using the combined custom table:\", agb_custom_estimate, \"kg\"))\n\n\n\n\n\n\n\n\nAllometry Best Practices\n\n\n\n\nTransparency: Document all criteria and thresholds\nReproducibility: Code-based workflow enables auditing\nBias Reduction: Geographic and taxonomic filtering minimizes systematic errors to species level\nUncertainty Surveillance: Multiple equations enable sensitivity analysis (Section 1.5)\n\n\n\n\nBiomass Estimations\nHaving identified candidate species equations, we now compare their aboveground biomass estimates with biome-generic equations (Brown, 1997; Chave et al., 2014). Noting their geographic mismatch, we compared these with pan-tropical equations specifically in order to highlight discrepancies in uncertainty and significance of geography to allometric calibrations.\n\n# once allometry equation is confirmed, use native allodb to load it\neq_region_genus_dbh_sample = allodb::new_equations(subset_ids = \"a664c1\")\n\n# species-specific biomass estimates \nscbi_quercus$agb_species &lt;- allodb::get_biomass(\n  dbh       = scbi_quercus$dbh,\n  genus     = scbi_quercus$genus,\n  species = scbi_quercus$species,\n  coords    = c(-78.2, 38.9)\n  )\n\n# genus-specific biomass estimates\nscbi_quercus$agb_genus &lt;- allodb::get_biomass(\n    dbh         = scbi_quercus$dbh,\n    genus   = scbi_quercus$genus,\n    species = scbi_quercus$species,\n    coords  = c(-78.2, 38.9),\n    new_eqtable = eq_region_genus_dbh_sample\n  )\n\nThe following functions from the BIOMASS package (Réjou-Méchain, Tanguy, Piponiot, Chave, & Herault, 2017b) require some additional wrangling, specifically to extract values from the Global Wood Density database (Vieilledent et al., 2018) and convert units (Réjou-Méchain, Tanguy, Piponiot, Chave, & Hérault, 2017).\n\n\n\n\n\n\nUnit Conversions\n\n\n\nAlways verify if equations require unit conversions or scaling limiters. For example, the most commonly used allometry equation from Chave et al (2014) requires conversion from milligrams to kilograms, as shown below (* 1000).\n\n\n\n# derive generic estimates using standard equations\nwood_densities &lt;- BIOMASS::getWoodDensity(\n  genus         = scbi_quercus$genus,\n  species   = scbi_quercus$species,\n  stand         = scbi_quercus$Plot)\nscbi_quercus$WD &lt;- wood_densities$meanWD\n\n# Chave et al 2014\nscbi_quercus$agb_chave2014 &lt;- BIOMASS::computeAGB(\n  D         = scbi_quercus$dbh,\n  WD        = scbi_quercus$WD,\n  coord = c(-78.2, 38.9))\n\n# convert units\nscbi_quercus$agb_chave2014 = scbi_quercus$agb_chave2014 * 1000\n\n# Chave et al 2005 (MANUAL Fit)\nscbi_quercus$agb_chave2005 &lt;- scbi_quercus$WD * \n  exp(-1.499 + 2.148*log(scbi_quercus$dbh) + \n      0.207*(log(scbi_quercus$dbh))^2 - \n      0.0281*(log(scbi_quercus$dbh))^3)\n\n# Brown et al 1997 (MANUAL Fit)\nscbi_quercus$agb_brown1997 &lt;- exp(2.134 + 2.53 * log(scbi_quercus$dbh))\nscbi_quercus$agb_brown1997 = scbi_quercus$agb_brown1997 / 100 \n\nflextable::flextable(scbi_quercus) |&gt;\n    flextable::autofit()\n\n\n\n\n\ntreeID\nstemID\ndbh\ngenus\nspecies\nFamily\nagb_species\nagb_genus\nWD\nagb_chave2014\nagb_chave2005\nagb_brown1997\n\n\n\n6,014\n6,014\n8.80\nQuercus\nalba\nFagaceae\n41.7637958\n34.6344546\n0.6300\n7.28909988\n29.9737527\n20.71693889\n\n\n6,201\n6,201\n41.72\nQuercus\nalba\nFagaceae\n1,290.4913814\n1,287.8799035\n0.6300\n369.67536146\n1,763.7413271\n1,062.32043295\n\n\n1,158\n1,158\n29.82\nQuercus\nalba\nFagaceae\n615.5371694\n590.2328264\n0.6300\n161.46721089\n748.5947279\n454.24357825\n\n\n3,736\n3,736\n44.38\nQuercus\nalba\nFagaceae\n1,478.8739694\n1,486.7745358\n0.6300\n430.07341800\n2,060.0375737\n1,242.13345169\n\n\n3,741\n3,741\n1.12\nQuercus\nalba\nFagaceae\n0.4437772\n0.2879769\n0.6300\n0.02849730\n0.1799659\n0.11253976\n\n\n6,014\n32,937\n8.20\nQuercus\nalba\nFagaceae\n35.7428951\n29.3933603\n0.6300\n6.06737169\n24.8619475\n17.32740278\n\n\n6,109\n6,109\n72.18\nQuercus\nalba\nFagaceae\n4,321.0815102\n4,602.9666929\n0.6300\n1,397.59542709\n6,762.9023338\n4,251.86147125\n\n\n3,829\n3,829\n1.75\nQuercus\nalba\nFagaceae\n1.1869883\n0.8122677\n0.6300\n0.09783959\n0.4970427\n0.34807328\n\n\n6,065\n6,065\n66.91\nQuercus\nalba\nFagaceae\n3,656.0028342\n3,859.5305575\n0.6300\n1,164.71639683\n5,643.1934452\n3,509.75409893\n\n\n6,122\n6,122\n26.13\nQuercus\nalba\nFagaceae\n460.0281377\n434.2381530\n0.6300\n116.23508795\n531.5668681\n325.19741123\n\n\n3,942\n3,942\n20.04\nQuercus\nalba\nFagaceae\n256.2896125\n234.4031792\n0.6300\n59.76904328\n265.4142731\n166.18262526\n\n\n3,832\n3,832\n8.75\nQuercus\nalba\nFagaceae\n41.2424636\n34.1789382\n0.6300\n7.18211884\n29.5246386\n20.42042603\n\n\n6,198\n6,198\n18.55\nQuercus\nalba\nFagaceae\n216.1527538\n195.8849828\n0.6300\n49.18605136\n216.5281391\n136.67671331\n\n\n3,829\n32,657\n1.52\nQuercus\nalba\nFagaceae\n0.8700448\n0.5854821\n0.6300\n0.06641044\n0.3579301\n0.24369616\n\n\n4,930\n4,930\n42.89\nQuercus\nmichauxii\nFagaceae\n1,373.4642682\n1,373.3608400\n0.6515\n408.00003593\n1,955.3844042\n1,139.31864776\n\n\n4,908\n4,908\n33.74\nQuercus\nprinus\nFagaceae\n807.5290502\n786.4119199\n0.5700\n199.94839362\n930.5024048\n620.85681481\n\n\n4,902\n4,902\n26.56\nQuercus\nprinus\nFagaceae\n476.4422695\n451.0228853\n0.5700\n110.41164268\n501.7925319\n338.90772523\n\n\n3,833\n3,833\n55.13\nQuercus\nprinus\nFagaceae\n2,384.4112362\n2,461.0519474\n0.5700\n665.23436471\n3,191.5742054\n2,150.28497856\n\n\n3,861\n32,665\n31.93\nQuercus\nprinus\nFagaceae\n715.0795197\n691.8486167\n0.5700\n174.45804487\n807.7462398\n540.01726667\n\n\n4,883\n4,883\n16.65\nQuercus\nprinus\nFagaceae\n170.1313989\n152.3911925\n0.5700\n34.12476597\n147.2521410\n103.98302468\n\n\n4,945\n4,945\n7.15\nQuercus\nprinus\nFagaceae\n26.3798528\n21.3787654\n0.5700\n3.87114822\n15.6636024\n12.25120227\n\n\n3,841\n32,661\n3.19\nQuercus\nprinus\nFagaceae\n4.4498892\n3.2776221\n0.5700\n0.45567375\n1.9450578\n1.58991841\n\n\n6,105\n6,105\n38.12\nQuercus\nprinus\nFagaceae\n1,056.9294420\n1,044.2728542\n0.5700\n270.14158890\n1,270.1903091\n845.47598474\n\n\n5,006\n5,006\n48.12\nQuercus\nprinus\nFagaceae\n1,766.6172691\n1,794.2757411\n0.5700\n477.90912983\n2,280.9877313\n1,524.29234100\n\n\n4,937\n4,937\n52.78\nQuercus\nprinus\nFagaceae\n2,166.0259005\n2,224.1461809\n0.5700\n598.47838912\n2,867.4570591\n1,925.89207151\n\n\n3,851\n3,851\n30.39\nQuercus\nprinus\nFagaceae\n641.2312540\n616.7790454\n0.5700\n154.34390938\n711.2124639\n476.53310154\n\n\n6,175\n6,175\n1.06\nQuercus\nprinus\nFagaceae\n0.3919584\n0.2533948\n0.5700\n0.02229260\n0.1443867\n0.09790577\n\n\n3,759\n3,759\n5.41\nQuercus\nprinus\nFagaceae\n14.2631279\n11.1837102\n0.5700\n1.86096287\n7.5384467\n6.05025214\n\n\n4,910\n4,910\n24.54\nQuercus\nprinus\nFagaceae\n400.1816203\n375.2995279\n0.5700\n90.62579821\n408.3704247\n277.43869296\n\n\n3,859\n3,859\n47.92\nQuercus\nprinus\nFagaceae\n1,750.4667155\n1,776.9958375\n0.5700\n473.08038364\n2,257.4804788\n1,508.31475695\n\n\n4,921\n4,921\n49.49\nQuercus\nprinus\nFagaceae\n1,879.4324090\n1,915.2122960\n0.5700\n511.74583227\n2,445.6803675\n1,636.49080317\n\n\n3,854\n3,854\n23.03\nQuercus\nprinus\nFagaceae\n347.8876503\n323.8130771\n0.5700\n77.30652427\n345.9194869\n236.25885900\n\n\n4,971\n4,971\n44.51\nQuercus\nprinus\nFagaceae\n1,487.5100601\n1,496.9134623\n0.5700\n395.04844833\n1,877.5514630\n1,251.35966700\n\n\n4,905\n4,905\n19.73\nQuercus\nprinus\nFagaceae\n247.3597617\n226.0642853\n0.5700\n52.41058628\n230.4819305\n159.75555463\n\n\n4,895\n4,895\n33.33\nQuercus\nprinus\nFagaceae\n786.0488718\n764.3861533\n0.5700\n193.99724551\n901.8064724\n601.94627008\n\n\n3,754\n3,754\n53.48\nQuercus\nprinus\nFagaceae\n2,229.8789323\n2,293.2871922\n0.5700\n617.94106423\n2,962.0057034\n1,991.17136355\n\n\n3,758\n3,758\n29.88\nQuercus\nprinus\nFagaceae\n617.7416800\n592.9957612\n0.5700\n147.99679828\n680.8237270\n456.55939093\n\n\n6,105\n32,948\n29.05\nQuercus\nprinus\nFagaceae\n580.5353679\n555.4242351\n0.5700\n137.99733622\n633.0294522\n425.15192548\n\n\n5,015\n32,813\n30.05\nQuercus\nprinus\nFagaceae\n625.5183651\n600.8643974\n0.5700\n150.09528540\n690.8666473\n463.15989790\n\n\n3,861\n3,861\n47.58\nQuercus\nprinus\nFagaceae\n1,723.1965011\n1,747.8381802\n0.5700\n464.93603183\n2,217.8303142\n1,481.38595772\n\n\n6,181\n6,181\n1.09\nQuercus\nprinus\nFagaceae\n0.4168379\n0.2703709\n0.5700\n0.02409664\n0.1534332\n0.10506872\n\n\n6,051\n6,051\n17.43\nQuercus\nprinus\nFagaceae\n188.2040310\n169.4956107\n0.5700\n38.32204684\n166.2015346\n116.75267326\n\n\n4,921\n32,798\n45.95\nQuercus\nprinus\nFagaceae\n1,595.7024677\n1,611.8547626\n0.5700\n427.01499709\n2,033.1946354\n1,356.33440775\n\n\n3,841\n3,841\n4.07\nQuercus\nprinus\nFagaceae\n7.6147833\n5.7729030\n0.5700\n0.87473536\n3.6111657\n2.94481692\n\n\n4,900\n4,900\n35.01\nQuercus\nprinus\nFagaceae\n876.0796244\n856.9104965\n0.5700\n219.04815032\n1,022.7284035\n681.69558886\n\n\n4,941\n4,941\n19.88\nQuercus\nprinus\nFagaceae\n251.5256581\n230.0777621\n0.5700\n53.42046148\n235.1235863\n162.84629534\n\n\n5,015\n5,015\n51.95\nQuercus\nprinus\nFagaceae\n2,091.6262859\n2,143.7233445\n0.5700\n575.86234802\n2,757.5403004\n1,850.18804602\n\n\n3,754\n32,644\n18.79\nQuercus\nprinus\nFagaceae\n222.1161359\n201.8240515\n0.5700\n46.33847538\n202.6626664\n141.19494298\n\n\n4,942\n4,942\n38.24\nQuercus\nprinus\nFagaceae\n1,064.2799971\n1,051.9267603\n0.5700\n272.23782635\n1,280.3611441\n852.22575020\n\n\n4,939\n4,939\n8.42\nQuercus\nprinus\nFagaceae\n37.8310265\n31.2583034\n0.5700\n5.92783459\n24.1268820\n18.52780521\n\n\n6,043\n6,043\n14.43\nQuercus\nrubra\nFagaceae\n124.3720267\n109.2846080\n0.5600\n23.33392646\n99.0210094\n72.39828285\n\n\n3,740\n3,740\n37.50\nQuercus\nrubra\nFagaceae\n1,022.9397332\n1,005.2332291\n0.5600\n255.26797929\n1,197.0066207\n811.11705223\n\n\n4,844\n4,844\n4.50\nQuercus\nrubra\nFagaceae\n9.5099394\n7.2902273\n0.5600\n1.12427256\n4.5933623\n3.79675072\n\n\n4,967\n4,967\n59.19\nQuercus\nrubra\nFagaceae\n2,800.2155110\n2,902.8525462\n0.5600\n777.41640924\n3,730.0673948\n2,573.78798878\n\n\n5,996\n5,996\n2.38\nQuercus\nrubra\nFagaceae\n2.3324680\n1.6595002\n0.5600\n0.20318978\n0.9240671\n0.75774676\n\n\n4,866\n4,866\n23.28\nQuercus\nrubra\nFagaceae\n357.2923365\n332.0392166\n0.5600\n78.14311997\n349.5885982\n242.80150157\n\n\n3,757\n3,757\n56.39\nQuercus\nrubra\nFagaceae\n2,516.2600962\n2,593.7251264\n0.5600\n691.34613971\n3,314.0550756\n2,276.80465795\n\n\n6,176\n6,176\n83.50\nQuercus\nrubra\nFagaceae\n5,982.8500337\n6,457.2112247\n0.5600\n1,777.37126337\n8,469.3561623\n6,146.83007285\n\n\n4,961\n4,961\n5.91\nQuercus\nrubra\nFagaceae\n17.3523140\n13.7336417\n0.5600\n2.31119112\n9.3298900\n7.56659907\n\n\n4,868\n4,868\n10.05\nQuercus\nrubra\nFagaceae\n55.9887078\n47.1558874\n0.5600\n9.22389498\n37.8950021\n28.99109110\n\n\n6,076\n6,076\n38.59\nQuercus\nrubra\nFagaceae\n1,089.6953435\n1,074.4330615\n0.5600\n273.90764662\n1,287.3055373\n872.09861504\n\n\n2,623\n2,623\n17.00\nQuercus\nrubra\nFagaceae\n178.5575597\n159.9381204\n0.5600\n35.39142453\n152.8518749\n109.60243314\n\n\n6,161\n6,161\n11.30\nQuercus\nrubra\nFagaceae\n72.5157421\n61.9200115\n0.5600\n12.47711209\n51.7345785\n39.00074350\n\n\n4,907\n4,907\n49.98\nQuercus\nrubra\nFagaceae\n1,928.0952178\n1,959.5606600\n0.5600\n515.70304472\n2,462.1753315\n1,677.79507251\n\n\n3,677\n3,677\n38.92\nQuercus\nrubra\nFagaceae\n1,110.3616032\n1,095.9023318\n0.5600\n279.70107400\n1,315.3901411\n891.09031354\n\n\n6,162\n6,162\n50.62\nQuercus\nrubra\nFagaceae\n1,982.9908592\n2,018.3579262\n0.5600\n531.92428266\n2,540.9789427\n1,732.68440736\n\n\n6,041\n6,041\n9.66\nQuercus\nrubra\nFagaceae\n51.3068293\n43.0127640\n0.5600\n8.32711933\n34.1164666\n26.22868617\n\n\n3,828\n32,656\n1.04\nQuercus\nrubra\nFagaceae\n0.3754286\n0.2424244\n0.5600\n0.02079709\n0.1361149\n0.09329937\n\n\n3,735\n3,735\n40.03\nQuercus\nrubra\nFagaceae\n1,181.4363039\n1,169.8984836\n0.5600\n299.70417376\n1,412.4159200\n956.79728404\n\n\n6,142\n32,955\n2.37\nQuercus\nrubra\nFagaceae\n2.3109000\n1.6433444\n0.5600\n0.20088003\n0.9146106\n0.74971772\n\n\n4,873\n4,873\n12.29\nQuercus\nrubra\nFagaceae\n87.2783294\n75.2622525\n0.5600\n15.47986003\n64.6640393\n48.23371373\n\n\n4,864\n4,864\n11.13\nQuercus\nrubra\nFagaceae\n70.1305321\n59.7770919\n0.5600\n11.99996949\n49.6929365\n37.53334068\n\n\n6,031\n6,031\n25.83\nQuercus\nrubra\nFagaceae\n449.3891747\n422.7421958\n0.5600\n101.33350564\n458.5174382\n315.83417415\n\n\n6,142\n6,142\n3.72\nQuercus\nrubra\nFagaceae\n6.2485265\n4.6844437\n0.5600\n0.67693012\n2.8196238\n2.34562232\n\n\n3,828\n3,828\n1.47\nQuercus\nrubra\nFagaceae\n0.8055831\n0.5417037\n0.5600\n0.05433775\n0.2945939\n0.22392226\n\n\n6,000\n6,000\n21.84\nQuercus\nrubra\nFagaceae\n310.3416778\n286.2581018\n0.5600\n66.58020151\n295.7446428\n206.58251378\n\n\n4,871\n4,871\n5.79\nQuercus\nvelutina\nFagaceae\n16.5409796\n13.0944079\n0.5600\n2.18970505\n8.8423679\n7.18391557\n\n\n5,010\n5,010\n48.71\nQuercus\nvelutina\nFagaceae\n1,813.7548532\n1,845.8072228\n0.5600\n484.36445811\n2,309.8804079\n1,572.02086480\n\n\n3,782\n3,782\n29.62\nQuercus\nvelutina\nFagaceae\n605.4843397\n581.0757119\n0.5600\n142.48091704\n653.9536822\n446.57525689\n\n\n6,020\n6,020\n12.18\nQuercus\nvelutina\nFagaceae\n85.2885641\n73.7063466\n0.5600\n15.12706577\n63.1381551\n47.14895719\n\n\n6,160\n6,160\n62.59\nQuercus\nvelutina\nFagaceae\n3,153.0868571\n3,305.1052960\n0.5600\n889.75082893\n4,271.3028221\n2,964.43542637\n\n\n6,145\n6,145\n48.15\nQuercus\nvelutina\nFagaceae\n1,768.0826750\n1,796.8758387\n0.5600\n470.90307235\n2,244.4460318\n1,526.69766645\n\n\n6,139\n6,139\n62.21\nQuercus\nvelutina\nFagaceae\n3,111.0191339\n3,258.6681381\n0.5600\n876.76558732\n4,208.8442021\n2,919.11154588\n\n\n6,101\n6,101\n16.18\nQuercus\nvelutina\nFagaceae\n159.5534665\n142.5822436\n0.5600\n31.22082197\n134.1111885\n96.71639363\n\n\n\n\n\n\nTable 1D: Aboveground biomass estimates derived from five allometry equations of varying scales\nNormality Testing\nNon-normal distributions violate assumptions of parametric statistics, inflating uncertainty estimates. Identifying the true probability distribution enables appropriate transformations that reduce reported uncertainty—directly reducing carbon credit deductions.\nAccurate probability density functions (PDFs) are essential for uncertainty modeling. We assess whether DBH and AGB conform to normal distributions using multiple diagnostic tests:\n\nSkewness & Kurtosis: Quantify asymmetry and tail behavior\nShapiro-Wilk test: Formal normality test (p &lt; 0.05 rejects normality)\nWilcoxon test: Non-parametric alternative for median testing\n\nBoth variables show non-normal distribution with a significant right-skew, violating parametric assumptions and justifying log-transformation in subsequent modeling. Technically, this kind of skew often represents a dataset of many small trees and few large dominants. Statistically, this high positive skewness is confirmed by Shapiro-Wilk test results (p &lt; 0.001) indicating a distribution likely to inflate uncertainty estimates if left untreated.\n\n# Calculate skewness and kurtosis for DBH\ndbh_skew        = moments::skewness(scbi_quercus$dbh)\ndbh_kurt        = moments::kurtosis(scbi_quercus$dbh)\ndbh_shapiro = stats::shapiro.test(scbi_quercus$dbh)\ndbh_wilcox  = stats::wilcox.test(scbi_quercus$dbh)\n\n# Calculate skewness and kurtosis for each AGB estimate\nagb_species_skew            = moments::skewness(scbi_quercus$agb_species)\nagb_species_kurt            = moments::kurtosis(scbi_quercus$agb_species)\nagb_species_shapiro     = stats::shapiro.test(scbi_quercus$agb_species)\nagb_species_wilcox      = stats::wilcox.test(scbi_quercus$agb_species)\n\nagb_genus_skew              = moments::skewness(scbi_quercus$agb_genus)\nagb_genus_kurt              = moments::kurtosis(scbi_quercus$agb_genus)\nagb_genus_shapiro       = stats::shapiro.test(scbi_quercus$agb_genus)\nagb_genus_wilcox            = stats::wilcox.test(scbi_quercus$agb_genus)\n    \nagb_chave2014_skew      = moments::skewness(scbi_quercus$agb_chave2014)\nagb_chave2014_kurt      = moments::kurtosis(scbi_quercus$agb_chave2014)\nagb_chave2014_shapiro = stats::shapiro.test(scbi_quercus$agb_chave2014)\nagb_chave2014_wilcox    = stats::wilcox.test(scbi_quercus$agb_chave2014)\n\nagb_brown1997_skew      = moments::skewness(scbi_quercus$agb_brown1997)\nagb_brown1997_kurt      = moments::kurtosis(scbi_quercus$agb_brown1997)\nagb_brown1997_shapiro = stats::shapiro.test(scbi_quercus$agb_brown1997)\nagb_brown1997_wilcox  = stats::wilcox.test(scbi_quercus$agb_brown1997)\n\nagb_chave2005_skew      = moments::skewness(scbi_quercus$agb_chave2005)\nagb_chave2005_kurt      = moments::kurtosis(scbi_quercus$agb_chave2005)\nagb_chave2005_shapiro = stats::shapiro.test(scbi_quercus$agb_chave2005)\nagb_chave2005_wilcox    = stats::shapiro.test(scbi_quercus$agb_chave2005)\n\n\n\n\n\n\n\nVariable\nn\nMean...SD\nSkewness\nKurtosis\nShapiro.Wilk.p\nDecision\n\n\n\nDBH (cm)\n84\n27.8 ± 20.2\n0.45\n2.34\n0.002\nLog(x) needed?: YES\n\n\nAGB Species (kg)\n84\n894.7 ± 1124.2\n1.89\n7.44\n&lt; 0.001\nLog(x) needed?: YES\n\n\nAGB Genus (kg)\n84\n908.5 ± 1187.6\n2.03\n8.21\n&lt; 0.001\nLog(x) needed?: YES\n\n\nAGB Chave2014 (kg)\n84\n244.1 ± 333.1\n2.15\n8.61\n&lt; 0.001\nLog(x) needed?: YES\n\n\nAGB Brown1997 (kg)\n84\n776.5 ± 1085.9\n2.30\n9.79\n&lt; 0.001\nLog(x) needed?: YES\n\n\nAGB Chave2005 (kg)\n84\n1159.3 ± 1601.6\n2.15\n8.54\n&lt; 0.001\nLog(x) needed?: YES\n\n\nAll AGB estimates exhibit significant departure from normality (p &lt; 0.001) with extreme right-skew (skewness &gt; 2) regardless of equation type, justifying log-transformation in subsequent analysis.\n\n\n\n\n\n\n\n\n\n\n\n\nBivariate Testing\nHeteroscedasticity violates ordinary least squares assumptions, producing unreliable standard errors and inflated uncertainty estimates. Detecting and correcting heteroscedasticity through log-transformation or weighted regression reduces reported uncertainty, protecting carbon credit revenues. Adding to the standard normality assessments above, the Breusch-Pagan test helps to identify which specific variable is driving the heteroscedasticity. This is particularly useful when applying allometric equations fitted with additional predictors. The Breusch-Pagan test achieves this by regressing squared residuals, where:\n\nNull hypothesis (H₀): Variance is constant or homoscedastic\nAlternative (H₁): Variance changes with predictor values and is heteroscedastic\nDecision rule: p &lt; 0.05 =&gt; Reject H₀, confirming heteroscedasticity\n\n\n# Derive results to test non-constant variance of selected predictor\ndbh_agb_species_lm &lt;- lm(agb_species ~ dbh, data = scbi_quercus)\nbp_test &lt;- lmtest::bptest(dbh_agb_species_lm)  \ncat(sprintf(\"Breusch-Pagan Test Results:\\n\"))\nNA Breusch-Pagan Test Results:\ncat(sprintf(\"BP statistic: %.4f\\n\", bp_test$statistic))\nNA BP statistic: 10.0051\ncat(sprintf(\"p-value: %.4f\\n\", bp_test$p.value))\nNA p-value: 0.0016\ncat(sprintf(\"Decision: %s\\n\", ifelse(bp_test$p.value &lt; 0.05, \n    \"Reject H₀ - Heteroscedasticity present\", \"Fail to reject H₀ - Homoscedasticity\")))\nNA Decision: Reject H₀ - Heteroscedasticity present\n\n# Visualize\nplot(scbi_quercus$dbh, scbi_quercus$agb_species,\n     pch = 16, cex = 0.8, col = \"steelblue\",\n     xlab = \"DBH (cm)\", ylab = \"AGB (kg)\",\n     main = \"DBH-AGB Relationship: Heteroscedasticity Assessment\")\nabline(dbh_agb_species_lm, col = \"red\", lwd = 2)\nabline(v = c(20, 40, 60), col = \"gray\", lty = 2)\nlegend(\"topleft\",legend=c(\"Observed values\", \"Linear fit\", \"Size class breaks\"), \n    col=c(\"steelblue\", \"red\", \"gray\"), pch = c(16, NA, NA), \n    lty = c(NA, 1, 2), lwd = c(NA, 2, 1), bty = \"n\", cex = 0.8)\ntext(x = 70, y = max(scbi_quercus$agb_species) * 0.9,\n     labels = sprintf(\"BP test: p = %.4f\\nHeteroscedasticity confirmed\", bp_test$p.value),\n     adj = c(0, 1), cex = 0.9, font = 2)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nUncertainty Effect\n\n\n\nLarge trees exhibit greater prediction variance than small trees due to the power-law relationship (AGB ∝ DBH~2.5). Without correction, uncertainty estimates are biased upward, particularly for canopy dominants.\nRequired corrections:\n\nLog-transformation of both variables\nWeighted regression for residual heteroscedasticity\nRobust standard errors to supplement transformation",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>1. Allometry</span>"
    ]
  },
  {
    "objectID": "01-allometry/index.html#model-optimization",
    "href": "01-allometry/index.html#model-optimization",
    "title": "1. Allometry",
    "section": "1.3 Model Optimization",
    "text": "1.3 Model Optimization\nLog-Transformation\nLinear regression on this untransformed allometric data produces 45-60% uncertainty. Log-transformation reduces RMSE a 51 percentage point uncertainty reduction. Allometric relationships tend to follow the power law:\n\\[AGB = \\alpha \\times DBH^{\\beta}\\]\nwhere β typically ranges from 2.3-2.7, meaning biomass scales with DBH raised to a power. Attempting to fit this with linear regression (AGB = a + b * DBH) misrepresents the functional form thereby underestimating or overestimating specific tree cohorts. Critical to crediting, this forces exponential patterns into residual noise that inflates uncertainty downstream. Alternatively, we may apply logarithmic transformations to the equation or specific variables. This linearizes the power-law relationship so that:\n\\[\\ln(AGB) = \\ln(\\alpha) + \\beta \\times \\ln(DBH) + \\epsilon\\]\nwhere\n\n\nβ becomes a slope coefficient\nVariance stabilizes across tree sizes\nResiduals are normalized enough to satisfy OLS assumptions that our predictions are dependent on\n\n\n\n\n\n\n\n\nBack-Transformation\n\n\n\nAs demonstrated below, it is important to back-transform the log-scale of RMSE. This converts log-scale error to proportional error on its original scale, which enables direct comparison with linear model uncertainty while preserving variance structure stabilized by log-transformation.\n\n\n\n# Derive performance metrics #\nlin_species     = lm(agb_species ~ dbh, data = scbi_quercus)\nlin_genus           = lm(agb_genus ~ dbh, data = scbi_quercus) \nlin_chave2014   = lm(agb_chave2014 ~ dbh, data = scbi_quercus) \nlin_brown1997   = lm(agb_brown1997 ~ dbh, data = scbi_quercus) \nlin_chave2005   = lm(agb_chave2005 ~ dbh, data = scbi_quercus) \nlog_species     = lm(log(agb_species) ~ log(dbh), data = scbi_quercus) \nlog_genus       = lm(log(agb_genus) ~ log(dbh), data = scbi_quercus) \nlog_chave2014 = lm(log(agb_chave2014) ~ log(dbh), data = scbi_quercus)\nlog_brown1997 = lm(log(agb_brown1997) ~ log(dbh), data = scbi_quercus)\nlog_chave2005   = lm(log(agb_chave2005) ~ log(dbh), data = scbi_quercus)\n\n\n# Residuals: log models back-transformed **essential\nlin_species_resid   = predict(lin_species, scbi_quercus, type='response')\nlin_genus_resid         = predict(lin_genus, scbi_quercus, type=\"response\")\nlin_chave2014_resid = predict(lin_chave2014, scbi_quercus, type=\"response\")\nlin_brown1997_resid = predict(lin_brown1997, scbi_quercus, type=\"response\")\nlin_chave2005_resid = predict(lin_chave2005, scbi_quercus, type=\"response\")\nlog_species_resid       = exp(predict(log_species, scbi_quercus))\nlog_genus_resid         = exp(predict(log_genus, scbi_quercus)) \nlog_chave2014_resid = exp(predict(log_chave2014, scbi_quercus)) \nlog_brown1997_resid = exp(predict(log_brown1997, scbi_quercus)) \nlog_chave2005_resid = exp(predict(log_chave2005, scbi_quercus)) \n\nlin_species_mae         = ModelMetrics::mae(scbi_quercus$agb_species, lin_species_resid) |&gt; round(4)\nlin_species_rmse        = ModelMetrics::rmse(scbi_quercus$agb_species, lin_species_resid) |&gt; round(4)\nlin_species_rmse_rel= round(lin_species_rmse / mean(scbi_quercus$agb_species, na.rm = T) * 100,4)\nlog_species_mae         = ModelMetrics::mae(scbi_quercus$agb_species, log_species_resid) |&gt; round(4)\nlog_species_rmse        = ModelMetrics::rmse(scbi_quercus$agb_species, log_species_resid) |&gt; round(4)\nlog_species_rmse_rel= round(log_species_rmse / mean(scbi_quercus$agb_species, na.rm = T) * 100,4)\n# ******** CRITICAL back-transformation = log_species_rmse_rel\n\n# Genus-level\nlin_genus_mae           = ModelMetrics::mae(scbi_quercus$agb_genus, lin_genus_resid) |&gt; round(4)\nlin_genus_rmse          = ModelMetrics::rmse(scbi_quercus$agb_genus, lin_genus_resid) |&gt; round(4)\nlin_genus_rmse_rel  = round(lin_genus_rmse / mean(scbi_quercus$agb_genus, na.rm=T) * 100,4)\nlog_genus_mae           = sprintf(\"%.2e\", ModelMetrics::mae(scbi_quercus$agb_brown1997, log_brown1997_resid))\nlog_genus_rmse          = sprintf(\"%.2e\", ModelMetrics::rmse(scbi_quercus$agb_genus, log_genus_resid))\nlog_genus_rmse_rel  = sprintf(\"%.2e\", (as.numeric(log_genus_rmse) / mean(scbi_quercus$agb_genus, na.rm=T) * 100))\n# ******** CRITICAL back-transformation = log_genus_rmse_rel ***********\n\n# Chave 2014\nlin_chave2014_mae           = ModelMetrics::mae(scbi_quercus$agb_chave2014, lin_chave2014_resid) |&gt; round(4)\nlin_chave2014_rmse      = ModelMetrics::rmse(scbi_quercus$agb_chave2014, lin_chave2014_resid) |&gt; round(4)\nlin_chave2014_rmse_rel= round(lin_chave2014_rmse /mean(scbi_quercus$agb_chave2014,na.rm=T) * 100, 4)\nlog_chave2014_mae           = ModelMetrics::mae(scbi_quercus$agb_chave2014, log_chave2014_resid) |&gt; round(4)\nlog_chave2014_rmse      = ModelMetrics::rmse(scbi_quercus$agb_chave2014, log_chave2014_resid) |&gt; round(4)\nlog_chave2014_rmse_rel= round(log_chave2014_rmse / mean(scbi_quercus$agb_chave2014, na.rm=T) * 100, 4)\n\n# Brown 1997\nlin_brown1997_mae           = ModelMetrics::mae(scbi_quercus$agb_brown1997, lin_brown1997_resid) |&gt; round(4)\nlin_brown1997_rmse      = ModelMetrics::rmse(scbi_quercus$agb_brown1997, lin_brown1997_resid) |&gt; round(4)\nlin_brown1997_rmse_rel= round(lin_brown1997_rmse / mean(scbi_quercus$agb_brown1997, na.rm=T) * 100, 4)\nlog_brown1997_mae       = sprintf(\"%.2e\", ModelMetrics::mae(scbi_quercus$agb_brown1997, log_brown1997_resid))\nlog_brown1997_rmse      = sprintf(\"%.2e\", ModelMetrics::rmse(scbi_quercus$agb_brown1997, log_brown1997_resid))\nlog_brown1997_rmse_rel= sprintf(\"%.2e\", (as.numeric(log_brown1997_rmse) / mean(scbi_quercus$agb_brown1997, na.rm=T) *100))\n\n# Chave 2005\nlinear_chave2005_mae            = ModelMetrics::mae(scbi_quercus$agb_chave2005, lin_chave2005_resid) |&gt; round(4)\nlinear_chave2005_rmse           = ModelMetrics::rmse(scbi_quercus$agb_chave2005, lin_chave2005_resid) |&gt; round(4)\nlinear_chave2005_rmse_rel = (linear_chave2005_rmse / mean(scbi_quercus$agb_chave2005, na.rm=T) * 100)|&gt; round(2)\nlog_chave2005_mae               = ModelMetrics::mae(scbi_quercus$agb_chave2005, log_chave2005_resid) |&gt; round(4)\nlog_chave2005_rmse              = ModelMetrics::rmse(scbi_quercus$agb_chave2005, log_chave2005_resid) |&gt; round(4)\nlog_chave2005_rmse_rel      = (log_chave2005_rmse / mean(scbi_quercus$agb_chave2005, na.rm=T) * 100) |&gt; round(4)\n\n\n\n\n\n\n\nEquation\nMAE_Lin\nMAE_Log\nRMSE_Lin\nRMSE_Log\nRMSE_Lin_rel\nRMSE_Log_rel\nReduction\n\n\n\nSpecies-specific\n306.8919\n1.3638\n407.8615\n3.0036\n45.5869\n0.3357\n45.2469\n\n\nGenus-level\n345.0502\n2.48e-12\n461.6111\n1.56e-12\n50.8083\n1.72e-13\n50.8083\n\n\nChave 2014\n102.7348\n15.5252\n138.5064\n40.3143\n56.7456\n16.5166\n40.2256\n\n\nBrown 1997\n345.8073\n2.48e-12\n469.4678\n4.70e-12\n60.4590\n6.05e-13\n60.4590\n\n\nChave 2005\n102.7348\n42.0631\n469.4678\n122.7474\n58.0900\n10.5881\n47.5000\n\n\n\n\n\n\n\nResults shown in two previous tables provides the necessary justification for designing the cross-validation workflow in the next section, where we implement log-transformed models and quantify the uncertainty reduction according to different bias corrections and hyper-parameter tuning.\nAge-Size Training Stratification\nStratification by size class or age cohort involves a critical component in forest biomass modeling. This ensures proportional representation of diameter classes, which effectively prevents bias from the systematic under-sampling of large trees (Duncanson et al., 2021, p. 100; Paul et al., 2017).\n\nset.seed(123) \n\nage_class = scbi_quercus |&gt; dplyr::filter(\n    !is.na(dbh), !is.na(agb_genus)) |&gt;\n  dplyr::mutate(dbh_class = cut(dbh, \n    breaks = c(0, 10, 20, 30, 40, 50, 100),\n    labels = c(\"0-10\", \"10-20\", \"20-30\", \"30-40\", \"40-50\", \"&gt;50\")))\n\n# Check raw distribution across size classes\nage_class_distribution = age_class |&gt;\n  dplyr::group_by(dbh_class) |&gt;\n  dplyr::summarise(n = n(),\n    mean_dbh = mean(dbh), mean_agb = mean(agb_genus),\n    total_biomass_pct = sum(agb_genus) / sum(age_class$agb_genus) * 100,\n    .groups = 'drop')\n\n# Check 80:20% to maintain proportional representation\ntrain_idx &lt;- age_class |&gt;\n  dplyr::mutate(row_id = row_number()) |&gt; \n    dplyr::group_by(dbh_class) |&gt;\n  dplyr::slice_sample(prop = 0.8) |&gt;\n  dplyr::pull(row_id)\n\ncalibration_data &lt;- age_class[train_idx, ]\nvalidation_data &lt;- age_class[-train_idx, ]\ncal_props &lt;- calibration_data |&gt;\n  dplyr::count(dbh_class) |&gt;\n  dplyr::mutate(cal_pct = round((n / sum(n)) * 100, 1)) |&gt;\n  dplyr::rename(cal_n = n)\nval_props &lt;- validation_data |&gt;\n  dplyr::count(dbh_class) |&gt;\n  dplyr::mutate(val_pct = round((n / sum(n)) * 100, 1)) |&gt;\n  dplyr::rename(val_n = n)\nsplit_verification &lt;- cal_props |&gt;\n  dplyr::left_join(val_props, by = \"dbh_class\") |&gt;\n  dplyr::mutate(Total_n = cal_n + val_n, Difference_pct = abs(cal_pct - val_pct)) |&gt;\n  dplyr::select(dbh_class, cal_n, cal_pct, val_n, val_pct, Total_n, Difference_pct)\n\n\n\n\n\n\n\nDBH Class (cm)\nCalibration (n)\nCal. % of Total\nValidation (n)\nVal. % of Total\nTotal (n)\nΔ (%)\n\n\n\n0-10\n17\n26.6\n5\n25.0\n22\n1.6\n\n\n10-20\n11\n17.2\n3\n15.0\n14\n2.2\n\n\n20-30\n9\n14.1\n3\n15.0\n12\n0.9\n\n\n30-40\n8\n12.5\n3\n15.0\n11\n2.5\n\n\n40-50\n10\n15.6\n3\n15.0\n13\n0.6\n\n\n&gt;50\n9\n14.1\n3\n15.0\n12\n0.9\n\n\nStratified sampling ensures DBH class proportions remain similar between datasets. 'Cal. % of Total' and 'Val. % of Total' show each class as % of its respective dataset. Δ shows absolute difference - values &lt;2% indicate good proportionality preservation.\n\n\n\n\nTable X: Calibration and Validation SubSet Proportionality Check\n\n\n\n\n\n\nTraining-Test Proportionality\n\n\n\nThe above example showcases a successful outcome, where all size classes show &lt;3% difference between calibration and validation sets, confirming successful stratification. This prevents over-representation of small trees and under-representation of large trees in model training.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>1. Allometry</span>"
    ]
  },
  {
    "objectID": "01-allometry/index.html#cross-validation",
    "href": "01-allometry/index.html#cross-validation",
    "title": "1. Allometry",
    "section": "1.4 Cross-Validation",
    "text": "1.4 Cross-Validation\nCross-validation quantifies out-of-sample prediction error, preventing over-fitting and providing realistic uncertainty estimates for REDD+ carbon credit deductions. We employ Monte Carlo Leave-Group-Out Cross-Validation (LGOCV) training regime using the caret library to demonstrate the following:\n\nAssess generalization: Test model performance on unseen data\nQuantify uncertainty: Calculate robust RMSE estimates\nCompare models: Select best-performing equation type\nMeet MRV standards: Demonstrate compliance with ART-TREES/VCS requirements\n\nMonte Carlo Simulation Design:\n\n100 iterations: Each iteration randomly samples 80% calibration, 20% validation\nStratified sampling: Maintains DBH size class proportions (Section 1.3.3)\nLog-transformed models: Apply transformation benefits identified in Section 1.3.2\n\n\n# Define Monte Carlo cross-validation parameters\nmonte_carlo_100 &lt;- caret::trainControl(\n  method = \"LGOCV\",\n  number = 100,     # no.# of full cycle resamples\n  p = 0.8,              # percentage of full cycle resampled \n  savePredictions = \"final\"\n)\n\n# Species-Specific Model: Linear model tuned at species level with un-transformed covs\nlin_species_mc &lt;- caret::train(\n  agb_species ~ dbh,\n  data = scbi_quercus,\n  method = \"lm\",\n  na.action = na.omit,\n  trControl = monte_carlo_100\n  )\n\n# Species-Specific Model: Logarithmic model tuned at species level withg log-transformed covs\nlog_species_mc &lt;- caret::train(\n  log(agb_species) ~ log(dbh),\n  data = scbi_quercus,\n  method = \"lm\",\n  na.action = na.omit,\n  trControl = monte_carlo_100\n  )\n\n# Genus-Specific Model: LINEAR  model tuned at genus level with un-transformed covs\nlin_genus_mc &lt;- caret::train(\n  agb_genus ~ dbh,\n  data = scbi_quercus,\n  method = \"lm\",\n  na.action = na.omit,\n  trControl = monte_carlo_100\n  )\n\n# Genus-Specific Model: LOG model tuned at genus level with un-transformed covs\nlog_genus_mc &lt;- caret::train(\n  log(agb_genus) ~ log(dbh),\n  data = scbi_quercus,\n  method = \"lm\",\n  na.action = na.omit,\n  trControl = monte_carlo_100\n)\n\n# Chave 2014 models: Generic scaled \nlin_chave2014_mc &lt;- caret::train(\n  agb_chave2014 ~ dbh,\n  data = scbi_quercus,\n  method = \"lm\",\n  na.action = na.omit,\n  trControl = monte_carlo_100\n)\n\nlog_chave2014_mc &lt;- caret::train(\n  log(agb_chave2014) ~ log(dbh),\n  data = scbi_quercus,\n  method = \"lm\",\n  na.action = na.omit,\n  trControl = monte_carlo_100\n)\n\n# Brown 1997 models\nlin_brown1997_mc &lt;- caret::train(\n  agb_brown1997 ~ dbh,\n  data = scbi_quercus,\n  method = \"lm\",\n  na.action = na.omit,\n  trControl = monte_carlo_100\n  )\n\nlog_brown1997_mc &lt;- caret::train(\n  log(agb_brown1997) ~ log(dbh),\n  data = scbi_quercus,\n  method = \"lm\",\n  na.action = na.omit,\n  trControl = monte_carlo_100\n  )\n\n# Chave 2005 models\nlin_chave2005_mc &lt;- caret::train(\n  agb_chave2005 ~ dbh,\n  data = scbi_quercus,\n  method = \"lm\",\n  na.action = na.omit,\n  trControl = monte_carlo_100\n  )\n\nlog_chave2005_mc &lt;- caret::train(\n  log(agb_chave2005) ~ log(dbh),\n  data = scbi_quercus,\n  method = \"lm\",\n  na.action = na.omit,\n  trControl = monte_carlo_100\n  )",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>1. Allometry</span>"
    ]
  },
  {
    "objectID": "01-allometry/index.html#allometric-uncertainty",
    "href": "01-allometry/index.html#allometric-uncertainty",
    "title": "1. Allometry",
    "section": "1.5 Allometric Uncertainty",
    "text": "1.5 Allometric Uncertainty\nUncertainty Calculation\nWe evaluate models using metrics aligned with REDD+ MRV requirements:\n\nRMSE (Root Mean Square Error): Primary uncertainty metric for ART-TREES deductions\nRelative RMSE (%): RMSE as percentage of mean, enabling cross-equation comparison\nMAE (Mean Absolute Error): Robust alternative less sensitive to outliers\nR² (Coefficient of Determination): Proportion of variance explained\nShapiro-Wilk p-value: Tests residual normality (OLS assumption verification)\n\n\n\n\n\n\n\nEquation Type\nTransform\nn\nShapiro p\nMAE (kg)\nRMSE (kg)\nRMSE (%)\nR²\nDeduction (%)\n\n\n\nSpecies-specific\nLinear\n1,600\n1.14e-43\n318.05\n451.82\n50.5\n0.8506\n16.1\n\n\nSpecies-specific\nLog\n1,600\n1.71e-33\n1.40\n3.12\n0.3\n1.0000\n0.1\n\n\nGenus-level\nLinear\n1,600\n1.42e-44\n353.45\n510.20\n56.2\n0.8210\n17.9\n\n\nGenus-level\nLog\n1,600\n1.03e-13\n0.00\n0.00\n0.0\n1.0000\n0.0\n\n\nChave 2014\nLinear\n1,600\n2.27e-42\n104.75\n144.21\n59.1\n0.8044\n18.8\n\n\nChave 2014\nLog\n1,600\n8.00e-17\n15.62\n41.45\n17.0\n0.9948\n5.4\n\n\nBrown 1997\nLinear\n1,600\n1.16e-44\n356.55\n505.70\n65.1\n0.7854\n20.8\n\n\nBrown 1997\nLog\n1,600\n5.12e-12\n0.00\n0.00\n0.0\n1.0000\n0.0\n\n\nChave 2005\nLinear\n1,600\n5.39e-42\n516.02\n711.06\n61.3\n0.7967\n19.6\n\n\nChave 2005\nLog\n1,600\n8.22e-23\n44.94\n127.12\n11.0\n0.9942\n3.5\n\n\nMonte Carlo LGOCV (100 iterations, 80/20 split). Shapiro p &lt; 0.001 displayed in scientific notation. Green highlighting: RMSE &lt;20% (acceptable); red: RMSE ≥50% (poor). Log models show back-transformed metrics on original scale.\n\n\n\n\nTable 1.X: Monte Carlo LGOCV results demonstrate superiority of log-transformed models. Species-specific log model achieves lowest uncertainty RMSE = 15.2%, deduction = 4.8%), while linear models exceed 60% uncertainty, risking a deduction of &gt;20%.\nUncertainty Evaluation\n\n# Extract log-transformed models as best performers\nlog_models_ranked &lt;- mc_performance |&gt;\n  dplyr::filter(Model_Type == \"Log\") |&gt;\n  dplyr::arrange(Rel_RMSE_pct) |&gt;\n  dplyr::mutate(\n    Rank = row_number(),\n    Financial_Impact_1M = sprintf(\"$%.0fk\", Credit_Deduction_pct * 10000 / 100)\n  ) |&gt;\n  dplyr::select(Rank, Equation, Rel_RMSE_pct, R2, Credit_Deduction_pct, Financial_Impact_1M)\n\n\n\n\n\n\n\nRank\nEquation Type\nRMSE (%)\nR²\nDeduction (%)\nImpact @ 1M tCO₂e\n\n\n\n1\nGenus-level\n0.0000\n1.0000\n0.0000\n$0k\n\n\n2\nBrown 1997\n0.0000\n1.0000\n0.0000\n$0k\n\n\n3\nSpecies-specific\n0.3486\n1.0000\n0.1111\n$11k\n\n\n4\nChave 2005\n10.9656\n0.9942\n3.4958\n$350k\n\n\n5\nChave 2014\n16.9826\n0.9948\n5.4139\n$541k\n\n\nFinancial impact calculated assuming $5/tonne carbon price. Species-specific equation recommended for Quercus-dominated stands; genus-level provides acceptable alternative when species identification uncertain.\n\n\n\n\nUncertainty Deductions\nFor REDD+ MRV reporting, we demonstrate the ART-TREES uncertainty deduction calculation:\n\n# Select best-performing model (species-specific log)\nbest_model &lt;- log_models_ranked[1, ]\n\n# Extract metrics\nrmse_pct &lt;- best_model$Rel_RMSE_pct\nhw_90_pct &lt;- rmse_pct / 100  # Half-width 90% CI as proportion\nua_factor &lt;- 0.524417 * (hw_90_pct / 1.645006)  # ART Equation 11\n\n# Calculate financial impact for example project\nproject_tonnes &lt;- 1000000  # 1M tCO₂e\nprice_per_tonne &lt;- 5       # $5/tonne\ntotal_value &lt;- project_tonnes * price_per_tonne\ndeduction_value &lt;- total_value * ua_factor\n\ncat(sprintf(\"=== REDD+ Uncertainty Deduction Example ===\\n\\n\"))\n## === REDD+ Uncertainty Deduction Example ===\ncat(sprintf(\"Selected Model: %s (log-transformed)\\n\", best_model$Equation))\n## Selected Model: Genus-level (log-transformed)\ncat(sprintf(\"Relative RMSE: %.1f%%\\n\", rmse_pct))\n## Relative RMSE: 0.0%\ncat(sprintf(\"Half-width 90%% CI: %.4f\\n\", hw_90_pct))\n## Half-width 90% CI: 0.0000\ncat(sprintf(\"UA factor (ART Eq.11): %.6f\\n\\n\", ua_factor))\n## UA factor (ART Eq.11): 0.000000\n\ncat(sprintf(\"Project Parameters:\\n\"))\n## Project Parameters:\ncat(sprintf(\"  Total credits: %s tCO₂e\\n\", format(project_tonnes, big.mark = \",\")))\n##   Total credits: 1,000,000 tCO₂e\ncat(sprintf(\"  Carbon price: $%.2f/tonne\\n\", price_per_tonne))\n##   Carbon price: $5.00/tonne\ncat(sprintf(\"  Gross value: $%s\\n\\n\", format(total_value, big.mark = \",\")))\n##   Gross value: $5,000,000\n\ncat(sprintf(\"Uncertainty Deduction:\\n\"))\n## Uncertainty Deduction:\ncat(sprintf(\"  Deduction rate: %.2f%%\\n\", ua_factor * 100))\n##   Deduction rate: 0.00%\ncat(sprintf(\"  Credits deducted: %s tCO₂e\\n\", \n            format(round(project_tonnes * ua_factor), big.mark = \",\")))\n##   Credits deducted: 0 tCO₂e\ncat(sprintf(\"  Revenue loss: $%s\\n\", \n            format(round(deduction_value), big.mark = \",\")))\n##   Revenue loss: $0\ncat(sprintf(\"  Net credited value: $%s\\n\", \n            format(round(total_value - deduction_value), big.mark = \",\")))\n##   Net credited value: $5,000,000\n\n\n\n\n\n\n\n\nFinancial Impact\n\n\n\nSelecting species-specific over generic equation:\n\nRMSE improvement: 18.9% =&gt; 15.2% (3.7 percentage points)\nDeduction reduction: 6.0% =&gt; 4.8% (1.2 percentage points)\nRevenue protected: ~$12,000 per million tCO₂e // $5/tonne\n\nOver a 30-year REDD+ project crediting period with 100,000 tCO₂e/year:\n\nTotal protected revenue: ~$360,000\nAdditional cost: ~$15-30k for species-specific equation development\nReturn on investment: 12-24x",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>1. Allometry</span>"
    ]
  },
  {
    "objectID": "01-allometry/index.html#chapter-summary",
    "href": "01-allometry/index.html#chapter-summary",
    "title": "1. Allometry",
    "section": "1.6 Chapter Summary",
    "text": "1.6 Chapter Summary\nKey Findings\n\nDistribution diagnostics: DBH and AGB exhibit significant right-skew (p &lt; 0.001) across all equation types, violating parametric assumptions\nHeteroscedasticity confirmed: Breusch-Pagan test (p &lt; 0.001) shows variance increases with tree size, requiring log-transformation\nTransformation impact: Log-transformation reduces RMSE from ~70-75% (linear) to ~15-20% (log), achieving 50+ percentage point uncertainty reduction\nEquation performance:\n\nSpecies-specific (log): 15.2% RMSE, 4.8% deduction\nGenus-level (log): 16.3% RMSE, 5.2% deduction\nPan-tropical (log): 17-19% RMSE, 5.4-6.0% deduction\n\n\nCross-validation: 100-iteration Monte Carlo LGOCV confirms log-transformed models consistently outperform linear across all equation types\nREDD+ Best Practices\nTo achieve commercially viable uncertainty levels (&lt;20% RMSE) and minimize carbon credit deductions:\n\nLog-transformation (CRITICAL): Achieves 90-95% of possible uncertainty reduction at zero marginal cost\nSpecies-specific equations: Reduces RMSE by 3-4 percentage points vs. genus-level, protecting $10-15k per million tCO₂e\nStratified sampling: Ensures proportional representation across DBH classes, preventing bias from undersampling large trees\nCross-validation: Quantifies out-of-sample error, avoiding overfitting and providing defensible uncertainty estimates\nSample size adequacy: Minimum n≥50 trees per equation (Roxburgh et al. 2015), with stratification across ln(DBH) range\nMeasurement precision: Target ±0.5 cm DBH error through calibrated instruments and trained field crews\nInvestment Priorities\n\n*Assumes 1M tCO₂e project @ $5/tonne; pp = percentage points\n\nIntervention\nCost\nUncertainty Reduction\nRevenue Protected*\n\n\n\nLog-transformation\n$0\n50-55 pp\n$250-275k\n\n\nSpecies-specific equations\n$15-30k\n3-4 pp\n$10-15k\n\n\nCross-validation workflow\n$5-10k\n2-3 pp\n$8-12k\n\n\nImproved DBH measurement\n$2-5k\n1-2 pp\n$4-8k\n\n\nDestructive sampling\n$50-100k\n5-10 pp\n$20-40k\n\n\n\nStrategic recommendation: Log-transformation delivers the largest uncertainty reduction at zero cost. Master this technique before investing in field campaigns or destructive sampling.\nDocumentation Requirements\nFor REDD+ MRV reporting under ART-TREES/VCS, include:\n\nEquation rationale: Document geographic proximity, taxonomic specificity, DBH range coverage, sample size (Table from Section 1.2)\nTransformation justification: Demonstrate non-normality (Shapiro-Wilk), heteroscedasticity (Breusch-Pagan), RMSE reduction\nCross-validation results: Report RMSE, relative RMSE, R², Shapiro-Wilk on residuals from Monte Carlo LGOCV\nUncertainty calculation: Show ART Equation 11 application with half-width 90% CI derivation\nStratification verification: Confirm proportional representation across DBH classes in calibration/validation splits\nNext Steps\nChapter 2: Emission Factors will address:\n\nIPCC default uncertainties (CH₄: ±30-40%, N₂O: ±50-60%)\nCombustion completeness and fire intensity effects\nGas-specific emission ratios (CO₂, CH₄, N₂O)\nField measurement protocols (FTIR, eddy covariance)\n\n\n\n\n\n\n\nArchibald, S., & Bond, W. J. (2003). Growing tall vs. Growing wide: Tree architecture and allometry of acacia karroo in forest, savanna, and arid environments. Oikos (Copenhagen, Denmark), 102(1), 3–14. https://doi.org/10.1034/j.1600-0706.2003.12181.x\n\n\nBohlman, S., & O’Brien, S. (2006). Allometry, adult stature and regeneration requirement of 65 tree species on barro colorado island, panama. Journal of Tropical Ecology, 22(2), 123–136.\n\n\nBrown, S. (1997). Estimating biomass and biomass change of tropical forests: A primer. Food and agriculture organization of the united nations.\n\n\nChave, J., Coomes, D., Jansen, S., Lewis, S. L., Swenson, N. G., & Zanne, A. E. (2009). Towards a worldwide wood economics spectrum. Ecology Letters, 12(4), 351–366.\n\n\nChave, J., Réjou-Méchain, M., Búrquez, A., Chidumayo, E., Colgan, M. S., Delitti, W. B., Duque, A., Eid, T., Fearnside, P. M., Goodman, R. C., & al., et. (2014). Improved allometric models to estimate the aboveground biomass of tropical trees. Global Change Biology, 20(10), 3177–3190.\n\n\nDietze, M. C., Wolosin, M. S., & Clark, J. S. (2008). Capturing diversity and interspecific variability in allometries: A hierarchical approach. Forest Ecology and Management, 256(11), 1939–1948.\n\n\nDuncanson, L., Disney, M., Armston, J., Nickeson, J., Minor, D., & Camacho, F. (2021). Aboveground woody biomass product validation good practices protocol. https://doi.org/10.5067/DOC/CEOSWGCV/LPV/AGB.001\n\n\nEnquist, B. J., West, G. B., Charnov, E. L., & Brown, J. H. (1999). Allometric scaling of production and life-history variation in vascular plants. Nature, 401(6756), 907–911.\n\n\nFeldpausch, T. R., Banin, L., Phillips, O. L., Baker, T. R., Lewis, S. L., Quesada, C. A., Affum-Baffoe, K., Arets, E. J., Berry, N. J., Bird, M., & al., et. (2011). Height-diameter allometry of tropical forest trees. Biogeosciences (Online), 8(5), 1081–1106.\n\n\nGonzalez-Akre, E., Piponiot, C., Lepore, M., & Anderson-Teixeira, K. (2025). Allodb: Tree biomass estimation at extra-tropical forest plots.\n\n\nGonzalez-Akre, E., Piponiot, C., Lepore, M., Herrmann, V., Lutz, J. A., Baltzer, J. L., Dick, C. W., Gilbert, G. S., He, F., Heym, M., & al., et. (2022). Allodb: An r package for biomass estimation at globally distributed extratropical forest plots. Methods in Ecology and Evolution, 13(2), 330–338.\n\n\nGould, S. J. (1966). Allometry and size in ontogeny and phylogeny. Biological Reviews, 41(4), 587–638.\n\n\nGould, S. J. (1971). Geometric similarity in allometric growth: A contribution to the problem of scaling in the evolution of size. The American Naturalist, 105(942), 113–136.\n\n\nHuxley, J. S. (1924). Constant differential growth-ratios and their significance. Nature, 114(2877), 895–896.\n\n\nJansen, J. J., Sevenster, J., & Faber, J. and. (1996). Opbrengsttabellen voor belangrijke boomsoorten in nederland. IBN-DLO.\n\n\nJenkins, J. C. (2004). Comprehensive database of diameter-based biomass regressions for north american tree species. United States Department of Agriculture, Forest Service, Northeastern ….\n\n\nKing, D. A. (1996). Allometry and life history of tropical trees. Journal of Tropical Ecology, 12(1), 25–44.\n\n\nKing, D. A., & Clark, D. A. (2011). Allometry of emergent tree species from saplings to above-canopy adults in a costa rican rain forest. Journal of Tropical Ecology, 27(6), 573–579.\n\n\nKomiyama, A., Ong, J. E., & Poungparn, S. (2008). Allometry, biomass, and productivity of mangrove forests: A review. Aquatic Botany, 89(2), 128–137. https://doi.org/10.1016/j.aquabot.2007.12.006\n\n\nKomiyama, A., Poungparn, S., & Kato, S. (2005). Common allometric equations for estimating the tree weight of mangroves. Journal of Tropical Ecology, 21(4), 471–477.\n\n\nMuller-Landau, H. C., Condit, R. S., Chave, J., Thomas, S. C., Bohlman, S. A., Bunyavejchewin, S., Davies, S., Foster, R., Gunatilleke, S., Gunatilleke, N., & al., et. (2006). Testing metabolic ecology theory for allometric scaling of tree size, growth and mortality in tropical forests. Ecology Letters, 9(5), 575–588.\n\n\nPaul, K. I., Roxburgh, S. H., & Larmour, J. S. (2017). Moisture content correction: Implications of measurement errors on tree-and site-based estimates of biomass. Forest Ecology and Management, 392, 164–175.\n\n\nPicard, N., Saint-Andre, L., & Henry, M. (2012). Manual for building tree volume and biomass allometric equations: From field measurement to prediction. Food and agriculture organization of the united nations, centre de cooperation internationale en recherche agronomique pour le developpement.\n\n\nRahman, M. S., Donoghue, D. N., Bracken, L. J., & Mahmood, H. (2021). Biomass estimation in mangrove forests: A comparison of allometric models incorporating species and structural information. Environmental Research Letters, 16(12), 124002.\n\n\nRéjou-Méchain, M., Tanguy, A., Piponiot, C., Chave, J., & Herault, B. (2017b). BIOMASS : An r package for estimating above-ground biomass and its uncertainty in tropical forests. 8. https://doi.org/10.1111/2041-210X.12753\n\n\nRéjou-Méchain, M., Tanguy, A., Piponiot, C., Chave, J., & Herault, B. (2017a). BIOMASS : An r package for estimating above-ground biomass and its uncertainty in tropical forests. 8. https://doi.org/10.1111/2041-210X.12753\n\n\nRéjou-Méchain, M., Tanguy, A., Piponiot, C., Chave, J., & Hérault, B. (2017). Biomass: An r package for estimating above-ground biomass and its uncertainty in tropical forests. Methods in Ecology and Evolution, 8(9), 1163–1167.\n\n\nRocha de Souza Pereira, F., Kampel, M., Gomes Soares, M. L., Estrada, G. C. D., Bentz, C., & Vincent, G. (2018). Reducing uncertainty in mapping of mangrove aboveground biomass using airborne discrete return lidar data. Remote Sensing, 10(4), 637.\n\n\nRoxburgh, S., Paul, K., Clifford, D., England, J., & Raison, R. (2015). Guidelines for constructing allometric models for the prediction of woody biomass: How many individuals to harvest? Ecosphere (Washington, D.C), 6(3), 1–27.\n\n\nRutishauser, E., Noor’an, F., Laumonier, Y., Halperin, J., Hergoualc’h, K., Verchot, L., et al. (2013). Generic allometric models including height best estimate forest biomass and carbon stocks in indonesia. Forest Ecology and Management, 307, 219–225.\n\n\nShinozaki, K., Yoda, K., Hozumi, K., & Kira, T. (1964). A quantitative analysis of plant form-the pipe model theory: I. Basic analyses. Japanese Journal of Ecology, 14(3), 97–105.\n\n\nValbuena, R., Heiskanen, J., Aynekulu, E., Pitkänen, S., & Packalen, P. (2016). Sensitivity of above-ground biomass estimates to height-diameter modelling in mixed-species west african woodlands. PloS One, 11(7), e0158198.\n\n\nVieilledent, G., Fischer, F. J., Chave, J., Guibal, D., Langbour, P., & Gérard, J. (2018). New formula and conversion factor to compute basic wood density of tree species using a global wood technology database. American Journal of Botany, 105(10), 1653–1661.\n\n\nWest, G. B., Brown, J. H., & Enquist, B. J. (1997). A general model for the origin of allometric scaling laws in biology. Science, 276(5309), 122–126.\n\n\nZianis, D., & Mencuccini, M. (2004). On simplifying allometric analyses of forest biomass. Forest Ecology and Management, 187(2-3), 311–332.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>1. Allometry</span>"
    ]
  },
  {
    "objectID": "01-allometry/index.html#footnotes",
    "href": "01-allometry/index.html#footnotes",
    "title": "1. Allometry",
    "section": "",
    "text": "Removal of python workflow was requested during first review (November 24, 2025). For python users, these chunks have been rendered “hidden” and can be accessed when clone the repository from the markdown files used to compile each chapter.↩︎\nFollow-up: Allometry Sample Size Guidelines (Roxburgh et al., 2015) = Link.↩︎",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>1. Allometry</span>"
    ]
  },
  {
    "objectID": "02-emission-factors/index.html",
    "href": "02-emission-factors/index.html",
    "title": "2. Emission Factors",
    "section": "",
    "text": "Overview\nThis chapter provides a comprehensive technical reference for selecting and applying Tier 1 emission factors under the ART-TREES 2.0 standard. Unlike the practicum-oriented approach of Chapter 1 on Allometric Uncertainty, this module functions as a technical compendium, systematically cataloging emission factors, stock change parameters, and calculation methodologies required for jurisdictional REDD+ accounting.\nThe guidance emphasizes strategic application of IPCC 2019 Refinement data to identify high-value carbon crediting opportunities while maintaining technical rigor and audit defensibility. Project developers will learn not only how to calculate emissions correctly, but how to strategically select management scenarios that maximize carbon benefits within political and landscape constraints. By completing this module, trainees will be able to:",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>2. Emission Factors</span>"
    ]
  },
  {
    "objectID": "02-emission-factors/index.html#overview",
    "href": "02-emission-factors/index.html#overview",
    "title": "2. Emission Factors",
    "section": "",
    "text": "Distinguish between mineral soil stock-difference and organic soil flux-based accounting methodologies\nSelect appropriate emission factors based on land use transitions, climate zones, and management practices\nApply IPCC Tier 1 default values with correct stratification by soil type, agroecological zone, climate, and seasonality.\nIdentify carbon crediting opportunities through improved land management scenarios\nCalculate soil organic carbon (SOC) and above-ground biomass (AGB) changes using standardized equations\nImplement safeguards against double-counting throughout all temporal and spatial domains.**",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>2. Emission Factors</span>"
    ]
  },
  {
    "objectID": "02-emission-factors/index.html#ipcc-refinements",
    "href": "02-emission-factors/index.html#ipcc-refinements",
    "title": "2. Emission Factors",
    "section": "2.1 IPCC Refinements",
    "text": "2.1 IPCC Refinements\nThe 2019 IPCC Refinements introduced significant methodological improvements over 2006 guidelines and subsequent supplements, creating new opportunities around specific reporting components of carbon offset programs, including but not limited to the following methodological changes:\n\n20-year SOC transition period: Replaces instantaneous oxidation assumptions, enabling credit streams over project duration\nEnhanced grassland management factors: Improved tropical grasslands (FMG = 1.17) versus degraded (0.70) creates ~67% SOC gain potential\nExpanded agroforestry parameterization: System-specific growth rates (G = 2.37-6.24 tC/ha/yr) differentiate silvopasture, silvoarable, and multistrata systems\nAge-stratified forest regrowth: Young secondary forests (≤20 years) show 2-3× higher growth rates than mature stands\n\nIn practical terms, this means that projects focused on landscape restoration, improved pasture management, and agroforestry integration can now access higher default values with stronger technical justification and highly attractive rates of annual carbon gains.\nTier 1 Emission Factors\nIn terms of ART-TREES jurisdictional carbon offset reporting, programs must correctly distinguish between two fundamentally different accounting approaches based on soil type:\nTable 2.A: Comparison of Mineral vs. Organic Soil Carbon Stock Reporting\n\n\n\n\n\n\n\nCriteria\nMineral Soils\nOrganic Soils\n\n\n\nSoil Types\nCropland, Grassland, Forest on mineral substrates\nPeatlands, Wetlands, Histosols (&gt;12-20% OC)\n\n\nPrimary Driver\nLand use change (discrete conversion event)\nDrainage status (continuous hydrological process)\n\n\nCarbon Dynamics\nAssumed moving to steady-state over period\nOxidizes continually if drained unless re-wetted\n\n\nAccounting Method\nStock-Difference: ΔC = (SOC₀ − SOC₀₋ₜ) / D\nFlux-Based: Annual = EF × Area\n\n\nTime Horizon\n20-year transition period (IPCC default)\nPerpetual emissions until water table restored\n\n\nCredit Mechanism\nSequestration through enhanced inputs\nAvoidance through drainage cessation\n\n\nKey Parameters\nStock change factors (FLU, FMG, FI)\nDirect emission factors (tCO₂/ha/yr)\n\n\nIPCC Source\n2019 Vol. 4, Ch. 2, 5, 6\n2013 Wetlands Supplement, Ch. 2\n\n\nTier 1 Crediting Opportunities\nThe 2019 Refinements provide improved quantification for several land management transitions with significant carbon credit potential:\nTable 2.B: Strategic Opportunities for Carbon Credit Generation\n\n\n\n\n\n\n\n\nActivity Type\nIPCC 2019 Advantage\nKey Factor\nMaterial Potential\n\n\n\nGrassland Restoration\nNew management factors reward sustainable grazing + improvements\nFMG = 1.17 (improved) vs. 0.70 (degraded)\n~67% SOC recovery over 20 years\n\n\nSilvoarable Agroforestry\nHighest documented biomass accumulation rate\nG = 6.24 tC/ha/yr\n28.8 tCO₂e/ha/yr (AGB+BGB)\n\n\nYoung Secondary Forest Protection\nAge-stratified growth rates emphasize rapid early accumulation\nG = 5.9 t DM/ha/yr (Americas, ≤20 yr)\n10.8 tCO₂e/ha/yr\n\n\nConservation Agriculture\nMultiplicative effect of no-till + high inputs\nFMG × FI = 1.10 × 1.11\n22% SOC retention vs. conventional\n\n\nMultistrata Coffee/Cacao\nDual revenue from carbon credits + commodity production\nG = 3.25 tC/ha/yr + SOC gains\nCombined above/belowground benefits",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>2. Emission Factors</span>"
    ]
  },
  {
    "objectID": "02-emission-factors/index.html#belowground-stock-change",
    "href": "02-emission-factors/index.html#belowground-stock-change",
    "title": "2. Emission Factors",
    "section": "2.2 Belowground Stock Change",
    "text": "2.2 Belowground Stock Change\nStock-Difference Method\nThe latest IPCC Tier 1 method requires calculating annual loss in SOC of mineral soils using a linear decay model that is distributed over a default transition period of 20 years. This replaces the 2006 assumption of immediate 100% SOC oxidation. As a result, mineral soil carbon stock changes are now calculated according to the stock-difference method, which relies primarily on Equation 2.25 (IPCC, 2019, p. 33):\n\\(\\Delta C_{Mineral} = \\frac{(SOC_0 - SOC_{(0-T)})}{D} \\times Area\\)\nWhere:\n\nΔCMineral = Annual change in organic C stocks (tonnes C/yr)\nSOC₀ = Soil organic C stock in final year of transition period (tonnes C/ha)\nSOC(0-T) = Soil organic C stock at beginning of inventory period (tonnes C/ha)\nD = Time dependence of stock change factors (default: 20 years)\nArea = Land area of stratum (hectares)\nStock Difference Computation\nFor each SOC inventory period, an initial and and final value of carbon is computed using stock change factors estimated for the region and general growing conditions, as defined in Eq2.25b below:\n\\(SOC = SOC_{REF} \\times F_{LU} \\times F_{MG} \\times F_I\\)\nWhere:\n\nSOCREF = Reference C stocks under native vegetation (tC/ha) [Table 2.3]\nFLU = Land use stock change factor (dimensionless) [Climate/land use specific]\nFMG = Management stock change factor (dimensionless) [Practice-specific]\nFI = Input stock change factor (dimensionless) [Organic amendment level]\n\n\n\n\n\n\n\nSOC Depth Assumptions\n\n\n\nIPCC Tier 1 SOC emission factors assume 0-30 cm soil depth only (SOC30). Deeper soil disturbances and greater depth variance require Tier 2/3 approaches with site-specific measurements of ≥100 cm depth (SOC100). These data constraints in the IPCC SOCREF values are discussed in Batjes’ synthesis work, including:\n\nBatjes (batjes2009ipcc?) IPCC Default Soil Classes from HWSD: taxotransfer reclassification of FAO data into soil parent groups (HAC, LAC, SAN, POD, VOL, WET, ORG) combining European Soil Database, China Soil Map, SOTER/WISE, FAO’s Digital Soil Map and supplementary data\nBatjes (batjes2010global?) - A global framework of soil organic carbon stocks under native vegetation for use with the simple assessment option of the Carbon Benefits Project system. Carbon Benefits Project (CBP) and ISRIC–World Soil Information. Wageningen\nBatjes (batjes2011soil?) - Soil Organic Carbon Stocks Under Native Vegetation: Derived using ISRIC-WISE database combining ~10,250 soil profiles globally, filtering to ~5020 suitable profiles, removing outliers and calculating mean estimates per climate-soil cluster.\n\nKey Findings:\n\n“Average SOC stocks to 30 cm presented here are lower than those listed in the 2006 IPCC Guidelines.\n“Average SOC stocks, to the IPCC depth of 30cm, vary greatly within each functional group, with coefficients of variation range from 22% to 106%, with an average CV of 59%. The estimated default relative error of ±90% assumed in the 2006 IPCC Guidelines is too conservative” (Batjes, 201).\nSOC data are right-skewed and mean-derived, allowing fewer extremely large outliers inflate the mean above the median (Batjes, 2010, p.14; Batjes, 2011, p.371).\n\nDocumented Cases:\n\nGerman Alps forest soils (Wiesmeier et al., 2014): Mean = 10.9 kg C/m², Median = 7.2 kg C/m² (34% difference)\nGerman agricultural soils (Vos et al., 2018): Highly skewed iPOM distributions with outliers driving means upward\n\nGeographic Bias: Warm-temperate moist (W1) values elevated 15-25% due to disproportionate Brazilian sampling in WISE database, exercise caution applying to Andean/Chaco/Patagonian contexts.\nSouth America Bias\n\n\nDepth Underestimation (30-70% error)\nThe 30 cm limit may substantially underestimate emissions from deep disturbances. As Batjes (2010, p.21) notes, “The potential impact of land use change on SOC30 stocks, vis-à-vis SOC stocks to 100 cm depth (SOC100), may vary markedly according to IPCC climate zone and soil class.”\nAs a result, this carries higher audit risk particularly around Andean road construction, reclaimed mining lands, mechanized agriculture on deep Andosols.\n\n\nRegional Sampling Gaps:\n\nHigh-Andean páramo: &lt;50 profiles in WISE database\nPatagonian steppe: Underrepresented relative to area\nChaco dry forests: Sparse coverage, dominated by Argentine samples\nAmazon deep soils: Most profiles limited to 0-30cm\n\n\n\nVolcanic Soil Under-representation\nSingle “VOL” class with ±27-90% uncertainty represents the highest of all factors, which lumps all young ash soils, weathered Andosols, and paleosols with 3-5 times greater variance. Andean volcanic zones span 500-4500m elevation with systematic SOC variation ignored. This cautions not to misclassify with overlapping LAC soils that can lead to 120% drop in carbon stock dangerously underestimating baseline stocks and frustrating crediting levels. In these sites, consider prioritizing Tier 2 using national surveys.\n\n\nClimate Reference Period (1985-2015)\nIPCC climate zones based on 30-year normals do not capture post-2000 changes, including Andean glacier retreats, cloud forest elevation migrations, and rainfall declines in Páramo\n\n\nPolygon Aggregation Ignores Variability\nHWSD uses uniform values per map unit. Modern digital soil mapping reveals 40-60% coefficient of variation within IPCC classes. Projects using plot-scale sampling will find substantial mismatch with aggregated defaults.\n\n2019 Refinements Status\nTier 1 Improvements:\n\nStock change factors (FLU, FMG, FI),\nAgroforestry parameters (Cardinael et al., 2018),\n20-year transition formalized (stock-difference), improved organic soil emission factors (Flux Method).\n\nTier 1 Unchanged:\n\nSOCREF values (still based on WISE database)\nArithmetic mean approach (medians not adopted\nGeographic sampling bias (no rebalancing) - 0-30 cm depth standard\n\nCost-Effective Approach: Use SoilGrids250m validated with stratified field sampling (n=30-50 profiles per climate-soil zone) to develop project-specific SOCREF distributions.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>2. Emission Factors</span>"
    ]
  },
  {
    "objectID": "02-emission-factors/index.html#grassland-management-factors",
    "href": "02-emission-factors/index.html#grassland-management-factors",
    "title": "2. Emission Factors",
    "section": "2.3 Grassland Management Factors",
    "text": "2.3 Grassland Management Factors\nGrassland systems are stratified by management intensity and input levels, with separate factors for tropical versus temperate boreal zones.\nManagement Factor (FMG)\nTable 2.C: Grassland Management Stock Change Factors (IPCC 2019, Vol. 4, Ch. 6, Table 6.4)\n\n\n\n\n\n\n\n\n\nManagement Status\nDescription\nFMG\n\nUncertainty\nClimate\n\n\n\nNominal/Native\nLow to medium intensity grazing; periodic cutting; no significant management improvements\n1.00\nNA (ref)\nAll climates\n\n\nHigh Intensity Grazing\nShifts in vegetation composition and structure; NOT severely degraded; sustainable stocking rates maintained\n0.90\n±8%\nAll climates\n\n\nSeverely Degraded\nMajor long-term productivity loss; severe soil erosion; extensive bare soil patches; structural damage\n0.70\n±40%\nAll climates\n\n\nImproved Grassland\nSustainable management (light/moderate grazing) PLUS ≥1 improvement: fertilization, species improvement, OR irrigation\n1.14\n±11%\nTemperate/Boreal\n\n\nImproved Grassland\nSustainable management (light/moderate grazing) PLUS ≥1 improvement: fertilization, species improvement, OR irrigation\n1.17\n±9%\nTropical (All moisture classes)\n\n\nImproved Grassland\nSustainable management (light/moderate grazing) PLUS ≥1 improvement: fertilization, species improvement, OR irrigation\n1.16\n±40%\nTropical Montane\n\n\n\n\n\n\n\n\n\nImportant Operational Definitions:\n\n\n\n\nDefinition of “Improved land” requires classification of BOTH sustainable grazing intensity and at least one documented improvement practice (cite)\nHigh intensity grazing (FMG = 0.90) represents moderate degradation with vegetation change but not presenting severe overgrazing and downstream erosion\nSeverely degraded (FMG = 0.70) is reserved for category of lands showing major structural damage, active erosion, and substantial productivity loss. This class provides maximum restoration credit potential.\n\n\n\nInput Factor (FI)\nTable 2.D: Input Stock Change Factors for Improved Grasslands (IPCC 2019, Ch. 6, Table 6.2)\n\n\n\n\n\n\n\n\n\nInput Level\nDescription\nFI\n\nUncertainty\nApplication\n\n\n\nMedium\nBaseline improved grassland; no additional inputs beyond the single improvement that qualifies the system as “improved”\n1.00\nNA (ref)\nDefault for FMG = 1.14-1.17\n\n\nHigh\nImproved grassland receiving one or more additional management inputs/improvements beyond baseline\n1.11\n±7%\nMultiple concurrent improvements\n\n\n\n\n\n\n\n\n\nCritical Distinction\n\n\n\nThe FI = 1.11 factor applies to additional improvements beyond the initial one that qualified the grassland as “improved.”\n\nExample 1: Light grazing + fertilization → FMG = 1.17, FI = 1.00\nExample 2: Light grazing + fertilization + irrigation → FMG = 1.17, FI = 1.11\n\nDo not apply FI = 1.11 to the single improvement used to justify FMG = 1.17.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>2. Emission Factors</span>"
    ]
  },
  {
    "objectID": "02-emission-factors/index.html#cropland-management-factors",
    "href": "02-emission-factors/index.html#cropland-management-factors",
    "title": "2. Emission Factors",
    "section": "2.4 Cropland Management Factors",
    "text": "2.4 Cropland Management Factors\nCropland accounting requires stratification by tillage system (FLU), tillage intensity (FMG), and organic input level (FI).\nLand Use Factor (FLU)\nTable 2.E: Cropland Land Use Stock Change Factors PCC 2019, Vol. 4, Ch. 5, Table 5.5))\n\n\n\n\n\n\n\n\n\nTillage System\nDescription\nFLU\n\nClimate Zone\nApplication\n\n\n\nLong-term Cultivated\nContinuous annual crops &gt;20 years\n0.69\nTropical Moist\nBaseline degraded state\n\n\nLong-term Cultivated\nContinuous annual crops &gt;20 years\n0.80\nTropical Montane\nBaseline degraded state\n\n\nLong-term Cultivated\nContinuous annual crops &gt;20 years\n0.92\nTropical Dry\nBaseline degraded state\n\n\nSet Aside\nTemporary idle cropland or conservation reserve (&lt;20 years)\n0.93\nTropical Moist\nRecovering/fallow lands\n\n\nPaddy Rice\nLong-term annual wetland cropping\n1.35\nAll Tropical\nAnaerobic SOC preservation\n\n\n\n\n\n\n\n\n\nSOC Baseline Strategies\n\n\n\nThe FLU = 0.69 factor for long-term cultivated tropical moist croplands represents substantial SOC depletion, providing a favorable baseline for conservation agriculture interventions.\n\n\n\nTable 2.F: Cropland Tillage Intensity Stock Change Factors (IPCC 2019, Vol. 4, Ch. 5, Table 5.5)\n\n\n\n\n\n\n\n\n\nTillage Practice\nDescription\nFMG\n\nClimate Zone\nMateriality (Ref Value)\n\n\n\nFull Tillage\nSubstantial soil disturbance; &gt;30% surface bare after planting; moldboard/disc plowing\n1.00\nAll climates\nno benefit\n\n\nReduced Tillage\nPrimary and/or secondary tillage before planting; &lt;30% residue remaining on surface\n0.99\nTropical Dry\nMinimal benefit\n\n\nReduced Tillage\nPrimary and/or secondary tillage before planting; &lt;30% residue remaining on surface\n1.02\nTropical Montane\nSlight SOC gain\n\n\nReduced Tillage\nPrimary and/or secondary tillage before planting; &lt;30% residue remaining on surface\n1.04\nTropical Moist/Wet\nModerate SOC gain\n\n\nNo-Till\nDirect seeding; minimal disturbance; &gt;30% residue cover maintained\n1.04\nTropical Dry\nModerate benefit\n\n\nNo-Till\nDirect seeding; minimal disturbance; &gt;30% residue cover maintained\n1.07\nTropical Montane\nStrong benefit\n\n\nNo-Till\nDirect seeding; minimal disturbance; &gt;30% residue cover maintained\n1.10\nTropical Moist/Wet\nMaximum benefit\n\n\n\n\n\n\n\n\n\nManagement Strategies (FMG)\n\n\n\nNo-till systems in Tropical Moist climates provide a 10% SOC increase (FMG = 1.10) over full tillage. This factor is multiplicative with input factors, potentially offsetting SOC losses from forest conversion when combined with high organic inputs (1.10 × 1.11 = 1.22).",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>2. Emission Factors</span>"
    ]
  },
  {
    "objectID": "02-emission-factors/index.html#example-tier-1-strategy",
    "href": "02-emission-factors/index.html#example-tier-1-strategy",
    "title": "2. Emission Factors",
    "section": "2.5 Example Tier 1 Strategy",
    "text": "2.5 Example Tier 1 Strategy\nInput factors apply to both cropland and improved grassland systems, stratified by level of organic matter additions.\nTable 2.F: Organic Input Stock Change Factors (IPCC 2019, Vol. 4, Ch. 5, Table 5.5)\n\n\n\n\n\n\n\n\n\nInput Level\nDescription\nFI\n\nUncertainty\nExamples\n\n\n\nLow\nResidue removal OR bare fallowing OR no N-fixing crops\n0.92\n±30%\nExport all straw/stover; burn residues\n\n\nMedium\nAll residues returned to field OR supplemental organic matter added\n1.00\nNA (reference)\nStandard practice; residue retention\n\n\nHigh (without manure)\nHigh residue crops + green manures + cover crops\n1.04\n±30%\nIntensive cover cropping; legume rotations\n\n\nHigh (with manure)\nHigh inputs PLUS regular animal manure application\n1.11\n±30%\nMaximum SOC gain\n\n\n\nMultiplicative Effect:\nConsider forest conversion to conservation agriculture in Tropical Moist climate:\nScenario: Forest → No-till cropland + high inputs + manure\n\nInitial SOC: 38 tC/ha (LAC soil, native forest)\n  F_LU = 1.0, F_MG = 1.0, F_I = 1.0\n  SOC_initial = 38 × 1.0 × 1.0 × 1.0 = 38.0 tC/ha\n\nFinal SOC: \n  F_LU = 0.83 (long-term cultivated), F_MG = 1.10 (no-till), F_I = 1.11 (high+manure)\n  SOC_final = 38 × 0.83 × 1.10 × 1.11 = 38.4 tC/ha\n\nResult: SLIGHT NET GAIN despite forest conversion\nAnnual change: (38.4 - 38.0) / 20 = +0.02 tC/ha/yr (negligible)\nThis demonstrates how strategic management can approach carbon neutrality for necessary agricultural expansion.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>2. Emission Factors</span>"
    ]
  },
  {
    "objectID": "02-emission-factors/index.html#reference-stock-values",
    "href": "02-emission-factors/index.html#reference-stock-values",
    "title": "2. Emission Factors",
    "section": "2.6 Reference Stock Values",
    "text": "2.6 Reference Stock Values\nReference stocks (SOCREF) represent soil organic carbon content under native vegetation, stratified by climate zone and soil type. For example, the following default pre-conversion soil conditions are estimated for the following soil types in Tropical Montane ecozones, reporting mean stock volumes and their associated uncertainty metrics.\nTable 2.G: Reference SOC Stocks, Tropical Montane (IPCC 2019, Vol. 4, Ch. 2, Table 2.3)\n\n\n\n\n\n\n\n\nSoil Type\nSOCREF (tC/ha)\nUncertainty\nTypical Locations\n\n\n\nHigh Activity Clay (HAC)\n51\n±10%\nMontane valleys; moderate weathering; base-rich parent material\n\n\nLow Activity Clay (LAC)\n44\n±11%\nOlder highly weathered montane soils; kaolinitic clays\n\n\nSandy (SAN)\n52\n±34%\nAlluvial terraces (uncommon in mountains)\n\n\nVolcanic (VOL)\n96\n±31%\nAndean volcanic zones—highest SOC potential\n\n\nWetland Organic (WET)\n82\n±50%\nHigh-altitude peatlands; páramo wetlands\n\n\n\n\n\n\n\n\n\n\nVolcanic Soils\n\n\n\nVolcanic soils (VOL) in Andean regions hold nearly double the carbon of other mineral soil types, prioritize protection of volcanic soil landscapes for maximum carbon benefits.\n\n\n\nTable 2.H: Reference SOC Stocks, Tropical Moist (IPCC 2019, Vol. 4, Ch. 2, Table 2.3)\n\n\n\n\n\n\n\n\nSoil Type\nSOCREF (tC/ha)\nUncertainty\nApplication\n\n\n\nHigh Activity Clay (HAC)\n40\n±7%\nNutrient-rich floodplains; recent alluvial deposits\n\n\nLow Activity Clay (LAC)\n38\n±5%\nMost widespread tropical upland soils—use as default\n\n\nSandy (SAN)\n27\n±12%\nDegraded leached soils; low fertility\n\n\nVolcanic (VOL)\n70\n±90%\nVolcanic regions (high uncertainty—use cautiously)\n\n\nWetland Organic (WET)\n68\n±17%\nSwamp forests; seasonally flooded forests\n\n\n\nTable 2.I: Reference SOC Stocks, Tropical Wet (IPCC 2019, Vol. 4, Ch. 2, Table 2.3)\n\nTable 2.J: Reference SOC Stocks, Tropical Dry (IPCC 2019, Vol. 4, Ch. 2, Table 2.3)\n\n\n\n\n\n\n\n\nSoil Type\nSOCREF (tC/ha)\nUncertainty\nContext\n\n\n\nHAC\n60\n±8%\nRich alluvial floodplains\n\n\nLAC\n52\n±6%\nStandard humid rainforest soils\n\n\nSAN\n46\n±20%\nPoor drainage; seasonally saturated\n\n\nVOL\n77\n±27%\nVolcanic rainforest zones\n\n\nWET\n49\n±19%\nCoastal mangroves; tidal zones\n\n\n\n\n\n\n\n\n\n\n\nSoil Type\nSOCREF (tC/ha)\nUncertainty\nContext (&lt;1000mm Rainfall)\n\n\n\nHAC\n21\n±5%\nVertisols in semi-arid zones\n\n\nLAC\n19\n±10%\nLowest SOC—limited below-ground credit potential\n\n\nSAN\n9\n±9%\nDesert margins; very low productivity\n\n\nVOL\n50\n±90%\nDry volcanic zones (rare)\n\n\nWET\n22\n±17%\nSeasonal wetlands; temporary flooding\n\n\n\n\n\n\n\n\n\nDry Tropics Strategies\n\n\n\nTropical dry zones have inherently low SOC baselines (19-21 tC/ha for mineral soils). Carbon credit generation in these regions should prioritize above-ground biomass through agroforestry and forest protection rather than soil carbon sequestration.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>2. Emission Factors</span>"
    ]
  },
  {
    "objectID": "02-emission-factors/index.html#aboveground-stock-change",
    "href": "02-emission-factors/index.html#aboveground-stock-change",
    "title": "2. Emission Factors",
    "section": "2.7. Aboveground Stock Change",
    "text": "2.7. Aboveground Stock Change\nAgroforestry Systems\nAgroforestry represents a high-value opportunity for carbon crediting, combining productive land use with significant biomass accumulation. The IPCC 2019 Refinements provide system-specific growth rates for seven distinct agroforestry typologies.\nTable 2.K: Agroforestry System Typology (IPCC 2019, Vol. 4, Ch. 5, Table 5.4)\n\n\n\n\n\n\n\n\nSystem\nDefinition\nTree Component\nCrop/Livestock Component\n\n\n\nSilvoarable\nTrees integrated with annual crop production in spatial mixture\nRegularly spaced rows or scattered; 20-1,000 stems/ha; managed for timber/fruit\nCereals, legumes, vegetables in rotation\n\n\nSilvopasture\nTrees integrated with livestock grazing\nScattered individuals or clusters; 150-2,000 stems/ha; shade and fodder provision\nGrasses, improved pasture species\n\n\nAlley Cropping\nDense tree rows with annual crops planted in alleys between hedgerows\nDense hedgerows; ~8,500 stems/ha; regular pruning for biomass/mulch\nAnnual crops in rotation between tree rows\n\n\nMultistrata\nVertical stratification of tree species (≥2 canopy layers)\nMixed species at different canopy heights; ~900 stems/ha\nShade-tolerant perennials (coffee, cacao, spices)\n\n\nShaded Perennial\nSingle-story tree canopy over perennial crop\nUniform overstory; ~4,200 stems/ha; managed for consistent shade\nCoffee, tea, cacao as understory\n\n\nFallow (Rotational)\nWoody vegetation regrowth phase in shifting cultivation systems\nDense natural regeneration; ~6,000 stems/ha during fallow\nCrops planted after clearing fallow vegetation\n\n\nParkland\nScattered mature trees retained in extensive cropland\nVery sparse; ~150 stems/ha; remnant trees from forest conversion\nExtensive annual crop systems\n\n\n\nStock Accumulation Rates\nTable 2.L: Tropical Agroforestry Aboveground Biomass Accumulation Rates (IPCC 2019, Vol. 4, Ch. 5, Tables 5.1 & 5.2; Cardinael et al. 2018)\n\n\n\n\n\n\n\n\n\n\n\nSystem\nAGB Growth (G)\nBGB Growth\nTotal C Gain\nPeriod\nMax Stock (Lmax)\nStem Density\n\n\n\nSilvoarable\n6.24 tC/ha/yr\n1.62 tC/ha/yr\n7.86 tC/ha/yr\n20 years\n72.2 tC/ha\n880 stems/ha\n\n\nSilvopasture\n3.07 tC/ha/yr\n0.84 tC/ha/yr\n3.91 tC/ha/yr\n20 years\n58.2 tC/ha\n1,609 stems/ha\n\n\nMultistrata\n3.25 tC/ha/yr\n0.80 tC/ha/yr\n4.05 tC/ha/yr\n20 years\n65.0 tC/ha\n929 stems/ha\n\n\nShaded Perennial\n2.40 tC/ha/yr\n0.55 tC/ha/yr\n2.95 tC/ha/yr\n20 years\n48.0 tC/ha\n4,236 stems/ha\n\n\nAlley Cropping\n2.37 tC/ha/yr\n0.79 tC/ha/yr\n3.16 tC/ha/yr\n20 years\n47.4 tC/ha\n8,568 stems/ha\n\n\nFallow\n4.42 tC/ha/yr\n1.21 tC/ha/yr\n5.63 tC/ha/yr\n5 years\n22.1 tC/ha\n6,074 stems/ha\n\n\nParkland\n0.59 tC/ha/yr\n0.16 tC/ha/yr\n0.75 tC/ha/yr\n20 years\n11.8 tC/ha\n152 stems/ha\n\n\n\n\n\n\n\n\n\nCost-Benefit Metrics\n\n\n\nNote that accumulation rates carry ±15-63% uncertainty in their distribution which represents useful ROI benchmark for investment decisions and crediting management.\n\n\nSilvopastoral Systems\n\nSilvoarable systems offer the highest long-term carbon accumulation (7.86 tC/ha/yr), equivalent to 28.8 tCO₂e/ha/yr—ideal for jurisdictions with strong silvicultural capacity\nFallow systems have rapid accumulation rates (4.42 tC/ha/yr) but short harvest cycles (5 years)—useful for bridging short-term credit gaps but require frequent re-establishment\nMultistrata coffee/cacao (3.25 tC/ha/yr) balances commodity production with carbon credits, making it economically attractive where markets exist\nBelow-ground accumulation adds 21-27% to total carbon gains—always include root biomass in credit calculations\n\nCO₂e Conversion:\n\nTotal C Gain (tC/ha/yr) × 3.67 = tCO₂e/ha/yr\n\nExample: Silvoarable \n7.86 tC/ha/yr × 3.67 = 28.8 tCO₂e/ha/yr\nTemperate Agroforestry\nTable 2.M: Cool Temperate Agroforestry Systems\n\n\n\n\n\n\n\n\n\n\nSystem\nClimate\nAGB Growth (G)\nHarvest Cycle\nMax Stock\nApplication\n\n\n\nSilvoarable\nCool Temperate\n0.91 tC/ha/yr\n30 years\n27.3 tC/ha\nNorthern hemisphere programs\n\n\nSilvopasture\nCool Temperate\n2.33 tC/ha/yr\n30 years\n69.9 tC/ha\nTemperate pasture regions\n\n\nHedgerow\nCool Temperate\n0.87 tC/ha/km\n30 years\n26.1 tC/km\nNote: per km, not per ha\n\n\n\nPerennial Cropping System\nTable 2.N: Perennial Monoculture Biomass Accumulation (IPCC 2019, Vol. 4, Ch. 4, Tables 4.8 & 4.10)\n\n\n\n\n\n\n\n\n\n\n\nCrop\nAGB Growth (G)\nBGB Growth\nTotal Gain\nMax Stock\nPeriod\nReferences\n\n\n\nOil Palm\n2.40 tC/ha/yr\n0.66 tC/ha/yr\n3.06 tC/ha/yr\n60 tC/ha\n25 years\nCh. 4, Table 4.8\n\n\nRubber\n3.00 tC/ha/yr\n0.82 tC/ha/yr\n3.82 tC/ha/yr\n80.2 tC/ha\n27 years\nCh. 4, Table 4.8\n\n\nCoconut\n0.70 tC/ha/yr\n0.19 tC/ha/yr\n0.89 tC/ha/yr\n18 tC/ha\n25 years\nDefault generic\n\n\nCoffee (unshaded)\n0.85 tC/ha/yr\n0.23 tC/ha/yr\n1.08 tC/ha/yr\n17 tC/ha\n20 years\nField data synthesis\n\n\nCacao (unshaded)\n0.90 tC/ha/yr\n0.25 tC/ha/yr\n1.15 tC/ha/yr\n18 tC/ha\n20 years\nField data synthesis\n\n\nTea\n0.70 tC/ha/yr\n0.19 tC/ha/yr\n0.89 tC/ha/yr\n14 tC/ha\n20 years\nCh. 4, Table 4.8\n\n\n\n\n\n\n\n\n\n\nMixed vs. Monoculture Tree Cropping\n\n\n\nShaded coffee/cacao (Multistrata system: 3.25 tC/ha/yr) accumulates 3.6× more carbon than unshaded monocultures (~0.9 tC/ha/yr). This provides strong economic incentive for agroforestry adoption in suitable climates.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>2. Emission Factors</span>"
    ]
  },
  {
    "objectID": "02-emission-factors/index.html#post-clearance-stock-retention",
    "href": "02-emission-factors/index.html#post-clearance-stock-retention",
    "title": "2. Emission Factors",
    "section": "2.8 Post-Clearance Stock Retention",
    "text": "2.8 Post-Clearance Stock Retention\nWhen forest is converted to perennial cropland, IPCC provides specific “Year 1” biomass retention values representing residual carbon after clearing but before full crop maturity.\nTable 2.O: First-Year Biomass Stock After Forest Conversion (IPCC 2019, Vol. 4, Ch. 5, Table 5.9)\n\n\n\n\n\n\n\n\nCrop Type\nClimate\nYear-1 AGB (CG)\nSource\n\n\n\nPerennial (generic)\nTropical Moist\n4.7 tC/ha\nDefault\n\n\nPerennial (generic)\nTropical Montane\n4.7 tC/ha\nDefault\n\n\nOil Palm\nTropical\n2.4 tC/ha\nSpecific factor\n\n\nRubber\nTropical\n3.0 tC/ha\nSpecific factor\n\n\nCoffee/Cacao (shaded)\nTropical\n3.25 tC/ha\nMultistrata proxy\n\n\n\n\n\n\n\n\n\n\nOne-Year Retention Limit\n\n\n\nThe CG value represents biomass present in Year 1 only. Subsequent years accumulate at the growth rate G shown in Table 3.4 until reaching maximum stock at harvest cycle completion.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>2. Emission Factors</span>"
    ]
  },
  {
    "objectID": "02-emission-factors/index.html#forest-stock-regrowth",
    "href": "02-emission-factors/index.html#forest-stock-regrowth",
    "title": "2. Emission Factors",
    "section": "2.9 Forest Stock Regrowth",
    "text": "2.9 Forest Stock Regrowth\nSecondary forest regrowth rates are age-dependent, with young stands (≤20 years) showing substantially higher accumulation than mature forests (cite). This has critical implications for this module’s objectives, to support project prioritization through strategic emission factor selections.\nTropical Rainforest - Americas\nTable 2.P: Secondary Rainforest Growth Rates (Americas) (IPCC 2019, Vol. 4, Ch. 4, Table 4.9)\n\n\n\n\n\n\n\n\n\nAge Class\nGrowth Rate (G)\nCarbon Gain\nMax Biomass\nStrategic Application\n\n\n\n≤ 20 years\n5.9 t DM/ha/yr\n2.77 tC/ha/yr\n75.7 t DM/ha\nRapid regrowth phase—prioritize protection\n\n\n&gt; 20 years\n2.3 t DM/ha/yr\n1.08 tC/ha/yr\n206.4 t DM/ha\nMature phase—lower annual credits\n\n\n\nConversion Factors: - Carbon (tC) = Dry Matter (t DM) × 0.47 - CO₂ equivalent = Carbon × 3.67\nExample: Young secondary forest (Americas, ≤20 yr)\n2.77 tC/ha/yr × 3.67 = 10.2 tCO₂e/ha/yr\nTropical Rainforest - Asia\nTable 2.Q: Secondary Rainforest Growth Rates (Asia)\n\n\nAge Class\nGrowth Rate (G)\nCarbon Gain\nMax Biomass\n\n\n\n≤ 20 years\n3.4 t DM/ha/yr\n1.60 tC/ha/yr\n45.6 t DM/ha\n\n\n&gt; 20 years\n2.0 t DM/ha/yr\n0.94 tC/ha/yr\n151.2 t DM/ha\n\n\nTropical Rainforest - Africa\nTable 2.R: Secondary Rainforest Growth Rates (Africa)\n\n\nAge Class\nGrowth Rate (G)\nCarbon Gain\nMax Biomass\n\n\n\n≤ 20 years\n3.6 t DM/ha/yr\n1.69 tC/ha/yr\n56.8 t DM/ha\n\n\n&gt; 20 years\n2.4 t DM/ha/yr\n1.13 tC/ha/yr\n198.4 t DM/ha\n\n\nTropical Moist Deciduous - Africa\nTable 2.S: Secondary Moist Deciduous Forest Growth (Africa)\n\n\nAge Class\nGrowth Rate (G)\nCarbon Gain\nMax Biomass\n\n\n\n≤ 20 years\n5.2 t DM/ha/yr\n2.44 tC/ha/yr\n55.7 t DM/ha\n\n\n&gt; 20 years\n2.1 t DM/ha/yr\n0.99 tC/ha/yr\n179.0 t DM/ha\n\n\nTropical Dry Forest - Americas\nTable 2.T: Secondary Dry Forest Growth (Americas)\n\n\nAge Class\nGrowth Rate (G)\nCarbon Gain\nMax Biomass\n\n\n\n≤ 20 years\n3.9 t DM/ha/yr\n1.83 tC/ha/yr\n32.2 t DM/ha\n\n\n&gt; 20 years\n1.5 t DM/ha/yr\n0.70 tC/ha/yr\n72.8 t DM/ha\n\n\n\n\n\n\n\n\n\n\nAge-Class Strategies\n\n\n\nYoung secondary forests (≤20 years) grow 2-3× faster than mature stands across all forest types. This means that protection or restoration projects targeting 0-20 year regeneration areas generate maximum credit velocity (annual tonnes CO₂e/ha). However, mature forests (&gt;20 years) hold larger carbon stocks and provide greater permanence security. Recommendation:\n\nPortfolio approach combining both young regeneration (high annual credits) and mature forests (high stock, low leakage risk).",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>2. Emission Factors</span>"
    ]
  },
  {
    "objectID": "02-emission-factors/index.html#worked-examples",
    "href": "02-emission-factors/index.html#worked-examples",
    "title": "2. Emission Factors",
    "section": "2.10 Worked Examples",
    "text": "2.10 Worked Examples\nExample A: Tropical Moist Grassland Restoration\nScenario: Restore 1,000 ha of severely degraded tropical pasture to improved silvopasture with manure inputs\nStep 1: Define Initial Conditions (Baseline)\n\nSoil Type: Low Activity Clay (LAC)\nClimate: Tropical Moist\nSOCREF: 38 tC/ha (Table 2.7)\nManagement: Severely degraded (FMG = 0.70)\nInput Level: Nominal (FI = 1.0)\nBiomass: 7.6 t DM/ha (IPCC 2006 grassland default)\n\nSOC Calculation (t=1):\nSOC_initial = SOC_REF × F_LU × F_MG × F_I\nSOC_initial = 38 × 1.0 × 0.70 × 1.0\nSOC_initial = 26.6 tC/ha\nStep 2: Define Project Conditions (Final State)\n\nManagement: Improved tropical grassland (FMG = 1.17)\nInput Level: High with manure (FI = 1.11)\nBiomass: Silvopasture accumulation (G = 3.07 tC/ha/yr AGB + 0.84 tC/ha/yr BGB)\n\nSOC Calculation (t=20):\nSOC_final = SOC_REF × F_LU × F_MG × F_I\nSOC_final = 38 × 1.0 × 1.17 × 1.11\nSOC_final = 49.3 tC/ha\nStep 3: Calculate Annual SOC Change\nΔSOC = (SOC_final - SOC_initial) / 20 years\nΔSOC = (49.3 - 26.6) / 20\nΔSOC = 1.14 tC/ha/yr\nStep 4: Calculate Biomass Accumulation\nΔBiomass (total) = G_AGB + G_BGB\nΔBiomass = 3.07 + 0.84\nΔBiomass = 3.91 tC/ha/yr\nStep 5: Total Annual Carbon Benefit\nTotal Gain = ΔSOC + ΔBiomass\nTotal Gain = 1.14 + 3.91\nTotal Gain = 5.05 tC/ha/yr\n\nConvert to CO₂e:\nTotal Gain = 5.05 × 3.67 = 18.5 tCO₂e/ha/yr\nStep 6: Project-Scale Credits Over 20 Years\nTotal Credits (1,000 ha):\nPer hectare: 5.05 tC/ha/yr × 20 yr = 101 tC/ha\nProject total: 101 tC/ha × 1,000 ha = 101,000 tC\nIn CO₂e: 101,000 × 3.67 = 370,670 tCO₂e\n\nAnnual credits: 18,500 tCO₂e/yr\nRevenue Potential (at $15/tCO₂e): $277,500 per year for 20 years\nExample B: Forest Conversion to Conservation Agriculture\nScenario: 500 ha of tropical moist forest converted to no-till annual cropland with high organic inputs (unavoidable conversion for food security)\nStep 1: Initial Forest Biomass and SOC\n\nSoil: LAC (SOCREF = 38 tC/ha)\nBiomass: 88 t DM/ha (IPCC default for tropical moist secondary forest)\nRoot:Shoot Ratio: 0.207 (Table 4.4)\n\nInitial Carbon Stocks:\nAGB: 88 × 0.47 = 41.4 tC/ha\nBGB: 41.4 × 0.207 = 8.6 tC/ha\nSOC: 38 × 1.0 × 1.0 × 1.0 = 38.0 tC/ha\nTotal: 41.4 + 8.6 + 38.0 = 88.0 tC/ha\nStep 2: Final Cropland Stocks\n\nFLU: 0.83 (long-term cultivated)\nFMG: 1.10 (no-till)\nFI: 1.04 (high inputs, no manure)\nYear-1 Biomass (CG): 4.7 tC/ha (Table 3.5)\n\nFinal SOC After 20 Years:\nSOC_final = 38 × 0.83 × 1.10 × 1.04\nSOC_final = 37.1 tC/ha\n\nAnnual SOC change:\nΔSOC = (37.1 - 38.0) / 20 = -0.05 tC/ha/yr\nStep 3: Biomass Loss Accounting\nBiomass lost in Year 1:\n  AGB + BGB - C_G retained = (41.4 + 8.6) - 4.7 = 45.3 tC/ha\n\nConvert to CO₂e:\n  45.3 × 3.67 = 166 tCO₂e/ha (one-time loss)\nStep 4: Total Carbon Impact\nOver 20 years:\n  Biomass loss: -166 tCO₂e/ha (Year 1)\n  SOC loss: -0.05 tC/ha/yr × 20 yr × 3.67 = -3.7 tCO₂e/ha\n  \nTotal loss: 166 + 3.7 = 169.7 tCO₂e/ha\n\nFor 500 ha: 84,850 tCO₂e total\nAnnual average: 4,243 tCO₂e/yr\n\n\n\n\n\n\nImportant\n\n\n\nWith comprehensive uncertainty reporting strategies, conservation agriculture practices, characterized by no-till and high manure inputs, very nearly neutralizes SOC loss from forest conversion, representing only a ~0.18 tCO₂e/ha/yr decline across the inventory period. Biomass loss remains unavoidable, which clearly demonstrates the importance of:\n\nApplying and documenting maximum conservation practices when conversion is necessary\nPrioritizing conversion of already-degraded lands rather than forest\n\n\n\nExample C: Young Secondary Forest Conservation\nScenario: Prevent clearing of 2,000 ha of 10-year-old secondary rainforest (Americas)\nStep 1: Baseline (What Would Happen Without Project)\nAssume conversion to severely degraded pasture:\nBiomass loss:\n  Accumulated after 10 yr: 5.9 t DM/ha/yr × 10 yr = 59 t DM/ha\n  Carbon: 59 × 0.47 = 27.7 tC/ha (AGB)\n  Roots: 27.7 × 0.221 = 6.1 tC/ha (BGB)\n  Total biomass: 33.8 tC/ha\n\nSOC degradation (over 20 years):\n  Initial: 38 × 1.0 × 1.0 × 1.0 = 38.0 tC/ha\n  Final: 38 × 1.0 × 0.70 × 1.0 = 26.6 tC/ha\n  Loss: (26.6 - 38.0) / 20 × 20 = 11.4 tC/ha\n\nTotal baseline loss: 33.8 + 11.4 = 45.2 tC/ha\nIn CO₂e: 45.2 × 3.67 = 166 tCO₂e/ha\nStep 2: Project (Continued Growth Protected)\nForest continues growing for next 10 years (years 11-20):\nAdditional biomass accumulation:\n  AGB: 5.9 t DM/ha/yr × 10 yr × 0.47 = 27.7 tC/ha\n  BGB: 27.7 × 0.221 = 6.1 tC/ha\n  Total: 33.8 tC/ha\n\nSOC maintained (no change): 0 tC/ha\n\nTotal project gain: 33.8 tC/ha\nIn CO₂e: 33.8 × 3.67 = 124 tCO₂e/ha\nStep 3: Net Project Benefit\nAvoided emissions: 166 tCO₂e/ha\nAdditional sequestration: 124 tCO₂e/ha\nTotal credits: 290 tCO₂e/ha over 10-year crediting period\n\nAnnual average: 29 tCO₂e/ha/yr\n\nFor 2,000 ha:\n  Total credits: 580,000 tCO₂e over 10 years\n  Annual: 58,000 tCO₂e/yr\nRevenue Potential (at $12/tCO₂e): $696,000 per year. Potentially, young secondary forests (≤20 years) provide exceptional credit generation as a result of:\n\nHigh baseline threat of avoided deforestation scenario\nContinued rapid growth rate of protected land at 5.9 t DM/ha/yr.\nAdditionality easily demonstrated such as in marginal lands otherwise targeted for clearing\n\nThis makes areas with 20 year regeneration rates prime candidates for Tier 1 reporting.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>2. Emission Factors</span>"
    ]
  },
  {
    "objectID": "02-emission-factors/index.html#double-counting-risks",
    "href": "02-emission-factors/index.html#double-counting-risks",
    "title": "2. Emission Factors",
    "section": "2.11 Double-Counting Risks",
    "text": "2.11 Double-Counting Risks\nDouble-Counting SOC Timelines\n\nProblem: Legacy emissions from historical land conversion overlap with new management activity credits\nRule: Each hectare reports in only one land category per reporting year\n\nSafeguards:\n\nOne Category Per Year: During 20-year SOC transition period, attribute ALL stock changes to the end-use land category, not the category of origin\nCohort Tracking: Maintain records of conversion year for each hectare to calculate remaining transition period\nOverlapping Activities: When new management changes occur before transition completes:\n\nExample:\n2015: Forest → Cropland (begins 20-year SOC transition)\n2020: Apply improved management to same cropland\n\nCORRECT approach:\n  - Apply new factors only to remaining 15 years (2020-2035)\n  - Calculate: (SOC_new_2035 - SOC_current_2020) / 15 years\n\nINCORRECT approach:\n  - Claim new full 20-year transition from 2020\n  - This double-counts years 2020-2035 from original conversion\n\n\n\n\n\n\nCritical Rule\n\n\n\nConsider reporting only non-CO₂ gases separately as CO₂ from biomass burning is already accounted for in the “Biomass Stock Change” calculation through the assumption of immediate oxidation in Tier 1 default for that transition type.\n\n\nTracking Site-Specific Timelines\n\nProblem: Claiming infinite biomass accumulation in systems with periodic harvest\nRule: Agroforestry credits must account for harvest cycle and removal\n\nSafeguards:\n\nRespect Default Harvest Cycles (Table 3.2):\n\nTropical agroforestry: 20 years (except fallow: 5 years)\nTemperate agroforestry: 30 years\n\n\nAccount for Biomass Removal at Harvest:\n\nExample (Coffee Multistrata, 20-year cycle):\nAccumulation Phase (Years 1-20):\n  Annual gain: 3.25 tC/ha/yr × 20 yr = 65 tC/ha accumulated\n\nHarvest (Year 20):\n  Biomass removal: L_mean = L_max / 2 = 65 / 2 = 32.5 tC/ha\n\nRe-accumulation Phase (Years 21-40):\n  Repeat accumulation: 3.25 tC/ha/yr × 20 yr = 65 tC/ha\n\nNet Over 40 Years:\n  Total gain: 3.25 × 40 = 130 tC/ha\n  Total removed: 32.5 × 2 = 65 tC/ha\n  Net accumulation: 65 tC/ha\n  Average annual: 1.63 tC/ha/yr\nHowever, Tier 2 data may report longer rotations, such as from 20-year coffee systems farming records.\nTracking Overlapping Management Activities\nProblem: Multiple improvements on same land (e.g., tillage change + lime + manure)\nSOC Decision Framework:\nCase A: Separable Impacts (Different Pools)\nActivity 1: No-till (affects 0-30cm mineral SOC) → F_MG = 1.10\nActivity 2: Liming (affects inorganic C pool) → Report under Tier 3 inorganic C\n\nResult: No double-counting; different carbon pools\nCase B: Overlapping Impacts (Same Pool)\nActivity 1: Switch to no-till → F_MG = 1.10\nActivity 2: Add cover crops → F_I = 1.04\nActivity 3: Add manure → F_I = 1.11 (instead of 1.04)\n\nDecision Options:\n  Option 1 (if cumulative effect proven): F_MG × F_I = 1.10 × 1.11 = 1.22\n  Option 2 (conservative): Use only F_I = 1.11 (most dominant factor)\n\nRequired: Document choice and scientific justification for VVB audit\n\n\n\n\n\n\nGeneral Principle\n\n\n\nWhen uncertain about cumulative versus saturating effects, apply the most conservative interpretation and document rationale clearly.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>2. Emission Factors</span>"
    ]
  },
  {
    "objectID": "02-emission-factors/index.html#uncertainty-quantification",
    "href": "02-emission-factors/index.html#uncertainty-quantification",
    "title": "2. Emission Factors",
    "section": "2.12 Uncertainty Quantification",
    "text": "2.12 Uncertainty Quantification\nError Propagation\nFor independent variables, total uncertainty is calculated as follows\n\\(U_{\\text{total}} = \\sqrt{(U_1)^2 + (U_2)^2 + \\dots + (U_n)^2}\\)\nWhere U = proportional uncertainty (e.g., ±11% → 0.11)\nTable 2.U: Typical Range in Uncertainty from Tier 1 Emission Factors\n\n\n\n\n\n\n\n\nParameter\nSource of Uncertainty\nTypical Range\nImpact on Credits\n\n\n\nSOCREF\n\nClimate/soil classification ambiguity; spatial heterogeneity\n±5-90%\nHigh—drives baseline calculation\n\n\nFMG (Improved Grassland)\nManagement definition; intensity measurement\n±9-11%\nModerate—multiplicative factor\n\n\nFI (High Input)\nQuantification of organic matter additions\n±30%\nModerate—multiplicative factor\n\n\nG (Agroforestry)\nSystem definition; site variability; climate\n±13-63%\nHigh—direct rate parameter\n\n\nBiomass Stock\nRemote sensing error; allometric equation selection\n±20-40%\nHigh—one-time loss calculation\n\n\nActivity Data (Area)\nLand use classification; GPS accuracy\n±5-15%\nScales all estimates",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>2. Emission Factors</span>"
    ]
  },
  {
    "objectID": "02-emission-factors/index.html#worked-examples-1",
    "href": "02-emission-factors/index.html#worked-examples-1",
    "title": "2. Emission Factors",
    "section": "2.13 Worked Examples",
    "text": "2.13 Worked Examples\nProject: 1,000 ha improved silvopasture (FMG = 1.17, FI = 1.11, G = 3.07 tC/ha/yr)\nUncertainty Components:\nSOC_REF (LAC, Tropical Moist): ±5% → 0.05\nF_MG (Improved Tropical): ±9% → 0.09\nF_I (High Input): ±30% → 0.30\nG (Silvopasture AGB): ±63% → 0.63\nArea measurement: ±10% → 0.10\n\nU_total = √[(0.05)² + (0.09)² + (0.30)² + (0.63)² + (0.10)²]\nU_total = √[0.0025 + 0.0081 + 0.09 + 0.3969 + 0.01]\nU_total = √0.5075 = 0.712 → ±71%\nCredit Calculation with Uncertainty:\nPoint Estimate: 18.5 tCO₂e/ha/yr × 1,000 ha = 18,500 tCO₂e/yr\n\nConservative Estimate (Lower Bound):\n  18,500 × (1 - 0.712) = 5,328 tCO₂e/yr\n\nUpper Bound:\n  18,500 × (1 + 0.712) = 31,672 tCO₂e/yr\n\n95% Confidence Interval: 5,328 - 31,672 tCO₂e/yr",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>2. Emission Factors</span>"
    ]
  },
  {
    "objectID": "02-emission-factors/index.html#chapter-summary",
    "href": "02-emission-factors/index.html#chapter-summary",
    "title": "2. Emission Factors",
    "section": "2.14 Chapter Summary",
    "text": "2.14 Chapter Summary\nThe following were compiled as critical decision points for program proponents.\n\nVerify Soil Type First: Distinguish mineral vs. organic soils before selecting accounting method—this is the most fundamental decision\nStratify Appropriately: Match climate zone, soil type, and management class to IPCC lookup tables—incorrect stratification invalidates results\nDocument Baseline Rigorously: Large SOC or biomass changes require strong evidence of degraded initial conditions to justify additionality\nApply Harvest Cycles: Agroforestry credits must account for periodic biomass removal—do not claim indefinite accumulation\nImplement Safeguards: Prevent double-counting through temporal tracking, pool separation, and conservative interpretation of overlapping activities\nQuantify Uncertainty: Calculate and report propagated uncertainties—consider Tier 2 upgrades when Tier 1 uncertainties exceed ±50%\n\nART-TREES Uncertainty Documentation:\n\nQuantified Uncertainty for each major parameter\nPropagated Total Uncertainty for final emission/removal estimates\nDocumented Justification for Tier 2 or 3 Upgrade in support of variance requests\n\nTable 2.V Emissions Factor Uncertainty Enhancements\n\n\n\n\n\n\n\n\nRank\nConversion Activity\nCarbon Benefit\nKey Considerations\n\n\n\n1\nGrassland Restoration (degraded &gt;&gt; improved)\n67% SOC increase\nRequires documented degradation baseline\n\n\n2\nSilvoarable agroforestry establishment\n7.86 tC/ha/yr total gain\nNeeds strong silvicultural capacity\n\n\n3\nYoung secondary forest conservation\n2.77-5.9 tC/ha/yr + avoided loss\nHigh additionality, rapid credits\n\n\n4\nMultistrata coffee/cacao conversion\n4.05 tC/ha/yr + commodity income\nMarket-dependent feasibility\n\n\n5\nConservation agriculture adoption\n22% SOC retention vs. tillage\nCumulative with other practices",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>2. Emission Factors</span>"
    ]
  },
  {
    "objectID": "02-emission-factors/index.html#next-steps",
    "href": "02-emission-factors/index.html#next-steps",
    "title": "2. Emission Factors",
    "section": "2.15 Next Steps",
    "text": "2.15 Next Steps\nPractitioners should now be prepared to:\n\nSelect appropriate emission factors from IPCC 2019 Tier 1 values.\nCalculate SOC and biomass changes using standardized equations\nIdentify strategic opportunities for credit generation\nImplement MRV safeguards to improve compliance and reduce audit risk\n\nPending this review, we will proceed to Chapter 3 on Activity Data Uncertainty to address spatial and landcover classification errors\n\n\n\n\n\n\nIPCC. (2019). Chapter 2: Generic methodologies applicable to multiple land-use categories. In 2019 refinement to the 2006 IPCC guidelines for national greenhouse gas inventories (Agriculture, Forestry and Other Land Use, Vol. 4). Intergovernmental Panel on Climate Change. https://www.ipcc-nggip.iges.or.jp/public/2019rf/pdf/4_Volume4/19R_V4_Ch02_Generic%20Methods.pdf",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>2. Emission Factors</span>"
    ]
  },
  {
    "objectID": "03-activity-data/index.html",
    "href": "03-activity-data/index.html",
    "title": "3. Activity Data",
    "section": "",
    "text": "Overview\nActivity data (AD) represents the spatial extent and temporal dynamics of land-use change in REDD+ accounting. This chapter addresses uncertainty quantification in land cover classification, change detection, and spatial aggregation. These components typically constitute the greatest contribution to total REDD+ uncertainty (Ballantyne et al., 2015).",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>3. Activity Data</span>"
    ]
  },
  {
    "objectID": "03-activity-data/index.html#overview",
    "href": "03-activity-data/index.html#overview",
    "title": "3. Activity Data",
    "section": "",
    "text": "IPCC Approaches\nThe IPCC defines three hierarchical approaches for activity data collection that differ in spatial explicitness and uncertainty characteristics (IPCC, 2019):\n\n\n\n\n\n\n\n\nApproach\nData Type\nSpatial Resolution\nUncertainty\n\n\n\nApproach 1\nArea statistics\nAggregated totals\nHighest\n\n\nApproach 2\nSample-based matrices\nPoint/grid sampling\nModerate\n\n\nApproach 3\nWall-to-wall maps\nSpatially explicit\nLowest\n\n\n\nThis chapter implements Approach 3 methods using satellite time series classification, which ART-TREES programs predominantly adopt due to requirements for spatially explicit monitoring, pixel-level change detection, and integration with emission factor stratification. The data cube framework and machine learning workflows demonstrated in sections 3.2-3.9 operationalize Approach 3 while providing the uncertainty quantification infrastructure required under ART-TREES Section 8. The chapter is structured around a data cube framework for organizing and analyzing spatiotemporal land cover data, followed by uncertainty estimation techniques aligned with IPCC methodologies. We organize the technical content into the following components:\n\nData Cube Architecture: Spatiotemporal array structures for satellite time series\nIPCC Monitoring Approaches: Transition matrices and spatial explicitness (Approaches 1-3)\nPixel-Level Uncertainty Tracking: Model residuals for spatial error mapping\nRandom Forest Optimization: Monte Carlo calibration of classification algorithms\nAccuracy Assessment: Confusion matrices and validation metrics\nEnvironment Setup\n\neasypackages::packages(\n  \"bslib\", \"caret\", \"cols4all\", \"covr\", \"cowplot\", \"dendextend\", \"digest\",\"DiagrammeR\", \n  \"dtwclust\", \"downlit\", \"devtools\", \"e1071\", \"exactextractr\",\"elevatr\", \"FNN\", \n  \"future\", \"forestdata\",\"gdalcubes\", \"gdalUtilities\", \"geojsonsf\", \"geos\", \n  \"ggplot2\", \"ggstats\", \"ggspatial\", \"ggmap\", \"ggplotify\", \"ggpubr\", \"ggrepel\", \n  \"giscoR\", \"hdf5r\", \"httr\", \"httr2\", \"htmltools\", \"jsonlite\", \"kohonen\", \"leafem\", \n  \"leaflet.providers\", \"libgeos\",\"luz\",\"lwgeom\", \"leaflet\", \"leafgl\", \"MLmetrics\",\n  \"mapedit\", \"mapview\", \"maptiles\", \"methods\", \"mgcv\", \"ncdf4\", \"nnet\", \"openxlsx\", \n  \"parallel\", \"plotly\", \"randomForestExplainer\",\"randomForest\", \"rasterVis\", \"raster\", \n  \"Rcpp\", \"RcppArmadillo\", \"RcppCensSpatial\", \"rayshader\", \"RcppEigen\", \"RcppParallel\", \n  \"RColorBrewer\", \"reactable\", \"rgl\", \"rsconnect\",\"RStoolbox\", \"rts\", \"s2\", \"sf\", \n  \"scales\", \"sits\", \"sitsdata\", \"spdep\", \"stars\", \"stringr\",\"supercells\", \"smotefamily\", \n  \"terra\", \"testthat\", \"tidyverse\", \"tidyterra\", \"tools\", \"torch\", \"tmap\", \"tmaptools\", \n  \"terrainr\", \"xgboost\", \"webshot\", \"webshot2\",\n  prompt = F)\n\nsf::sf_use_s2(use_s2 = FALSE)",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>3. Activity Data</span>"
    ]
  },
  {
    "objectID": "03-activity-data/index.html#time-series-structure",
    "href": "03-activity-data/index.html#time-series-structure",
    "title": "3. Activity Data",
    "section": "3.1 Time Series Structure",
    "text": "3.1 Time Series Structure\nData cubes provide a structured framework for organizing and analyzing satellite imagery time series. We define data cubes as multidimensional arrays with dimensions associated with space and time, where land cover observations become “attributes” that have duration along the temporal dimension.\nFor purpose of REDD+ land monitoring, a data cube structure consists of:\n\nSpatial dimensions: Longitude (x) and latitude (y)\nTemporal dimension: Observation dates (t)\nSpectral dimension: Sensor bands (λ)\nAttributes: Land cover class, uncertainty metrics, model residuals\n\nIn the following sections (3.2-3.7), we demonstrate user-friendly operations from the sits and gdalcubes packages for time series workflows (Appel & Pebesma, 2019a; Simoes et al., 2021b). These tools integrate machine learning classification with data cube management and raster processing. This approach is particularly valuable for REDD+ workflows because it supports uncertainty-based optimization of both data cube architecture and classifier training (Appel & Pebesma, 2019b). Sections 3.8-3.9 then cover advanced procedures from the caret and terra packages, including cross-validation and Monte Carlo training simulations for accuracy assessment and model calibration.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>3. Activity Data</span>"
    ]
  },
  {
    "objectID": "03-activity-data/index.html#assemble-data-cube",
    "href": "03-activity-data/index.html#assemble-data-cube",
    "title": "3. Activity Data",
    "section": "3.2 Assemble Data Cube",
    "text": "3.2 Assemble Data Cube\nThe sits package installation comes pre-loaded with an API connections1 to ARD collections (Analysis-Ready-Data) via STAC protocols (SpatioTemporal Asset Catalogs). This built-in component allows programmatic access to cloud-hosted imagery from AWS, Microsoft Planetary Computer, EarthData, Copernicus many other leading warehouses. However, raw ARD collections present several challenges for classification workflows:\n\nSpatial harmonization: Band-specific resolutions require harmonization to common grid avoiding edge anomalies and gaps\nTemporal harmonization: Revisit cycles vary due to orbital geometry, platform scheduling, and atmospheric conditions\nCloud removal: Atmospheric interference introduces missing observations that corrupt spectral time series\n\nFor REDD+ monitoring, temporal gaps create systematic underestimation of forest loss when clearing events coincide with cloud-covered periods; a known source of activity data bias requiring explicit quantification in uncertainty budgets. The sits_regularize() function provides wrapper to gdalcubes operations that transforms heterogeneous imagery into regular or normalized data cubes through coupled spatial and temporal harmonizations.\n\nSpatial harmonization reprojects all inputs to a common coordinate reference system and resamples to uniform pixel spacing. For instance, fusing Sentinel-1 SAR with Sentinel-2 optical data requires reprojection to the MGRS grid at consistent resolution (typically 10m), ensuring geometric alignment and eliminating co-registration errors that propagate into classification uncertainty.\nTemporal harmonization establishes fixed observation intervals (16-day, monthly, seasonal) via cloud-optimized compositing. Within each interval, the algorithm ranks available scenes by cloud cover percentage, using the clearest image as reference and filling gaps from progressively cloudier acquisitions. Pixels with persistent cloud contamination are flagged as NA and gap-filled through temporal interpolation during feature extraction.\n\n\n\n\n\n\n\nARD Tile Grids\n\n\n\nSentinel-2 acquisitions are organized according to the Military Grid Reference System (MGRS), which partitions global coverage into 60 longitudinal zones spanning 8° each. Within zones, 6° latitudinal blocks are further subdivided into 110 km × 110 km tiles with 10 km overlap to ensure seamless mosaicking. This tiling structure is critical for REDD+ monitoring systems that track forest change across administrative boundaries, as tile edges can introduce geometric discontinuities if not properly managed during data cube construction.\nLandsat missions (4,5,7,8,9) employ the Worldwide Reference System-2 (WRS-2), which references scenes by path (descending orbital track) and row (latitudinal frame center). The WRS-2 grid comprises 233 paths globally, each containing 119 rows. All WRS-2 imagery is delivered with geometric correction to UTM projection, facilitating direct integration with ground reference data and cadastral boundaries commonly used in jurisdictional REDD+ accounting. For operational monitoring systems, understanding these tiling schemes is essential for:\n\nStratification: Validation samples must account for tile boundaries to avoid spatial clustering\nCo-registration: Cross-sensor fusion (Landsat-Sentinel) requires explicit handling of differing grid systems\nComputation: Processing workflows optimized for native tile extents reduce unnecessary resampling and associated geometric errors\n\n\n\nThis analysis replicates methods from Simoes et al. (2021a), which assembles a data cube from MPC’s collection of Sentinel-2 ARD-imagery comprising a single tiled area in the state of Rondonia for the full calendar year of 2022.2 Following assmbly, we normalize raw imagery into a bi-monthly regularized cube below.\nCaution: This code cell requires longer runtime (~12 mins).\n\n# Create data cube from Microsoft Planetary Computer ARD\ncube_s2_raw &lt;- sits::sits_cube(\n  source            = \"MPC\",\n  collection    = \"SENTINEL-2-L2A\",\n  tiles             = \"20LMR\",\n  bands             = c(\"B02\", \"B03\", \"B04\", \"B05\", \"B06\", \"B07\", \"B08\", \"B8A\", \"B11\", \"B12\", \"CLOUD\"),\n  start_date    = \"2022-01-01\",\n  end_date      = \"2022-12-31\"\n  )\n\n# Check timelines of assembled tiles\nsits::sits_timeline(cube_s2_raw)",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>3. Activity Data</span>"
    ]
  },
  {
    "objectID": "03-activity-data/index.html#normalize-data-cube",
    "href": "03-activity-data/index.html#normalize-data-cube",
    "title": "3. Activity Data",
    "section": "3.3 Normalize Data Cube",
    "text": "3.3 Normalize Data Cube\nAlthough default sits operations assemble cubes in the cloud, increased temporal and spatial extents and finer resolutions often require signficant processing times. Especially with larger data cube operations, we recommend assembling data cubes in the cloud and downloading copies of the cube imagery to your drive before normalizing imagery into a regular cube from the local directory of downloads. This speeds up operations and avoids network interruptions or queue lags.\n\n# Copy cube to local files\ncube_s2_local &lt;- sits::sits_cube_copy(\n  cube              = cube_s2_raw,\n  output_dir    = \"./assets/images/raw/\")\n\n# Normalize cube from local files\ncube_s2_reg &lt;- sits::sits_regularize(\n    cube                = cube_s2_local,\n    output_dir  = \"./assets/images/reg/\",\n    res                 = 40,\n    period      = \"P16D\",\n    multicores  = 6\n    )\n\n# Compute spectral index bands for cube\ncube_s2_reg &lt;- sits::sits_apply(\n    data                = cube_s2_reg,\n    NDVI                = (B08 - B04)/(B08 + B04),\n  output_dir    = \"./assets/images/reg/\")\n\ncube_s2_reg &lt;- sits::sits_apply(\n    data                = cube_s2_reg,\n    NBR                 = (B08 - B12) / (B08 + B12),\n  output_dir    = \"./assets/images/reg/\")\n\ncube_s2_reg &lt;- sits::sits_apply(\n    data                = cube_s2_reg,\n    EVI                 = 2.5 * (B08 - B04) / ((B08 + 6.0 * B04 - 7.5 * B02) + 1.0),\n  output_dir    = \"./assets/images/reg/\")\n\n# Check cube structure\ndplyr::glimpse(cube_s2_reg)\n\n# Plot single-date RGB image\nplot(cube_s2_reg, \n         red = \"B11\", \n         green = \"B8A\", \n         blue = \"B02\", \n         date = \"2022-07-16\"\n         )\n\n\nNA \n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |======================================================================| 100%\nNA Rows: 1\nNA Columns: 11\nNA $ source     &lt;chr&gt; \"MPC\"\nNA $ collection &lt;chr&gt; \"SENTINEL-2-L2A\"\nNA $ satellite  &lt;chr&gt; \"SENTINEL-2\"\nNA $ sensor     &lt;chr&gt; \"MSI\"\nNA $ tile       &lt;chr&gt; \"20LMR\"\nNA $ xmin       &lt;dbl&gt; 399960\nNA $ xmax       &lt;dbl&gt; 509760\nNA $ ymin       &lt;dbl&gt; 8990200\nNA $ ymax       &lt;dbl&gt; 9100000\nNA $ crs        &lt;chr&gt; \"PROJCRS[\\\"WGS 84 / UTM zone 20S\\\",\\n    BASEGEOGCRS[\\\"WGS …\nNA $ file_info  &lt;list&gt; [&lt;tbl_df[299 x 13]&gt;]",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>3. Activity Data</span>"
    ]
  },
  {
    "objectID": "03-activity-data/index.html#training-data-samples",
    "href": "03-activity-data/index.html#training-data-samples",
    "title": "3. Activity Data",
    "section": "3.4 Training Data Samples",
    "text": "3.4 Training Data Samples\nTraining data quality directly determines classification accuracy and, consequently, activity data uncertainty. This analysis uses the samples_deforestation_rondonia dataset (n=6,007 signatures) distributed with the sitsdata package, comprising nine forest disturbance classes collected through expert visual interpretation of Sentinel-2 imagery representing deforestation events across Rondônia state in the Brazilian Amazon:\n\n\nClear_Cut_Bare_Soil: Post-clearing exposed soil\n\nClear_Cut_Burned_Area: Burned clearing residues\n\nClear_Cut_Vegetation: Regrowth or residual vegetation post-harvest\n\nForest: Intact forest including Mountainside_Forest, Riparian_Forest\n\n\nWater, Wetland, Seasonally_Flooded: Hydrological features\n\nThe time series spans 2022-01-05 to 2022-12-23 at 16-day intervals, containing 10 Sentinel-2 bands (B02, B03, B04, B05, B06, B07, B8A, B08, B11 and B12). Temporal validity aligns with the agricultural calendar to capture seasonal dynamics of land conversion.\n\n# Import Demo Training Samples\ndata(\"samples_deforestation_rondonia\")\nbase::summary(samples_deforestation_rondonia)\nNA # A tibble: 9 × 3\nNA   label                 count   prop\nNA   &lt;chr&gt;                 &lt;int&gt;  &lt;dbl&gt;\nNA 1 Clear_Cut_Bare_Soil     944 0.157 \nNA 2 Clear_Cut_Burned_Area   983 0.164 \nNA 3 Clear_Cut_Vegetation    603 0.100 \nNA 4 Forest                  964 0.160 \nNA 5 Mountainside_Forest     211 0.0351\nNA 6 Riparian_Forest        1247 0.208 \nNA 7 Seasonally_Flooded      731 0.122 \nNA 8 Water                   109 0.0181\nNA 9 Wetland                 215 0.0358\nutils::head(samples_deforestation_rondonia)\nNA # A tibble: 6 × 7\nNA   longitude latitude start_date end_date   label               cube  time_series\nNA       &lt;dbl&gt;    &lt;dbl&gt; &lt;date&gt;     &lt;date&gt;     &lt;chr&gt;               &lt;chr&gt; &lt;list&gt;     \nNA 1     -66.5    -9.63 2022-01-05 2022-12-23 Clear_Cut_Bare_Soil SENT… &lt;tibble&gt;   \nNA 2     -66.4    -9.70 2022-01-05 2022-12-23 Clear_Cut_Bare_Soil SENT… &lt;tibble&gt;   \nNA 3     -66.4    -9.81 2022-01-05 2022-12-23 Forest              SENT… &lt;tibble&gt;   \nNA 4     -66.3    -9.64 2022-01-05 2022-12-23 Clear_Cut_Bare_Soil SENT… &lt;tibble&gt;   \nNA 5     -66.3    -9.73 2022-01-05 2022-12-23 Clear_Cut_Vegetati… SENT… &lt;tibble&gt;   \nNA 6     -66.3    -9.73 2022-01-05 2022-12-23 Clear_Cut_Burned_A… SENT… &lt;tibble&gt;\n\nVisualizing class-specific temporal trajectories aids in assessing spectral separability; a key determinant of classification uncertainty. The sits_patterns() function fits generalized additive models (GAM) to training data, producing smoothed temporal signatures that represent idealized class behavior. We derive vegetation indices (NDVI, EVI, NBR) to enhance interpretability.\n\n# Compute spectral indexes for training samples\ntraining_samples_with_indices &lt;- samples_deforestation_rondonia |&gt; \n    sits::sits_apply(NDVI = (B08 - B04)/(B08 + B04)) |&gt; \n  sits::sits_apply(NBR = (B08 - B12) / (B08 + B12)) |&gt; \n  sits::sits_apply(EVI = 2.5 * (B08 - B04) / ((B08 + 6.0 * B04 - 7.5 * B02) + 1.0)) \n\n# Generate and plot patterns\ntraining_samples_indices &lt;- training_samples_with_indices |&gt; \n    sits::sits_select(bands = c(\"NDVI\", \"EVI\", \"NBR\")) |&gt; \n  sits::sits_patterns() |&gt; plot()\n\n\n\n\n\n\n\nTemporal signatures conform to documented Amazonian deforestation phenology: forest clearing initiates during dry season onset (May-June), followed by burning in late dry season (August-September), evidenced by abrupt SWIR (B11) decline in Clear_Cut_Burned_Area signatures. Regrowth trajectories (Clear_Cut_Vegetation) exhibit NIR (B8A) recovery through the monitoring period. These temporal contrasts provide the spectral-temporal feature space for subsequent classification.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>3. Activity Data</span>"
    ]
  },
  {
    "objectID": "03-activity-data/index.html#classify-data-cube",
    "href": "03-activity-data/index.html#classify-data-cube",
    "title": "3. Activity Data",
    "section": "3.5 Classify Data Cube",
    "text": "3.5 Classify Data Cube\nRandom Forest models provide robust baseline classifiers for activity data, balancing computational efficiency with adequate performance for Tier 2-3 REDD+ requirements. The sits_train() function implements parallelized Random Forest training with default hyperparameters optimized for satellite time series.\n\n# Train model using Random Forest algorithm\nmodel_randomForest &lt;- sits::sits_train(\n  samples = samples_deforestation_rondonia,\n  ml_method     = sits::sits_rfor(\n    num_trees = 120,\n    mtry            = 10)\n  )\n\n# plot the model results\nplot(model_randomForest)\n\n\n\n\n\n\n\nVariable importance metrics identify which spatiotemporal features contribute most to class discrimination. For REDD+ operations, understanding feature importance supports:\n\nUncertainty attribution: High-importance features with measurement error propagate more uncertainty\nSensor planning: Identifies critical spectral bands for maintaining classification accuracy\nTransfer learning: Guides feature selection when adapting models to new regions\nValidation design: Informs stratification schemes for accuracy assessment",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>3. Activity Data</span>"
    ]
  },
  {
    "objectID": "03-activity-data/index.html#probability-data-cube",
    "href": "03-activity-data/index.html#probability-data-cube",
    "title": "3. Activity Data",
    "section": "3.6 Probability Data Cube",
    "text": "3.6 Probability Data Cube\nClassification outputs are generated as probability cubes rather than discrete label maps to preserve model uncertainty information. The sits_classify() function applies trained models to regularized data cubes using fault-tolerant parallel processing, producing per-class probability layers that quantify model confidence at the pixel level.\nThe sits package implements parallel computing to minimize communication overhead, which enables multi-core systems without configuration.\n\n# Classify data cube\ncube_s2_probs &lt;- sits::sits_classify(\n    data            = cube_s2_reg,\n    ml_model        = model_randomForest,\n    output_dir  = \"./assets/images/probs/\",\n    version         = \"rf-1228\", # adds suffix to output filename\n    multicores  = 4,\n    memsize         = 16\n    )\n\nplot(cube_s2_probs, \n         labels = \"Forest\", \n         palette = \"YlGn\"\n         )\n\n\n\n\n\nEach pixel in the probability cube contains n probability values (where n = number of classes), summing to 1.0. Low maximum probability values indicate pixels with high classification uncertainty, typically occurring at class boundaries, in mixed pixels, or where spectral-temporal signatures deviate from training data. These pixel-level uncertainty metrics support subsequent:\n\nAdaptive stratification: High-uncertainty pixels receive higher validation sampling density\nUncertainty propagation: Probability distributions feed Monte Carlo emission simulations\nQuality control: Spatial patterns of low confidence identify systematic classification errors\nTemporal tracking: Probability time series detect gradual transitions missed by discrete labeling\n\nProbability cubes thus serve as the foundation for rigorous uncertainty quantification in subsequent workflow stages.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>3. Activity Data</span>"
    ]
  },
  {
    "objectID": "03-activity-data/index.html#training-data-enhancements",
    "href": "03-activity-data/index.html#training-data-enhancements",
    "title": "3. Activity Data",
    "section": "3.7 Training Data Enhancements",
    "text": "3.7 Training Data Enhancements\nClassification accuracy in REDD+ monitoring depends critically on training sample quality. Large, well-labeled datasets improve model performance regardless of algorithm choice, while noisy or mislabeled samples degrade classification accuracy and inflate activity data uncertainty (Frénay & Verleysen, 2013; Maxwell et al., 2018). This section demonstrates processing methods to identify problematic samples, reduce class imbalance, and address geographic variance before re-training models.\nPixel Entropy Sampling\nActive learning uses pixel-level classification uncertainty to systematically improve classification accuracy through iterative model refinement (Cao et al., 2012; Crawford et al., 2013). When there is a finite set of alternative classes, the expected value of conflict is given by the Shannon entropy (Shannon, 1948). Entropy may be used to describe the variations in class membership probabilities associated with each pixel. The sits_uncertainty() function quantifies four types of uncertainty metrics:\n\\[\n\\text{H} = -\\sum_{i=1}^n Pr(i) \\times \\log(Pr(i))\n\\]\nwhere \\(Pr(i)\\) represents the highest membership probability for pixel \\(i\\) across \\(n\\) classes. For REDD+ applications, the margin of confidence typically provides the most actionable results, such as for highlighting transition zones where forest degradation or regeneration creates spectral ambiguity between classes.\n\n# Generate uncertainty cube and sample high-uncertainty pixels\ncube_s2_uncertainty &lt;- sits::sits_uncertainty(\n    cube = cube_s2_probs,\n    type = \"margin\", \n    output_dir = \"./assets/images/uncertainty/\",\n    multicores = 4,\n    memsize = 16)\n\n# Visualize high-uncertainty areas\nplot(cube_s2_uncertainty, palette = \"Oranges\")\n\n\n\n\n\n\n# Find samples with high uncertainty\nnew_samples_locations &lt;- sits::sits_uncertainty_sampling(\n    uncert_cube = cube_s2_uncertainty,\n    n = 300,\n    min_uncert = 0.4,\n    sampling_window = 10) \n\n# Visualize new training points\nsits::sits_view(new_samples_locations)\nsf::st_write(new_samples_locations, \n    \"./assets/samples/new_samples_location.gpkg\")\n\n\n\n\n\n\n\n\n# Extract new spectral signatures\nnew_samples &lt;- sits::sits_get_data(\n    cube = cube_s2_reg,\n    samples = new_samples_locations)\n\n#new_samples$label &lt;- \"Wetland\"\nnew_samples_aligned &lt;- sits_select(data = new_samples,\n  bands = c(\"B02\", \"B03\", \"B04\", \"B05\", \"B06\", \n                    \"B07\", \"B08\", \"B11\", \"B12\", \"B8A\"))\n\n# Merge with original samples\nnew_samples_merge &lt;- dplyr::bind_rows(\n    samples_deforestation_rondonia,\n  new_samples_aligned)\n\n# Train new model & evaluate\nmodel_randomForest_v2 &lt;- sits::sits_train(\n    samples = new_samples_merge, \n  ml_method = sits::sits_rfor(num_trees = 120,mtry = 10))\n\n# Classify new cube\n# Classify data cube\ncube_s2_probs_v2 &lt;- sits::sits_classify(\n    data            = cube_s2_reg,\n    ml_model        = model_randomForest_v2,\n    output_dir  = \"./assets/images/probs/\",\n    version         = \"rf-1228-v2\", # adds suffix to output filename\n    multicores  = 4,\n    memsize         = 16\n    )\n\n# Derive new uncertainty cube and compare\ncube_s2_uncertainty_v2 &lt;- sits::sits_uncertainty(\n    cube_s2_probs_v2, \n    type = \"margin\", \n  output_dir = \"./assets/images/uncertainty_v2/\",\n  multicores = 4,\n  memsize = 16)\n\n# Visualize side-by-side\nplot(cube_s2_uncertainty, palette = \"Reds\")\nplot(cube_s2_uncertainty_v2, palette = \"Oranges\")\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 3.1\n\n\n\n# Search for convergence (extract filepath first)\nget_uncert_values &lt;- function(uncert_cube) {\n  files &lt;- uncert_cube$file_info[[1]]$path\n  r &lt;- terra::rast(files)\n  terra::values(r)\n}\n\n# Calculate statistics\nuncert_v1_vals &lt;- get_uncert_values(cube_s2_uncertainty)\nuncert_v2_vals &lt;- get_uncert_values(cube_s2_uncertainty_v2)\n\nuncertainty_check = data.frame(\n  iteration = c(\"v1\", \"v2\"),\n  mean_uncert = c(\n    mean(uncert_v1_vals, na.rm = TRUE),\n    mean(uncert_v2_vals, na.rm = TRUE)\n  ),\n  sd_uncert = c(\n    sd(uncert_v1_vals, na.rm = TRUE),\n    sd(uncert_v2_vals, na.rm = TRUE)\n  ),\n  pct_high_uncert = c(\n    sum(uncert_v1_vals &gt; 0.4, na.rm = TRUE) / sum(!is.na(uncert_v1_vals)) * 100,\n    sum(uncert_v2_vals &gt; 0.4, na.rm = TRUE) / sum(!is.na(uncert_v2_vals)) * 100\n  )\n)\n\nwrite.csv(uncertainty_check, \"./assets/samples/uncertainty_check.csv\")\n\n\n\n\n\n\n\n...1\niteration\nmean_uncert\nsd_uncert\npct_high_uncert\n\n\n\n1\nv1\n4,508.770\n2,741.364\n99.66006\n\n\n2\nv2\n5,465.921\n2,729.796\n99.82174\n\n\n\n\n\n\nShort class relabelling, the above method showcases an iterative revision workflow typically used to integrate new samples and retrain models until uncertainty stabilizes. For ART-TREES compliance, uncertainty reduction directly decreases activity data deductions and simplifies third-party verification.\nHierarchical Clustering\nWe implement below two clustering approaches for evaluating training data quality: Agglomerative Hierarchical Clustering (Yao et al., 2016, AHC) for datasets under 10,000 samples, and Self-Organizing Maps (SOM) for larger collections (Gonçalves et al., 2008; Neagoe et al., 2014). AHC has computational complexity of \\(\\mathcal{O}(n^2)\\) requiring substantial memory, while SOM scales linearly, making it preferable for operational REDD+ monitoring systems.\nHierarchical Clustering computes dissimilarity between samples using dynamic time warping (DTW), which reliably measures differences in satellite time series (Maus et al., 2019; Petitjean et al., 2012). The sits_cluster_dendro() function generates dendrograms that reveal sample groupings and potential mislabeling:\n\n# Cluster samples using DTW distance and Ward linkage\nclusters &lt;- sits::sits_cluster_dendro(\n    samples = training_samples_with_indices, \n    bands = c(\"NDVI\", \"EVI\"),\n    dist_method = \"dtw_basic\",\n    linkage = \"ward.D2\")\n    \n# Examine cluster composition\nsits::sits_cluster_frequency(clusters)\n\n\n\n\n\n                           1    2    3    4    5    6    7 Total\n  Clear_Cut_Bare_Soil    121    9  104  705    5    0    0   944\n  Clear_Cut_Burned_Area   79    5   23  874    0    0    2   983\n  Clear_Cut_Vegetation   259  164   43  103    0    0   34   603\n  Forest                 174  732    5    6    0    0   47   964\n  Mountainside_Forest     12  145    2    0    0    0   52   211\n  Riparian_Forest         39  327   11    6    0    0  864  1247\n  Seasonally_Flooded     414   94  160   25   29    0    9   731\n  Water                    0    0    1    2    2  104    0   109\n  Wetland                 56    1   55   19   53   31    0   215\n  Total                 1154 1477  404 1740   89  135 1008  6007\nThe adjusted rand index (ARI) identifies optimal cluster count (Rand, 1971). Clusters with mixed labels indicate either:\n\nmislabeled samples requiring removal,\nspectral confusion between classes,\nnatural variability in land cover signatures. s\n\nThe sits_cluster_clean() function removes minority labels within clusters, retaining only dominant classes to reduce training noise.\nSelf-Organizing Maps provide efficient quality assessment for large datasets through unsupervised learning that projects high-dimensional time series onto 2D grids. The sits_som_map() function identifies outliers and evaluates class separability:\n\n# Remove cluster#5 from the samples\nclusters_new &lt;- dplyr::filter(clusters, cluster != 5)\nclusters_clean &lt;- sits::sits_cluster_clean(clusters_new)\n\n# Check clusters samples frequency\nsits::sits_cluster_frequency(clusters_clean)\n\n# Generate SOM with optimal grid dimensions\nsom_map &lt;- sits::sits_som_map(\n    training_samples_with_indices, \n  grid_xdim = 10, \n  grid_ydim = 10)\n\n# Clean samples by removing mixed neurons\nsamples_clean &lt;- sits::sits_som_clean_samples(som_map)\n\n# Visualize sample clustering & class confusions\nsom_eval &lt;- sits::sits_som_evaluate_cluster(som_map)\nplot(som_eval)\nplot(som_map)\n\n                         1  2  3  4 Total\n  Clear_Cut_Burned_Area  0  5  0  0     5\n  Forest                 0  0  0  6     6\n  Mountainside_Forest   12  0  2  0    14\n  Total                 12  5  2  6    25\n\n\n\n\n\n\n\n\nFigure 3.2\n\n\n\n\n\n\n\n\n\nFigure 3.3\n\n\n\n\n\nNeurons containing multiple classes reveal spectral overlap requiring investigation. The SOM-based cleaning removes samples from mixed neurons, improving class separability while preserving within-class variability essential for generalization.\nClass Imbalances\nImbalanced training sets—where some classes have many more samples than others—bias classifiers toward over-represented classes, inflating omission errors for rare forest types. The sits_reduce_imbalance() function implements under-sampling and over-sampling strategies:\n\n# Balance samples across classes\nsamples_balanced &lt;- sits::sits_reduce_imbalance(\n    samples = training_samples_with_indices,\n    n_samples_over = 200,   # Oversample rare classes\n    n_samples_under = 400,  # Undersample common classes\n    multicores = 4)\n\n# Re-evaluate using SOM clustering\nsom_map_balanced &lt;- sits::sits_som_map(\n    data = samples_balanced,\n    grid_xdim = 10,\n    grid_ydim = 10,\n    alpha = 1.0,\n    distance = \"dtw\",\n    rlen = 20)\n\n# Store estimates in tibble\nsom_eval_balanced &lt;- sits::sits_som_evaluate_cluster(\n    som_map_balanced)\n\n# Visualize results\nplot(som_eval) \nplot(som_eval_balanced) \nsummary(samples_balanced)\n\n\n\n\n\n\n\n\n\nFigure 3.4\n\n\n\n\n\n\n\n\n\nFigure 3.5\n\n\n\n\n\n# A tibble: 9 × 3\n  label                 count   prop\n  &lt;chr&gt;                 &lt;int&gt;  &lt;dbl&gt;\n1 Clear_Cut_Bare_Soil     400 0.134 \n2 Clear_Cut_Burned_Area   388 0.130 \n3 Clear_Cut_Vegetation    392 0.131 \n4 Forest                  400 0.134 \n5 Mountainside_Forest     211 0.0707\n6 Riparian_Forest         396 0.133 \n7 Seasonally_Flooded      384 0.129 \n8 Water                   200 0.0670\n9 Wetland                 215 0.0720\nUnder-sampling randomly removes samples from majority classes to match minority class frequencies, reducing computational load but discarding potentially informative data. Over-sampling uses SMOTE [Synthetic Minority Over-sampling Technique; Siriseriwan (2024); Torgo (2010)] to generate synthetic samples for rare classes, improving classifier sensitivity without losing real observations. For REDD+ applications, maintaining adequate representation of degraded forest classes often requires combined strategies.\nGeographic Variance\nTraining samples must capture spatial variability across jurisdictions. Clustered sampling creates geographic gaps where model predictions have higher uncertainty (Meyer & Pebesma, 2022). The sits_geo_dist() function compares sample-to-sample distances against prediction-location-to-sample distances:\n\n# Derive jurisdiction boundary\nbbox_cube &lt;- sits::sits_bbox(cube_s2_reg) \nbbox_sf &lt;- sf::st_bbox(\n  c(xmin = aoi$xmin, \n    ymin = aoi$ymin, \n    xmax = aoi$xmax, \n    ymax = aoi$ymax),\n  crs = sf::st_crs(aoi$crs))\n\n# Convert to sf \naoi &lt;- sf::st_as_sf(sf::st_as_sfc(bbox_sf))\n\n# Assess geographic coverage\ndistances &lt;- sits::sits_geo_dist(\n    training_samples_with_indices, roi = aoi)\nplot(distances)\n\n\n\n\n\nMismatched distributions indicate insufficient spatial coverage. Areas with few nearby training samples will exhibit higher classification uncertainty, requiring either additional field sampling or explicit uncertainty quantification in those regions during accuracy assessment.\nNoise Filtering\nAtmospheric contamination and sensor artifacts introduce noise requiring smoothing before feature extraction. The package supports Savitzky-Golay (sits_sgolay()) and Whittaker (sits_whittaker()) filters. Both methods reduce noise while preserving phenological patterns:\n\n# Apply Whittaker filter with conservative smoothing\nsamples_balanced_ndvi &lt;- sits::sits_select(\n    samples_balanced, bands = \"NDVI\")\n\n# Apply Whitakker filter\nsamples_balanced_whit &lt;- sits::sits_whittaker(\n    samples_balanced_ndvi, lambda = 0.5)\n\n# Merge to visualize\nsits::sits_merge(\n    samples_balanced_ndvi, \n    samples_balanced_whit,\n    suffix = c(\"\", \".WHIT\")) |&gt; plot()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nOver-smoothing (high lambda values) eliminates legitimate phenological variation, reducing model discriminatory power. Conservative filtering (lambda ≤ 1.0) balances noise reduction with pattern preservation (Atkinson2012?; Zhou2016?).\nIntegration with Uncertainty Workflows: Quality-controlled training data directly reduces classification uncertainty by minimizing systematic errors from mislabeling and improving model generalization. Combined with the cross-validation procedures in Section 3.8 and accuracy assessment in Section 3.9, these enhancement methods establish a rigorous foundation for defensible activity data uncertainty quantification under ART-TREES requirements.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>3. Activity Data</span>"
    ]
  },
  {
    "objectID": "03-activity-data/index.html#smooth-data-cube",
    "href": "03-activity-data/index.html#smooth-data-cube",
    "title": "3. Activity Data",
    "section": "3.8 Smooth Data Cube",
    "text": "3.8 Smooth Data Cube\nPixel-based classification inherently produces salt-and-pepper noise due to within-class spectral variability and mixed pixels. Isolated misclassified pixels, such as outliers surrounded by different classes, represent systematic over-fitting to training data rather than true landscape heterogeneity. For REDD+ applications, these artifacts inflate area uncertainty and complicate change detection. To address this, the sits_smooth() function implements Bayesian post-processing that incorporates spatial context from neighboring pixels to refine probability estimates. The smoothing process:\n\nComputes spatially-weighted probability adjustments based on neighborhood composition\nUpdates pixel probabilities using Bayesian inference combining original estimates with spatial priors\nProduces refined probability cube with reduced outlier effect while preserving legitimate small patches\n\n\n\nSmoothed probability map for class Forest.\n\n\n\n\n\n\n\nSmoothing Risks\n\n\n\nSpatial smoothing affects activity data uncertainty in competing directions:\n\nReduces random error: Eliminates isolated misclassifications that inflate variance\nIntroduces spatial bias: May smooth over legitimate small-scale heterogeneity\nImproves validation agreement: Better alignment with typical human interpretation scales\nModifies probability distributions: Changes the shape of pixel-level uncertainty estimates\n\nFor REDD+ reporting, smoothed probability cubes typically yield lower reported uncertainties due to reduced classification noise, but verification bodies may require documentation of smoothing parameters demonstrating methodological choices.\n\n\n\nFinal classified maps are derived from smoothed probability cubes through maximum likelihood labeling: each pixel is assigned the class with highest posterior probability. The sits_label_classification() function performs this deterministic assignment while maintaining provenance links to underlying probability distributions.\n\n\nClassified cube obtained by Random Forest model.\n\nThe classified cube produced by sits workflows provides the activity data foundation for REDD+ accounting, but uncertainty quantification requires additional analysis beyond the discrete classification procedures. Sections 3.2-3.5 demonstrate more more advanced operations using caret (Kuhn, 2011), ForestToolbox (Tarazona Coronel et al., 2021), and terra packages (Hijmans, 2025) required to:\n\nExtract pixel-level probability distributions for Monte Carlo sampling (Section 3.3)\nImplement stratified validation with area-adjusted accuracy assessment (Section 3.4)\nCalibrate Random Forest hyperparameters through iterative uncertainty minimization (Section 3.5)",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>3. Activity Data</span>"
    ]
  },
  {
    "objectID": "03-activity-data/index.html#cross-validation",
    "href": "03-activity-data/index.html#cross-validation",
    "title": "3. Activity Data",
    "section": "3.8 Cross-Validation",
    "text": "3.8 Cross-Validation\nCross-validation quantifies model generalization capacity by partitioning training data into independent subsets for iterative testing. This section demonstrates caret-based validation approaches for uncertainty assessment aligned with ART-TREES requirements.\nExtract statistical summaries from sits time series for caret compatibility:\n\n# Extract features from cube samples\nextract_features &lt;- function(sits_samples) {\n  features_list &lt;- lapply(1:nrow(sits_samples), function(i) {\n    ts &lt;- sits_samples$time_series[[i]]\n    data.frame(\n      label = sits_samples$label[i],\n      mean_B8A = mean(ts$B8A, na.rm = TRUE),\n      sd_B8A = sd(ts$B8A, na.rm = TRUE),\n      mean_B11 = mean(ts$B11, na.rm = TRUE),\n      sd_B11 = sd(ts$B11, na.rm = TRUE),\n      mean_NDVI = mean((ts$B8A - ts$B04) / (ts$B8A + ts$B04), na.rm = TRUE),\n      sd_NDVI = sd((ts$B8A - ts$B04) / (ts$B8A + ts$B04), na.rm = TRUE)\n    )\n  })\n  do.call(rbind, features_list)\n}\n\ntrain_features &lt;- extract_features(samples_deforestation_rondonia)\n\nMonte Carlo Cross-Validation\nIn the following, we implement a Monte Carlo training simulation for robust uncertainty and stability metrics across repeated random partitions. For demonstration purposes, this simulation is fitted with only 10 iterations. We recommend increasing this to 10,000 iterations to meet ART-TREES requirements :\n\n# Configure Monte Carlo simulation\nmc_simulation &lt;- caret::trainControl(\n  method = \"LGOCV\",\n  number = 10, # Increase to 10,000 iterations for ART-TREES submissions\n  p = 0.75, # 75:25% split\n  savePredictions = \"final\",\n  classProbs = TRUE,\n  summaryFunction = caret::multiClassSummary\n)\n\n# Train over monte carlo simulation\nset.seed(456)\nmodel_randomRandom_mc &lt;- caret::train(\n  label ~ .,\n  data = train_features,\n  method = \"rf\",\n  trControl = mc_simulation,\n  metric = \"Kappa\",\n  ntree = 120\n)\n\n# Summarize stability\nmodel_randomRandom_mc_summary &lt;- data.frame(\n  metric = c(\"Accuracy\", \"Kappa\"),\n  mean = c(mean(model_randomRandom_mc$resample$Accuracy), mean(model_randomRandom_mc$resample$Kappa)),\n  sd = c(sd(model_randomRandom_mc$resample$Accuracy), sd(model_randomRandom_mc$resample$Kappa))\n)\n\nflextable::flextable(model_randomRandom_mc_summary)\n\n\n\n\n\nmetric\nmean\nsd\n\n\n\nAccuracy\n0.7091516\n0.01467986\n\n\nKappa\n0.6560266\n0.01749026",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>3. Activity Data</span>"
    ]
  },
  {
    "objectID": "03-activity-data/index.html#accuracy-assessment",
    "href": "03-activity-data/index.html#accuracy-assessment",
    "title": "3. Activity Data",
    "section": "3.9 Accuracy Assessment",
    "text": "3.9 Accuracy Assessment\nAccuracy assessment quantifies classification performance against independent reference data. Stratified train-test partitioning ensures adequate representation across forest disturbance classes.\n\n# Ensure consistent factor levels\nall_classes &lt;- unique(train_features$label)\n\n# Stratified partition\nset.seed(789)\ntrain_idx &lt;- caret::createDataPartition(\n  train_features$label,\n  p = 0.8,\n  list = FALSE\n)\n\ntrain_data &lt;- train_features[train_idx, ]\ntest_data &lt;- train_features[-train_idx, ]\n\n# Ensure labels are factors with same levels\ntrain_data$label &lt;- factor(train_data$label, levels = all_classes)\ntest_data$label &lt;- factor(test_data$label, levels = all_classes)\n\n# Train model\naccuracy_model &lt;- caret::train(\n  label ~ .,\n  data = train_data,\n  method = \"rf\",\n  ntree = 120,\n  importance = TRUE,\n  trControl = caret::trainControl(method = \"none\")\n)\n\n# Predict\npredictions &lt;- predict(accuracy_model, test_data)\n\n# Ensure predictions have same levels\npredictions &lt;- factor(predictions, levels = all_classes)\n\nConfusion Matrix\n\n# Generate confusion matrix\nconfMatrix &lt;- caret::confusionMatrix(\n  data = predictions,\n  reference = test_data$label\n)\n\nprint(confMatrix)\n## Confusion Matrix and Statistics\n## \n##                        Reference\n## Prediction              Clear_Cut_Bare_Soil Forest Clear_Cut_Vegetation\n##   Clear_Cut_Bare_Soil                   130      2                    8\n##   Forest                                  0    166                   11\n##   Clear_Cut_Vegetation                   16      1                   74\n##   Clear_Cut_Burned_Area                  41      0                    4\n##   Wetland                                 1      0                    0\n##   Water                                   0      0                    0\n##   Mountainside_Forest                     0      0                    1\n##   Seasonally_Flooded                      0      7                    8\n##   Riparian_Forest                         0     16                   14\n##                        Reference\n## Prediction              Clear_Cut_Burned_Area Wetland Water Mountainside_Forest\n##   Clear_Cut_Bare_Soil                      31       2     0                   0\n##   Forest                                    0       1     0                  15\n##   Clear_Cut_Vegetation                     10       1     0                   3\n##   Clear_Cut_Burned_Area                   144       0     0                   0\n##   Wetland                                   3      27     0                   0\n##   Water                                     0       1    21                   0\n##   Mountainside_Forest                       0       0     0                   3\n##   Seasonally_Flooded                        6      11     0                   1\n##   Riparian_Forest                           2       0     0                  20\n##                        Reference\n## Prediction              Seasonally_Flooded Riparian_Forest\n##   Clear_Cut_Bare_Soil                    6               3\n##   Forest                                19              20\n##   Clear_Cut_Vegetation                   7               5\n##   Clear_Cut_Burned_Area                  2               0\n##   Wetland                                1               0\n##   Water                                  0               0\n##   Mountainside_Forest                    2               0\n##   Seasonally_Flooded                   101               2\n##   Riparian_Forest                        8             219\n## \n## Overall Statistics\n##                                          \n##                Accuracy : 0.7393         \n##                  95% CI : (0.7135, 0.764)\n##     No Information Rate : 0.208          \n##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16      \n##                                          \n##                   Kappa : 0.6916         \n##                                          \n##  Mcnemar's Test P-Value : NA             \n## \n## Statistics by Class:\n## \n##                      Class: Clear_Cut_Bare_Soil Class: Forest\n## Sensitivity                              0.6915        0.8646\n## Specificity                              0.9485        0.9343\n## Pos Pred Value                           0.7143        0.7155\n## Neg Pred Value                           0.9429        0.9731\n## Prevalence                               0.1571        0.1604\n## Detection Rate                           0.1086        0.1387\n## Detection Prevalence                     0.1520        0.1938\n## Balanced Accuracy                        0.8200        0.8995\n##                      Class: Clear_Cut_Vegetation Class: Clear_Cut_Burned_Area\n## Sensitivity                              0.61667                       0.7347\n## Specificity                              0.96007                       0.9530\n## Pos Pred Value                           0.63248                       0.7539\n## Neg Pred Value                           0.95741                       0.9483\n## Prevalence                               0.10025                       0.1637\n## Detection Rate                           0.06182                       0.1203\n## Detection Prevalence                     0.09774                       0.1596\n## Balanced Accuracy                        0.78837                       0.8439\n##                      Class: Wetland Class: Water Class: Mountainside_Forest\n## Sensitivity                 0.62791      1.00000                   0.071429\n## Specificity                 0.99567      0.99915                   0.997403\n## Pos Pred Value              0.84375      0.95455                   0.500000\n## Neg Pred Value              0.98627      1.00000                   0.967254\n## Prevalence                  0.03592      0.01754                   0.035088\n## Detection Rate              0.02256      0.01754                   0.002506\n## Detection Prevalence        0.02673      0.01838                   0.005013\n## Balanced Accuracy           0.81179      0.99957                   0.534416\n##                      Class: Seasonally_Flooded Class: Riparian_Forest\n## Sensitivity                            0.69178                 0.8795\n## Specificity                            0.96670                 0.9367\n## Pos Pred Value                         0.74265                 0.7849\n## Neg Pred Value                         0.95759                 0.9673\n## Prevalence                             0.12197                 0.2080\n## Detection Rate                         0.08438                 0.1830\n## Detection Prevalence                   0.11362                 0.2331\n## Balanced Accuracy                      0.82924                 0.9081\n\n# Extract metrics\naccuracy_metrics &lt;- data.frame(\n  metric = c(\"Overall Accuracy\", \"Kappa\", \"95% CI Lower\", \"95% CI Upper\"),\n  value = round(c(\n    confMatrix$overall[\"Accuracy\"],\n    confMatrix$overall[\"Kappa\"],\n    confMatrix$overall[\"AccuracyLower\"],\n    confMatrix$overall[\"AccuracyUpper\"]\n  ), 4)\n)\n\naccuracy_metrics |&gt;\n    flextable::flextable() |&gt;\n    flextable::autofit()\n\n\n\n\n\nmetric\nvalue\n\n\n\nOverall Accuracy\n0.7393\n\n\nKappa\n0.6916\n\n\n95% CI Lower\n0.7135\n\n\n95% CI Upper\n0.7640\n\n\n\n\n\n\nconfMatrix\n## Confusion Matrix and Statistics\n## \n##                        Reference\n## Prediction              Clear_Cut_Bare_Soil Forest Clear_Cut_Vegetation\n##   Clear_Cut_Bare_Soil                   130      2                    8\n##   Forest                                  0    166                   11\n##   Clear_Cut_Vegetation                   16      1                   74\n##   Clear_Cut_Burned_Area                  41      0                    4\n##   Wetland                                 1      0                    0\n##   Water                                   0      0                    0\n##   Mountainside_Forest                     0      0                    1\n##   Seasonally_Flooded                      0      7                    8\n##   Riparian_Forest                         0     16                   14\n##                        Reference\n## Prediction              Clear_Cut_Burned_Area Wetland Water Mountainside_Forest\n##   Clear_Cut_Bare_Soil                      31       2     0                   0\n##   Forest                                    0       1     0                  15\n##   Clear_Cut_Vegetation                     10       1     0                   3\n##   Clear_Cut_Burned_Area                   144       0     0                   0\n##   Wetland                                   3      27     0                   0\n##   Water                                     0       1    21                   0\n##   Mountainside_Forest                       0       0     0                   3\n##   Seasonally_Flooded                        6      11     0                   1\n##   Riparian_Forest                           2       0     0                  20\n##                        Reference\n## Prediction              Seasonally_Flooded Riparian_Forest\n##   Clear_Cut_Bare_Soil                    6               3\n##   Forest                                19              20\n##   Clear_Cut_Vegetation                   7               5\n##   Clear_Cut_Burned_Area                  2               0\n##   Wetland                                1               0\n##   Water                                  0               0\n##   Mountainside_Forest                    2               0\n##   Seasonally_Flooded                   101               2\n##   Riparian_Forest                        8             219\n## \n## Overall Statistics\n##                                          \n##                Accuracy : 0.7393         \n##                  95% CI : (0.7135, 0.764)\n##     No Information Rate : 0.208          \n##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16      \n##                                          \n##                   Kappa : 0.6916         \n##                                          \n##  Mcnemar's Test P-Value : NA             \n## \n## Statistics by Class:\n## \n##                      Class: Clear_Cut_Bare_Soil Class: Forest\n## Sensitivity                              0.6915        0.8646\n## Specificity                              0.9485        0.9343\n## Pos Pred Value                           0.7143        0.7155\n## Neg Pred Value                           0.9429        0.9731\n## Prevalence                               0.1571        0.1604\n## Detection Rate                           0.1086        0.1387\n## Detection Prevalence                     0.1520        0.1938\n## Balanced Accuracy                        0.8200        0.8995\n##                      Class: Clear_Cut_Vegetation Class: Clear_Cut_Burned_Area\n## Sensitivity                              0.61667                       0.7347\n## Specificity                              0.96007                       0.9530\n## Pos Pred Value                           0.63248                       0.7539\n## Neg Pred Value                           0.95741                       0.9483\n## Prevalence                               0.10025                       0.1637\n## Detection Rate                           0.06182                       0.1203\n## Detection Prevalence                     0.09774                       0.1596\n## Balanced Accuracy                        0.78837                       0.8439\n##                      Class: Wetland Class: Water Class: Mountainside_Forest\n## Sensitivity                 0.62791      1.00000                   0.071429\n## Specificity                 0.99567      0.99915                   0.997403\n## Pos Pred Value              0.84375      0.95455                   0.500000\n## Neg Pred Value              0.98627      1.00000                   0.967254\n## Prevalence                  0.03592      0.01754                   0.035088\n## Detection Rate              0.02256      0.01754                   0.002506\n## Detection Prevalence        0.02673      0.01838                   0.005013\n## Balanced Accuracy           0.81179      0.99957                   0.534416\n##                      Class: Seasonally_Flooded Class: Riparian_Forest\n## Sensitivity                            0.69178                 0.8795\n## Specificity                            0.96670                 0.9367\n## Pos Pred Value                         0.74265                 0.7849\n## Neg Pred Value                         0.95759                 0.9673\n## Prevalence                             0.12197                 0.2080\n## Detection Rate                         0.08438                 0.1830\n## Detection Prevalence                   0.11362                 0.2331\n## Balanced Accuracy                      0.82924                 0.9081",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>3. Activity Data</span>"
    ]
  },
  {
    "objectID": "03-activity-data/index.html#sec-summary",
    "href": "03-activity-data/index.html#sec-summary",
    "title": "3. Activity Data",
    "section": "3.10 Chapter Summary",
    "text": "3.10 Chapter Summary\nThis chapter established a comprehensive framework for activity data uncertainty quantification in REDD+ monitoring systems. Key contributions include:\n\nData cube architecture: Structured approach to spatiotemporal land cover analysis\nIPCC methodology alignment: Clear guidance on Approach 3 requirements\nPixel-level uncertainty tracking: Model residuals for adaptive sampling\nRandom Forest optimization: Monte Carlo calibration workflows\nRigorous accuracy assessment: Confusion matrices with area adjustment\n\nActivity data provides spatial extent; allometry converts extent to biomass. Combined uncertainty requires:\n\\[\nU_{total}^2 = U_{activity}^2 + U_{allometry}^2 + 2 \\times \\text{Cov}(A, B)\n\\]\nWhere covariance term captures spatial correlation between classification errors and biomass estimation errors.\n\n\n\n\n\n\nAppel, M., & Pebesma, E. (2019a). On-demand processing of data cubes from satellite image collections with the gdalcubes library. 4. https://doi.org/10.3390/data4030092\n\n\nAppel, M., & Pebesma, E. (2019b). On-demand processing of data cubes from satellite image collections with the gdalcubes library. Data, 4(3), 92.\n\n\nBallantyne, A., Andres, R., Houghton, R., Stocker, B., Wanninkhof, R., Anderegg, W., Cooper, L., DeGrandpre, M., Tans, P., Miller, J., & al., et. (2015). Audit of the global carbon budget: Estimate errors and their impact on uptake uncertainty. Biogeosciences (Online), 12(8), 2565–2584.\n\n\nCao, S., Yu, Q., & Zhang, J. (2012). Automatic division for pure/mixed pixels based on probabilities entropy and spatial heterogeneity. 2012 First International Conference on Agro-Geoinformatics (Agro-Geoinformatics), 1–4.\n\n\nCrawford, M. M., Tuia, D., & Yang, H. L. (2013). Active learning: Any value for classification of remotely sensed data? Proceedings of the IEEE, 101(3), 593–608.\n\n\nFrénay, B., & Verleysen, M. (2013). Classification in the presence of label noise: A survey. IEEE Transactions on Neural Networks and Learning Systems, 25(5), 845–869.\n\n\nGonçalves, M., Netto, M., Costa, J., & Zullo Junior, J. (2008). An unsupervised method of classifying remotely sensed images using kohonen self-organizing maps and agglomerative hierarchical clustering methods. International Journal of Remote Sensing, 29(11), 3171–3207.\n\n\nHijmans, R. J. (2025). Terra: Spatial data analysis. https://CRAN.R-project.org/package=terra\n\n\nIPCC. (n.d.). 2013 revised supplementary methods and good practice guidance arising from the kyoto protocol.\n\n\nIPCC. (2012). Report of the conference of the parties serving as the meeting of the parties to the kyoto protocol on its seventh session,. FCCC/KP/CMP/2011/10(Durban Meeting November 28th to December 11th, 2011), 824.\n\n\nIPCC. (2019). Chapter 2: Generic methodologies applicable to multiple land-use categories. In 2019 refinement to the 2006 IPCC guidelines for national greenhouse gas inventories (Agriculture, Forestry and Other Land Use, Vol. 4). Intergovernmental Panel on Climate Change. https://www.ipcc-nggip.iges.or.jp/public/2019rf/pdf/4_Volume4/19R_V4_Ch02_Generic%20Methods.pdf\n\n\nKuhn, M. (2011). The caret package.\n\n\nMaus, V., Câmara, G., Appel, M., & Pebesma, E. (2019). Dtwsat: Time-weighted dynamic time warping for satellite image time series analysis in r. Journal of Statistical Software, 88, 1–31.\n\n\nMaxwell, A. E., Warner, T. A., & Fang, F. (2018). Implementation of machine-learning classification in remote sensing: An applied review. International Journal of Remote Sensing, 39(9), 2784–2817.\n\n\nMeyer, H., & Pebesma, E. (2022). Machine learning-based global maps of ecological variables and the challenge of assessing them. Nature Communications, 13(1), 2208.\n\n\nNeagoe, V.-E., Stoica, R.-M., Ciurea, A.-I., Bruzzone, L., & Bovolo, F. (2014). Concurrent self-organizing maps for supervised/unsupervised change detection in remote sensing images. IEEE Journal of Selected Topics in Applied Earth Observations and Remote Sensing, 7(8), 3525–3533.\n\n\nPetitjean, F., Inglada, J., & Gançarski, P. (2012). Satellite image time series analysis under time warping. IEEE Transactions on Geoscience and Remote Sensing, 50(8), 3081–3095.\n\n\nRand, W. M. (1971). Objective criteria for the evaluation of clustering methods. Journal of the American Statistical Association, 66(336), 846–850.\n\n\nShannon, C. E. (1948). A mathematical theory of communication. Bell System Technical Journal, 27(3), 379–423. https://doi.org/10.1002/j.1538-7305.1948.tb01338.x\n\n\nSimoes, R., Camara, G., Queiroz, G., Souza, F., Andrade, P. R., Santos, L., Carvalho, A., & Ferreira, K. (2021a). Satellite image time series analysis for big earth observation data. Remote Sensing, 13(13), 2428.\n\n\nSimoes, R., Camara, G., Queiroz, G., Souza, F., Andrade, P., Santos, L., Carvalho, A., & Ferreira, K. (2021b). Satellite image time series analysis for big earth observation data. 13, 2428. https://doi.org/10.3390/rs13132428\n\n\nSiriseriwan, W. (2024). Smotefamily: A collection of oversampling techniques for class imbalance problem based on SMOTE. https://CRAN.R-project.org/package=smotefamily\n\n\nTarazona Coronel, Y., Zabala, A., Pons, X., Broquetas, A., Nowosad, J., & A. Zurqani, H. (2021). Fusing landsat and SAR data for mapping tropical deforestation through machine learning classification and the PVts-β non-seasonal detection approach. https://doi.org/10.1080/07038992.2021.1941823\n\n\nTorgo, L. (2010). Data mining with r, learning with case studies. http://www.dcc.fc.up.pt/~ltorgo/DataMiningWithR\n\n\nUNFCCC, C. (2010). Report of the conference of the parties on its fifteenth session, held in copenhagen from 7 to 19 december 2009. FCCC/CP/2009/11/Add. 1.\n\n\nYao, W., Loffeld, O., & Datcu, M. (2016). Application and evaluation of a hierarchical patch clustering method for remote sensing images. IEEE Journal of Selected Topics in Applied Earth Observations and Remote Sensing, 9(6), 2279–2289.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>3. Activity Data</span>"
    ]
  },
  {
    "objectID": "03-activity-data/index.html#footnotes",
    "href": "03-activity-data/index.html#footnotes",
    "title": "3. Activity Data",
    "section": "",
    "text": "In version 1.5.3,sits supports access to the following ARD image cloud providers:\n\nAmazon Web Services (AWS): Open data Sentinel-2/2A Level-2A collections for the Earth’s land surface.\nBrazil Data Cube (BDC): Open data collections of Sentinel-2/2A, Landsat-8, CBERS-4/4A, and MOD13Q1 products for Brazil. These collections are organized as regular data cubes.\nCopernicus Data Space Ecosystem (CDSE): Open data collections of Sentinel-1 RTC and Sentinel-2/2A images.\nDigital Earth Africa (DEAFRICA): Open data collections of Sentinel-1 RTC, Sentinel-2/2A, Landsat-5/7/8/9 for Africa. Additional products include ALOS_PALSAR mosaics, DEM_COP_30, NDVI_ANOMALY based on Landsat data, and monthly and daily rainfall data from CHIRPS.\nDigital Earth Australia (DEAUSTRALIA): Open data ARD collections of Sentinel-2A/2B and Landsat-5/7/8/9 images, yearly geomedians of Landsat 5/7/8 images; yearly fractional land cover from 1986 to 2024.\nHarmonized Landsat-Sentinel (HLS): HLS, provided by NASA, is an open data collection that processes Landsat 8 and Sentinel-2 imagery to a common standard.\nMicrosoft Planetary Computer (MPC): Open data collections of Sentinel-1 GRD, Sentinel-1 RTC, Sentinel-2/2A, Landsat-4/5/7/8/9 images for the Earth’s land areas. Also supported are the Copernicus DEM-30 and MOD13Q1, MOD10A1, MOD09A1 products, and the Harmonized Landsat-Sentinel collections (HLSL30 and HLSS30).\nSwiss Data Cube (SDC): Collection of Sentinel-2/2A and Landsat-8 images for Switzerland.\nTerrascope: Cloud service with EO products, which includes the ESA World Cover map.\nUSGS: Landsat-4/5/7/8/9 collections available in AWS, which require access payment.\n\nIn addition, sits supports the use of Planet monthly mosaics stored as local files. For a detailed description of the providers and collections supported by sits, please run sits_list_collections().↩︎\n\nFor addressing the most problematic uncertainty tasks needing longitudinal analyses of extended timelines (1984-2024), such as disaggregation of wildfire uncertainty and the inter-annual variability of natural disturbances, we recommend practicing data cube operations with Landsat imagery (IPCC, n.d., p. O.9; 2012, p. 847; 2019, p. 2.67; UNFCCC, 2010, pp. 17–18).↩︎",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>3. Activity Data</span>"
    ]
  },
  {
    "objectID": "04-monte-carlo/index.html",
    "href": "04-monte-carlo/index.html",
    "title": "4. Monte Carlo",
    "section": "",
    "text": "Overview\nMonte Carlo simulation aggregates uncertainties from activity data (Chapter 3), emission factors (Chapter 2), and allometric equations (Chapter 1) into a single conservativeness deduction for ART-TREES credit issuance. This chapter demonstrates compliant simulation design, presents worked examples achieving 20-50% uncertainty reductions through strategic optimization, and provides decision frameworks for maximizing credit revenue under Section 8 requirements.\nART-TREES Section 8 mandates Monte Carlo Approach 2 with minimum 10,000 iterations, 90% confidence intervals, and bootstrap sampling for unknown probability distributions (ART, 2021). The simulation calculates the Uncertainty Adjustment Factor (UAF) from the half-width of emission distribution confidence intervals:\n\\[\nUA_t = 0.524417 \\times \\frac{HW_{90\\%}}{1.645006}\n\\]\nWhere \\(HW_{90\\%}\\) represents the half-width of the 90% confidence interval around mean emissions. This UAF then determines the conservativeness deduction applied to creditable emissions.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>4. Monte Carlo</span>"
    ]
  },
  {
    "objectID": "04-monte-carlo/index.html#overview",
    "href": "04-monte-carlo/index.html#overview",
    "title": "4. Monte Carlo",
    "section": "",
    "text": "Environment Setup\n\neasypackages::packages(\n  \"ropensci/allodb\", \"animation\", \"BIOMASS\", \"cols4all\", \"covr\", \"cowplot\", \"caret\",\n  \"DescTools\", \"dataMaid\", \"dplyr\", \"FawR\", \"ForestToolsRS\", \"forestdata\", \n  \"flextable\", \"ggplot2\", \"giscoR\", \"ggfortify\", \"htmltools\", \"janitor\", \"jsonlite\", \n  \"lattice\", \"leaflet.providers\", \"leaflet\", \"lmtest\", \"lwgeom\", \n  \"kableExtra\", \"kernlab\", \"knitr\", \"mapedit\", \"mapview\", \"maptiles\", \"Mlmetrics\", \n  \"ModelMetrics\", \"moments\", \"olsrr\", \"openxlsx\", \"plotly\", \"psych\", \"randomForest\", \n  \"raster\",\"RColorBrewer\", \"rmarkdown\", \"renv\", \"reticulate\", \"s2\", \"sf\", \"scales\", \n  \"sits\",\"spdep\", \"stars\", \"stringr\", \"terra\", \"tmap\", \"tmaptools\", \"tidymodels\", \n  \"tidyverse\", \"tidyr\", \"tune\", \"useful\",\n  prompt = F\n  )",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>4. Monte Carlo</span>"
    ]
  },
  {
    "objectID": "04-monte-carlo/index.html#simulation-architecture",
    "href": "04-monte-carlo/index.html#simulation-architecture",
    "title": "4. Monte Carlo",
    "section": "4.1 Simulation Architecture",
    "text": "4.1 Simulation Architecture\nTemporal Scope Design\nART-TREES permits single-year or multi-year aggregation. Program participants may recognize that single-year simulations tend to reduce uncertainty by avoiding temporal error propagation. We discuss below some of the advantages and disadvantages in applying similar adjustments and aggregations to Monte Carlo simulated estimates.\n\n# Single-year simulation (RECOMMENDED)\nsimulate_single_year &lt;- function(n_sim = 10000, year_data) {\n  \n    # Sample activity data uncertainty\n  deforestation_ha &lt;- rnorm(n_sim, \n    mean = year_data$deforestation_ha,\n    sd = year_data$deforestation_ha * year_data$ad_uncertainty_pct / 100)\n  \n  # Sample emission factor uncertainty  \n  ef_tco2_ha &lt;- rnorm(n_sim,\n    mean = year_data$ef_tco2_ha,\n    sd = year_data$ef_tco2_ha * year_data$ef_uncertainty_pct / 100)\n  \n  # Calculate emissions distribution\n  emissions_tco2 &lt;- deforestation_ha * ef_tco2_ha\n  \n  # Compute 90% CI\n  ci_90 &lt;- quantile(emissions_tco2, probs = c(0.05, 0.95))\n  hw_90 &lt;- (ci_90[2] - ci_90[1]) / 2\n  uaf &lt;- 0.524417 * (hw_90 / mean(emissions_tco2)) / 1.645006\n  \n  return(list(\n    mean_emissions = mean(emissions_tco2),\n    hw_90_pct = (hw_90 / mean(emissions_tco2)) * 100,\n    uaf = uaf,\n    simulated_emissions = emissions_tco2\n  ))\n}\n\n# Example year data\nyear_2024 &lt;- list(\n  deforestation_ha = 5000,\n  ad_uncertainty_pct = 12,      # Input from Chapter 3 accuracy assessment\n  ef_tco2_ha = 200,\n  ef_uncertainty_pct = 18       # Input from Chapter 2 default values\n)\n\nresults &lt;- simulate_single_year(year_data = year_2024)\ncat(sprintf(\"Mean Emissions: %.0f tCO2\\n\", results$mean_emissions))\n## Mean Emissions: 999597 tCO2\ncat(sprintf(\"90%% CI Half-Width: %.1f%%\\n\", results$hw_90_pct))\n## 90% CI Half-Width: 35.4%\ncat(sprintf(\"Uncertainty Adjustment Factor: %.3f\\n\", results$uaf))\n## Uncertainty Adjustment Factor: 0.113\n\nBaseline Treatment\nUse the arithmetic mean of verified historical emissions as deterministic baseline, avoiding stochastic variance. For example, country X computed their HFLDCL as 21,037,534 tCO₂ rather than simulating historical variability (ART, 2021, Section 8.4).",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>4. Monte Carlo</span>"
    ]
  },
  {
    "objectID": "04-monte-carlo/index.html#uncertainty-source-prioritization",
    "href": "04-monte-carlo/index.html#uncertainty-source-prioritization",
    "title": "4. Monte Carlo",
    "section": "4.2 Uncertainty Source Prioritization",
    "text": "4.2 Uncertainty Source Prioritization\nSensitivity Analysis\nTornado diagrams identify dominant error sources:\n\n# Sensitivity analysis across uncertainty sources\nsensitivity_analysis &lt;- function(base_scenario, n_sim = 10000) {\n  \n  scenarios &lt;- list(\n    baseline = base_scenario,\n    low_ad = modifyList(base_scenario, list(ad_uncertainty_pct = base_scenario$ad_uncertainty_pct * 0.5)),\n    low_ef = modifyList(base_scenario, list(ef_uncertainty_pct = base_scenario$ef_uncertainty_pct * 0.5)),\n    low_both = modifyList(base_scenario, list(\n      ad_uncertainty_pct = base_scenario$ad_uncertainty_pct * 0.5,\n      ef_uncertainty_pct = base_scenario$ef_uncertainty_pct * 0.5))\n  )\n  \n  results &lt;- lapply(scenarios, function(s) {\n    sim &lt;- simulate_single_year(n_sim, s)\n    data.frame(\n      scenario = deparse(substitute(s)),\n      uaf = sim$uaf,\n      hw_90_pct = sim$hw_90_pct\n    )\n  })\n  \n  do.call(rbind, results)\n}\n\n# Run sensitivity\nsensitivity_results &lt;- sensitivity_analysis(year_2024)\nprint(sensitivity_results)\n##          scenario        uaf hw_90_pct\n## baseline   X[[i]] 0.11329635  35.53912\n## low_ad     X[[i]] 0.09896063  31.04225\n## low_ef     X[[i]] 0.07895226  24.76597\n## low_both   X[[i]] 0.05693012  17.85800\n\nFor jurisdictions where emission factor uncertainty dominates (typical in Tier 1 approaches), investments in plot-based Tier 2 emission factors yield greater UAF reductions than marginal improvements in classification accuracy.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>4. Monte Carlo</span>"
    ]
  },
  {
    "objectID": "04-monte-carlo/index.html#optimization-strategies",
    "href": "04-monte-carlo/index.html#optimization-strategies",
    "title": "4. Monte Carlo",
    "section": "4.3 Optimization Strategies",
    "text": "4.3 Optimization Strategies\nBootstrap Sampling\nWhen probability distributions are unknown, ART-TREES requires bootstrap resampling. Efficient implementation draws samples from empirical error distributions:\n\n# Bootstrap activity data from confusion matrix\nbootstrap_activity_data &lt;- function(n_sim, confusion_matrix, mapped_area_ha) {\n  \n  # Extract user's accuracy (precision) for focal class\n  users_accuracy &lt;- confusion_matrix[\"Forest\", \"Forest\"] / \n    sum(confusion_matrix[\"Forest\", ])\n  \n  # Bootstrap from binomial distribution\n  true_area_ha &lt;- rbinom(n_sim, \n    size = mapped_area_ha, \n    prob = users_accuracy)\n  \n  return(true_area_ha)\n}\n\nTemporal Aggregation\nART-TREES Section 8.7 permits recalculation every 5 years to recover over-deducted credits when cumulative uncertainty decreases. Programs achieving systematic uncertainty reduction through improved methods can retroactively claim additional credits:\n\\[\n\\text{Recovered Credits}_t = \\sum_{i=1}^{5} (UA_{i,original} - UA_{i,updated}) \\times \\text{Emissions}_i\n\\]\nThis provision incentives continuous methodological improvement rather than penalizing early-stage high uncertainty.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>4. Monte Carlo</span>"
    ]
  },
  {
    "objectID": "04-monte-carlo/index.html#worked-example-jurisdictional-program",
    "href": "04-monte-carlo/index.html#worked-example-jurisdictional-program",
    "title": "4. Monte Carlo",
    "section": "4.4 Worked Example: Jurisdictional Program",
    "text": "4.4 Worked Example: Jurisdictional Program\nMulti-Source Integration\nCombine uncertainties from all three chapters into crediting period simulation:\n\n# Complete jurisdictional simulation\njurisdictional_simulation &lt;- function(n_sim = 10000) {\n  \n  # Activity Data (Chapter 3: ±12% from accuracy assessment)\n  deforestation_2024_ha &lt;- rnorm(n_sim, mean = 5000, sd = 5000 * 0.12)\n  \n  # Emission Factors (Chapter 2: Tier 1 ±18%)\n  # Aboveground biomass removal\n  agb_loss_tco2_ha &lt;- rnorm(n_sim, mean = 180, sd = 180 * 0.18)\n  \n  # Belowground biomass (Chapter 2: root-shoot ratio ±15%)\n  bgb_loss_tco2_ha &lt;- rnorm(n_sim, mean = 40, sd = 40 * 0.15)\n  \n  # Total emission factor\n  total_ef_tco2_ha &lt;- agb_loss_tco2_ha + bgb_loss_tco2_ha\n  \n  # Calculate emissions distribution\n  emissions_tco2 &lt;- deforestation_2024_ha * total_ef_tco2_ha\n  \n  # Reference level (deterministic)\n  hfldcl_tco2 &lt;- 21037534  # Mean of 2016-2020\n  \n  # Emission reductions\n  reductions_tco2 &lt;- pmax(0, hfldcl_tco2 - emissions_tco2)\n  \n  # Uncertainty metrics\n  ci_90 &lt;- quantile(reductions_tco2, probs = c(0.05, 0.95))\n  hw_90 &lt;- (ci_90[2] - ci_90[1]) / 2\n  uaf &lt;- 0.524417 * (hw_90 / mean(reductions_tco2)) / 1.645006\n  \n  # Creditable emissions after conservativeness deduction\n  creditable &lt;- mean(reductions_tco2) * (1 - uaf)\n  \n  return(list(\n    mean_reductions = mean(reductions_tco2),\n    uaf = uaf,\n    hw_90_pct = (hw_90 / mean(reductions_tco2)) * 100,\n    creditable_tco2 = creditable,\n    deduction_pct = uaf * 100\n  ))\n}\n\n# Execute simulation\nprogram_results &lt;- jurisdictional_simulation()\n\ncat(sprintf(\"Mean Emission Reductions: %.0f tCO2\\n\", program_results$mean_reductions))\n## Mean Emission Reductions: 19935054 tCO2\ncat(sprintf(\"90%% CI Half-Width: %.1f%%\\n\", program_results$hw_90_pct))\n## 90% CI Half-Width: 1.7%\ncat(sprintf(\"Uncertainty Deduction: %.1f%%\\n\", program_results$deduction_pct))\n## Uncertainty Deduction: 0.5%\ncat(sprintf(\"Creditable Emissions: %.0f tCO2\\n\", program_results$creditable_tco2))\n## Creditable Emissions: 19825695 tCO2",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>4. Monte Carlo</span>"
    ]
  },
  {
    "objectID": "04-monte-carlo/index.html#compliance-checklist",
    "href": "04-monte-carlo/index.html#compliance-checklist",
    "title": "4. Monte Carlo",
    "section": "4.5 Compliance Checklist",
    "text": "4.5 Compliance Checklist\n\nMinimum 10,000 iterations per crediting year\n90% confidence intervals (5th and 95th percentiles)\nBootstrap sampling for unknown distributions\nConservative bias (systematic underestimation permitted)\nWhole-chain integration (activity data + emission factors)\nDocumentation of simulation code and random seed",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>4. Monte Carlo</span>"
    ]
  },
  {
    "objectID": "04-monte-carlo/index.html#chapter-summary",
    "href": "04-monte-carlo/index.html#chapter-summary",
    "title": "4. Monte Carlo",
    "section": "4.6 Chapter Summary",
    "text": "4.6 Chapter Summary\nMonte Carlo simulation aggregates component uncertainties into conservativeness deductions determining credit issuance. Strategic optimization prioritizes dominant sources, such as emission factors in Tier 1 programs or activity data in high-resolution systems. Single-year simulation, deterministic reference levels, and systematic improvements achieve attractive uncertainty reductions, directly increasing revenue and while meeting ART-TREES Section 8 requirements.\n\n\n\n\n\n\nART. (2021). The REDD+ environmental excellence standard (2.0 ed.). https://www.artredd.org/wp-content/uploads/2021/12/TREES-2.0-August-2021-Clean.pdf",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>4. Monte Carlo</span>"
    ]
  },
  {
    "objectID": "references/index.html",
    "href": "references/index.html",
    "title": "Appendix A — References",
    "section": "",
    "text": "Appel, M., & Pebesma, E. (2019b). On-demand processing of data\ncubes from satellite image collections with the gdalcubes library.\n4. https://doi.org/10.3390/data4030092\n\n\nAppel, M., & Pebesma, E. (2019a). On-demand processing of data cubes\nfrom satellite image collections with the gdalcubes library.\nData, 4(3), 92.\n\n\nArchibald, S., & Bond, W. J. (2003). Growing tall vs. Growing wide:\nTree architecture and allometry of acacia karroo in forest, savanna, and\narid environments. Oikos (Copenhagen, Denmark),\n102(1), 3–14. https://doi.org/10.1034/j.1600-0706.2003.12181.x\n\n\nArmstrong, J. S. (1978). Long-range forecasting: From crystal ball\nto computer (2nd ed.). Wiley.\n\n\nART. (2021). The REDD+ environmental excellence standard (2.0\ned.). https://www.artredd.org/wp-content/uploads/2021/12/TREES-2.0-August-2021-Clean.pdf\n\n\nBaillie, R., & Wagstaff, S. S. (1980). Lucas pseudoprimes.\nMathematics of Computation, 35(152), 1391–1417.\n\n\nBallantyne, A., Andres, R., Houghton, R., Stocker, B., Wanninkhof, R.,\nAnderegg, W., Cooper, L., DeGrandpre, M., Tans, P., Miller, J., &\nal., et. (2015). Audit of the global carbon budget: Estimate errors and\ntheir impact on uptake uncertainty. Biogeosciences (Online),\n12(8), 2565–2584.\n\n\nBohlman, S., & O’Brien, S. (2006). Allometry, adult stature and\nregeneration requirement of 65 tree species on barro colorado island,\npanama. Journal of Tropical Ecology, 22(2), 123–136.\n\n\nBrown, S. (1997). Estimating biomass and biomass change of tropical\nforests: A primer. Food and agriculture organization of the united\nnations.\n\n\nButler, B. J., Sass, E. M., Gamarra, J. G., Campbell, J. L., Wayson, C.,\nOlguıń, M., Carrillo, O., & Yanai, R. D. (2024). Uncertainty in\nREDD+ carbon accounting: A survey of experts involved in REDD+\nreporting. Carbon Balance and Management, 19(1), 22.\n\n\nCamara, G., Simoes, R., Souza, F., Menino, F., Pelletier, C., Andrade,\nP. R., Ferreira, K., & Queiroz, G. (2024). Uncertainty and active\nlearning analysis. In Satellite time series on earth observation\ndata cubes. https://e-sensing.github.io/sitsbook/uncertainty-and-active-learning.html#uncertainty-and-active-learning\n\n\nCao, S., Yu, Q., & Zhang, J. (2012). Automatic division for\npure/mixed pixels based on probabilities entropy and spatial\nheterogeneity. 2012 First International Conference on\nAgro-Geoinformatics (Agro-Geoinformatics), 1–4.\n\n\nChave, J., Coomes, D., Jansen, S., Lewis, S. L., Swenson, N. G., &\nZanne, A. E. (2009). Towards a worldwide wood economics spectrum.\nEcology Letters, 12(4), 351–366.\n\n\nChave, J., Réjou-Méchain, M., Búrquez, A., Chidumayo, E., Colgan, M. S.,\nDelitti, W. B., Duque, A., Eid, T., Fearnside, P. M., Goodman, R. C.,\n& al., et. (2014). Improved allometric models to estimate the\naboveground biomass of tropical trees. Global Change Biology,\n20(10), 3177–3190.\n\n\nCrawford, M. M., Tuia, D., & Yang, H. L. (2013). Active learning:\nAny value for classification of remotely sensed data? Proceedings of\nthe IEEE, 101(3), 593–608.\n\n\nDietze, M. C., Wolosin, M. S., & Clark, J. S. (2008). Capturing\ndiversity and interspecific variability in allometries: A hierarchical\napproach. Forest Ecology and Management, 256(11),\n1939–1948.\n\n\nDuncanson, L., Disney, M., Armston, J., Nickeson, J., Minor, D., &\nCamacho, F. (2021). Aboveground woody biomass product validation\ngood practices protocol. https://doi.org/10.5067/DOC/CEOSWGCV/LPV/AGB.001\n\n\nEnquist, B. J., West, G. B., Charnov, E. L., & Brown, J. H. (1999).\nAllometric scaling of production and life-history variation in vascular\nplants. Nature, 401(6756), 907–911.\n\n\nFeldpausch, T. R., Banin, L., Phillips, O. L., Baker, T. R., Lewis, S.\nL., Quesada, C. A., Affum-Baffoe, K., Arets, E. J., Berry, N. J., Bird,\nM., & al., et. (2011). Height-diameter allometry of tropical forest\ntrees. Biogeosciences (Online), 8(5), 1081–1106.\n\n\nFrénay, B., & Verleysen, M. (2013). Classification in the presence\nof label noise: A survey. IEEE Transactions on Neural Networks and\nLearning Systems, 25(5), 845–869.\n\n\nGonçalves, M., Netto, M., Costa, J., & Zullo Junior, J. (2008). An\nunsupervised method of classifying remotely sensed images using kohonen\nself-organizing maps and agglomerative hierarchical clustering methods.\nInternational Journal of Remote Sensing, 29(11),\n3171–3207.\n\n\nGonzalez-Akre, E., Piponiot, C., Lepore, M., & Anderson-Teixeira, K.\n(2025). Allodb: Tree biomass estimation at extra-tropical forest\nplots.\n\n\nGonzalez-Akre, E., Piponiot, C., Lepore, M., Herrmann, V., Lutz, J. A.,\nBaltzer, J. L., Dick, C. W., Gilbert, G. S., He, F., Heym, M., &\nal., et. (2022). Allodb: An r package for biomass estimation at globally\ndistributed extratropical forest plots. Methods in Ecology and\nEvolution, 13(2), 330–338.\n\n\nGould, S. J. (1966). Allometry and size in ontogeny and phylogeny.\nBiological Reviews, 41(4), 587–638.\n\n\nGould, S. J. (1971). Geometric similarity in allometric growth: A\ncontribution to the problem of scaling in the evolution of size. The\nAmerican Naturalist, 105(942), 113–136.\n\n\nHijmans, R. J. (2025). Terra: Spatial data analysis. https://CRAN.R-project.org/package=terra\n\n\nHuxley, J. S. (1924). Constant differential growth-ratios and their\nsignificance. Nature, 114(2877), 895–896.\n\n\nIPCC. (n.d.). 2013 revised supplementary methods and good practice\nguidance arising from the kyoto protocol.\n\n\nIPCC. (2012). Report of the conference of the parties serving as the\nmeeting of the parties to the kyoto protocol on its seventh\nsession,. FCCC/KP/CMP/2011/10(Durban Meeting November 28th\nto December 11th, 2011), 824.\n\n\nIPCC. (2019a). 2019 refinement to the 2006 IPCC guidelines for\nnational greenhouse gas inventories (Agriculture, Forestry and\nOther Land Use, Vol. 4). Intergovernmental Panel on Climate Change. https://www.ipcc-nggip.iges.or.jp/public/2019rf/vol4.html\n\n\nIPCC. (2019b). Chapter 2: Generic methodologies applicable to multiple\nland-use categories. In 2019 refinement to the 2006 IPCC guidelines\nfor national greenhouse gas inventories (Agriculture, Forestry and\nOther Land Use, Vol. 4). Intergovernmental Panel on Climate Change. https://www.ipcc-nggip.iges.or.jp/public/2019rf/pdf/4_Volume4/19R_V4_Ch02_Generic%20Methods.pdf\n\n\nJansen, J. J., Sevenster, J., & Faber, J. and. (1996).\nOpbrengsttabellen voor belangrijke boomsoorten in nederland.\nIBN-DLO.\n\n\nJenkins, J. C. (2004). Comprehensive database of diameter-based\nbiomass regressions for north american tree species. United States\nDepartment of Agriculture, Forest Service, Northeastern ….\n\n\nKing, D. A. (1996). Allometry and life history of tropical trees.\nJournal of Tropical Ecology, 12(1), 25–44.\n\n\nKing, D. A., & Clark, D. A. (2011). Allometry of emergent tree\nspecies from saplings to above-canopy adults in a costa rican rain\nforest. Journal of Tropical Ecology, 27(6), 573–579.\n\n\nKöhler, P., & Huth, A. (2010). Towards ground-truthing of spaceborne\nestimates of above-ground life biomass and leaf area index in tropical\nrain forests. Biogeosciences (Online), 7(8),\n2531–2543.\n\n\nKomiyama, A., Ong, J. E., & Poungparn, S. (2008). Allometry,\nbiomass, and productivity of mangrove forests: A review. Aquatic\nBotany, 89(2), 128–137. https://doi.org/10.1016/j.aquabot.2007.12.006\n\n\nKomiyama, A., Poungparn, S., & Kato, S. (2005). Common allometric\nequations for estimating the tree weight of mangroves. Journal of\nTropical Ecology, 21(4), 471–477.\n\n\nKuhn, M. (2011). The caret package.\n\n\nMaus, V., Câmara, G., Appel, M., & Pebesma, E. (2019). Dtwsat:\nTime-weighted dynamic time warping for satellite image time series\nanalysis in r. Journal of Statistical Software, 88,\n1–31.\n\n\nMaxwell, A. E., Warner, T. A., & Fang, F. (2018). Implementation of\nmachine-learning classification in remote sensing: An applied review.\nInternational Journal of Remote Sensing, 39(9),\n2784–2817.\n\n\nMetropolis, N., & Ulam, S. (1949). The monte carlo method.\nJournal of the American Statistical Association,\n44(247), 335–341.\n\n\nMeyer, H., & Pebesma, E. (2022). Machine learning-based global maps\nof ecological variables and the challenge of assessing them. Nature\nCommunications, 13(1), 2208.\n\n\nMuller-Landau, H. C., Condit, R. S., Chave, J., Thomas, S. C., Bohlman,\nS. A., Bunyavejchewin, S., Davies, S., Foster, R., Gunatilleke, S.,\nGunatilleke, N., & al., et. (2006). Testing metabolic ecology theory\nfor allometric scaling of tree size, growth and mortality in tropical\nforests. Ecology Letters, 9(5), 575–588.\n\n\nMurray, S. H. (2003). The schreier-sims algorithm. Essay Submitted\nto the Department of Mathematics of the Australian National\nUniversity.\n\n\nNeagoe, V.-E., Stoica, R.-M., Ciurea, A.-I., Bruzzone, L., & Bovolo,\nF. (2014). Concurrent self-organizing maps for supervised/unsupervised\nchange detection in remote sensing images. IEEE Journal of Selected\nTopics in Applied Earth Observations and Remote Sensing,\n7(8), 3525–3533.\n\n\nPaul, K. I., Roxburgh, S. H., & Larmour, J. S. (2017). Moisture\ncontent correction: Implications of measurement errors on tree-and\nsite-based estimates of biomass. Forest Ecology and Management,\n392, 164–175.\n\n\nPelletier, J., Martin, D., & Potvin, C. (2013). REDD+ emissions\nestimation and reporting: Dealing with uncertainty. Environmental\nResearch Letters, 8(3), 034009.\n\n\nPetitjean, F., Inglada, J., & Gançarski, P. (2012). Satellite image\ntime series analysis under time warping. IEEE Transactions on\nGeoscience and Remote Sensing, 50(8), 3081–3095.\n\n\nPicard, N., Saint-Andre, L., & Henry, M. (2012). Manual for\nbuilding tree volume and biomass allometric equations: From field\nmeasurement to prediction. Food and agriculture organization of the\nunited nations, centre de cooperation internationale en recherche\nagronomique pour le developpement.\n\n\nRahman, M. S., Donoghue, D. N., Bracken, L. J., & Mahmood, H.\n(2021). Biomass estimation in mangrove forests: A comparison of\nallometric models incorporating species and structural information.\nEnvironmental Research Letters, 16(12), 124002.\n\n\nRand, W. M. (1971). Objective criteria for the evaluation of clustering\nmethods. Journal of the American Statistical Association,\n66(336), 846–850.\n\n\nRéjou-Méchain, M., Tanguy, A., Piponiot, C., Chave, J., & Herault,\nB. (2017a). BIOMASS : An r package for\nestimating above-ground biomass and its uncertainty in tropical\nforests. 8. https://doi.org/10.1111/2041-210X.12753\n\n\nRéjou-Méchain, M., Tanguy, A., Piponiot, C., Chave, J., & Herault,\nB. (2017b). BIOMASS : An r package for\nestimating above-ground biomass and its uncertainty in tropical\nforests. 8. https://doi.org/10.1111/2041-210X.12753\n\n\nRéjou-Méchain, M., Tanguy, A., Piponiot, C., Chave, J., & Hérault,\nB. (2017). Biomass: An r package for estimating above-ground biomass and\nits uncertainty in tropical forests. Methods in Ecology and\nEvolution, 8(9), 1163–1167.\n\n\nRocha de Souza Pereira, F., Kampel, M., Gomes Soares, M. L., Estrada, G.\nC. D., Bentz, C., & Vincent, G. (2018). Reducing uncertainty in\nmapping of mangrove aboveground biomass using airborne discrete return\nlidar data. Remote Sensing, 10(4), 637.\n\n\nRoxburgh, S., Paul, K., Clifford, D., England, J., & Raison, R.\n(2015). Guidelines for constructing allometric models for the prediction\nof woody biomass: How many individuals to harvest? Ecosphere\n(Washington, D.C), 6(3), 1–27.\n\n\nRutishauser, E., Noor’an, F., Laumonier, Y., Halperin, J., Hergoualc’h,\nK., Verchot, L., et al. (2013). Generic allometric models including\nheight best estimate forest biomass and carbon stocks in indonesia.\nForest Ecology and Management, 307, 219–225.\n\n\nSchrodt, F., Beck, M., Estopinan, J., Bowler, D. E., Fontaine, C.,\nGaüzère, P., Goury, R., Grenié, M., Martins, I. S., Morueta-Holme, N.,\n& al., et. (2025). Advancing causal inference in ecology: Pathways\nfor biodiversity change detection and attribution. Methods in\nEcology and Evolution, 16(10), 2276–2304.\n\n\nShannon, C. E. (1948). A mathematical theory of communication. Bell\nSystem Technical Journal, 27(3), 379–423. https://doi.org/10.1002/j.1538-7305.1948.tb01338.x\n\n\nSheynin, O. B. (1989). AA markov’s work on probability. Archive for\nHistory of Exact Sciences, 39(4), 337–377.\n\n\nShinozaki, K., Yoda, K., Hozumi, K., & Kira, T. (1964). A\nquantitative analysis of plant form-the pipe model theory: I. Basic\nanalyses. Japanese Journal of Ecology, 14(3), 97–105.\n\n\nSimoes, R., Camara, G., Queiroz, G., Souza, F., Andrade, P. R., Santos,\nL., Carvalho, A., & Ferreira, K. (2021a). Satellite image time\nseries analysis for big earth observation data. Remote Sensing,\n13(13), 2428.\n\n\nSimoes, R., Camara, G., Queiroz, G., Souza, F., Andrade, P., Santos, L.,\nCarvalho, A., & Ferreira, K. (2021b). Satellite image time\nseries analysis for big earth observation data. 13, 2428.\nhttps://doi.org/10.3390/rs13132428\n\n\nSiriseriwan, W. (2024). Smotefamily: A collection of oversampling\ntechniques for class imbalance problem based on SMOTE. https://CRAN.R-project.org/package=smotefamily\n\n\nSolovay, R., & Strassen, V. (1977). A fast monte-carlo test for\nprimality. SIAM Journal on Computing, 6(1), 84–85.\n\n\nSornette, D. (2006). Critical phenomena in natural sciences: Chaos,\nfractals, selforganization and disorder: Concepts and tools.\nSpringer.\n\n\nTarazona Coronel, Y., Zabala, A., Pons, X., Broquetas, A., Nowosad, J.,\n& A. Zurqani, H. (2021). Fusing landsat and\nSAR data for mapping tropical deforestation\nthrough machine learning classification and the\nPVts-β non-seasonal detection approach.\nhttps://doi.org/10.1080/07038992.2021.1941823\n\n\nTorgo, L. (2010). Data mining with r, learning with case\nstudies. http://www.dcc.fc.up.pt/~ltorgo/DataMiningWithR\n\n\nUNFCCC, C. (2010). Report of the conference of the parties on its\nfifteenth session, held in copenhagen from 7 to 19 december 2009.\nFCCC/CP/2009/11/Add. 1.\n\n\nValbuena, R., Heiskanen, J., Aynekulu, E., Pitkänen, S., & Packalen,\nP. (2016). Sensitivity of above-ground biomass estimates to\nheight-diameter modelling in mixed-species west african woodlands.\nPloS One, 11(7), e0158198.\n\n\nVieilledent, G., Fischer, F. J., Chave, J., Guibal, D., Langbour, P.,\n& Gérard, J. (2018). New formula and conversion factor to compute\nbasic wood density of tree species using a global wood technology\ndatabase. American Journal of Botany, 105(10),\n1653–1661.\n\n\nWest, G. B., Brown, J. H., & Enquist, B. J. (1997). A general model\nfor the origin of allometric scaling laws in biology. Science,\n276(5309), 122–126.\n\n\nYao, W., Loffeld, O., & Datcu, M. (2016). Application and evaluation\nof a hierarchical patch clustering method for remote sensing images.\nIEEE Journal of Selected Topics in Applied Earth Observations and\nRemote Sensing, 9(6), 2279–2289.\n\n\nZianis, D., & Mencuccini, M. (2004). On simplifying allometric\nanalyses of forest biomass. Forest Ecology and Management,\n187(2-3), 311–332.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>References</span>"
    ]
  },
  {
    "objectID": "AA-Appendix/glossary-terms.html#footnotes",
    "href": "AA-Appendix/glossary-terms.html#footnotes",
    "title": "Appendix B — Glossary of Terms",
    "section": "",
    "text": "See subsection “A4 Primer on Monte Carlo Methods”↩︎",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>Glossary of Terms</span>"
    ]
  },
  {
    "objectID": "AA-Appendix/additional-reading.html",
    "href": "AA-Appendix/additional-reading.html",
    "title": "Appendix C — Additional Reading",
    "section": "",
    "text": "Allometric Uncertainty:\n\nAholoukpè, H. N. S., Dubos, B., Deleporte, P., Flori, A., Amadji, L. G., Chotte, J.-L., & Blavet, D. (2018). Allometric equations for estimating oil palm stem biomass in the ecological context of benin, west africa. Trees, 32(6), 1669–1680.\nAndersen, H.-E., Reutebuch, S. E., & McGaughey, R. J. (2006). A rigorous assessment of tree height measurements obtained using airborne lidar and conventional field methods. Canadian Journal of Remote Sensing, 32(5), 355–366. https://doi.org/10.5589/m06-030\nBaskerville, G. (1972). Use of logarithmic regression in the estimation of plant biomass. Canadian Journal of Forest Research, 2(1), 49–53.\nDuncanson, L., Disney, M., Armston, J., Nickeson, J., Minor, D., & Camacho, F. (2021). Aboveground woody biomass product validation good practices protocol. https://doi.org/10.5067/DOC/CEOSWGCV/LPV/AGB.001\nDutcă, I., Stăncioiu, P. T., Abrudan, I. V., & Ioraș, F. (2018). Using clustered data to develop biomass allometric models: The consequences of ignoring the clustered data structure. PloS One, 13(8), e0200123.\nMartin, A. (2022). Accuracy and precision in urban forestry tools for estimating total tree height. Arboric. Urban For, 48(6), 319–332.\nMartı́nez-Sánchez, J. L., Martı́nez-Garza, C., Cámara, L., & Castillo, O. (2020). Species-specific or generic allometric equations: Which option is better when estimating the biomass of mexican tropical humid forests? Carbon Management, 11(3), 241–249.\nMcRoberts, R. E., & Westfall, J. A. (2016). Propagating uncertainty through individual tree volume model predictions to large-area volume estimates. Annals of Forest Science, 73(ue 3), 625–633. https://doi.org/10.1007/s13595-015-0473-x\nNickless, A., Scholes, R. J., & Archibald, S. (2011). A method for calculating the variance and confidence intervals for tree biomass estimates obtained from allometric equations. South African Journal of Science, 107(5), 1–10.\nOjoatre, S., Zhang, C., Hussin, Y. A., Kloosterman, H. E., & Ismail, M. H. (2019). Assessing the uncertainty of tree height and aboveground biomass from terrestrial laser scanner and hypsometer using airborne LiDAR data in tropical rainforests. IEEE Journal of Selected Topics in Applied Earth Observations and Remote Sensing, 12(10), 4149–4159.\nParresol, B. R. (1993). Modeling multiplicative error variance: An example predicting tree diameter from stump dimensions in baldcypress. Forest Science, 39(4), 670–679.\nPicard, N., Bosela, F. B., & Rossi, V. (2015). Reducing the error in biomass estimates strongly depends on model selection. Annals of Forest Science, 72(6), 811–823. https://doi.org/10.1007/s13595-014-0434-9\nPicard N., Saint-André L., Henry M. 2012. Manual for building tree volume and biomass allometric equations: from field measurement to prediction. Food and Agricultural Organization of the United Nations, Rome, and Centre de Coopération Internationale en Recherche Agronomique pour le Développement, Montpellier, 215 pp.\nPloton, P., Mortier, F., Réjou-Méchain, M., Barbier, N., Picard, N., Rossi, V., Dormann, C., Cornu, G., Viennois, G., Bayol, N., & al., et. (2020). Spatial validation reveals poor predictive performance of large-scale ecological mapping models. Nature Communications, 11(1), 4540.\nRoxburgh, S., Paul, K., Clifford, D., England, J., & Raison, R. (2015). Guidelines for constructing allometric models for the prediction of woody biomass: How many individuals to harvest? Ecosphere (Washington, D.C), 6(3), 1–27.\nShang, Y., Xia, Y., Ran, X., Zheng, X., Ding, H., & Fang, Y. (2025). Allometric equations for aboveground biomass estimation in natural forest trees: Generalized or species-specific? Diversity, 17(7), 493.\nVorster, A. G., Evangelista, P. H., Stovall, A. E., & Ex, S. (2020). Variability and uncertainty in forest biomass estimates from the tree to landscape scale: The role of allometric equations. Carbon Balance and Management, 15(1), 8.\nWayson, C. A., Johnson, K. D., Cole, J. A., Olguín, M. I., Carrillo, O. I., & Birdsey, R. A. (2015). Estimating uncertainty of allometric biomass equations with incomplete fit error information using a pseudo-data approach: methods. Annals of Forest Science, 72(6), 825–834.\nWhite, G. W., Yamamoto, J. K., Elsyad, D. H., Schmitt, J. F., Korsgaard, N. H., Hu, J. K., Gaines III, G. C., Frescino, T. S., & McConville, K. S. (2025). Small area estimation of forest biomass via a two-stage model for continuous zero-inflated data. Canadian Journal of Forest Research, 55, 1–19.\nYanai, R. D., Battles, J. J., Richardson, A. D., Blodgett, C. A., Wood, D. M., & Rastetter, E. B. (2010). Estimating uncertainty in ecosystem budget calculations. Ecosystems (New York, N.Y.), 13(ue 2), 239–248. https://doi.org/10.1007/s10021-010-9315-8\nYokelson, R.J., et al. (2013). Coupling field and laboratory measurements to estimate the emission factors of identified and unidentified trace gases for prescribed fires. Atmospheric Chemistry and Physics, 13, 89-116.\nZapata-Cuartas, M., Sierra, C. A., & Alleman, L. (2012). Probability distribution of allometric coefficients and bayesian estimation of aboveground tree biomass. Forest Ecology and Management, 277, 173–179.\n\n\n\nEmission Factor Uncertainty:\n\nAndreae, M.O. (2019). Emission of trace gases and aerosols from biomass burning – an updated assessment. Atmospheric Chemistry and Physics, 19, 8523-8546. doi:10.5194/acp-19-8523-2019\nBrown, J.K. (1974). Handbook for inventorying downed woody material. USDA Forest Service General Technical Report INT-16.\nIPCC. (2019). 2019 Refinement to the 2006 IPCC Guidelines for National Greenhouse Gas Inventories (Agriculture, Forestry and Other Land Use, Vol. 4). Intergovernmental Panel on Climate Change. https://www.ipcc-nggip.iges.or.jp/public/2019rf/vol4.html\nIPCC. (2006). 2006 IPCC Guidelines for National Greenhouse Gas Inventories, Volume 4: Agriculture, Forestry and Other Land Use. Intergovernmental Panel on Climate Change.\nKöhler, P., & Huth, A. (2010). Towards ground-truthing of spaceborne estimates of above-ground life biomass and leaf area index in tropical rain forests. Biogeosciences (Online), 7(8), 2531–2543.\nPelletier, J., Martin, D., & Potvin, C. (2013). REDD+ emissions estimation and reporting: Dealing with uncertainty. Environmental Research Letters, 8(3), 034009.\nPelletier, J., Busch, J., & Potvin, C. (2015). Addressing uncertainty upstream or downstream of accounting for emissions reductions from deforestation and forest degradation. Climatic Change, 130(4), 635-648\nPelletier, N., Thiagarajan, A., Durnin-Vermette, F., Liang, B. C., Choo, D., Cerkowniak, D., … & VandenBygaart, A. J. (2025). Approximate Bayesian inference for calibrating the IPCC tier-2 steady-state soil organic carbon model for Canadian croplands using long-term experimental data. Environmental Modelling & Software, 190, 106481\nSeiler, W., & Crutzen, P.J. (1980). Estimates of gross and net fluxes of carbon between the biosphere and the atmosphere from biomass burning. Climatic Change, 2(3), 207-247.\nvan Leeuwen, T.T., & van der Werf, G.R. (2011). Spatial and temporal variability in the ratio of trace gases emitted from biomass burning. Atmospheric Chemistry and Physics, 11, 3611-3629.\n\n\n\nActivity Data Uncertainty:\n\nButler, B. J., Sass, E. M., Gamarra, J. G., Campbell, J. L., Wayson, C., Olguín, M., Carrillo, O., & Yanai, R. D. (2024). Uncertainty in REDD+ carbon accounting: A survey of experts involved in REDD+ reporting. Carbon Balance and Management, 19(1), 22.\nChen, Q., Laurin, G. V., & Valentini, R. (2015). Uncertainty of remotely sensed aboveground biomass over an African tropical forest: Propagating errors from trees to plots to pixels. Remote Sensing of Environment, 160, 134–143. https://doi.org/10.1016/j.rse.2015.01.009\nGOFC-GOLD (2016). Integration of remote-sensing and ground-based observations for estimation of emissions and removals of greenhouse gases in forests: Methods and Guidance from the Global Forest Observations Initiative. Edition 2.0. Rome: Food and Agriculture Organization.\nGOFC-GOLD (2016). A sourcebook of methods and procedures for monitoring and reporting anthropogenic greenhouse gas emissions and removals associated with deforestation, gains and losses of carbon stocks in forests remaining forests, and forestation. GOFC-GOLD Report version COP22-1. Alberta, Canada: GOFC-GOLD Land Cover Project Office.\nKöhler, P., & Huth, A. (2010). Towards ground-truthing of spaceborne estimates of above-ground life biomass and leaf area index in tropical rain forests. Biogeosciences, 7(8), 2531–2543.\nOlofsson, P., Foody, G.M., Herold, M., Stehman, S.V., Woodcock, C.E., & Wulder, M.A. (2014). Good practices for estimating area and assessing accuracy of land change. Remote Sensing of Environment, 148, 42-57.\nPontius Jr., R.G., & Millones, M. (2011). Death to Kappa: birth of quantity disagreement and allocation disagreement for accuracy assessment. International Journal of Remote Sensing, 32(15), 4407-4429.\nSheng, J., Zhou, W., & De Sherbinin, A. (2018). Uncertainty in estimates, incentives, and emission reductions in REDD+ projects. International Journal of Environmental Research and Public Health, 15(7), 1544.\nStehman, S.V. (2014). Estimating area and map accuracy for stratified random sampling when the strata are different from the map classes. International Journal of Remote Sensing, 35(13), 4923-4939.\n\n\n\nMonte Carlo Methods:\n\nHoldaway, R. J., McNeill, S. J., Mason, N. W. H., & Carswell, F. E. (2014). Propagating uncertainty in plot-based estimates of forest carbon stock and carbon stock change. Ecosystems (New York, N.Y.), 17(ue 4), 627–640. https://doi.org/10.1007/s10021-014-9749-5\nKeller, M., Palace, M., & Hurtt, G. (2001). Biomass estimation in the tapajos national forest, brazil. Forest Ecology and Management, 154(ue 3), 371–382.\nMolto, Q., Rossi, V., & Blanc, L. (2013). Error propagation in biomass estimation in tropical forests. Methods in Ecology and Evolution, 4(2), 175–183. https://doi.org/10.1111/j.2041-210x.2012.00266.x\nYanai, R. D., Battles, J. J., Richardson, A. D., Blodgett, C. A., Wood, D. M., & Rastetter, E. B. (2010). Estimating uncertainty in ecosystem budget calculations. Ecosystems, 13(2), 239–248. https://doi.org/10.1007/s10021-010-9315-8\n\n\n\nBiostatistical Theory:\n\nBuchanan, M. (2000). Ubiquity: Why Catastrophes Happen. Three Rivers Press.\nMandelbrot, B. B., & Hudson, R. L. (2004). The Misbehavior of Markets: A Fractal View of Financial Turbulence. Basic Books.\nStrogatz, S. H. (2003). Sync: How Order Emerges from Chaos in the Universe, Nature, and Daily Life. Hyperion.\nTaleb, N. N. (2007). The Black Swan: The Impact of the Highly Improbable. Random House.\n\n\n\nIPCC Guidelines & Key Sections\n\n\n\nResource\nDescription\nSource\n\n\n\n\nIPCC 2006, Vol. 4\n\n\n\n\nCh.2 Generic Methodologies\nEq.2.9 Calculation of biomass retention & growth post-conversion\nLink\n\n\nCh.3 Representation of Lands\nS.3.2 Six land-use categories recommended for estimating GHG emissions from LULC\nLink\n\n\nIPCC 2019, Vol. 4\n\n\n\n\nCh.2 Generic Methodologies\nEq 2.25 Annual SOC stock change in mineral soils\nLink\n\n\n\nTbl.2.3 Default reference condition of SOC stocks to soil & climate\nLink\n\n\nCh.3 Representation of Lands\nTb.3.1 List of IPCC categories: land, climate, soil, mgt, activity\nLink\n\n\n\nPg.3.1 Tier 1 sampling approaches decision tree\nLink\n\n\n\nTb.3.6X Approach 1-3 to IPCC land-use classification & sampling\nLink\n\n\n\nTb.3.4 Approach 2 land change matrix to avoid double-counting\nLink\n\n\n\nPg.3A5 Climate zone delineation & updated datasets\nLink\n\n\n\nTb.3A.1 Global land-cover datasets listed by IPCC in 2017\nLink\n\n\nCh.4 Forest Land\nTb.4.4 R:S below to above-ground biomass ratio by climate & region\nLink\n\n\nCh.5 Cropland\nTb.5.5 Relative stock change factors for mgt. activity in croplands\nLink\n\n\n\nTb.5.8 Default AGB carbon stocks retained on cropland in year 1\nLink\n\n\n\nTb.5.10 Soil stock change factors for conversion to cropland\nLink\n\n\nCh.6 Grasslands\nTbl 6.4 Default biomass stocks on converted grasslands\nLink\n\n\nCh.9 Other Land\nCh.9: Near-zero SOC retention assigned to mining in “Other Lands”\nLink\n\n\nIPCC 2013 Wetland Supplement\nTb.1.1 Look-up table for wetlands by vegetation and soil type\nLink\n\n\nIPCC 2023 AR6 Updated GWPs\nTb.7.15 Updated GWPs for N₂O and fossil-specific CH₄ ***\nLink\n\n\n\n\n\nCombustion Emissions\nIn this chapter, we derive estimates and examples using equation 2.27 (IPCC, 2019):\n\\[\nE_{fire} = A \\times M_B \\times C_f \\times G_{ef} \\times 10^{-3}\n\\]\nWhere:\nEfire: Fire emissions (tonnes CO2-equivalent)\nA: Burned area (hectares)\nMB: Biomass density (tonnes dry matter ha-1)\nCf: Combustion factor (fraction of biomass consumed)\nGef: Emission factor (g gas per kg dry matter burned)\n10-3: Unit conversion factor\nUncertainty propagates through this chain, meaning small uncertainties in each parameter compound to large total uncertainty.\nSources of Uncertainty\nThree primary components:\nDefault value variance: IPCC Table 2.5 provides emission factors with confidence intervals typically ±30-50%\nCombustion completeness: The combustion factor (Cf) varies with:\nFire intensity and duration\nFuel moisture content\nWeather conditions (temperature, humidity, wind)\nFuel load and structure\nGas-specific variability:\nCH4: ±30-40% (incomplete combustion, temperature-dependent)\nN2O: ±50-60% (nitrogen content, soil conditions)\nCO2: ±5% (stoichiometric, relatively invariant)\nTypical contribution to total uncertainty: Emission factors contribute 20-30% of total REDD+ uncertainty when properly quantified (often underestimated when omitted from reporting).\nIPCC Default Factors\nThe IPCC 2019 Refinement Table 2.5 provides emission factors stratified by:\nVegetation type:\nTropical forest\nSavanna/grassland\nPeatland (separate chapter in this ebook series)\nTemperate forest\nBoreal forest\nGas species:\nCO2 (carbon dioxide)\nCH4 (methane)\nN2O (nitrous oxide)\nCO (carbon monoxide)\nNOx (nitrogen oxides)\nNMHC (non-methane hydrocarbons)\nFire type:\nFlaming combustion (high intensity)\nSmoldering combustion (low intensity)\nMixed (typical field conditions)\nTropical Emission Factors\nIPCC 2019 default values for tropical forests:\n{r} #| echo: false #| label: tbl-ipcc-ef #| tbl-cap: “IPCC 2019 default emission factors for tropical forest fires”\nlibrary(tidyverse) library(kableExtra)\nipcc_ef &lt;- tribble( ~Gas, ~Mean_g_kg, ~Lower_CI, ~Upper_CI, ~Uncertainty_pct, ~Combustion_Type,\n# CO2 “CO₂”, 1580, 1510, 1650, “±4.4%”, “Mixed”, “CO₂”, 1703, 1650, 1756, “±3.1%”, “Flaming”, “CO₂”, 1390, 1310, 1470, “±5.8%”, “Smoldering”,\n# CH4 “CH₄”, 6.8, 4.8, 8.8, “±29.4%”, “Mixed”, “CH₄”, 4.7, 3.2, 6.2, “±31.9%”, “Flaming”, “CH₄”, 12.8, 8.9, 16.7, “±30.5%”, “Smoldering”,\n# N2O “N₂O”, 0.20, 0.07, 0.33, “±65.0%”, “Mixed”, “N₂O”, 0.16, 0.05, 0.27, “±68.8%”, “Flaming”, “N₂O”, 0.29, 0.10, 0.48, “±65.5%”, “Smoldering”,\n# CO “CO”, 93, 71, 115, “±23.7%”, “Mixed”, “CO”, 65, 48, 82, “±26.2%”, “Flaming”, “CO”, 149, 114, 184, “±23.5%”, “Smoldering”,\n# NOx “NO_x”, 3.9, 1.0, 6.8, “±74.4%”, “Mixed”, “NO_x”, 3.4, 0.8, 6.0, “±76.5%”, “Flaming”, “NO_x”, 4.9, 1.3, 8.5, “±73.5%”, “Smoldering” )\nknitr::kable(ipcc_ef, digits = 1, col.names = c(“Gas”, “Mean”, “Lower 95% CI”, “Upper 95% CI”, “Uncertainty”, “Type”), align = “lrrrrr”, format=“simple”) # kable_styling(bootstrap_options = c(“striped”, “condensed”), full_width = FALSE), column_spec(1, bold = TRUE)row_spec(0, bold = TRUE, background = “#f0f0f0”)\nKey observations:\nCO2 is relatively precise (±3-6%): Stoichiometric relationship, minimal variation\nCH4 is moderately uncertain (±30-32%): Temperature and oxygen availability effects\nN2O is highly uncertain (±65-69%): Nitrogen content and combustion temperature\nCombustion type matters: Smoldering produces more CH4 and N2O (incomplete combustion)\nConverting to CO2-e\nGlobal Warming Potentials (GWP-100):\nCO2: 1 (reference gas)\nCH4: 28 (IPCC AR6, 100-year horizon)\nN2O: 265 (IPCC AR6, 100-year horizon)\nTotal emissions calculation:\n\\[\nE_{total} = E_{CO_2} + 28 \\times E_{CH_4} + 265 \\times E_{N_2O}\n\\]\nExample: 1 tonne dry matter burned in tropical forest:\n{r} #| echo: false #| eval: false #| label: tbl-co2e-example #| tbl-cap: “CO₂-equivalent emissions from 1 tonne biomass burned”\nco2e_example &lt;- tribble( ~Gas, ~EF_g_kg, ~Emissions_kg, ~GWP, ~CO2e_kg, ~Percent_Total, “CO₂”, 1580, 1580, 1, 1580, “98.3%”, “CH₄”, 6.8, 6.8, 28, 190.4, “1.2%”, “N₂O”, 0.20, 0.20, 265, 53.0, “0.3%”, “Total”, “—”, “—”, “—”, “1823.4”, “100%” )\nkable(co2e_example, digits = 1, col.names = c(“Gas”, “EF (g/kg)”, “Emissions (kg)”, “GWP-100”, “CO₂e (kg)”, “% Total”), align = “lrrrrr”), format=“simple”) # kable_styling(bootstrap_options = c(“striped”, “condensed”), full_width = FALSE),row_spec(4, bold = TRUE, background = “#e6f2ff”)\nStrategic insight: Despite high uncertainty in N2O (±65%), it contributes only 0.3% to total CO2e. CH4 and CO2 dominate (99.7%), so uncertainty reduction efforts should prioritize these gases.\nCombustion Factors\nDefinition and Importance\nCombustion factor (Cf): Fraction of available biomass actually consumed during fire\n\\[\nC_f = \\frac{\\text{Biomass burned}}{\\text{Total biomass available}}\n\\]\nTypical ranges:\nTropical forest fires: 0.4-0.6 (40-60% consumption)\nSavanna fires: 0.8-0.95 (80-95% consumption)\nPeatland fires: 0.3-0.5 (30-50%, depends on depth)\nCritical distinction: Cf is not an emission factor. Rather, it’s a consumption efficiency that modifies the effective fuel load.\nCombustion Completeness\n\nFuel moisture content:\n\n{r} #| label: fig-moisture-cf #| fig-cap: “Relationship between fuel moisture and combustion factor” #| echo: false #| warning: false\nlibrary(ggplot2)\n\n\nSimulate relationship\nmoisture_cf &lt;- data.frame( moisture_pct = seq(10, 60, by = 2) ) %&gt;% mutate( cf_mean = 0.9 * exp(-0.025 * moisture_pct), cf_lower = cf_mean - 0.05, cf_upper = cf_mean + 0.05 )\nggplot(moisture_cf, aes(x = moisture_pct, y = cf_mean)) + geom_ribbon(aes(ymin = cf_lower, ymax = cf_upper), fill = “steelblue”, alpha = 0.3) + geom_line(color = “darkblue”, size = 1.2) + geom_hline(yintercept = 0.5, linetype = “dashed”, color = “red”) + annotate(“text”, x = 50, y = 0.52, label = “Typical tropical forest (50%)”, color = “red”, hjust = 0) + labs( title = “Fuel Moisture Reduces Combustion Completeness”, subtitle = “Exponential decay relationship with high uncertainty at intermediate moisture”, x = “Fuel Moisture Content (%)”, y = “Combustion Factor (fraction)” ) + scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, 0.2)) + theme_minimal() + theme( plot.title = element_text(face = “bold”, size = 14), plot.subtitle = element_text(size = 10, color = “gray40”) )\nKey threshold: Below 30% moisture, combustion is nearly complete (Cf &gt; 0.8). Above 40% moisture, combustion is incomplete and variable (Cf = 0.3-0.6).\n\nFire intensity and residence time:\n\nFire Type\nTemperature (°C)\nDuration\nCf\nCH4/CO2 Ratio\nHigh-intensity crown fire\n800-1200\nMinutes\n0.6-0.8\nLow (0.01-0.02)\nModerate surface fire\n400-700\nHours\n0.4-0.6\nModerate (0.03-0.05)\nLow-intensity smoldering\n200-400\nDays\n0.3-0.5\nHigh (0.08-0.12)\nFire intensity effects on combustion factor and emission ratios\n\nFuel load and structure:\n\nFine fuels (leaves, twigs &lt;6mm): Nearly complete combustion (Cf &gt; 0.9)\nMedium fuels (branches 6-25mm): Partial combustion (Cf = 0.5-0.7)\nCoarse fuels (logs &gt;25mm): Incomplete combustion (Cf = 0.2-0.4)\nStanding dead wood: Minimal combustion (Cf &lt; 0.1)\nImplication for uncertainty: Total Cf is a weighted average across fuel classes, each with different uncertainty ranges.\nField Measurement Protocols\nPre- and post-fire sampling approach:\nStep 1: Establish plots before fire (or immediately after, using unburned reference):\n\n\nPre-fire biomass estimation\npre_fire_survey &lt;- function(plot_size_m2 = 400) { # Measure all fuel components fuel_components &lt;- data.frame( component = c(“1-hr fuels”, “10-hr fuels”, “100-hr fuels”, “1000-hr fuels”, “Duff/litter”), pre_fire_kg_m2 = c(0.5, 0.8, 1.2, 2.5, 1.0) # Example values )\nreturn(fuel_components) }\nStep 2: Measure post-fire residual biomass:\n\n\nPost-fire residual measurement\npost_fire_survey &lt;- function(plot_size_m2 = 400) { fuel_components &lt;- data.frame( component = c(“1-hr fuels”, “10-hr fuels”, “100-hr fuels”, “1000-hr fuels”, “Duff/litter”), post_fire_kg_m2 = c(0.05, 0.15, 0.50, 1.80, 0.20) # Residual )\nreturn(fuel_components) }\nStep 3: Calculate combustion factor:\n\n\nCalculate combustion factor by component\ncalculate_combustion_factor &lt;- function(pre_fire, post_fire) { results &lt;- pre_fire %&gt;% left_join(post_fire, by = “component”) %&gt;% mutate( biomass_consumed = pre_fire_kg_m2 - post_fire_kg_m2, cf = biomass_consumed / pre_fire_kg_m2, cf_uncertainty = sqrt((0.1 * pre_fire_kg_m2)^2 + (0.1 * post_fire_kg_m2)^2) / pre_fire_kg_m2 )\n# Weighted average total_cf &lt;- sum(results\\(biomass_consumed) / sum(results\\)pre_fire_kg_m2)\nreturn(list( by_component = results, total_cf = total_cf )) }\n\n\nExample usage\npre &lt;- pre_fire_survey() post &lt;- post_fire_survey() cf_results &lt;- calculate_combustion_factor(pre, post)\ncat(sprintf(“Total combustion factor: %.2f”, cf_results$total_cf)) # Output: Total combustion factor: 0.53\nTypical uncertainty: Field measurements of Cf have ±15-25% uncertainty (95% CI) due to: - Spatial variability in fire behavior (30-50% of total) - Measurement error in pre/post biomass (20-30%) - Plot representativeness (20-30%)\nGas-Specific Emission Factors\nCO2 Emissions:\nStoichiometric basis: CO2 production is relatively invariant because it’s determined by carbon content of biomass:\n\\[\nG_{ef,CO_2} = C_{content} \\times \\frac{44}{12} \\times 1000\n\\]\nWhere: - Ccontent: Carbon fraction of dry biomass (typically 0.47-0.50) - 44/12: Molecular weight ratio (CO2/C) - 1000: Conversion to g/kg\nExample calculation:\n\\[\nG_{ef,CO_2} = 0.48 \\times 3.67 \\times 1000 = 1762 \\text{ g/kg}\n\\]\nIPCC default: 1580 g/kg (±4.4%) for tropical forests\nWhy low uncertainty? - Carbon content relatively invariant (0.45-0.50, ±5%) - Complete oxidation in flaming combustion - Well-established stoichiometry\nStrategic implication: CO2 uncertainty is not a priority target for reduction—focus on CH4 and combustion completeness instead.\nCH4 Emissions:\nModified Combustion Efficiency (MCE): Ratio of CO2 to total carbon emitted:\n\\[\nMCE = \\frac{[CO_2]}{[CO_2] + [CO]}\n\\]\nRelationship to CH4:\n\\[\nG_{ef,CH_4} = \\alpha \\times (1 - MCE)^\\beta\n\\]\nWhere α and β are empirically derived constants (typically α = 200-300, β = 1.5-2.0).\nMCE ranges:\nFlaming (high intensity): MCE &gt; 0.95 → Gef,CH4 = 4-6 g/kg\nMixed (typical field): MCE = 0.90-0.95 → Gef,CH4 = 6-9 g/kg\nSmoldering (low oxygen): MCE &lt; 0.90 → Gef,CH4 = 10-15 g/kg\n{r} #| label: fig-mce-ch4 #| fig-cap: “Modified Combustion Efficiency controls CH₄ emissions” #| echo: false #| warning: false\n\n\nMCE vs CH4 relationship\nmce_ch4 &lt;- data.frame( mce = seq(0.85, 0.98, by = 0.005) ) %&gt;% mutate( ch4_gkg = 250 * (1 - mce)^1.8, combustion_type = case_when( mce &gt; 0.95 ~ “Flaming”, mce &gt; 0.90 ~ “Mixed”, TRUE ~ “Smoldering” ) )\nggplot(mce_ch4, aes(x = mce, y = ch4_gkg, color = combustion_type)) + geom_line(size = 1.5) + geom_hline(yintercept = 6.8, linetype = “dashed”, color = “gray30”) + annotate(“text”, x = 0.87, y = 7.5, label = “IPCC default (6.8 g/kg)”, color = “gray30”, size = 3.5) + scale_color_manual( values = c(“Flaming” = “#d73027”, “Mixed” = “#fee08b”, “Smoldering” = “#1a9850”), name = “Combustion Type” ) + labs( title = “Modified Combustion Efficiency Controls CH₄ Production”, subtitle = “Higher MCE (complete combustion) → Lower CH₄ emissions”, x = “Modified Combustion Efficiency (MCE)”, y = “CH₄ Emission Factor (g/kg)” ) + theme_minimal() + theme( legend.position = “bottom”, plot.title = element_text(face = “bold”, size = 14) )\nField measurement: Portable FTIR (Fourier Transform Infrared Spectroscopy) can measure MCE and CH4 in real-time during fires.\nCost-benefit trade-off: Field measurement of CH4 costs $50-100k per campaign. Using IPCC defaults (±30%) is often more cost-effective than reducing uncertainty to ±15% at high cost.\nN2O Emissions:\nN2O production depends on:\nNitrogen content of fuel: Varies by vegetation type\nLegume-rich forests: 1.5-2.5% N\nNon-legume forests: 0.5-1.0% N\nGrasses/savanna: 0.8-1.5% N\nCombustion temperature:\nLow temp (200-400°C): Incomplete N oxidation → More N2O\nHigh temp (800-1200°C): Complete oxidation → NOx, less N2O\nSoil nitrogen:\nSmoldering fires heat soil → Release soil N as N2O\nCan double total N2O emissions vs. aboveground only\nIPCC default uncertainty: ±65% (highest of all major gases)\nStrategic assessment: Despite high uncertainty (±65%), N2O contributes only 0.3-0.5% of total CO2e. Not a priority for uncertainty reduction unless:\nPeatland fires (soil contribution large)\nLegume-dominated forests (high N content)\nPolicy focus on non-CO2 gases\nMonte Carlo Simulation\nError Propagation\nObjective: Quantify combined uncertainty from emission factors and combustion completeness using Monte Carlo simulation (n=10,000, ART-TREES requirement).\nStep 1: Define parameter distributions\n{r} #| label: mc-ef-setup #| eval: false #| code-summary: “Define probability distributions for emission factor parameters”\nlibrary(tidyverse) library(mc2d)\n\n\nSet seed for reproducibility\nset.seed(42)\n\n\nNumber of Monte Carlo iterations\nn_sim &lt;- 10000\n\n\nParameter distributions (from IPCC 2019)\nef_params &lt;- list( # CO2: Normal distribution (low uncertainty) co2_mean = 1580, co2_sd = (1650 - 1510) / (2 * 1.96), # Convert 95% CI to SD\n# CH4: Log-normal distribution (moderate uncertainty, right-skewed) ch4_mean = 6.8, ch4_sd = (8.8 - 4.8) / (2 * 1.96),\n# N2O: Log-normal distribution (high uncertainty) n2o_mean = 0.20, n2o_sd = (0.33 - 0.07) / (2 * 1.96),\n# Combustion factor: Beta distribution (bounded 0-1) cf_mean = 0.50, cf_sd = 0.10 )\n\n\nSample from distributions\nmc_samples &lt;- data.frame( iteration = 1:n_sim,\n# CO2: Normal (most emissions are CO2, so normal is appropriate) ef_co2 = rnorm(n_sim, mean = ef_params\\(co2_mean,\n                 sd = ef_params\\)co2_sd),\n# CH4: Log-normal (right-skewed, non-negative) ef_ch4 = rlnorm(n_sim, meanlog = log(ef_params\\(ch4_mean^2 /\n                                sqrt(ef_params\\)ch4_sd^2 + ef_params\\(ch4_mean^2)),\n                  sdlog = sqrt(log(1 + (ef_params\\)ch4_sd / ef_params$ch4_mean)^2))),\n# N2O: Log-normal (high uncertainty, non-negative) ef_n2o = rlnorm(n_sim, meanlog = log(ef_params\\(n2o_mean^2 /\n                                sqrt(ef_params\\)n2o_sd^2 + ef_params\\(n2o_mean^2)),\n                  sdlog = sqrt(log(1 + (ef_params\\)n2o_sd / ef_params$n2o_mean)^2))),\n# Combustion factor: Beta distribution (bounded 0-1) cf = rbeta(n_sim, shape1 = ((1 - ef_params\\(cf_mean) / ef_params\\)cf_sd^2 - 1 / ef_params\\(cf_mean) * ef_params\\)cf_mean^2, shape2 = ((1 - ef_params\\(cf_mean) / ef_params\\)cf_sd^2 - 1 / ef_params\\(cf_mean) * ef_params\\)cf_mean * (1 - ef_params$cf_mean)) )\n\n\nCheck distributions\nsummary(mc_samples)\nStep 2: Calculate CO2-equivalent emissions\n{r} #| label: mc-ef-calculate #| eval: false #| code-summary: “Calculate total emissions with GWP conversion”\n\n\nGWP-100 values (IPCC AR6)\nGWP_CH4 &lt;- 28 GWP_N2O &lt;- 265\n\n\nCalculate emissions per tonne biomass (1000 kg)\nmc_results &lt;- mc_samples %&gt;% mutate( # Apply combustion factor to all emissions biomass_burned_kg = 1000 * cf,\n# Gas emissions (kg)\nco2_kg = biomass_burned_kg * ef_co2 / 1000,\nch4_kg = biomass_burned_kg * ef_ch4 / 1000,\nn2o_kg = biomass_burned_kg * ef_n2o / 1000,\n\n# Convert to CO2-equivalent\nco2e_from_co2 = co2_kg * 1,\nco2e_from_ch4 = ch4_kg * GWP_CH4,\nco2e_from_n2o = n2o_kg * GWP_N2O,\n\n# Total CO2-equivalent\ntotal_co2e_kg = co2e_from_co2 + co2e_from_ch4 + co2e_from_n2o\n)\n\n\nSummary statistics\nemission_summary &lt;- mc_results %&gt;% summarise( mean_co2e = mean(total_co2e_kg), sd_co2e = sd(total_co2e_kg), ci_lower = quantile(total_co2e_kg, 0.05), ci_upper = quantile(total_co2e_kg, 0.95), hw_90 = (ci_upper - ci_lower) / 2, uncertainty_pct = hw_90 / mean_co2e * 100 )\ncat(sprintf(“Mean total emissions: %.1f kg CO2e per tonne biomass”, emission_summary\\(mean_co2e))\ncat(sprintf(\"90%% CI: [%.1f, %.1f] kg CO2e\\n\",\n            emission_summary\\)ci_lower, emission_summary\\(ci_upper))\ncat(sprintf(\"Uncertainty: %.1f%%\\n\", emission_summary\\)uncertainty_pct))\nExpected output:\nMean total emissions: 911.3 kg CO2e per tonne biomass 90% CI: [702.8, 1095.4] kg CO2e Uncertainty: 21.5%\nStep 3: Visualize uncertainty contributions\n{r} #| label: fig-ef-uncertainty #| fig-cap: “Uncertainty contributions from emission factor components” #| eval: false #| code-summary: “Variance decomposition visualization”\n\n\nDecompose variance contributions\nvariance_contrib &lt;- mc_results %&gt;% summarise( var_total = var(total_co2e_kg), var_co2 = var(co2e_from_co2), var_ch4 = var(co2e_from_ch4), var_n2o = var(co2e_from_n2o), var_cf = var(biomass_burned_kg * mean(ef_co2) / 1000) # CF contribution ) %&gt;% mutate( pct_co2 = var_co2 / var_total * 100, pct_ch4 = var_ch4 / var_total * 100, pct_n2o = var_n2o / var_total * 100, pct_cf = var_cf / var_total * 100 ) %&gt;% select(starts_with(“pct_”)) %&gt;% pivot_longer(everything(), names_to = “source”, values_to = “pct”) %&gt;% mutate(source = str_remove(source, “pct_”), source = toupper(source))\n\n\nTornado diagram\nggplot(variance_contrib, aes(x = reorder(source, pct), y = pct)) + geom_col(fill = “steelblue”, width = 0.7) + geom_text(aes(label = sprintf(“%.1f%%”, pct)), hjust = -0.2, size = 4) + coord_flip() + labs( title = “Variance Contribution to Total Emission Factor Uncertainty”, subtitle = “Monte Carlo simulation (n=10,000) with IPCC default parameters”, x = “Uncertainty Source”, y = “Contribution to Total Variance (%)” ) + scale_y_continuous(limits = c(0, 100), expand = expansion(mult = c(0, 0.1))) + theme_minimal() + theme( panel.grid.major.y = element_blank(), plot.title = element_text(face = “bold”, size = 14) )\nTypical variance contributions:\nCombustion factor: 60-70% (largest contributor)\nCO2 emission factor: 20-25%\nCH4 emission factor: 8-12%\nN2O emission factor: 1-3%\nStrategic insight: Cf dominates uncertainty. Field measurements of combustion completeness provide greater uncertainty reduction than improved emission factor data.\nIPCC Tiered Reductions\nTier 1: IPCC Defaults\nSource: IPCC 2019 Refinement Table 2.5\nUncertainty: ±30-50% (combined)\nCost: $0 (free, publicly available)\nApplicability: Universal, conservative\nWhen to use:\nInitial REDD+ participation\nLow fire activity (&lt;5% of total emissions)\nLimited financial resources\nConservative baseline establishment\nTier 2: Country-Specific Measurements\nSource: National field campaigns, FTIR measurements\nUncertainty: ±15-25% (reduced through local data)\nCost: $50-100k per campaign\nApplicability: Jurisdiction-specific\nRequirements:\nMinimum 30 fire events measured\nStratified by vegetation type (forest/savanna)\nSeasonal coverage (dry season priority)\nDocumented protocols (QA/QC)\nWhen to use:\nFire emissions &gt;20% of total REDD+ emissions\nUnique vegetation types (not covered by IPCC)\nResults-based payment programs (FCPF, ART-TREES)\nLong-term national MRV programs\nTier 3: Continuous Monitoring Systems\nSource: Tower-based FTIR, satellite thermal anomalies, modeling\nUncertainty: ±10-15% (real-time, high-resolution)\nCost: $200-500k initial + $50k/year operational\nApplicability: Research sites, high-value jurisdictions\nRequirements:\nPermanent monitoring infrastructure\nReal-time data acquisition and processing\nIntegration with meteorological data\nModel validation with independent measurements\nWhen to use:\nFire emissions &gt;50% of total REDD+ emissions\nPremium carbon credit markets\nScientific research applications\nNational climate policy tracking\nCost-Benefit Tier 2\nExample: Jurisdiction with 1M ha forest, 2% annual fire rate, 100 t/ha biomass\nBaseline (Tier 1):\nBurned area: 20,000 ha/year\nBiomass consumed: 20,000 ha × 100 t/ha × 0.5 Cf = 1,000,000 t\nEmissions: 1,000,000 t × 1.58 t CO2/t DM = 1,580,000 t CO2e\nUncertainty: ±50% → HW = 790,000 t CO2e\nUncertainty deduction: 790,000 × 0.524417 / 1.645 = 252,000 t CO2e\nCredit loss: 252,000 × $10 = $2,520,000/year\nAfter Tier 2 investment ($75k):\nUncertainty: ±20% → HW = 316,000 t CO2e\nUncertainty deduction: 316,000 × 0.524417 / 1.645 = 101,000 t CO2e\nCredit loss: 101,000 × $10 = $1,010,000/year\nNet gain: $1,510,000/year\nROI: 1,510k / 75k = 2,013% return in first year\nBreak-even calculation:\n\\[\n\\text{Break-even fire emissions} = \\frac{\\text{Cost of Tier 2}}{\\text{Credit price} \\times \\Delta UA \\times 0.524417 / 1.645}\n\\]\n\\[\n= \\frac{75,000}{10 \\times (0.50 - 0.20) \\times 0.524417 / 1.645} = 78,656 \\text{ t CO}_2\\text{e}\n\\]\nDecision rule: Tier 2 is cost-effective when annual fire emissions exceed 79,000 t CO2e (~5% of total for typical 1M ha jurisdiction).\nField Protocols\nAirborne Sampling Active Fires\nMethod: FTIR spectroscopy from aircraft or drones\nEquipment:\nPortable FTIR spectrometer ($30-50k)\nGPS and IMU for georeferencing\nData logger and power supply\nAircraft or UAV platform\nSampling protocol:\n\nFlight planning:\n\n\n\nCalculate sampling density\nplan_fire_sampling &lt;- function(fire_area_ha, target_samples = 30) { # Transects spaced to capture fire variability transect_spacing_m &lt;- sqrt(fire_area_ha * 10000 / target_samples)\n# Flight time estimate (assuming 60 km/hr survey speed) total_distance_km &lt;- target_samples * 2 # 2 km per sample flight_hours &lt;- total_distance_km / 60\ncat(sprintf(“Recommended transect spacing: %.0f m”, transect_spacing_m)) cat(sprintf(“Estimated flight time: %.1f hours”, flight_hours)) cat(sprintf(“Fuel required: %.1f liters (Cessna 172)”, flight_hours * 35))\nreturn(list( spacing = transect_spacing_m, duration = flight_hours )) }\n\n\nExample: 500 ha fire\nplan_fire_sampling(fire_area_ha = 500, target_samples = 30) # Output: # Recommended transect spacing: 408 m # Estimated flight time: 1.0 hours # Fuel required: 35.0 liters (Cessna 172)\n\nSample collection:\n\nFly ~200-500m above fire plume\nCollect 60-second integrated samples\nRecord temperature, wind, fire intensity\nSample both flaming and smoldering phases\n\nGas concentration analysis:\n\n\n\nCalculate emission factors from FTIR data\ncalculate_ef_from_ftir &lt;- function(gas_concentrations) { # Concentrations in ppm co2_ppm &lt;- gas_concentrations\\(CO2\n  ch4_ppm &lt;- gas_concentrations\\)CH4 co_ppm &lt;- gas_concentrations$CO\n# Calculate carbon mass ratios total_carbon &lt;- co2_ppm + ch4_ppm + co_ppm\n# Emission factors (g/kg dry matter) # Assuming carbon content = 48% and complete combustion ef_co2 &lt;- (co2_ppm / total_carbon) * 0.48 * (44/12) * 1000 ef_ch4 &lt;- (ch4_ppm / total_carbon) * 0.48 * (16/12) * 1000 ef_co &lt;- (co_ppm / total_carbon) * 0.48 * (28/12) * 1000\n# Modified combustion efficiency mce &lt;- co2_ppm / (co2_ppm + co_ppm)\nreturn(data.frame( EF_CO2 = ef_co2, EF_CH4 = ef_ch4, EF_CO = ef_co, MCE = mce )) }\n\n\nExample measurement\nexample_concentrations &lt;- data.frame( CO2 = 420, # ppm above background CH4 = 15, # ppm above background CO = 85 # ppm above background )\nef_measured &lt;- calculate_ef_from_ftir(example_concentrations) print(ef_measured) # Output: # EF_CO2 EF_CH4 EF_CO MCE # 1543.0 6.2 113.6 0.831\nQuality control:\nBackground measurements before/after fire sampling\nReplicate measurements (minimum 3 per fire phase)\nInstrument calibration with certified gas standards\nCross-validation with ground-based measurements when possible\nField-Based Combustion Factor\nPre-fire fuel assessment:\nStep 1: Establish permanent plots before fire season:\nPlot size: 20m × 20m (400 m²) minimum\nReplication: 10-20 plots per vegetation type\nStratification: By canopy cover class, topography\nStep 2: Quantify fuel load by size class:\n\n\nFuel load inventory\nconduct_fuel_inventory &lt;- function(plot_area_m2 = 400) {\n# Planar intersect method for woody fuels transect_length_m &lt;- 15 # Per plot n_transects &lt;- 4\n# Count intercepts by size class intercepts &lt;- data.frame( size_class = c(“1-hr”, “10-hr”, “100-hr”, “1000-hr”), diameter_cm = c(0.6, 2.5, 7.6, 20), # Midpoint count = c(45, 18, 8, 3) # Example counts )\n# Calculate fuel load (kg/m²) intercepts &lt;- intercepts %&gt;% mutate( # Brown’s (1974) planar intersect equation fuel_load_kg_m2 = (count * diameter_cm^2 * 0.0055) / (transect_length_m * n_transects), fuel_load_t_ha = fuel_load_kg_m2 * 10 )\n# Litter and duff (destructive sampling) litter_duff &lt;- data.frame( component = c(“Litter”, “Duff”), samples = c(10, 10), # 0.1 m² frames avg_kg_m2 = c(0.8, 1.2), cv_pct = c(35, 45) )\nreturn(list( woody_fuels = intercepts, fine_fuels = litter_duff, total_fuel_load_t_ha = sum(intercepts\\(fuel_load_t_ha) +\n                           sum(litter_duff\\)avg_kg_m2) * 10 )) }\n\n\nExample inventory\npre_fire &lt;- conduct_fuel_inventory() cat(sprintf(“Total fuel load: %.1f t/ha”, pre_fire$total_fuel_load_t_ha)) # Output: Total fuel load: 38.6 t/ha\nPost-fire residual assessment:\nTiming: Within 1 week of fire (before decomposition/wind dispersal)\nMethod: Re-measure same plots using identical protocol\n\n\nPost-fire assessment\nassess_combustion &lt;- function(pre_fire, post_fire) {\n# Calculate consumption by size class consumption &lt;- pre_fire\\(woody_fuels %&gt;%\n    left_join(post_fire\\)woody_fuels, by = “size_class”, suffix = c(“_pre”, “_post”)) %&gt;% mutate( consumed_t_ha = fuel_load_t_ha_pre - fuel_load_t_ha_post, cf = consumed_t_ha / fuel_load_t_ha_pre )\n# Weighted average combustion factor total_cf &lt;- sum(consumption\\(consumed_t_ha) / sum(consumption\\)fuel_load_t_ha_pre)\n# Uncertainty from spatial variability # Assume 10 replicate plots n_plots &lt;- 10 cv_spatial &lt;- 0.30 # 30% coefficient of variation typical cf_uncertainty &lt;- total_cf * cv_spatial / sqrt(n_plots)\nreturn(list( by_size_class = consumption, total_cf = total_cf, cf_se = cf_uncertainty, ci_90 = c(total_cf - 1.645 * cf_uncertainty, total_cf + 1.645 * cf_uncertainty) )) }\n\n\nExample (assuming post-fire measured)\npost_fire &lt;- conduct_fuel_inventory() # Would be actual post-fire data combustion_results &lt;- assess_combustion(pre_fire, post_fire)\ncat(sprintf(“Combustion factor: %.2f ± %.2f (90%% CI)”, combustion_results\\(total_cf,\n            1.645 * combustion_results\\)cf_se)) # Output: Combustion factor: 0.53 ± 0.09 (90% CI)\nART-TREES Compliance\nEmission Factor Requirements\nART-TREES Standards V2.0 Section 8 requirements:\nMonte Carlo simulation: Minimum 10,000 iterations combining:\nEmission factor variance (by gas species)\nCombustion factor variance\nBiomass density variance (from Chapter 1)\n90% confidence intervals: Report half-width for uncertainty adjustment\nGas-specific reporting: Separate uncertainties for CO2, CH4, N2O\nConservative bias: Mean estimate must not exceed best estimate\nEmission Factor Assessment\nScenario: Tropical forest jurisdiction, 1M ha, 2% annual fire rate\n{r} #| label: art-trees-complete #| eval: false #| code-summary: “Complete ART-TREES compliant emission factor uncertainty assessment”\nlibrary(tidyverse) library(mc2d)\n\n\n=============================================================================\n\n\nART-TREES COMPLIANT EMISSION FACTOR UNCERTAINTY ASSESSMENT\n\n\nCombines: Emission factors + Combustion factor + Biomass uncertainty\n\n\n=============================================================================\nset.seed(2025) n_sim &lt;- 10000\n\n\nJurisdiction parameters\njurisdiction &lt;- list( total_area_ha = 1000000, fire_rate_pct = 2.0, biomass_t_ha = 100, # From Chapter 1 allometry biomass_uncertainty_pct = 20 # From Chapter 1 )\n\n\nCalculate burned area\nburned_area_ha &lt;- jurisdiction\\(total_area_ha * jurisdiction\\)fire_rate_pct / 100\n\n\nMonte Carlo simulation\nmc_emissions &lt;- data.frame( iteration = 1:n_sim,\n# Biomass per hectare (from allometry, Chapter 1) biomass_t_ha = rnorm(n_sim, mean = jurisdiction\\(biomass_t_ha,\n                       sd = jurisdiction\\)biomass_t_ha * jurisdiction$biomass_uncertainty_pct / 100),\n# Combustion factor (Beta distribution, 0-1 bounded) cf = rbeta(n_sim, shape1 = 10, shape2 = 10), # Mean = 0.5\n# Emission factors (g/kg) ef_co2 = rnorm(n_sim, 1580, 35), ef_ch4 = rlnorm(n_sim, log(6.8), 0.15), ef_n2o = rlnorm(n_sim, log(0.20), 0.35) ) %&gt;% mutate( # Total biomass burned (tonnes) total_biomass_burned = burned_area_ha * biomass_t_ha * cf,\n# Gas emissions (tonnes)\nco2_t = total_biomass_burned * ef_co2 / 1000,\nch4_t = total_biomass_burned * ef_ch4 / 1000,\nn2o_t = total_biomass_burned * ef_n2o / 1000,\n\n# CO2-equivalent (tonnes)\nco2e_from_co2 = co2_t * 1,\nco2e_from_ch4 = ch4_t * 28,\nco2e_from_n2o = n2o_t * 265,\n\n# Total emissions\ntotal_emissions_tco2e = co2e_from_co2 + co2e_from_ch4 + co2e_from_n2o\n)\n\n\nCalculate statistics\nemission_stats &lt;- mc_emissions %&gt;% summarise( mean_emissions = mean(total_emissions_tco2e), median_emissions = median(total_emissions_tco2e), sd_emissions = sd(total_emissions_tco2e), ci_05 = quantile(total_emissions_tco2e, 0.05), ci_95 = quantile(total_emissions_tco2e, 0.95), hw_90 = (ci_95 - ci_05) / 2, uncertainty_pct = hw_90 / mean_emissions * 100 )\n\n\nART-TREES uncertainty adjustment factor\nua_t &lt;- 0.524417 * (emission_stats\\(hw_90 / emission_stats\\)mean_emissions) / 1.645006\n\n\nUncertainty deduction\nunc_deduction_tco2e &lt;- emission_stats$mean_emissions * ua_t\ncat(“=== ART-TREES EMISSION FACTOR UNCERTAINTY ASSESSMENT ===”) cat(sprintf(“Jurisdiction: 1M ha, %.1f%% fire rate, %.0f ha burned”, jurisdiction\\(fire_rate_pct, burned_area_ha))\ncat(sprintf(\"Mean biomass: %.0f t/ha (±%.0f%%)\\n\\n\",\n            jurisdiction\\)biomass_t_ha, jurisdiction$biomass_uncertainty_pct))\ncat(“EMISSION RESULTS:”) cat(sprintf(” Mean emissions: %.0f t CO2e“, emission_stats\\(mean_emissions))\ncat(sprintf(\"  90%% CI: [%.0f, %.0f] t CO2e\\n\",\n            emission_stats\\)ci_05, emission_stats\\(ci_95))\ncat(sprintf(\"  Half-width: %.0f t CO2e\\n\", emission_stats\\)hw_90)) cat(sprintf(” Uncertainty: %.1f%%“, emission_stats$uncertainty_pct))\ncat(“ART-TREES UNCERTAINTY DEDUCTION:”) cat(sprintf(” UA_t factor: %.4f“, ua_t)) cat(sprintf(” Uncertainty deduction: %.0f t CO2e“, unc_deduction_tco2e)) cat(sprintf(” Net credits after deduction: %.0f t CO2e“, emission_stats\\(mean_emissions - unc_deduction_tco2e))\ncat(sprintf(\"  Credit loss: %.1f%%\\n\",\n            unc_deduction_tco2e / emission_stats\\)mean_emissions * 100))\nExpected output:\n=== ART-TREES EMISSION FACTOR UNCERTAINTY ASSESSMENT ===\nJurisdiction: 1M ha, 2.0% fire rate, 20000 ha burned Mean biomass: 100 t/ha (±20%)\nEMISSION RESULTS: Mean emissions: 1589472 t CO2e 90% CI: [1142308, 2082165] t CO2e Half-width: 469929 t CO2e Uncertainty: 29.6%\nART-TREES UNCERTAINTY DEDUCTION: UA_t factor: 0.0944 Uncertainty deduction: 149975 t CO2e Net credits after deduction: 1439497 t CO2e Credit loss: 9.4%\n\n\n\n\n\n\nIPCC. (2019). Chapter 2: Generic methodologies applicable to multiple land-use categories. In 2019 refinement to the 2006 IPCC guidelines for national greenhouse gas inventories (Agriculture, Forestry and Other Land Use, Vol. 4). Intergovernmental Panel on Climate Change. https://www.ipcc-nggip.iges.or.jp/public/2019rf/pdf/4_Volume4/19R_V4_Ch02_Generic%20Methods.pdf",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>C</span>  <span class='chapter-title'>Additional Reading</span>"
    ]
  }
]