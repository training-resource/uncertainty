<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>3. Activity Data – REDD+ Uncertainty Training for Carbon Credit Optomization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../04-monte-carlo/index.html" rel="next">
<link href="../02-emission-factors/index.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-49a404399acb846fa9462a115fe112f4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<meta property="og:title" content="3. Activity Data – REDD+ Uncertainty Training for Carbon Credit Optomization">
<meta property="og:description" content="">
<meta property="og:image" content="index_files/figure-html/unnamed-chunk-5-1.png">
<meta property="og:site_name" content="REDD+ Uncertainty Training for Carbon Credit Optomization">
</head>
<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../03-activity-data/index.html"><span class="chapter-title">3. Activity Data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">REDD+ Uncertainty</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/training-resource/uncertainty" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-allometry/index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">1. Allometry</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02-emission-factors/index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2. Emission Factors</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-activity-data/index.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">3. Activity Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04-monte-carlo/index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">4. Monte Carlo</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references/index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../AA-Appendix/glossary-terms.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Glossary of Terms</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../AA-Appendix/additional-reading.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Additional Reading</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title"><strong>On this page</strong></h2>
   
  <ul>
<li>
<a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a>
  <ul class="collapse">
<li><a href="#environment-setup" id="toc-environment-setup" class="nav-link" data-scroll-target="#environment-setup">Environment Setup</a></li>
  </ul>
</li>
  <li><a href="#time-series-structure" id="toc-time-series-structure" class="nav-link" data-scroll-target="#time-series-structure">3.1 Time Series Structure</a></li>
  <li><a href="#assemble-data-cube" id="toc-assemble-data-cube" class="nav-link" data-scroll-target="#assemble-data-cube">3.2 Assemble Data Cube</a></li>
  <li><a href="#normalize-data-cube" id="toc-normalize-data-cube" class="nav-link" data-scroll-target="#normalize-data-cube">3.3 Normalize Data Cube</a></li>
  <li><a href="#training-data-samples" id="toc-training-data-samples" class="nav-link" data-scroll-target="#training-data-samples">3.4 Training Data Samples</a></li>
  <li><a href="#classify-data-cube" id="toc-classify-data-cube" class="nav-link" data-scroll-target="#classify-data-cube">3.5 Classify Data Cube</a></li>
  <li><a href="#probability-data-cube" id="toc-probability-data-cube" class="nav-link" data-scroll-target="#probability-data-cube">3.6 Probability Data Cube</a></li>
  <li>
<a href="#training-data-enhancements" id="toc-training-data-enhancements" class="nav-link" data-scroll-target="#training-data-enhancements">3.7 Training Data Enhancements</a>
  <ul class="collapse">
<li><a href="#hierachical-clustering" id="toc-hierachical-clustering" class="nav-link" data-scroll-target="#hierachical-clustering">Hierachical Clustering</a></li>
  <li><a href="#class-imbalances" id="toc-class-imbalances" class="nav-link" data-scroll-target="#class-imbalances">Class Imbalances</a></li>
  <li><a href="#geographic-variance" id="toc-geographic-variance" class="nav-link" data-scroll-target="#geographic-variance">Geographic Variance</a></li>
  <li><a href="#noise-filtering" id="toc-noise-filtering" class="nav-link" data-scroll-target="#noise-filtering">Noise Filtering</a></li>
  </ul>
</li>
  <li><a href="#smooth-data-cube" id="toc-smooth-data-cube" class="nav-link" data-scroll-target="#smooth-data-cube">3.8 Smooth Data Cube</a></li>
  <li><a href="#cross-validation" id="toc-cross-validation" class="nav-link" data-scroll-target="#cross-validation">3.8 Cross-Validation</a></li>
  <li><a href="#accuracy-assessment" id="toc-accuracy-assessment" class="nav-link" data-scroll-target="#accuracy-assessment">3.9 Accuracy Assessment</a></li>
  <li>
<a href="#sec-ipcc-approaches" id="toc-sec-ipcc-approaches" class="nav-link" data-scroll-target="#sec-ipcc-approaches">3.2 IPCC Land Monitoring Approaches</a>
  <ul class="collapse">
<li><a href="#sec-approach-classification" id="toc-sec-approach-classification" class="nav-link" data-scroll-target="#sec-approach-classification">Approach Classification</a></li>
  </ul>
</li>
  <li><a href="#sec-summary" id="toc-sec-summary" class="nav-link" data-scroll-target="#sec-summary">3.10 Chapter Summary</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/training-resource/uncertainty/edit/main/03-activity-data/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/training-resource/uncertainty/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-title">3. Activity Data</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="overview" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="overview">Overview</h2>
<p>Activity data (AD) represents the spatial extent and temporal dynamics of land-use change in REDD+ accounting. This chapter addresses uncertainty quantification in land cover classification, change detection, and spatial aggregation. These components typically constitute the greatest contribution to total REDD+ uncertainty <span class="citation" data-cites="ballantyne2015audit">(<a href="../references/index.html#ref-ballantyne2015audit" role="doc-biblioref">Ballantyne et al., 2015</a>)</span>.</p>
<p>The chapter is structured around a data cube framework for organizing and analyzing spatiotemporal land cover data, followed by uncertainty estimation techniques aligned with IPCC methodologies. We organize the technical content into the following components:</p>
<ol type="1">
<li>Data Cube Architecture: Spatiotemporal array structures for satellite time series</li>
<li>IPCC Monitoring Approaches: Transition matrices and spatial explicitness (Approaches 1-3)</li>
<li>Pixel-Level Uncertainty Tracking: Model residuals for spatial error mapping</li>
<li>Random Forest Optimization: Monte Carlo calibration of classification algorithms</li>
<li>Accuracy Assessment: Confusion matrices and validation metrics</li>
</ol>
<section id="environment-setup" class="level3 unnumbered"><h3 class="unnumbered anchored" data-anchor-id="environment-setup">Environment Setup</h3>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">easypackages</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/easypackages/man/packages.html">packages</a></span><span class="op">(</span></span>
<span>  <span class="st">"bslib"</span>, <span class="st">"cols4all"</span>, <span class="st">"covr"</span>, <span class="st">"cowplot"</span>, <span class="st">"dendextend"</span>, <span class="st">"digest"</span>,<span class="st">"DiagrammeR"</span>, </span>
<span>  <span class="st">"dtwclust"</span>, <span class="st">"downlit"</span>, <span class="st">"devtools"</span>, <span class="st">"e1071"</span>, <span class="st">"exactextractr"</span>,<span class="st">"elevatr"</span>, <span class="st">"FNN"</span>, </span>
<span>  <span class="st">"future"</span>, <span class="st">"forestdata"</span>,<span class="st">"gdalcubes"</span>, <span class="st">"gdalUtilities"</span>, <span class="st">"geojsonsf"</span>, <span class="st">"geos"</span>, <span class="st">"ggplot2"</span>, </span>
<span>  <span class="st">"ggstats"</span>, <span class="st">"ggspatial"</span>, <span class="st">"ggmap"</span>, <span class="st">"ggplotify"</span>, <span class="st">"ggpubr"</span>, <span class="st">"ggrepel"</span>, <span class="st">"giscoR"</span>, </span>
<span>  <span class="st">"hdf5r"</span>, <span class="st">"httr"</span>, <span class="st">"httr2"</span>, <span class="st">"htmltools"</span>, <span class="st">"jsonlite"</span>, <span class="st">"kohonen"</span>, <span class="st">"leaflet.providers"</span>, </span>
<span>  <span class="st">"leafem"</span>, <span class="st">"libgeos"</span>,<span class="st">"luz"</span>,<span class="st">"lwgeom"</span>, <span class="st">"leaflet"</span>, <span class="st">"leafgl"</span>, <span class="st">"mapedit"</span>, <span class="st">"mapview"</span>, </span>
<span>  <span class="st">"maptiles"</span>, <span class="st">"methods"</span>, <span class="st">"mgcv"</span>, <span class="st">"ncdf4"</span>, <span class="st">"nnet"</span>, <span class="st">"openxlsx"</span>, <span class="st">"parallel"</span>, <span class="st">"plotly"</span>, </span>
<span>  <span class="st">"randomForestExplainer"</span>,<span class="st">"randomForest"</span>, <span class="st">"rasterVis"</span>, <span class="st">"raster"</span>, <span class="st">"Rcpp"</span>, <span class="st">"RcppArmadillo"</span>, </span>
<span>  <span class="st">"RcppCensSpatial"</span>, <span class="st">"rayshader"</span>, <span class="st">"RcppEigen"</span>, <span class="st">"RcppParallel"</span>, <span class="st">"RColorBrewer"</span>, <span class="st">"reactable"</span>, </span>
<span>  <span class="st">"rgl"</span>, <span class="st">"rsconnect"</span>,<span class="st">"RStoolbox"</span>, <span class="st">"rts"</span>, <span class="st">"s2"</span>, <span class="st">"sf"</span>, <span class="st">"scales"</span>, <span class="st">"sits"</span>, <span class="st">"sitsdata"</span>, <span class="st">"spdep"</span>, </span>
<span>  <span class="st">"stars"</span>, <span class="st">"stringr"</span>,<span class="st">"supercells"</span>, <span class="st">"smotefamily"</span>, <span class="st">"terra"</span>, <span class="st">"testthat"</span>, <span class="st">"tidyverse"</span>, </span>
<span>  <span class="st">"tidyterra"</span>, <span class="st">"tools"</span>, <span class="st">"torch"</span>, <span class="st">"tmap"</span>, <span class="st">"tmaptools"</span>, <span class="st">"terrainr"</span>, <span class="st">"xgboost"</span>, </span>
<span>  <span class="st">"webshot"</span>, <span class="st">"webshot2"</span>,</span>
<span>  prompt <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/s2.html">sf_use_s2</a></span><span class="op">(</span>use_s2 <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr></section></section><section id="time-series-structure" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="time-series-structure">3.1 Time Series Structure</h2>
<p>Data cubes provide a structured framework for organizing and analyzing satellite imagery time series. We define data cubes as multidimensional arrays with dimensions associated with space and time, where land cover observations become “attributes” that have duration along the temporal dimension.</p>
<p>For purpose of REDD+ land monitoring, a data cube structure consists of:</p>
<ul>
<li>Spatial dimensions: Longitude (x) and latitude (y)</li>
<li>Temporal dimension: Observation dates (t)</li>
<li>Spectral dimension: Sensor bands (λ)</li>
<li>Attributes: Land cover class, uncertainty metrics, model residuals</li>
</ul>
<p>In the following sections (3.2-3.7), we demonstrate user-friendly operations from the <code>sits</code> and <code>gdalcubes</code> packages for time series workflows <span class="citation" data-cites="sits gdalcubes">(<a href="../references/index.html#ref-gdalcubes" role="doc-biblioref">Appel &amp; Pebesma, 2019a</a>; <a href="../references/index.html#ref-sits" role="doc-biblioref">Simoes et al., 2021b</a>)</span>. These tools integrate machine learning classification with data cube management and raster processing. This approach is particularly valuable for REDD+ workflows because it supports uncertainty-based optimization of both data cube architecture and classifier training <span class="citation" data-cites="appel2019demand">(<a href="../references/index.html#ref-appel2019demand" role="doc-biblioref">Appel &amp; Pebesma, 2019b</a>)</span>. Sections 3.8-3.9 then cover advanced procedures from the <code>caret</code> and <code>terra</code> packages, including cross-validation and Monte Carlo training simulations for accuracy assessment and model calibration.</p>
</section><section id="assemble-data-cube" class="level2"><h2 class="anchored" data-anchor-id="assemble-data-cube">3.2 Assemble Data Cube</h2>
<p>The <code>sits</code> package installation comes pre-loaded with an API connections<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> to ARD collections (<a href="https://ceos.org/ard/">Analysis-Ready-Data</a>) via STAC protocols (<a href="https://stacspec.org/en">SpatioTemporal Asset Catalogs</a>). This built-in component allows programmatic access to cloud-hosted imagery from AWS, Microsoft Planetary Computer, EarthData, Copernicus many other leading warehouses. However, raw ARD collections present several challenges for classification workflows:</p>
<ul>
<li>Spatial harmonization: Band-specific resolutions require harmonization to common grid avoiding edge anomalies and gaps</li>
<li>Temporal harmonization: Revisit cycles vary due to orbital geometry, platform scheduling, and atmospheric conditions</li>
<li>Cloud removal: Atmospheric interference introduces missing observations that corrupt spectral time series</li>
</ul>
<p>For REDD+ monitoring, temporal gaps create systematic underestimation of forest loss when clearing events coincide with cloud-covered periods; a known source of activity data bias requiring explicit quantification in uncertainty budgets. The <code>sits_regularize()</code> function provides wrapper to <code>gdalcubes</code> operations that transforms heterogeneous imagery into regular or normalized data cubes through coupled spatial and temporal harmonizations.</p>
<ul>
<li>Spatial harmonization reprojects all inputs to a common coordinate reference system and resamples to uniform pixel spacing. For instance, fusing Sentinel-1 SAR with Sentinel-2 optical data requires reprojection to the MGRS grid at consistent resolution (typically 10m), ensuring geometric alignment and eliminating co-registration errors that propagate into classification uncertainty.</li>
<li>Temporal harmonization establishes fixed observation intervals (16-day, monthly, seasonal) via cloud-optimized compositing. Within each interval, the algorithm ranks available scenes by cloud cover percentage, using the clearest image as reference and filling gaps from progressively cloudier acquisitions. Pixels with persistent cloud contamination are flagged as NA and gap-filled through temporal interpolation during feature extraction.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
ARD Tile Grids
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sentinel-2 acquisitions are organized according to the Military Grid Reference System (MGRS), which partitions global coverage into 60 longitudinal zones spanning 8° each. Within zones, 6° latitudinal blocks are further subdivided into 110 km × 110 km tiles with 10 km overlap to ensure seamless mosaicking. This tiling structure is critical for REDD+ monitoring systems that track forest change across administrative boundaries, as tile edges can introduce geometric discontinuities if not properly managed during data cube construction.</p>
<p>Landsat missions (4,5,7,8,9) employ the Worldwide Reference System-2 (WRS-2), which references scenes by path (descending orbital track) and row (latitudinal frame center). The WRS-2 grid comprises 233 paths globally, each containing 119 rows. All WRS-2 imagery is delivered with geometric correction to UTM projection, facilitating direct integration with ground reference data and cadastral boundaries commonly used in jurisdictional REDD+ accounting. For operational monitoring systems, understanding these tiling schemes is essential for:</p>
<ul>
<li>Stratification: Validation samples must account for tile boundaries to avoid spatial clustering</li>
<li>Co-registration: Cross-sensor fusion (Landsat-Sentinel) requires explicit handling of differing grid systems</li>
<li>Computation: Processing workflows optimized for native tile extents reduce unnecessary resampling and associated geometric errors</li>
</ul>
</div>
</div>
<p>This analysis replicates methods from <span class="citation" data-cites="simoes2021satellite">Simoes et al. (<a href="../references/index.html#ref-simoes2021satellite" role="doc-biblioref">2021a</a>)</span>, which assembles a data cube from MPC’s collection of Sentinel-2 ARD-imagery comprising a single tiled area in the state of Rondonia for the full calendar year of 2022.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> Following assmbly, we normalize raw imagery into a bi-monthly regularized cube below.</p>
<p><em>Caution: This code cell requires longer runtime (~12 mins).</em></p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create data cube from Microsoft Planetary Computer ARD</span></span>
<span><span class="va">cube_s2_raw</span> <span class="op">&lt;-</span> <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_cube.html">sits_cube</a></span><span class="op">(</span></span>
<span>  source            <span class="op">=</span> <span class="st">"MPC"</span>,</span>
<span>  collection    <span class="op">=</span> <span class="st">"SENTINEL-2-L2A"</span>,</span>
<span>  tiles             <span class="op">=</span> <span class="st">"20LMR"</span>,</span>
<span>  bands             <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"B02"</span>, <span class="st">"B03"</span>, <span class="st">"B04"</span>, <span class="st">"B05"</span>, <span class="st">"B06"</span>, <span class="st">"B07"</span>, <span class="st">"B08"</span>, <span class="st">"B8A"</span>, <span class="st">"B11"</span>, <span class="st">"B12"</span>, <span class="st">"CLOUD"</span><span class="op">)</span>,</span>
<span>  start_date    <span class="op">=</span> <span class="st">"2022-01-01"</span>,</span>
<span>  end_date      <span class="op">=</span> <span class="st">"2022-12-31"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Check timelines of assembled tiles</span></span>
<span><span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_timeline.html">sits_timeline</a></span><span class="op">(</span><span class="va">cube_s2_raw</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="normalize-data-cube" class="level2"><h2 class="anchored" data-anchor-id="normalize-data-cube">3.3 Normalize Data Cube</h2>
<p>Although default <code>sits</code> operations assemble cubes in the cloud, increased temporal and spatial extents and finer resolutions often require signficant processing times. Especially with larger data cube operations, we recommend assembling data cubes in the cloud and downloading copies of the cube imagery to your drive before normalizing imagery into a regular cube from the local directory of downloads. This speeds up operations and avoids network interruptions or queue lags.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Copy cube to local files</span></span>
<span><span class="va">cube_s2_local</span> <span class="op">&lt;-</span> <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_cube_copy.html">sits_cube_copy</a></span><span class="op">(</span></span>
<span>  cube              <span class="op">=</span> <span class="va">cube_s2_raw</span>,</span>
<span>  output_dir    <span class="op">=</span> <span class="st">"./assets/images/raw/"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Normalize cube from local files</span></span>
<span><span class="va">cube_s2_reg</span> <span class="op">&lt;-</span> <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_regularize.html">sits_regularize</a></span><span class="op">(</span></span>
<span>    cube                <span class="op">=</span> <span class="va">cube_s2_local</span>,</span>
<span>    output_dir  <span class="op">=</span> <span class="st">"./assets/images/reg/"</span>,</span>
<span>    res                 <span class="op">=</span> <span class="fl">40</span>,</span>
<span>    period      <span class="op">=</span> <span class="st">"P16D"</span>,</span>
<span>    multicores  <span class="op">=</span> <span class="fl">6</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute spectral index bands for cube</span></span>
<span><span class="va">cube_s2_reg</span> <span class="op">&lt;-</span> <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_apply.html">sits_apply</a></span><span class="op">(</span></span>
<span>    data                <span class="op">=</span> <span class="va">cube_s2_reg</span>,</span>
<span>    NDVI                <span class="op">=</span> <span class="op">(</span><span class="va">B08</span> <span class="op">-</span> <span class="va">B04</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">B08</span> <span class="op">+</span> <span class="va">B04</span><span class="op">)</span>,</span>
<span>  output_dir    <span class="op">=</span> <span class="st">"./assets/images/reg/"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cube_s2_reg</span> <span class="op">&lt;-</span> <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_apply.html">sits_apply</a></span><span class="op">(</span></span>
<span>    data                <span class="op">=</span> <span class="va">cube_s2_reg</span>,</span>
<span>    NBR                 <span class="op">=</span> <span class="op">(</span><span class="va">B08</span> <span class="op">-</span> <span class="va">B12</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">B08</span> <span class="op">+</span> <span class="va">B12</span><span class="op">)</span>,</span>
<span>  output_dir    <span class="op">=</span> <span class="st">"./assets/images/reg/"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cube_s2_reg</span> <span class="op">&lt;-</span> <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_apply.html">sits_apply</a></span><span class="op">(</span></span>
<span>    data                <span class="op">=</span> <span class="va">cube_s2_reg</span>,</span>
<span>    EVI                 <span class="op">=</span> <span class="fl">2.5</span> <span class="op">*</span> <span class="op">(</span><span class="va">B08</span> <span class="op">-</span> <span class="va">B04</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="op">(</span><span class="va">B08</span> <span class="op">+</span> <span class="fl">6.0</span> <span class="op">*</span> <span class="va">B04</span> <span class="op">-</span> <span class="fl">7.5</span> <span class="op">*</span> <span class="va">B02</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1.0</span><span class="op">)</span>,</span>
<span>  output_dir    <span class="op">=</span> <span class="st">"./assets/images/reg/"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check cube structure</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">cube_s2_reg</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot single-date RGB image</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cube_s2_reg</span>, red <span class="op">=</span> <span class="st">"B11"</span>, green <span class="op">=</span> <span class="st">"B8A"</span>, blue <span class="op">=</span> <span class="st">"B02"</span>, date <span class="op">=</span> <span class="st">"2022-07-16"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<pre><code>NA 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |======                                                                |   9%
  |                                                                            
  |=========                                                             |  13%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |===============                                                       |  22%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |=================================                                     |  48%
  |                                                                            
  |=====================================                                 |  52%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |===========================================                           |  61%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |=======================================================               |  78%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |=============================================================         |  87%
  |                                                                            
  |================================================================      |  91%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |======================================================================| 100%
NA Rows: 1
NA Columns: 11
NA $ source     &lt;chr&gt; "MPC"
NA $ collection &lt;chr&gt; "SENTINEL-2-L2A"
NA $ satellite  &lt;chr&gt; "SENTINEL-2"
NA $ sensor     &lt;chr&gt; "MSI"
NA $ tile       &lt;chr&gt; "20LMR"
NA $ xmin       &lt;dbl&gt; 399960
NA $ xmax       &lt;dbl&gt; 509760
NA $ ymin       &lt;dbl&gt; 8990200
NA $ ymax       &lt;dbl&gt; 9100000
NA $ crs        &lt;chr&gt; "PROJCRS[\"WGS 84 / UTM zone 20S\",\n    BASEGEOGCRS[\"WGS …
NA $ file_info  &lt;list&gt; [&lt;tbl_df[299 x 13]&gt;]</code></pre>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</section><section id="training-data-samples" class="level2"><h2 class="anchored" data-anchor-id="training-data-samples">3.4 Training Data Samples</h2>
<p>Training data quality directly determines classification accuracy and, consequently, activity data uncertainty. This analysis uses the <code>samples_deforestation_rondonia</code> dataset (n=6,007 signatures) distributed with the <code>sitsdata</code> package, comprising nine forest disturbance classes collected through expert visual interpretation of Sentinel-2 imagery representing deforestation events across Rondônia state in the Brazilian Amazon:</p>
<ul>
<li>
<code>Clear_Cut_Bare_Soil</code>: Post-clearing exposed soil</li>
<li>
<code>Clear_Cut_Burned_Area</code>: Burned clearing residues</li>
<li>
<code>Clear_Cut_Vegetation</code>: Regrowth or residual vegetation post-harvest</li>
<li>
<code>Forest</code>: Intact forest including <code>Mountainside_Forest</code>, <code>Riparian_Forest</code>
</li>
<li>
<code>Water</code>, <code>Wetland</code>, <code>Seasonally_Flooded</code>: Hydrological features</li>
</ul>
<p>The time series spans 2022-01-05 to 2022-12-23 at 16-day intervals, containing 10 Sentinel-2 bands (<code>B02</code>, <code>B03</code>, <code>B04</code>, <code>B05</code>, <code>B06</code>, <code>B07</code>, <code>B8A</code>, <code>B08</code>, <code>B11</code> and <code>B12</code>). Temporal validity aligns with the agricultural calendar to capture seasonal dynamics of land conversion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import Demo Training Samples</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"samples_deforestation_rondonia"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">summary</span>(samples_deforestation_rondonia)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="co"># A tibble: 9 × 3</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span>   label                 count   prop</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>                 <span class="er">&lt;</span>int<span class="sc">&gt;</span>  <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="dv">1</span> Clear_Cut_Bare_Soil     <span class="dv">944</span> <span class="fl">0.157</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="dv">2</span> Clear_Cut_Burned_Area   <span class="dv">983</span> <span class="fl">0.164</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="dv">3</span> Clear_Cut_Vegetation    <span class="dv">603</span> <span class="fl">0.100</span> </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="dv">4</span> Forest                  <span class="dv">964</span> <span class="fl">0.160</span> </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="dv">5</span> Mountainside_Forest     <span class="dv">211</span> <span class="fl">0.0351</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="dv">6</span> Riparian_Forest        <span class="dv">1247</span> <span class="fl">0.208</span> </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="dv">7</span> Seasonally_Flooded      <span class="dv">731</span> <span class="fl">0.122</span> </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="dv">8</span> Water                   <span class="dv">109</span> <span class="fl">0.0181</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="dv">9</span> Wetland                 <span class="dv">215</span> <span class="fl">0.0358</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">head</span>(samples_deforestation_rondonia)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="co"># A tibble: 6 × 7</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span>   longitude latitude start_date end_date   label               cube  time_series</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span>       <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>     <span class="er">&lt;</span>date<span class="sc">&gt;</span>     <span class="er">&lt;</span>chr<span class="sc">&gt;</span>               <span class="er">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>list<span class="sc">&gt;</span>     </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="dv">1</span>     <span class="sc">-</span><span class="fl">66.5</span>    <span class="sc">-</span><span class="fl">9.63</span> <span class="dv">2022-01-05</span> <span class="dv">2022-12-23</span> Clear_Cut_Bare_Soil SENT… <span class="sc">&lt;</span>tibble<span class="sc">&gt;</span>   </span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="dv">2</span>     <span class="sc">-</span><span class="fl">66.4</span>    <span class="sc">-</span><span class="fl">9.70</span> <span class="dv">2022-01-05</span> <span class="dv">2022-12-23</span> Clear_Cut_Bare_Soil SENT… <span class="sc">&lt;</span>tibble<span class="sc">&gt;</span>   </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="dv">3</span>     <span class="sc">-</span><span class="fl">66.4</span>    <span class="sc">-</span><span class="fl">9.81</span> <span class="dv">2022-01-05</span> <span class="dv">2022-12-23</span> Forest              SENT… <span class="sc">&lt;</span>tibble<span class="sc">&gt;</span>   </span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="dv">4</span>     <span class="sc">-</span><span class="fl">66.3</span>    <span class="sc">-</span><span class="fl">9.64</span> <span class="dv">2022-01-05</span> <span class="dv">2022-12-23</span> Clear_Cut_Bare_Soil SENT… <span class="sc">&lt;</span>tibble<span class="sc">&gt;</span>   </span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="dv">5</span>     <span class="sc">-</span><span class="fl">66.3</span>    <span class="sc">-</span><span class="fl">9.73</span> <span class="dv">2022-01-05</span> <span class="dv">2022-12-23</span> Clear_Cut_Vegetati… SENT… <span class="sc">&lt;</span>tibble<span class="sc">&gt;</span>   </span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="dv">6</span>     <span class="sc">-</span><span class="fl">66.3</span>    <span class="sc">-</span><span class="fl">9.73</span> <span class="dv">2022-01-05</span> <span class="dv">2022-12-23</span> Clear_Cut_Burned_A… SENT… <span class="sc">&lt;</span>tibble<span class="sc">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualizing class-specific temporal trajectories aids in assessing spectral separability; a key determinant of classification uncertainty. The <code>sits_patterns()</code> function fits generalized additive models (GAM) to training data, producing smoothed temporal signatures that represent idealized class behavior. We derive vegetation indices (NDVI, EVI, NBR) to enhance interpretability.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compute spectral indexes for training samples</span></span>
<span><span class="va">training_samples_with_indices</span> <span class="op">&lt;-</span> <span class="va">samples_deforestation_rondonia</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_apply.html">sits_apply</a></span><span class="op">(</span>NDVI <span class="op">=</span> <span class="op">(</span><span class="va">B08</span> <span class="op">-</span> <span class="va">B04</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">B08</span> <span class="op">+</span> <span class="va">B04</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_apply.html">sits_apply</a></span><span class="op">(</span>NBR <span class="op">=</span> <span class="op">(</span><span class="va">B08</span> <span class="op">-</span> <span class="va">B12</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">B08</span> <span class="op">+</span> <span class="va">B12</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_apply.html">sits_apply</a></span><span class="op">(</span>EVI <span class="op">=</span> <span class="fl">2.5</span> <span class="op">*</span> <span class="op">(</span><span class="va">B08</span> <span class="op">-</span> <span class="va">B04</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="op">(</span><span class="va">B08</span> <span class="op">+</span> <span class="fl">6.0</span> <span class="op">*</span> <span class="va">B04</span> <span class="op">-</span> <span class="fl">7.5</span> <span class="op">*</span> <span class="va">B02</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1.0</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Generate and plot patterns</span></span>
<span><span class="va">training_samples_indices</span> <span class="op">&lt;-</span> <span class="va">training_samples_with_indices</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_select.html">sits_select</a></span><span class="op">(</span>bands <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NDVI"</span>, <span class="st">"EVI"</span>, <span class="st">"NBR"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_patterns.html">sits_patterns</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<p>Temporal signatures conform to documented Amazonian deforestation phenology: forest clearing initiates during dry season onset (May-June), followed by burning in late dry season (August-September), evidenced by abrupt SWIR (B11) decline in <code>Clear_Cut_Burned_Area</code> signatures. Regrowth trajectories (<code>Clear_Cut_Vegetation</code>) exhibit NIR (B8A) recovery through the monitoring period. These temporal contrasts provide the spectral-temporal feature space for subsequent classification.</p>
<p>For extracting spectral signatures at known locations of ground truth points, the <code>sits_get_data()</code> function extracts band values by capturing signatures from the regularized data cube, creating a dataset suitable for training a classification model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>training_samples_derived <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_get_data</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">cube        =</span> cube_s2_reg, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">samples =</span> training_samples_with_indices)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the tibble with the first three points</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">head</span>(training_samples_derived)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="co"># A tibble: 6 × 7</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span>   longitude latitude start_date end_date   label               cube  time_series</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span>       <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span>    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>date<span class="sc">&gt;</span>     <span class="er">&lt;</span>date<span class="sc">&gt;</span>     <span class="er">&lt;</span>chr<span class="sc">&gt;</span>               <span class="er">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>list<span class="sc">&gt;</span>     </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="dv">1</span>     <span class="sc">-</span><span class="fl">63.9</span>    <span class="sc">-</span><span class="fl">8.57</span> <span class="dv">2022-01-05</span> <span class="dv">2022-12-23</span> Clear_Cut_Burned_A… SENT… <span class="sc">&lt;</span>tibble<span class="sc">&gt;</span>   </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="dv">2</span>     <span class="sc">-</span><span class="fl">63.9</span>    <span class="sc">-</span><span class="fl">8.37</span> <span class="dv">2022-01-05</span> <span class="dv">2022-12-23</span> Clear_Cut_Bare_Soil SENT… <span class="sc">&lt;</span>tibble<span class="sc">&gt;</span>   </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="dv">3</span>     <span class="sc">-</span><span class="fl">63.8</span>    <span class="sc">-</span><span class="fl">8.62</span> <span class="dv">2022-01-05</span> <span class="dv">2022-12-23</span> Water               SENT… <span class="sc">&lt;</span>tibble<span class="sc">&gt;</span>   </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="dv">4</span>     <span class="sc">-</span><span class="fl">63.8</span>    <span class="sc">-</span><span class="fl">8.59</span> <span class="dv">2022-01-05</span> <span class="dv">2022-12-23</span> Riparian_Forest     SENT… <span class="sc">&lt;</span>tibble<span class="sc">&gt;</span>   </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="dv">5</span>     <span class="sc">-</span><span class="fl">63.8</span>    <span class="sc">-</span><span class="fl">8.60</span> <span class="dv">2022-01-05</span> <span class="dv">2022-12-23</span> Wetland             SENT… <span class="sc">&lt;</span>tibble<span class="sc">&gt;</span>   </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="cn">NA</span> <span class="dv">6</span>     <span class="sc">-</span><span class="fl">63.8</span>    <span class="sc">-</span><span class="fl">8.59</span> <span class="dv">2022-01-05</span> <span class="dv">2022-12-23</span> Riparian_Forest     SENT… <span class="sc">&lt;</span>tibble<span class="sc">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr></section><section id="classify-data-cube" class="level2"><h2 class="anchored" data-anchor-id="classify-data-cube">3.5 Classify Data Cube</h2>
<p>Random Forest models provide robust baseline classifiers for activity data, balancing computational efficiency with adequate performance for Tier 2-3 REDD+ requirements. The <code>sits_train()</code> function implements parallelized Random Forest training with default hyperparameters optimized for satellite time series.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Train model using Random Forest algorithm</span></span>
<span><span class="va">model_randomForest</span> <span class="op">&lt;-</span> <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_train.html">sits_train</a></span><span class="op">(</span></span>
<span>  samples <span class="op">=</span> <span class="va">samples_deforestation_rondonia</span>,</span>
<span>  ml_method     <span class="op">=</span> <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_rfor.html">sits_rfor</a></span><span class="op">(</span></span>
<span>    num_trees <span class="op">=</span> <span class="fl">120</span>,</span>
<span>    mtry            <span class="op">=</span> <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the model results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">model_randomForest</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<p>Variable importance metrics identify which spatiotemporal features contribute most to class discrimination. For REDD+ operations, understanding feature importance supports:</p>
<ol type="1">
<li>Uncertainty attribution: High-importance features with measurement error propagate more uncertainty</li>
<li>Sensor planning: Identifies critical spectral bands for maintaining classification accuracy</li>
<li>Transfer learning: Guides feature selection when adapting models to new regions</li>
<li>Validation design: Informs stratification schemes for accuracy assessment</li>
</ol></section><section id="probability-data-cube" class="level2"><h2 class="anchored" data-anchor-id="probability-data-cube">3.6 Probability Data Cube</h2>
<p>Classification outputs are generated as probability cubes rather than discrete label maps to preserve model uncertainty information. The <code>sits_classify()</code> function applies trained models to regularized data cubes using fault-tolerant parallel processing, producing per-class probability layers that quantify model confidence at the pixel level.</p>
<p>The <code>sits</code> package implements parallel computing to minimize communication overhead, which enables multi-core systems without configuration.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="assets/images/png/activity-data-d.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Each pixel in the probability cube contains <code>n</code> probability values (where <code>n</code> = number of classes), summing to 1.0. Low maximum probability values indicate pixels with high classification uncertainty, typically occurring at class boundaries, in mixed pixels, or where spectral-temporal signatures deviate from training data. These pixel-level uncertainty metrics support subsequent:</p>
<ul>
<li>Adaptive stratification: High-uncertainty pixels receive higher validation sampling density</li>
<li>Uncertainty propagation: Probability distributions feed Monte Carlo emission simulations</li>
<li>Quality control: Spatial patterns of low confidence identify systematic classification errors</li>
<li>Temporal tracking: Probability time series detect gradual transitions missed by discrete labeling</li>
</ul>
<p>Probability cubes thus serve as the foundation for rigorous uncertainty quantification in subsequent workflow stages.</p>
</section><section id="training-data-enhancements" class="level2"><h2 class="anchored" data-anchor-id="training-data-enhancements">3.7 Training Data Enhancements</h2>
<p>Classification accuracy in REDD+ monitoring depends critically on training sample quality. Large, well-labeled datasets improve model performance regardless of algorithm choice, while noisy or mislabeled samples degrade classification accuracy and inflate activity data uncertainty <span class="citation" data-cites="maxwell2018implementation frenay2013classification">(<a href="../references/index.html#ref-frenay2013classification" role="doc-biblioref">Frénay &amp; Verleysen, 2013</a>; <a href="../references/index.html#ref-maxwell2018implementation" role="doc-biblioref">Maxwell et al., 2018</a>)</span>. This section demonstrates processing methods to identify problematic samples, reduce class imbalance, and address geographic variance before re-training models.</p>
<section id="hierachical-clustering" class="level3"><h3 class="anchored" data-anchor-id="hierachical-clustering">Hierachical Clustering</h3>
<p>We implement below two clustering approaches for evaluating training data quality: Agglomerative Hierarchical Clustering [AHC; <span class="citation" data-cites="yao2016application">Yao et al. (<a href="../references/index.html#ref-yao2016application" role="doc-biblioref">2016</a>)</span>] for datasets under 10,000 samples, and Self-Organizing Maps (SOM) for larger collections <span class="citation" data-cites="neagoe2014concurrent gonccalves2008unsupervised">(<a href="../references/index.html#ref-gonccalves2008unsupervised" role="doc-biblioref">Gonçalves et al., 2008</a>; <a href="../references/index.html#ref-neagoe2014concurrent" role="doc-biblioref">Neagoe et al., 2014</a>)</span>. AHC has computational complexity of <span class="math inline">\(\mathcal{O}(n^2)\)</span> requiring substantial memory, while SOM scales linearly, making it preferable for operational REDD+ monitoring systems.</p>
<p>Hierarchical Clustering computes dissimilarity between samples using dynamic time warping (DTW), which reliably measures differences in satellite time series <span class="citation" data-cites="Petitjean2012 Maus2016">(<a href="../references/index.html#ref-Petitjean2012" role="doc-biblioref"><strong>Petitjean2012?</strong></a>; <a href="../references/index.html#ref-Maus2016" role="doc-biblioref"><strong>Maus2016?</strong></a>)</span>. The <code>sits_cluster_dendro()</code> function generates dendrograms that reveal sample groupings and potential mislabeling:</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Cluster samples using DTW distance and Ward linkage</span></span>
<span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_cluster_dendro.html">sits_cluster_dendro</a></span><span class="op">(</span></span>
<span>    samples <span class="op">=</span> <span class="va">training_samples_with_indices</span>, </span>
<span>    bands <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NDVI"</span>, <span class="st">"EVI"</span><span class="op">)</span>,</span>
<span>    dist_method <span class="op">=</span> <span class="st">"dtw_basic"</span>,</span>
<span>    linkage <span class="op">=</span> <span class="st">"ward.D2"</span><span class="op">)</span></span>
<span>    </span>
<span><span class="co"># Examine cluster composition</span></span>
<span><span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_cluster_frequency.html">sits_cluster_frequency</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="assets/images/png/activity-data-g.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<pre><code>                           1    2    3    4    5    6    7 Total
  Clear_Cut_Bare_Soil    121    9  104  705    5    0    0   944
  Clear_Cut_Burned_Area   79    5   23  874    0    0    2   983
  Clear_Cut_Vegetation   259  164   43  103    0    0   34   603
  Forest                 174  732    5    6    0    0   47   964
  Mountainside_Forest     12  145    2    0    0    0   52   211
  Riparian_Forest         39  327   11    6    0    0  864  1247
  Seasonally_Flooded     414   94  160   25   29    0    9   731
  Water                    0    0    1    2    2  104    0   109
  Wetland                 56    1   55   19   53   31    0   215
  Total                 1154 1477  404 1740   89  135 1008  6007</code></pre>
<p>The adjusted rand index (ARI) identifies optimal cluster count <span class="citation" data-cites="rand1971objective">(<a href="../references/index.html#ref-rand1971objective" role="doc-biblioref">Rand, 1971</a>)</span>. Clusters with mixed labels indicate either:</p>
<ul>
<li>mislabeled samples requiring removal,</li>
<li>spectral confusion between classes,</li>
<li>natural variability in land cover signatures. s</li>
</ul>
<p>The <code>sits_cluster_clean()</code> function removes minority labels within clusters, retaining only dominant classes to reduce training noise.</p>
<p>Self-Organizing Maps provide efficient quality assessment for large datasets through unsupervised learning that projects high-dimensional time series onto 2D grids. The <code>sits_som_map()</code> function identifies outliers and evaluates class separability:</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Remove cluster#5 from the samples</span></span>
<span><span class="va">clusters_new</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">clusters</span>, <span class="va">cluster</span> <span class="op">!=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">clusters_clean</span> <span class="op">&lt;-</span> <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_cluster_clean.html">sits_cluster_clean</a></span><span class="op">(</span><span class="va">clusters_new</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check clusters samples frequency</span></span>
<span><span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_cluster_frequency.html">sits_cluster_frequency</a></span><span class="op">(</span><span class="va">clusters_clean</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate SOM with optimal grid dimensions</span></span>
<span><span class="va">som_map</span> <span class="op">&lt;-</span> <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_som_map.html">sits_som_map</a></span><span class="op">(</span></span>
<span>    <span class="va">training_samples_with_indices</span>, </span>
<span>  grid_xdim <span class="op">=</span> <span class="fl">10</span>, </span>
<span>  grid_ydim <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Clean samples by removing mixed neurons</span></span>
<span><span class="va">samples_clean</span> <span class="op">&lt;-</span> <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_som_clean_samples.html">sits_som_clean_samples</a></span><span class="op">(</span><span class="va">som_map</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize sample clustering &amp; class confusions</span></span>
<span><span class="va">som_eval</span> <span class="op">&lt;-</span> <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_som_evaluate_cluster.html">sits_som_evaluate_cluster</a></span><span class="op">(</span><span class="va">som_map</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">som_eval</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">som_map</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>                         1  2  3  4 Total
  Clear_Cut_Burned_Area  0  5  0  0     5
  Forest                 0  0  0  6     6
  Mountainside_Forest   12  0  2  0    14
  Total                 12  5  2  6    25</code></pre>
<div id="fig-som-a" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-som-a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<img src="assets/images/png/activity-data-h1.png" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-som-a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1
</figcaption></figure>
</div>
<p>Neurons containing multiple classes reveal spectral overlap requiring investigation. The SOM-based cleaning removes samples from mixed neurons, improving class separability while preserving within-class variability essential for generalization.</p>
</section><section id="class-imbalances" class="level3"><h3 class="anchored" data-anchor-id="class-imbalances">Class Imbalances</h3>
<p>Imbalanced training sets—where some classes have many more samples than others—bias classifiers toward over-represented classes, inflating omission errors for rare forest types. The <code>sits_reduce_imbalance()</code> function implements under-sampling and over-sampling strategies:</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Balance samples across classes</span></span>
<span><span class="va">samples_balanced</span> <span class="op">&lt;-</span> <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_reduce_imbalance.html">sits_reduce_imbalance</a></span><span class="op">(</span></span>
<span>    samples <span class="op">=</span> <span class="va">training_samples_with_indices</span>,</span>
<span>    n_samples_over <span class="op">=</span> <span class="fl">200</span>,   <span class="co"># Oversample rare classes</span></span>
<span>    n_samples_under <span class="op">=</span> <span class="fl">400</span>,  <span class="co"># Undersample common classes</span></span>
<span>    multicores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Re-evaluate using SOM clustering</span></span>
<span><span class="va">som_map_balanced</span> <span class="op">&lt;-</span> <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_som_map.html">sits_som_map</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">samples_balanced</span>,</span>
<span>    grid_xdim <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    grid_ydim <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span>    distance <span class="op">=</span> <span class="st">"dtw"</span>,</span>
<span>    rlen <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Store estimates in tibble</span></span>
<span><span class="va">som_eval_balanced</span> <span class="op">&lt;-</span> <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_som_evaluate_cluster.html">sits_som_evaluate_cluster</a></span><span class="op">(</span></span>
<span>    <span class="va">som_map_balanced</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">som_eval_balanced</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">som_map_balanced</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">samples_balanced</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-som-b" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-som-b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<img src="assets/images/png/activity-data-i1.png" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-som-b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.2
</figcaption></figure>
</div>
<pre><code># A tibble: 9 × 3
  label                 count   prop
  &lt;chr&gt;                 &lt;int&gt;  &lt;dbl&gt;
1 Clear_Cut_Bare_Soil     400 0.134 
2 Clear_Cut_Burned_Area   388 0.130 
3 Clear_Cut_Vegetation    392 0.131 
4 Forest                  400 0.134 
5 Mountainside_Forest     211 0.0707
6 Riparian_Forest         396 0.133 
7 Seasonally_Flooded      384 0.129 
8 Water                   200 0.0670
9 Wetland                 215 0.0720</code></pre>
<p>Under-sampling randomly removes samples from majority classes to match minority class frequencies, reducing computational load but discarding potentially informative data. Over-sampling uses SMOTE [Synthetic Minority Over-sampling Technique; <span class="citation" data-cites="smotefamily">Siriseriwan (<a href="../references/index.html#ref-smotefamily" role="doc-biblioref">2024</a>)</span>; <span class="citation" data-cites="DMwR">Torgo (<a href="../references/index.html#ref-DMwR" role="doc-biblioref">2010</a>)</span>] to generate synthetic samples for rare classes, improving classifier sensitivity without losing real observations. For REDD+ applications, maintaining adequate representation of degraded forest classes often requires combined strategies.</p>
</section><section id="geographic-variance" class="level3"><h3 class="anchored" data-anchor-id="geographic-variance">Geographic Variance</h3>
<p>Training samples must capture spatial variability across jurisdictions. Clustered sampling creates geographic gaps where model predictions have higher uncertainty <span class="citation" data-cites="meyer2022machine">(<a href="../references/index.html#ref-meyer2022machine" role="doc-biblioref">Meyer &amp; Pebesma, 2022</a>)</span>. The <code>sits_geo_dist()</code> function compares sample-to-sample distances against prediction-location-to-sample distances:</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Derive jurisdiction boundary</span></span>
<span><span class="va">bbox_cube</span> <span class="op">&lt;-</span> <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_bbox.html">sits_bbox</a></span><span class="op">(</span><span class="va">cube_s2_reg</span><span class="op">)</span> </span>
<span><span class="va">bbox_sf</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html">st_bbox</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">aoi</span><span class="op">$</span><span class="va">xmin</span>, </span>
<span>    ymin <span class="op">=</span> <span class="va">aoi</span><span class="op">$</span><span class="va">ymin</span>, </span>
<span>    xmax <span class="op">=</span> <span class="va">aoi</span><span class="op">$</span><span class="va">xmax</span>, </span>
<span>    ymax <span class="op">=</span> <span class="va">aoi</span><span class="op">$</span><span class="va">ymax</span><span class="op">)</span>,</span>
<span>  crs <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">aoi</span><span class="op">$</span><span class="va">crs</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert to sf </span></span>
<span><span class="va">aoi</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sfc.html">st_as_sfc</a></span><span class="op">(</span><span class="va">bbox_sf</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assess geographic coverage</span></span>
<span><span class="va">distances</span> <span class="op">&lt;-</span> <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_geo_dist.html">sits_geo_dist</a></span><span class="op">(</span></span>
<span>    <span class="va">training_samples_with_indices</span>, roi <span class="op">=</span> <span class="va">aoi</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">distances</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="assets/images/png/activity-data-j.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Mismatched distributions indicate insufficient spatial coverage. Areas with few nearby training samples will exhibit higher classification uncertainty, requiring either additional field sampling or explicit uncertainty quantification in those regions during accuracy assessment.</p>
</section><section id="noise-filtering" class="level3"><h3 class="anchored" data-anchor-id="noise-filtering">Noise Filtering</h3>
<p>Atmospheric contamination and sensor artifacts introduce noise requiring smoothing before feature extraction. The package supports Savitzky-Golay (<code>sits_sgolay()</code>) and Whittaker (<code>sits_whittaker()</code>) filters. Both methods reduce noise while preserving phenological patterns:</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Apply Whittaker filter with conservative smoothing</span></span>
<span><span class="va">samples_balanced_ndvi</span> <span class="op">&lt;-</span> <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_select.html">sits_select</a></span><span class="op">(</span></span>
<span>    <span class="va">samples_balanced</span>, bands <span class="op">=</span> <span class="st">"NDVI"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply Whitakker filter</span></span>
<span><span class="va">samples_balanced_whit</span> <span class="op">&lt;-</span> <span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_whittaker.html">sits_whittaker</a></span><span class="op">(</span></span>
<span>    <span class="va">samples_balanced_ndvi</span>, lambda <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Merge to visualize</span></span>
<span><span class="fu">sits</span><span class="fu">::</span><span class="fu"><a href="https://e-sensing.github.io/sits/reference/sits_merge.html">sits_merge</a></span><span class="op">(</span></span>
<span>    <span class="va">samples_balanced_ndvi</span>, </span>
<span>    <span class="va">samples_balanced_whit</span>,</span>
<span>    suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">".WHIT"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>::: {#fig-som-a layout-ncol=“4”, layout-nrow=“4”} <img src="assets/images/png/activity-data-k1a.png" class="img-fluid quarto-figure quarto-figure-center"><img src="assets/images/png/activity-data-k1b.png" class="img-fluid quarto-figure quarto-figure-center"><img src="assets/images/png/activity-data-k2a.png" class="img-fluid quarto-figure quarto-figure-center"><img src="assets/images/png/activity-data-k2b.png" class="img-fluid quarto-figure quarto-figure-center"><img src="assets/images/png/activity-data-k3a.png" class="img-fluid quarto-figure quarto-figure-center"><img src="assets/images/png/activity-data-k3b.png" class="img-fluid quarto-figure quarto-figure-center"><img src="assets/images/png/activity-data-k4a.png" class="img-fluid quarto-figure quarto-figure-center"><img src="assets/images/png/activity-data-k4b.png" class="img-fluid quarto-figure quarto-figure-center"><img src="assets/images/png/activity-data-k5a.png" class="img-fluid quarto-figure quarto-figure-center"><img src="assets/images/png/activity-data-k5b.png" class="img-fluid quarto-figure quarto-figure-center"><img src="assets/images/png/activity-data-k6a.png" class="img-fluid quarto-figure quarto-figure-center"><img src="assets/images/png/activity-data-k6b.png" class="img-fluid quarto-figure quarto-figure-center"><img src="assets/images/png/activity-data-k7a.png" class="img-fluid quarto-figure quarto-figure-center"><img src="assets/images/png/activity-data-k7b.png" class="img-fluid quarto-figure quarto-figure-center"><img src="assets/images/png/activity-data-k8a.png" class="img-fluid quarto-figure quarto-figure-center"><img src="assets/images/png/activity-data-k8b.png" class="img-fluid quarto-figure quarto-figure-center"> :::</p>
<p>Over-smoothing (high lambda values) eliminates legitimate phenological variation, reducing model discriminatory power. Conservative filtering (lambda ≤ 1.0) balances noise reduction with pattern preservation <span class="citation" data-cites="Atkinson2012 Zhou2016">(<a href="../references/index.html#ref-Atkinson2012" role="doc-biblioref"><strong>Atkinson2012?</strong></a>; <a href="../references/index.html#ref-Zhou2016" role="doc-biblioref"><strong>Zhou2016?</strong></a>)</span>.</p>
<p>Integration with Uncertainty Workflows: Quality-controlled training data directly reduces classification uncertainty by minimizing systematic errors from mislabeling and improving model generalization. Combined with the cross-validation procedures in Section 3.8 and accuracy assessment in Section 3.9, these enhancement methods establish a rigorous foundation for defensible activity data uncertainty quantification under ART-TREES requirements.</p>
</section></section><section id="smooth-data-cube" class="level2"><h2 class="anchored" data-anchor-id="smooth-data-cube">3.8 Smooth Data Cube</h2>
<p>Pixel-based classification inherently produces salt-and-pepper noise due to within-class spectral variability and mixed pixels. Isolated misclassified pixels (outliers surrounded by different classes) represent systematic over-fitting to training data rather than true landscape heterogeneity. For REDD+ applications, these artifacts inflate area uncertainty and complicate change detection. To address this, the <code>sits_smooth()</code> function implements Bayesian post-processing that incorporates spatial context from neighboring pixels to refine probability estimates. The smoothing process:</p>
<ol type="1">
<li>Computes spatially-weighted probability adjustments based on neighborhood composition</li>
<li>Updates pixel probabilities using Bayesian inference combining original estimates with spatial priors</li>
<li>Produces refined probability cube with reduced outlier occurrence while preserving legitimate small patches</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="assets/images/png/activity-data-e.png" class="img-fluid figure-img"></p>
<figcaption>Smoothed probability map for class <code>Forest</code>.</figcaption></figure>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Smoothing Risks
</div>
</div>
<div class="callout-body-container callout-body">
<p>Spatial smoothing affects activity data uncertainty in competing directions:</p>
<ul>
<li>Reduces random error: Eliminates isolated misclassifications that inflate variance</li>
<li>Introduces spatial bias: May smooth over legitimate small-scale heterogeneity</li>
<li>Improves validation agreement: Better alignment with typical human interpretation scales</li>
<li>Modifies probability distributions: Changes the shape of pixel-level uncertainty estimates</li>
</ul>
<p>For REDD+ reporting, smoothed probability cubes typically yield lower reported uncertainties due to reduced classification noise, but verification bodies may require documentation of smoothing parameters demonstrating methodological choices.</p>
</div>
</div>
<hr>
<p>Final classified maps are derived from smoothed probability cubes through maximum likelihood labeling: each pixel is assigned the class with highest posterior probability. The <code>sits_label_classification()</code> function performs this deterministic assignment while maintaining provenance links to underlying probability distributions.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="assets/images/png/activity-data-f.png" class="img-fluid figure-img"></p>
<figcaption>Classified cube obtained by Random Forest model.</figcaption></figure>
</div>
<p>The classified cube produced by <code>sits</code> workflows provides the activity data foundation for REDD+ accounting, but uncertainty quantification requires additional analysis beyond the discrete classification procedures. Sections 3.2-3.5 demonstrate more more advanced operations using <code>caret</code> <span class="citation" data-cites="kuhn2011caret">(<a href="../references/index.html#ref-kuhn2011caret" role="doc-biblioref">Kuhn, 2011</a>)</span>, <code>ForestToolbox</code> <span class="citation" data-cites="ForesToolboxRS">(<a href="../references/index.html#ref-ForesToolboxRS" role="doc-biblioref">Tarazona Coronel et al., 2021</a>)</span>, and <code>terra</code> packages <span class="citation" data-cites="terra-2">(<a href="../references/index.html#ref-terra-2" role="doc-biblioref">Hijmans, 2025</a>)</span> required to:</p>
<ol type="1">
<li>Extract pixel-level probability distributions for Monte Carlo sampling (Section 3.3)</li>
<li>Implement stratified validation with area-adjusted accuracy assessment (Section 3.4)</li>
<li>Calibrate Random Forest hyperparameters through iterative uncertainty minimization (Section 3.5)</li>
</ol>
<hr></section><section id="cross-validation" class="level2"><h2 class="anchored" data-anchor-id="cross-validation">3.8 Cross-Validation</h2>
</section><section id="accuracy-assessment" class="level2"><h2 class="anchored" data-anchor-id="accuracy-assessment">3.9 Accuracy Assessment</h2>
</section><section id="sec-ipcc-approaches" class="level2"><h2 class="anchored" data-anchor-id="sec-ipcc-approaches">3.2 IPCC Land Monitoring Approaches</h2>
<p>The architecture of land-use transition monitoring systems determines the complexity and uncertainty of activity data. IPCC guidelines define three hierarchical approaches that differ in spatial explicitness and data requirements.</p>
<section id="sec-approach-classification" class="level3"><h3 class="anchored" data-anchor-id="sec-approach-classification">Approach Classification</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 26%">
<col style="width: 24%">
</colgroup>
<thead><tr class="header">
<th>Approach</th>
<th>Data Requirement</th>
<th>Spatial Explicitness</th>
<th>Uncertainty</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Approach 1</td>
<td>Total areas by category</td>
<td>None (aggregated statistics)</td>
<td>Highest</td>
</tr>
<tr class="even">
<td>Approach 2</td>
<td>Transition matrices</td>
<td>Sampling-based</td>
<td>Moderate</td>
</tr>
<tr class="odd">
<td>Approach 3</td>
<td>Wall-to-wall maps</td>
<td>Spatially explicit</td>
<td>Lowest</td>
</tr>
</tbody>
</table>
<p>REDD+ Standard: Most carbon projects use Approach 3 with remote sensing classification, combining high spatial resolution with complete coverage. This approach enables:</p>
<ul>
<li>Pixel-level change detection</li>
<li>Spatial stratification for uncertainty analysis</li>
<li>Integration with degradation monitoring</li>
<li>Transparent, verifiable methodologies</li>
</ul>
<hr></section></section><section id="sec-summary" class="level2"><h2 class="anchored" data-anchor-id="sec-summary">3.10 Chapter Summary</h2>
<p>This chapter established a comprehensive framework for activity data uncertainty quantification in REDD+ monitoring systems. Key contributions include:</p>
<ol type="1">
<li>Data cube architecture: Structured approach to spatiotemporal land cover analysis</li>
<li>IPCC methodology alignment: Clear guidance on Approach 3 requirements</li>
<li>Pixel-level uncertainty tracking: Model residuals for adaptive sampling</li>
<li>Random Forest optimization: Monte Carlo calibration workflows</li>
<li>Rigorous accuracy assessment: Confusion matrices with area adjustment</li>
</ol>
<p>Activity data provides spatial extent; allometry converts extent to biomass. Combined uncertainty requires:</p>
<p><span class="math display">\[
U_{total}^2 = U_{activity}^2 + U_{allometry}^2 + 2 \times \text{Cov}(A, B)
\]</span></p>
<p>Where covariance term captures spatial correlation between classification errors and biomass estimation errors.</p>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-gdalcubes" class="csl-entry" role="listitem">
Appel, M., &amp; Pebesma, E. (2019a). <em>On-demand processing of data cubes from satellite image collections with the gdalcubes library</em>. <em>4</em>. <a href="https://doi.org/10.3390/data4030092">https://doi.org/10.3390/data4030092</a>
</div>
<div id="ref-appel2019demand" class="csl-entry" role="listitem">
Appel, M., &amp; Pebesma, E. (2019b). On-demand processing of data cubes from satellite image collections with the gdalcubes library. <em>Data</em>, <em>4</em>(3), 92.
</div>
<div id="ref-ballantyne2015audit" class="csl-entry" role="listitem">
Ballantyne, A., Andres, R., Houghton, R., Stocker, B., Wanninkhof, R., Anderegg, W., Cooper, L., DeGrandpre, M., Tans, P., Miller, J., &amp; al., et. (2015). Audit of the global carbon budget: Estimate errors and their impact on uptake uncertainty. <em>Biogeosciences (Online)</em>, <em>12</em>(8), 2565–2584.
</div>
<div id="ref-frenay2013classification" class="csl-entry" role="listitem">
Frénay, B., &amp; Verleysen, M. (2013). Classification in the presence of label noise: A survey. <em>IEEE Transactions on Neural Networks and Learning Systems</em>, <em>25</em>(5), 845–869.
</div>
<div id="ref-gonccalves2008unsupervised" class="csl-entry" role="listitem">
Gonçalves, M., Netto, M., Costa, J., &amp; Zullo Junior, J. (2008). An unsupervised method of classifying remotely sensed images using kohonen self-organizing maps and agglomerative hierarchical clustering methods. <em>International Journal of Remote Sensing</em>, <em>29</em>(11), 3171–3207.
</div>
<div id="ref-terra-2" class="csl-entry" role="listitem">
Hijmans, R. J. (2025). <em>Terra: Spatial data analysis</em>. <a href="https://CRAN.R-project.org/package=terra">https://CRAN.R-project.org/package=terra</a>
</div>
<div id="ref-ipcc2013RevisedSupplementary2014" class="csl-entry" role="listitem">
IPCC. (n.d.). <em>2013 revised supplementary methods and good practice guidance arising from the kyoto protocol</em>.
</div>
<div id="ref-ipccReportConferenceParties2012" class="csl-entry" role="listitem">
IPCC. (2012). <em>Report of the conference of the parties serving as the meeting of the parties to the kyoto protocol on its seventh session,</em>. <em>FCCC/KP/CMP/2011/10</em>(Durban Meeting November 28th to December 11th, 2011), 824.
</div>
<div id="ref-ipccChapter2Generic2019" class="csl-entry" role="listitem">
IPCC. (2019). Chapter 2: Generic methodologies applicable to multiple land-use categories. In <em>2019 refinement to the 2006 IPCC guidelines for national greenhouse gas inventories</em> (Agriculture, Forestry and Other Land Use, Vol. 4). Intergovernmental Panel on Climate Change. <a href="https://www.ipcc-nggip.iges.or.jp/public/2019rf/pdf/4_Volume4/19R_V4_Ch02_Generic%20Methods.pdf">https://www.ipcc-nggip.iges.or.jp/public/2019rf/pdf/4_Volume4/19R_V4_Ch02_Generic%20Methods.pdf</a>
</div>
<div id="ref-kuhn2011caret" class="csl-entry" role="listitem">
Kuhn, M. (2011). <em>The caret package</em>.
</div>
<div id="ref-maxwell2018implementation" class="csl-entry" role="listitem">
Maxwell, A. E., Warner, T. A., &amp; Fang, F. (2018). Implementation of machine-learning classification in remote sensing: An applied review. <em>International Journal of Remote Sensing</em>, <em>39</em>(9), 2784–2817.
</div>
<div id="ref-meyer2022machine" class="csl-entry" role="listitem">
Meyer, H., &amp; Pebesma, E. (2022). Machine learning-based global maps of ecological variables and the challenge of assessing them. <em>Nature Communications</em>, <em>13</em>(1), 2208.
</div>
<div id="ref-neagoe2014concurrent" class="csl-entry" role="listitem">
Neagoe, V.-E., Stoica, R.-M., Ciurea, A.-I., Bruzzone, L., &amp; Bovolo, F. (2014). Concurrent self-organizing maps for supervised/unsupervised change detection in remote sensing images. <em>IEEE Journal of Selected Topics in Applied Earth Observations and Remote Sensing</em>, <em>7</em>(8), 3525–3533.
</div>
<div id="ref-rand1971objective" class="csl-entry" role="listitem">
Rand, W. M. (1971). Objective criteria for the evaluation of clustering methods. <em>Journal of the American Statistical Association</em>, <em>66</em>(336), 846–850.
</div>
<div id="ref-simoes2021satellite" class="csl-entry" role="listitem">
Simoes, R., Camara, G., Queiroz, G., Souza, F., Andrade, P. R., Santos, L., Carvalho, A., &amp; Ferreira, K. (2021a). Satellite image time series analysis for big earth observation data. <em>Remote Sensing</em>, <em>13</em>(13), 2428.
</div>
<div id="ref-sits" class="csl-entry" role="listitem">
Simoes, R., Camara, G., Queiroz, G., Souza, F., Andrade, P., Santos, L., Carvalho, A., &amp; Ferreira, K. (2021b). <em>Satellite image time series analysis for big earth observation data</em>. <em>13</em>, 2428. <a href="https://doi.org/10.3390/rs13132428">https://doi.org/10.3390/rs13132428</a>
</div>
<div id="ref-smotefamily" class="csl-entry" role="listitem">
Siriseriwan, W. (2024). <em>Smotefamily: A collection of oversampling techniques for class imbalance problem based on SMOTE</em>. <a href="https://CRAN.R-project.org/package=smotefamily">https://CRAN.R-project.org/package=smotefamily</a>
</div>
<div id="ref-ForesToolboxRS" class="csl-entry" role="listitem">
Tarazona Coronel, Y., Zabala, A., Pons, X., Broquetas, A., Nowosad, J., &amp; A. Zurqani, H. (2021). <em>Fusing landsat and <span></span>SAR<span></span> data for mapping tropical deforestation through machine learning classification and the <span></span>PVts<span></span>-β non-seasonal detection approach</em>. <a href="https://doi.org/10.1080/07038992.2021.1941823">https://doi.org/10.1080/07038992.2021.1941823</a>
</div>
<div id="ref-DMwR" class="csl-entry" role="listitem">
Torgo, L. (2010). <em>Data mining with r, learning with case studies</em>. <a href="http://www.dcc.fc.up.pt/~ltorgo/DataMiningWithR">http://www.dcc.fc.up.pt/~ltorgo/DataMiningWithR</a>
</div>
<div id="ref-unfccc2010report" class="csl-entry" role="listitem">
UNFCCC, C. (2010). Report of the conference of the parties on its fifteenth session, held in copenhagen from 7 to 19 december 2009. <em>FCCC/CP/2009/11/Add. 1</em>.
</div>
<div id="ref-yao2016application" class="csl-entry" role="listitem">
Yao, W., Loffeld, O., &amp; Datcu, M. (2016). Application and evaluation of a hierarchical patch clustering method for remote sensing images. <em>IEEE Journal of Selected Topics in Applied Earth Observations and Remote Sensing</em>, <em>9</em>(6), 2279–2289.
</div>
</div>
</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1">
<p>In version 1.5.3,<code>sits</code> supports access to the following ARD image cloud providers:</p>
<ul>
<li>Amazon Web Services (AWS): Open data Sentinel-2/2A Level-2A collections for the Earth’s land surface.</li>
<li>Brazil Data Cube (BDC): Open data collections of Sentinel-2/2A, Landsat-8, CBERS-4/4A, and MOD13Q1 products for Brazil. These collections are organized as regular data cubes.</li>
<li>Copernicus Data Space Ecosystem (CDSE): Open data collections of Sentinel-1 RTC and Sentinel-2/2A images.</li>
<li>Digital Earth Africa (DEAFRICA): Open data collections of Sentinel-1 RTC, Sentinel-2/2A, Landsat-5/7/8/9 for Africa. Additional products include ALOS_PALSAR mosaics, DEM_COP_30, NDVI_ANOMALY based on Landsat data, and monthly and daily rainfall data from CHIRPS.</li>
<li>Digital Earth Australia (DEAUSTRALIA): Open data ARD collections of Sentinel-2A/2B and Landsat-5/7/8/9 images, yearly geomedians of Landsat 5/7/8 images; yearly fractional land cover from 1986 to 2024.</li>
<li>Harmonized Landsat-Sentinel (HLS): HLS, provided by NASA, is an open data collection that processes Landsat 8 and Sentinel-2 imagery to a common standard.</li>
<li>Microsoft Planetary Computer (MPC): Open data collections of Sentinel-1 GRD, Sentinel-1 RTC, Sentinel-2/2A, Landsat-4/5/7/8/9 images for the Earth’s land areas. Also supported are the Copernicus DEM-30 and MOD13Q1, MOD10A1, MOD09A1 products, and the Harmonized Landsat-Sentinel collections (HLSL30 and HLSS30).</li>
<li>Swiss Data Cube (SDC): Collection of Sentinel-2/2A and Landsat-8 images for Switzerland.</li>
<li>Terrascope: Cloud service with EO products, which includes the ESA World Cover map.</li>
<li>USGS: Landsat-4/5/7/8/9 collections available in AWS, which require access payment.</li>
</ul>
<p>In addition, <code>sits</code> supports the use of Planet monthly mosaics stored as local files. For a detailed description of the providers and collections supported by <code>sits</code>, please run <code>sits_list_collections()</code>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p>
</li>
<li id="fn2"><p>For addressing the most problematic uncertainty tasks needing longitudinal analyses of extended timelines (1984-2024), such as disaggregation of wildfire uncertainty and the inter-annual variability of natural disturbances, we recommend practicing data cube operations with Landsat imagery <span class="citation" data-cites="ipccReportConferenceParties2012 ipccChapter2Generic2019 ipcc2013RevisedSupplementary2014 unfccc2010report">(<a href="../references/index.html#ref-ipcc2013RevisedSupplementary2014" role="doc-biblioref">IPCC, n.d., p. O.9</a>; <a href="../references/index.html#ref-ipccReportConferenceParties2012" role="doc-biblioref">2012, p. 847</a>; <a href="../references/index.html#ref-ipccChapter2Generic2019" role="doc-biblioref">2019, p. 2.67</a>; <a href="../references/index.html#ref-unfccc2010report" role="doc-biblioref">UNFCCC, 2010, pp. 17–18</a>)</span>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../02-emission-factors/index.html" class="pagination-link" aria-label="2. Emission Factors">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">2. Emission Factors</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../04-monte-carlo/index.html" class="pagination-link" aria-label="4. Monte Carlo">
        <span class="nav-page-text"><span class="chapter-title">4. Monte Carlo</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb17" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "3. Activity Data"</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">  docx:</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">    reference-doc: ../references/style.docx</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: github</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="an">knitr:</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">  opts_chunk:</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co">    prefer-html: true</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co">    dev: "png"</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co">    dpi: 300</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> ../references/references.bib</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="an">csl:</span><span class="co"> ../references/apa.csl</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview {.unnumbered}</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>Activity data (AD) represents the spatial extent and temporal dynamics of land-use change in REDD+ accounting. This chapter addresses uncertainty quantification in land cover classification, change detection, and spatial aggregation. These components typically constitute the greatest contribution to total REDD+ uncertainty <span class="co">[</span><span class="ot">@ballantyne2015audit</span><span class="co">]</span>.</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>The chapter is structured around a data cube framework for organizing and analyzing spatiotemporal land cover data, followed by uncertainty estimation techniques aligned with IPCC methodologies. We organize the technical content into the following components:</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Data Cube Architecture: Spatiotemporal array structures for satellite time series</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>IPCC Monitoring Approaches: Transition matrices and spatial explicitness (Approaches 1-3)</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Pixel-Level Uncertainty Tracking: Model residuals for spatial error mapping</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Random Forest Optimization: Monte Carlo calibration of classification algorithms</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Accuracy Assessment: Confusion matrices and validation metrics</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="fu">### Environment Setup {.unnumbered}</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>easypackages<span class="sc">::</span><span class="fu">packages</span>(</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>  <span class="st">"bslib"</span>, <span class="st">"cols4all"</span>, <span class="st">"covr"</span>, <span class="st">"cowplot"</span>, <span class="st">"dendextend"</span>, <span class="st">"digest"</span>,<span class="st">"DiagrammeR"</span>, </span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dtwclust"</span>, <span class="st">"downlit"</span>, <span class="st">"devtools"</span>, <span class="st">"e1071"</span>, <span class="st">"exactextractr"</span>,<span class="st">"elevatr"</span>, <span class="st">"FNN"</span>, </span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>  <span class="st">"future"</span>, <span class="st">"forestdata"</span>,<span class="st">"gdalcubes"</span>, <span class="st">"gdalUtilities"</span>, <span class="st">"geojsonsf"</span>, <span class="st">"geos"</span>, <span class="st">"ggplot2"</span>, </span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ggstats"</span>, <span class="st">"ggspatial"</span>, <span class="st">"ggmap"</span>, <span class="st">"ggplotify"</span>, <span class="st">"ggpubr"</span>, <span class="st">"ggrepel"</span>, <span class="st">"giscoR"</span>, </span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>  <span class="st">"hdf5r"</span>, <span class="st">"httr"</span>, <span class="st">"httr2"</span>, <span class="st">"htmltools"</span>, <span class="st">"jsonlite"</span>, <span class="st">"kohonen"</span>, <span class="st">"leaflet.providers"</span>, </span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>  <span class="st">"leafem"</span>, <span class="st">"libgeos"</span>,<span class="st">"luz"</span>,<span class="st">"lwgeom"</span>, <span class="st">"leaflet"</span>, <span class="st">"leafgl"</span>, <span class="st">"mapedit"</span>, <span class="st">"mapview"</span>, </span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>  <span class="st">"maptiles"</span>, <span class="st">"methods"</span>, <span class="st">"mgcv"</span>, <span class="st">"ncdf4"</span>, <span class="st">"nnet"</span>, <span class="st">"openxlsx"</span>, <span class="st">"parallel"</span>, <span class="st">"plotly"</span>, </span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>  <span class="st">"randomForestExplainer"</span>,<span class="st">"randomForest"</span>, <span class="st">"rasterVis"</span>, <span class="st">"raster"</span>, <span class="st">"Rcpp"</span>, <span class="st">"RcppArmadillo"</span>, </span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>  <span class="st">"RcppCensSpatial"</span>, <span class="st">"rayshader"</span>, <span class="st">"RcppEigen"</span>, <span class="st">"RcppParallel"</span>, <span class="st">"RColorBrewer"</span>, <span class="st">"reactable"</span>, </span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>  <span class="st">"rgl"</span>, <span class="st">"rsconnect"</span>,<span class="st">"RStoolbox"</span>, <span class="st">"rts"</span>, <span class="st">"s2"</span>, <span class="st">"sf"</span>, <span class="st">"scales"</span>, <span class="st">"sits"</span>, <span class="st">"sitsdata"</span>, <span class="st">"spdep"</span>, </span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>  <span class="st">"stars"</span>, <span class="st">"stringr"</span>,<span class="st">"supercells"</span>, <span class="st">"smotefamily"</span>, <span class="st">"terra"</span>, <span class="st">"testthat"</span>, <span class="st">"tidyverse"</span>, </span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tidyterra"</span>, <span class="st">"tools"</span>, <span class="st">"torch"</span>, <span class="st">"tmap"</span>, <span class="st">"tmaptools"</span>, <span class="st">"terrainr"</span>, <span class="st">"xgboost"</span>, </span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>  <span class="st">"webshot"</span>, <span class="st">"webshot2"</span>,</span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>  <span class="at">prompt =</span> F)</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>sf<span class="sc">::</span><span class="fu">sf_use_s2</span>(<span class="at">use_s2 =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repos =</span> <span class="fu">c</span>(<span class="at">CRAN =</span> <span class="st">"https://cloud.r-project.org"</span>),</span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>        <span class="at">htmltools.dir.version =</span> <span class="cn">FALSE</span>, </span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>        <span class="at">htmltools.preserve.raw =</span> <span class="cn">FALSE</span></span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"ytarazona/ForesToolboxRS"</span>)</span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(ForesToolboxRS))</span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">echo =</span> <span class="cn">TRUE</span>, </span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">message =</span> <span class="cn">FALSE</span>, </span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">warning =</span> <span class="cn">FALSE</span>,</span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">error =</span> <span class="cn">FALSE</span>, </span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a>  <span class="at">comment =</span> <span class="cn">NA</span>, </span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">tidy.opts =</span> <span class="fu">list</span>(<span class="at">width.cutoff =</span> <span class="dv">60</span>)</span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.1 Time Series Structure {.unnumbered}</span></span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a>Data cubes provide a structured framework for organizing and analyzing satellite imagery time series. We define data cubes as multidimensional arrays with dimensions associated with space and time, where land cover observations become "attributes" that have duration along the temporal dimension.</span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a>For purpose of REDD+ land monitoring, a data cube structure consists of:</span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Spatial dimensions: Longitude (x) and latitude (y)</span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Temporal dimension: Observation dates (t)</span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Spectral dimension: Sensor bands (λ)</span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Attributes: Land cover class, uncertainty metrics, model residuals</span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a>In the following sections (3.2-3.7), we demonstrate user-friendly operations from the <span class="in">`sits`</span> and <span class="in">`gdalcubes`</span> packages for time series workflows <span class="co">[</span><span class="ot">@sits; @gdalcubes</span><span class="co">]</span>. These tools integrate machine learning classification with data cube management and raster processing. This approach is particularly valuable for REDD+ workflows because it supports uncertainty-based optimization of both data cube architecture and classifier training <span class="co">[</span><span class="ot">@appel2019demand</span><span class="co">]</span>. Sections 3.8-3.9 then cover advanced procedures from the <span class="in">`caret`</span> and <span class="in">`terra`</span> packages, including cross-validation and Monte Carlo training simulations for accuracy assessment and model calibration.</span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.2 Assemble Data Cube</span></span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a>The <span class="in">`sits`</span> package installation comes pre-loaded with an API connections<span class="ot">[^index-1]</span> to ARD collections (<span class="co">[</span><span class="ot">Analysis-Ready-Data</span><span class="co">](https://ceos.org/ard/)</span>) via STAC protocols (<span class="co">[</span><span class="ot">SpatioTemporal Asset Catalogs</span><span class="co">](https://stacspec.org/en)</span>). This built-in component allows programmatic access to cloud-hosted imagery from AWS, Microsoft Planetary Computer, EarthData, Copernicus many other leading warehouses. However, raw ARD collections present several challenges for classification workflows:</span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Spatial harmonization: Band-specific resolutions require harmonization to common grid avoiding edge anomalies and gaps</span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Temporal harmonization: Revisit cycles vary due to orbital geometry, platform scheduling, and atmospheric conditions</span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Cloud removal: Atmospheric interference introduces missing observations that corrupt spectral time series</span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a>For REDD+ monitoring, temporal gaps create systematic underestimation of forest loss when clearing events coincide with cloud-covered periods; a known source of activity data bias requiring explicit quantification in uncertainty budgets. The <span class="in">`sits_regularize()`</span> function provides wrapper to <span class="in">`gdalcubes`</span> operations that transforms heterogeneous imagery into regular or normalized data cubes through coupled spatial and temporal harmonizations.</span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Spatial harmonization reprojects all inputs to a common coordinate reference system and resamples to uniform pixel spacing. For instance, fusing Sentinel-1 SAR with Sentinel-2 optical data requires reprojection to the MGRS grid at consistent resolution (typically 10m), ensuring geometric alignment and eliminating co-registration errors that propagate into classification uncertainty.</span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Temporal harmonization establishes fixed observation intervals (16-day, monthly, seasonal) via cloud-optimized compositing. Within each interval, the algorithm ranks available scenes by cloud cover percentage, using the clearest image as reference and filling gaps from progressively cloudier acquisitions. Pixels with persistent cloud contamination are flagged as NA and gap-filled through temporal interpolation during feature extraction.</span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a><span class="fu">## ARD Tile Grids</span></span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a>Sentinel-2 acquisitions are organized according to the Military Grid Reference System (MGRS), which partitions global coverage into 60 longitudinal zones spanning 8° each. Within zones, 6° latitudinal blocks are further subdivided into 110 km × 110 km tiles with 10 km overlap to ensure seamless mosaicking. This tiling structure is critical for REDD+ monitoring systems that track forest change across administrative boundaries, as tile edges can introduce geometric discontinuities if not properly managed during data cube construction.</span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a>Landsat missions (4,5,7,8,9) employ the Worldwide Reference System-2 (WRS-2), which references scenes by path (descending orbital track) and row (latitudinal frame center). The WRS-2 grid comprises 233 paths globally, each containing 119 rows. All WRS-2 imagery is delivered with geometric correction to UTM projection, facilitating direct integration with ground reference data and cadastral boundaries commonly used in jurisdictional REDD+ accounting. For operational monitoring systems, understanding these tiling schemes is essential for:</span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Stratification: Validation samples must account for tile boundaries to avoid spatial clustering</span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Co-registration: Cross-sensor fusion (Landsat-Sentinel) requires explicit handling of differing grid systems</span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Computation: Processing workflows optimized for native tile extents reduce unnecessary resampling and associated geometric errors</span>
<span id="cb17-128"><a href="#cb17-128" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-129"><a href="#cb17-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a>This analysis replicates methods from @simoes2021satellite, which assembles a data cube from MPC's collection of Sentinel-2 ARD-imagery comprising a single tiled area in the state of Rondonia for the full calendar year of 2022.<span class="ot">[^index-2]</span> Following assmbly, we normalize raw imagery into a bi-monthly regularized cube below.</span>
<span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a>*Caution: This code cell requires longer runtime (\~12 mins).*</span>
<span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb17-138"><a href="#cb17-138" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data cube from Microsoft Planetary Computer ARD</span></span>
<span id="cb17-139"><a href="#cb17-139" aria-hidden="true" tabindex="-1"></a>cube_s2_raw <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_cube</span>(</span>
<span id="cb17-140"><a href="#cb17-140" aria-hidden="true" tabindex="-1"></a>  <span class="at">source            =</span> <span class="st">"MPC"</span>,</span>
<span id="cb17-141"><a href="#cb17-141" aria-hidden="true" tabindex="-1"></a>  <span class="at">collection    =</span> <span class="st">"SENTINEL-2-L2A"</span>,</span>
<span id="cb17-142"><a href="#cb17-142" aria-hidden="true" tabindex="-1"></a>  <span class="at">tiles             =</span> <span class="st">"20LMR"</span>,</span>
<span id="cb17-143"><a href="#cb17-143" aria-hidden="true" tabindex="-1"></a>  <span class="at">bands             =</span> <span class="fu">c</span>(<span class="st">"B02"</span>, <span class="st">"B03"</span>, <span class="st">"B04"</span>, <span class="st">"B05"</span>, <span class="st">"B06"</span>, <span class="st">"B07"</span>, <span class="st">"B08"</span>, <span class="st">"B8A"</span>, <span class="st">"B11"</span>, <span class="st">"B12"</span>, <span class="st">"CLOUD"</span>),</span>
<span id="cb17-144"><a href="#cb17-144" aria-hidden="true" tabindex="-1"></a>  <span class="at">start_date    =</span> <span class="st">"2022-01-01"</span>,</span>
<span id="cb17-145"><a href="#cb17-145" aria-hidden="true" tabindex="-1"></a>  <span class="at">end_date      =</span> <span class="st">"2022-12-31"</span></span>
<span id="cb17-146"><a href="#cb17-146" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-147"><a href="#cb17-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-148"><a href="#cb17-148" aria-hidden="true" tabindex="-1"></a><span class="co"># Check timelines of assembled tiles</span></span>
<span id="cb17-149"><a href="#cb17-149" aria-hidden="true" tabindex="-1"></a>sits<span class="sc">::</span><span class="fu">sits_timeline</span>(cube_s2_raw)</span>
<span id="cb17-150"><a href="#cb17-150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-151"><a href="#cb17-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-152"><a href="#cb17-152" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.3 Normalize Data Cube</span></span>
<span id="cb17-153"><a href="#cb17-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-154"><a href="#cb17-154" aria-hidden="true" tabindex="-1"></a>Although default <span class="in">`sits`</span> operations assemble cubes in the cloud, increased temporal and spatial extents and finer resolutions often require signficant processing times. Especially with larger data cube operations, we recommend assembling data cubes in the cloud and downloading copies of the cube imagery to your drive before normalizing imagery into a regular cube from the local directory of downloads. This speeds up operations and avoids network interruptions or queue lags.</span>
<span id="cb17-155"><a href="#cb17-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-158"><a href="#cb17-158" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-159"><a href="#cb17-159" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb17-160"><a href="#cb17-160" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy cube to local files</span></span>
<span id="cb17-161"><a href="#cb17-161" aria-hidden="true" tabindex="-1"></a>cube_s2_local <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_cube_copy</span>(</span>
<span id="cb17-162"><a href="#cb17-162" aria-hidden="true" tabindex="-1"></a>  <span class="at">cube              =</span> cube_s2_raw,</span>
<span id="cb17-163"><a href="#cb17-163" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_dir    =</span> <span class="st">"./assets/images/raw/"</span>)</span>
<span id="cb17-164"><a href="#cb17-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-165"><a href="#cb17-165" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize cube from local files</span></span>
<span id="cb17-166"><a href="#cb17-166" aria-hidden="true" tabindex="-1"></a>cube_s2_reg <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_regularize</span>(</span>
<span id="cb17-167"><a href="#cb17-167" aria-hidden="true" tabindex="-1"></a>    <span class="at">cube                =</span> cube_s2_local,</span>
<span id="cb17-168"><a href="#cb17-168" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_dir  =</span> <span class="st">"./assets/images/reg/"</span>,</span>
<span id="cb17-169"><a href="#cb17-169" aria-hidden="true" tabindex="-1"></a>    <span class="at">res                 =</span> <span class="dv">40</span>,</span>
<span id="cb17-170"><a href="#cb17-170" aria-hidden="true" tabindex="-1"></a>    <span class="at">period      =</span> <span class="st">"P16D"</span>,</span>
<span id="cb17-171"><a href="#cb17-171" aria-hidden="true" tabindex="-1"></a>    <span class="at">multicores  =</span> <span class="dv">6</span></span>
<span id="cb17-172"><a href="#cb17-172" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-173"><a href="#cb17-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-174"><a href="#cb17-174" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute spectral index bands for cube</span></span>
<span id="cb17-175"><a href="#cb17-175" aria-hidden="true" tabindex="-1"></a>cube_s2_reg <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_apply</span>(</span>
<span id="cb17-176"><a href="#cb17-176" aria-hidden="true" tabindex="-1"></a>    <span class="at">data                =</span> cube_s2_reg,</span>
<span id="cb17-177"><a href="#cb17-177" aria-hidden="true" tabindex="-1"></a>    <span class="at">NDVI                =</span> (B08 <span class="sc">-</span> B04)<span class="sc">/</span>(B08 <span class="sc">+</span> B04),</span>
<span id="cb17-178"><a href="#cb17-178" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_dir    =</span> <span class="st">"./assets/images/reg/"</span>)</span>
<span id="cb17-179"><a href="#cb17-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-180"><a href="#cb17-180" aria-hidden="true" tabindex="-1"></a>cube_s2_reg <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_apply</span>(</span>
<span id="cb17-181"><a href="#cb17-181" aria-hidden="true" tabindex="-1"></a>    <span class="at">data                =</span> cube_s2_reg,</span>
<span id="cb17-182"><a href="#cb17-182" aria-hidden="true" tabindex="-1"></a>    <span class="at">NBR                 =</span> (B08 <span class="sc">-</span> B12) <span class="sc">/</span> (B08 <span class="sc">+</span> B12),</span>
<span id="cb17-183"><a href="#cb17-183" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_dir    =</span> <span class="st">"./assets/images/reg/"</span>)</span>
<span id="cb17-184"><a href="#cb17-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-185"><a href="#cb17-185" aria-hidden="true" tabindex="-1"></a>cube_s2_reg <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_apply</span>(</span>
<span id="cb17-186"><a href="#cb17-186" aria-hidden="true" tabindex="-1"></a>    <span class="at">data                =</span> cube_s2_reg,</span>
<span id="cb17-187"><a href="#cb17-187" aria-hidden="true" tabindex="-1"></a>    <span class="at">EVI                 =</span> <span class="fl">2.5</span> <span class="sc">*</span> (B08 <span class="sc">-</span> B04) <span class="sc">/</span> ((B08 <span class="sc">+</span> <span class="fl">6.0</span> <span class="sc">*</span> B04 <span class="sc">-</span> <span class="fl">7.5</span> <span class="sc">*</span> B02) <span class="sc">+</span> <span class="fl">1.0</span>),</span>
<span id="cb17-188"><a href="#cb17-188" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_dir    =</span> <span class="st">"./assets/images/reg/"</span>)</span>
<span id="cb17-189"><a href="#cb17-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-190"><a href="#cb17-190" aria-hidden="true" tabindex="-1"></a><span class="co"># Check cube structure</span></span>
<span id="cb17-191"><a href="#cb17-191" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(cube_s2_reg)</span>
<span id="cb17-192"><a href="#cb17-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-193"><a href="#cb17-193" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot single-date RGB image</span></span>
<span id="cb17-194"><a href="#cb17-194" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cube_s2_reg, <span class="at">red =</span> <span class="st">"B11"</span>, <span class="at">green =</span> <span class="st">"B8A"</span>, <span class="at">blue =</span> <span class="st">"B02"</span>, <span class="at">date =</span> <span class="st">"2022-07-16"</span>)</span>
<span id="cb17-195"><a href="#cb17-195" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-196"><a href="#cb17-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-199"><a href="#cb17-199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-200"><a href="#cb17-200" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb17-201"><a href="#cb17-201" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb17-202"><a href="#cb17-202" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb17-203"><a href="#cb17-203" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb17-204"><a href="#cb17-204" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb17-205"><a href="#cb17-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-206"><a href="#cb17-206" aria-hidden="true" tabindex="-1"></a><span class="co"># Access local data cube</span></span>
<span id="cb17-207"><a href="#cb17-207" aria-hidden="true" tabindex="-1"></a>cube_s2_reg <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_cube</span>(</span>
<span id="cb17-208"><a href="#cb17-208" aria-hidden="true" tabindex="-1"></a>    <span class="at">source          =</span> <span class="st">"MPC"</span>,</span>
<span id="cb17-209"><a href="#cb17-209" aria-hidden="true" tabindex="-1"></a>  <span class="at">collection    =</span> <span class="st">"SENTINEL-2-L2A"</span>,</span>
<span id="cb17-210"><a href="#cb17-210" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_dir      =</span> <span class="st">"./assets/images/reg/"</span>)</span>
<span id="cb17-211"><a href="#cb17-211" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-212"><a href="#cb17-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-213"><a href="#cb17-213" aria-hidden="true" tabindex="-1"></a><span class="co"># Check cube structure</span></span>
<span id="cb17-214"><a href="#cb17-214" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(cube_s2_reg)</span>
<span id="cb17-215"><a href="#cb17-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-216"><a href="#cb17-216" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot one temporal instance</span></span>
<span id="cb17-217"><a href="#cb17-217" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cube_s2_reg, </span>
<span id="cb17-218"><a href="#cb17-218" aria-hidden="true" tabindex="-1"></a>         <span class="at">red =</span> <span class="st">"B11"</span>, </span>
<span id="cb17-219"><a href="#cb17-219" aria-hidden="true" tabindex="-1"></a>         <span class="at">green =</span> <span class="st">"B8A"</span>, </span>
<span id="cb17-220"><a href="#cb17-220" aria-hidden="true" tabindex="-1"></a>         <span class="at">blue =</span> <span class="st">"B02"</span>, </span>
<span id="cb17-221"><a href="#cb17-221" aria-hidden="true" tabindex="-1"></a>         <span class="at">date =</span> <span class="st">"2022-07-16"</span></span>
<span id="cb17-222"><a href="#cb17-222" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb17-223"><a href="#cb17-223" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-224"><a href="#cb17-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-227"><a href="#cb17-227" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-228"><a href="#cb17-228" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb17-229"><a href="#cb17-229" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb17-230"><a href="#cb17-230" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb17-231"><a href="#cb17-231" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb17-232"><a href="#cb17-232" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb17-233"><a href="#cb17-233" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb17-234"><a href="#cb17-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-235"><a href="#cb17-235" aria-hidden="true" tabindex="-1"></a><span class="co"># Files are also available remotely from sitsdata directory </span></span>
<span id="cb17-236"><a href="#cb17-236" aria-hidden="true" tabindex="-1"></a>data_dir <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">"extdata/Rondonia-20LMR/"</span>, <span class="at">package =</span> <span class="st">"sitsdata"</span>)</span>
<span id="cb17-237"><a href="#cb17-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-238"><a href="#cb17-238" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data cube</span></span>
<span id="cb17-239"><a href="#cb17-239" aria-hidden="true" tabindex="-1"></a>rondonia_20LMR <span class="ot">&lt;-</span> <span class="fu">sits_cube</span>(</span>
<span id="cb17-240"><a href="#cb17-240" aria-hidden="true" tabindex="-1"></a>    <span class="at">source =</span> <span class="st">"MPC"</span>,</span>
<span id="cb17-241"><a href="#cb17-241" aria-hidden="true" tabindex="-1"></a>    <span class="at">collection =</span> <span class="st">"SENTINEL-2-L2A"</span>,</span>
<span id="cb17-242"><a href="#cb17-242" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_dir =</span> data_dir</span>
<span id="cb17-243"><a href="#cb17-243" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-244"><a href="#cb17-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-245"><a href="#cb17-245" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the cube</span></span>
<span id="cb17-246"><a href="#cb17-246" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rondonia_20LMR, <span class="at">date =</span> <span class="st">"2022-07-16"</span>, <span class="at">band =</span> <span class="st">"NDVI"</span>)</span>
<span id="cb17-247"><a href="#cb17-247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-248"><a href="#cb17-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-249"><a href="#cb17-249" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.4 Training Data Samples</span></span>
<span id="cb17-250"><a href="#cb17-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-251"><a href="#cb17-251" aria-hidden="true" tabindex="-1"></a>Training data quality directly determines classification accuracy and, consequently, activity data uncertainty. This analysis uses the <span class="in">`samples_deforestation_rondonia`</span> dataset (n=6,007 signatures) distributed with the <span class="in">`sitsdata`</span> package, comprising nine forest disturbance classes collected through expert visual interpretation of Sentinel-2 imagery representing deforestation events across Rondônia state in the Brazilian Amazon:</span>
<span id="cb17-252"><a href="#cb17-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-253"><a href="#cb17-253" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`Clear_Cut_Bare_Soil`</span>: Post-clearing exposed soil</span>
<span id="cb17-254"><a href="#cb17-254" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`Clear_Cut_Burned_Area`</span>: Burned clearing residues</span>
<span id="cb17-255"><a href="#cb17-255" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`Clear_Cut_Vegetation`</span>: Regrowth or residual vegetation post-harvest</span>
<span id="cb17-256"><a href="#cb17-256" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`Forest`</span>: Intact forest including <span class="in">`Mountainside_Forest`</span>, <span class="in">`Riparian_Forest`</span></span>
<span id="cb17-257"><a href="#cb17-257" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`Water`</span>, <span class="in">`Wetland`</span>, <span class="in">`Seasonally_Flooded`</span>: Hydrological features</span>
<span id="cb17-258"><a href="#cb17-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-259"><a href="#cb17-259" aria-hidden="true" tabindex="-1"></a>The time series spans 2022-01-05 to 2022-12-23 at 16-day intervals, containing 10 Sentinel-2 bands (<span class="in">`B02`</span>, <span class="in">`B03`</span>, <span class="in">`B04`</span>, <span class="in">`B05`</span>, <span class="in">`B06`</span>, <span class="in">`B07`</span>, <span class="in">`B8A`</span>, <span class="in">`B08`</span>, <span class="in">`B11`</span> and <span class="in">`B12`</span>). Temporal validity aligns with the agricultural calendar to capture seasonal dynamics of land conversion.</span>
<span id="cb17-260"><a href="#cb17-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-263"><a href="#cb17-263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-264"><a href="#cb17-264" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb17-265"><a href="#cb17-265" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb17-266"><a href="#cb17-266" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb17-267"><a href="#cb17-267" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb17-268"><a href="#cb17-268" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb17-269"><a href="#cb17-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-270"><a href="#cb17-270" aria-hidden="true" tabindex="-1"></a><span class="co"># Import Demo Training Samples</span></span>
<span id="cb17-271"><a href="#cb17-271" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"samples_deforestation_rondonia"</span>)</span>
<span id="cb17-272"><a href="#cb17-272" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">summary</span>(samples_deforestation_rondonia)</span>
<span id="cb17-273"><a href="#cb17-273" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">head</span>(samples_deforestation_rondonia)</span>
<span id="cb17-274"><a href="#cb17-274" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-275"><a href="#cb17-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-276"><a href="#cb17-276" aria-hidden="true" tabindex="-1"></a>Visualizing class-specific temporal trajectories aids in assessing spectral separability; a key determinant of classification uncertainty. The <span class="in">`sits_patterns()`</span> function fits generalized additive models (GAM) to training data, producing smoothed temporal signatures that represent idealized class behavior. We derive vegetation indices (NDVI, EVI, NBR) to enhance interpretability.</span>
<span id="cb17-277"><a href="#cb17-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-280"><a href="#cb17-280" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-281"><a href="#cb17-281" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb17-282"><a href="#cb17-282" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb17-283"><a href="#cb17-283" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb17-284"><a href="#cb17-284" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb17-285"><a href="#cb17-285" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb17-286"><a href="#cb17-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-287"><a href="#cb17-287" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute spectral indexes for training samples</span></span>
<span id="cb17-288"><a href="#cb17-288" aria-hidden="true" tabindex="-1"></a>training_samples_with_indices <span class="ot">&lt;-</span> samples_deforestation_rondonia <span class="sc">|&gt;</span> </span>
<span id="cb17-289"><a href="#cb17-289" aria-hidden="true" tabindex="-1"></a>    sits<span class="sc">::</span><span class="fu">sits_apply</span>(<span class="at">NDVI =</span> (B08 <span class="sc">-</span> B04)<span class="sc">/</span>(B08 <span class="sc">+</span> B04)) <span class="sc">|&gt;</span> </span>
<span id="cb17-290"><a href="#cb17-290" aria-hidden="true" tabindex="-1"></a>  sits<span class="sc">::</span><span class="fu">sits_apply</span>(<span class="at">NBR =</span> (B08 <span class="sc">-</span> B12) <span class="sc">/</span> (B08 <span class="sc">+</span> B12)) <span class="sc">|&gt;</span> </span>
<span id="cb17-291"><a href="#cb17-291" aria-hidden="true" tabindex="-1"></a>  sits<span class="sc">::</span><span class="fu">sits_apply</span>(<span class="at">EVI =</span> <span class="fl">2.5</span> <span class="sc">*</span> (B08 <span class="sc">-</span> B04) <span class="sc">/</span> ((B08 <span class="sc">+</span> <span class="fl">6.0</span> <span class="sc">*</span> B04 <span class="sc">-</span> <span class="fl">7.5</span> <span class="sc">*</span> B02) <span class="sc">+</span> <span class="fl">1.0</span>)) </span>
<span id="cb17-292"><a href="#cb17-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-293"><a href="#cb17-293" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate and plot patterns</span></span>
<span id="cb17-294"><a href="#cb17-294" aria-hidden="true" tabindex="-1"></a>training_samples_indices <span class="ot">&lt;-</span> training_samples_with_indices <span class="sc">|&gt;</span> </span>
<span id="cb17-295"><a href="#cb17-295" aria-hidden="true" tabindex="-1"></a>    sits<span class="sc">::</span><span class="fu">sits_select</span>(<span class="at">bands =</span> <span class="fu">c</span>(<span class="st">"NDVI"</span>, <span class="st">"EVI"</span>, <span class="st">"NBR"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb17-296"><a href="#cb17-296" aria-hidden="true" tabindex="-1"></a>  sits<span class="sc">::</span><span class="fu">sits_patterns</span>() <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb17-297"><a href="#cb17-297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-298"><a href="#cb17-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-299"><a href="#cb17-299" aria-hidden="true" tabindex="-1"></a>Temporal signatures conform to documented Amazonian deforestation phenology: forest clearing initiates during dry season onset (May-June), followed by burning in late dry season (August-September), evidenced by abrupt SWIR (B11) decline in <span class="in">`Clear_Cut_Burned_Area`</span> signatures. Regrowth trajectories (<span class="in">`Clear_Cut_Vegetation`</span>) exhibit NIR (B8A) recovery through the monitoring period. These temporal contrasts provide the spectral-temporal feature space for subsequent classification.</span>
<span id="cb17-300"><a href="#cb17-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-301"><a href="#cb17-301" aria-hidden="true" tabindex="-1"></a>For extracting spectral signatures at known locations of ground truth points, the <span class="in">`sits_get_data()`</span> function extracts band values by capturing signatures from the regularized data cube, creating a dataset suitable for training a classification model.</span>
<span id="cb17-302"><a href="#cb17-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-305"><a href="#cb17-305" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-306"><a href="#cb17-306" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb17-307"><a href="#cb17-307" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb17-308"><a href="#cb17-308" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb17-309"><a href="#cb17-309" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb17-310"><a href="#cb17-310" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb17-311"><a href="#cb17-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-312"><a href="#cb17-312" aria-hidden="true" tabindex="-1"></a>training_samples_derived <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_get_data</span>(</span>
<span id="cb17-313"><a href="#cb17-313" aria-hidden="true" tabindex="-1"></a>    <span class="at">cube        =</span> cube_s2_reg, </span>
<span id="cb17-314"><a href="#cb17-314" aria-hidden="true" tabindex="-1"></a>  <span class="at">samples =</span> training_samples_with_indices)</span>
<span id="cb17-315"><a href="#cb17-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-316"><a href="#cb17-316" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the tibble with the first three points</span></span>
<span id="cb17-317"><a href="#cb17-317" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">head</span>(training_samples_derived)</span>
<span id="cb17-318"><a href="#cb17-318" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-319"><a href="#cb17-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-320"><a href="#cb17-320" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb17-321"><a href="#cb17-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-322"><a href="#cb17-322" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.5 Classify Data Cube</span></span>
<span id="cb17-323"><a href="#cb17-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-324"><a href="#cb17-324" aria-hidden="true" tabindex="-1"></a>Random Forest models provide robust baseline classifiers for activity data, balancing computational efficiency with adequate performance for Tier 2-3 REDD+ requirements. The <span class="in">`sits_train()`</span> function implements parallelized Random Forest training with default hyperparameters optimized for satellite time series.</span>
<span id="cb17-325"><a href="#cb17-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-328"><a href="#cb17-328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-329"><a href="#cb17-329" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb17-330"><a href="#cb17-330" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb17-331"><a href="#cb17-331" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb17-332"><a href="#cb17-332" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb17-333"><a href="#cb17-333" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb17-334"><a href="#cb17-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-335"><a href="#cb17-335" aria-hidden="true" tabindex="-1"></a><span class="co"># Train model using Random Forest algorithm</span></span>
<span id="cb17-336"><a href="#cb17-336" aria-hidden="true" tabindex="-1"></a>model_randomForest <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_train</span>(</span>
<span id="cb17-337"><a href="#cb17-337" aria-hidden="true" tabindex="-1"></a>  <span class="at">samples =</span> samples_deforestation_rondonia,</span>
<span id="cb17-338"><a href="#cb17-338" aria-hidden="true" tabindex="-1"></a>  <span class="at">ml_method     =</span> sits<span class="sc">::</span><span class="fu">sits_rfor</span>(</span>
<span id="cb17-339"><a href="#cb17-339" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_trees =</span> <span class="dv">120</span>,</span>
<span id="cb17-340"><a href="#cb17-340" aria-hidden="true" tabindex="-1"></a>    <span class="at">mtry            =</span> )</span>
<span id="cb17-341"><a href="#cb17-341" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-342"><a href="#cb17-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-343"><a href="#cb17-343" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the model results</span></span>
<span id="cb17-344"><a href="#cb17-344" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_randomForest)</span>
<span id="cb17-345"><a href="#cb17-345" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-346"><a href="#cb17-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-347"><a href="#cb17-347" aria-hidden="true" tabindex="-1"></a>Variable importance metrics identify which spatiotemporal features contribute most to class discrimination. For REDD+ operations, understanding feature importance supports:</span>
<span id="cb17-348"><a href="#cb17-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-349"><a href="#cb17-349" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Uncertainty attribution: High-importance features with measurement error propagate more uncertainty</span>
<span id="cb17-350"><a href="#cb17-350" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Sensor planning: Identifies critical spectral bands for maintaining classification accuracy</span>
<span id="cb17-351"><a href="#cb17-351" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Transfer learning: Guides feature selection when adapting models to new regions</span>
<span id="cb17-352"><a href="#cb17-352" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Validation design: Informs stratification schemes for accuracy assessment</span>
<span id="cb17-353"><a href="#cb17-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-354"><a href="#cb17-354" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.6 Probability Data Cube</span></span>
<span id="cb17-355"><a href="#cb17-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-356"><a href="#cb17-356" aria-hidden="true" tabindex="-1"></a>Classification outputs are generated as probability cubes rather than discrete label maps to preserve model uncertainty information. The <span class="in">`sits_classify()`</span> function applies trained models to regularized data cubes using fault-tolerant parallel processing, producing per-class probability layers that quantify model confidence at the pixel level.</span>
<span id="cb17-357"><a href="#cb17-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-358"><a href="#cb17-358" aria-hidden="true" tabindex="-1"></a>The <span class="in">`sits`</span> package implements parallel computing to minimize communication overhead, which enables multi-core systems without configuration.</span>
<span id="cb17-359"><a href="#cb17-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-362"><a href="#cb17-362" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-363"><a href="#cb17-363" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb17-364"><a href="#cb17-364" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb17-365"><a href="#cb17-365" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb17-366"><a href="#cb17-366" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb17-367"><a href="#cb17-367" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb17-368"><a href="#cb17-368" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb17-369"><a href="#cb17-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-370"><a href="#cb17-370" aria-hidden="true" tabindex="-1"></a><span class="co"># Classify data cube</span></span>
<span id="cb17-371"><a href="#cb17-371" aria-hidden="true" tabindex="-1"></a>cube_s2_probs <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_classify</span>(</span>
<span id="cb17-372"><a href="#cb17-372" aria-hidden="true" tabindex="-1"></a>    <span class="at">data            =</span> cube_s2_reg,</span>
<span id="cb17-373"><a href="#cb17-373" aria-hidden="true" tabindex="-1"></a>    <span class="at">ml_model        =</span> rfor_model,</span>
<span id="cb17-374"><a href="#cb17-374" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_dir  =</span> <span class="st">"./assets/images/probs/"</span>,</span>
<span id="cb17-375"><a href="#cb17-375" aria-hidden="true" tabindex="-1"></a>    <span class="at">version         =</span> <span class="st">"rf-raster"</span>,</span>
<span id="cb17-376"><a href="#cb17-376" aria-hidden="true" tabindex="-1"></a>    <span class="at">multicores  =</span> <span class="dv">4</span>,</span>
<span id="cb17-377"><a href="#cb17-377" aria-hidden="true" tabindex="-1"></a>    <span class="at">memsize         =</span> <span class="dv">16</span></span>
<span id="cb17-378"><a href="#cb17-378" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-379"><a href="#cb17-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-380"><a href="#cb17-380" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cube_s2_probs, </span>
<span id="cb17-381"><a href="#cb17-381" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels =</span> <span class="st">"Forest"</span>, </span>
<span id="cb17-382"><a href="#cb17-382" aria-hidden="true" tabindex="-1"></a>         <span class="at">palette =</span> <span class="st">"YlGn"</span></span>
<span id="cb17-383"><a href="#cb17-383" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb17-384"><a href="#cb17-384" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-385"><a href="#cb17-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-386"><a href="#cb17-386" aria-hidden="true" tabindex="-1"></a><span class="al">![](assets/images/png/activity-data-d.png)</span>{fig-align="center"}</span>
<span id="cb17-387"><a href="#cb17-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-388"><a href="#cb17-388" aria-hidden="true" tabindex="-1"></a>Each pixel in the probability cube contains <span class="in">`n`</span> probability values (where <span class="in">`n`</span> = number of classes), summing to 1.0. Low maximum probability values indicate pixels with high classification uncertainty, typically occurring at class boundaries, in mixed pixels, or where spectral-temporal signatures deviate from training data. These pixel-level uncertainty metrics support subsequent:</span>
<span id="cb17-389"><a href="#cb17-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-390"><a href="#cb17-390" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Adaptive stratification: High-uncertainty pixels receive higher validation sampling density</span>
<span id="cb17-391"><a href="#cb17-391" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Uncertainty propagation: Probability distributions feed Monte Carlo emission simulations</span>
<span id="cb17-392"><a href="#cb17-392" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Quality control: Spatial patterns of low confidence identify systematic classification errors</span>
<span id="cb17-393"><a href="#cb17-393" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Temporal tracking: Probability time series detect gradual transitions missed by discrete labeling</span>
<span id="cb17-394"><a href="#cb17-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-395"><a href="#cb17-395" aria-hidden="true" tabindex="-1"></a>Probability cubes thus serve as the foundation for rigorous uncertainty quantification in subsequent workflow stages.</span>
<span id="cb17-396"><a href="#cb17-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-397"><a href="#cb17-397" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.6.i Pixel Class Uncertainty</span></span>
<span id="cb17-398"><a href="#cb17-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-399"><a href="#cb17-399" aria-hidden="true" tabindex="-1"></a>3.6.ii</span>
<span id="cb17-400"><a href="#cb17-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-401"><a href="#cb17-401" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.7 Training Data Enhancements</span></span>
<span id="cb17-402"><a href="#cb17-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-403"><a href="#cb17-403" aria-hidden="true" tabindex="-1"></a>Classification accuracy in REDD+ monitoring depends critically on training sample quality. Large, well-labeled datasets improve model performance regardless of algorithm choice, while noisy or mislabeled samples degrade classification accuracy and inflate activity data uncertainty <span class="co">[</span><span class="ot">@maxwell2018implementation; @frenay2013classification</span><span class="co">]</span>. This section demonstrates processing methods to identify problematic samples, reduce class imbalance, and address geographic variance before re-training models.</span>
<span id="cb17-404"><a href="#cb17-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-405"><a href="#cb17-405" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hierachical Clustering</span></span>
<span id="cb17-406"><a href="#cb17-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-407"><a href="#cb17-407" aria-hidden="true" tabindex="-1"></a>We implement below two clustering approaches for evaluating training data quality: Agglomerative Hierarchical Clustering <span class="co">[</span><span class="ot">AHC; @yao2016application</span><span class="co">]</span> for datasets under 10,000 samples, and Self-Organizing Maps (SOM) for larger collections <span class="co">[</span><span class="ot">@neagoe2014concurrent; @gonccalves2008unsupervised</span><span class="co">]</span>. AHC has computational complexity of $\mathcal{O}(n^2)$ requiring substantial memory, while SOM scales linearly, making it preferable for operational REDD+ monitoring systems.</span>
<span id="cb17-408"><a href="#cb17-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-409"><a href="#cb17-409" aria-hidden="true" tabindex="-1"></a>Hierarchical Clustering computes dissimilarity between samples using dynamic time warping (DTW), which reliably measures differences in satellite time series <span class="co">[</span><span class="ot">@Petitjean2012; @Maus2016</span><span class="co">]</span>. The <span class="in">`sits_cluster_dendro()`</span> function generates dendrograms that reveal sample groupings and potential mislabeling:</span>
<span id="cb17-410"><a href="#cb17-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-413"><a href="#cb17-413" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-414"><a href="#cb17-414" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb17-415"><a href="#cb17-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-416"><a href="#cb17-416" aria-hidden="true" tabindex="-1"></a><span class="co"># Cluster samples using DTW distance and Ward linkage</span></span>
<span id="cb17-417"><a href="#cb17-417" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_cluster_dendro</span>(</span>
<span id="cb17-418"><a href="#cb17-418" aria-hidden="true" tabindex="-1"></a>    <span class="at">samples =</span> training_samples_with_indices, </span>
<span id="cb17-419"><a href="#cb17-419" aria-hidden="true" tabindex="-1"></a>    <span class="at">bands =</span> <span class="fu">c</span>(<span class="st">"NDVI"</span>, <span class="st">"EVI"</span>),</span>
<span id="cb17-420"><a href="#cb17-420" aria-hidden="true" tabindex="-1"></a>    <span class="at">dist_method =</span> <span class="st">"dtw_basic"</span>,</span>
<span id="cb17-421"><a href="#cb17-421" aria-hidden="true" tabindex="-1"></a>    <span class="at">linkage =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb17-422"><a href="#cb17-422" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-423"><a href="#cb17-423" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine cluster composition</span></span>
<span id="cb17-424"><a href="#cb17-424" aria-hidden="true" tabindex="-1"></a>sits<span class="sc">::</span><span class="fu">sits_cluster_frequency</span>(clusters)</span>
<span id="cb17-425"><a href="#cb17-425" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-426"><a href="#cb17-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-427"><a href="#cb17-427" aria-hidden="true" tabindex="-1"></a><span class="al">![](assets/images/png/activity-data-g.png)</span>{fig-align="center"}</span>
<span id="cb17-428"><a href="#cb17-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-429"><a href="#cb17-429" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb17-430"><a href="#cb17-430" aria-hidden="true" tabindex="-1"></a><span class="in">                           1    2    3    4    5    6    7 Total</span></span>
<span id="cb17-431"><a href="#cb17-431" aria-hidden="true" tabindex="-1"></a><span class="in">  Clear_Cut_Bare_Soil    121    9  104  705    5    0    0   944</span></span>
<span id="cb17-432"><a href="#cb17-432" aria-hidden="true" tabindex="-1"></a><span class="in">  Clear_Cut_Burned_Area   79    5   23  874    0    0    2   983</span></span>
<span id="cb17-433"><a href="#cb17-433" aria-hidden="true" tabindex="-1"></a><span class="in">  Clear_Cut_Vegetation   259  164   43  103    0    0   34   603</span></span>
<span id="cb17-434"><a href="#cb17-434" aria-hidden="true" tabindex="-1"></a><span class="in">  Forest                 174  732    5    6    0    0   47   964</span></span>
<span id="cb17-435"><a href="#cb17-435" aria-hidden="true" tabindex="-1"></a><span class="in">  Mountainside_Forest     12  145    2    0    0    0   52   211</span></span>
<span id="cb17-436"><a href="#cb17-436" aria-hidden="true" tabindex="-1"></a><span class="in">  Riparian_Forest         39  327   11    6    0    0  864  1247</span></span>
<span id="cb17-437"><a href="#cb17-437" aria-hidden="true" tabindex="-1"></a><span class="in">  Seasonally_Flooded     414   94  160   25   29    0    9   731</span></span>
<span id="cb17-438"><a href="#cb17-438" aria-hidden="true" tabindex="-1"></a><span class="in">  Water                    0    0    1    2    2  104    0   109</span></span>
<span id="cb17-439"><a href="#cb17-439" aria-hidden="true" tabindex="-1"></a><span class="in">  Wetland                 56    1   55   19   53   31    0   215</span></span>
<span id="cb17-440"><a href="#cb17-440" aria-hidden="true" tabindex="-1"></a><span class="in">  Total                 1154 1477  404 1740   89  135 1008  6007</span></span>
<span id="cb17-441"><a href="#cb17-441" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-442"><a href="#cb17-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-443"><a href="#cb17-443" aria-hidden="true" tabindex="-1"></a>The adjusted rand index (ARI) identifies optimal cluster count <span class="co">[</span><span class="ot">@rand1971objective</span><span class="co">]</span>. Clusters with mixed labels indicate either:</span>
<span id="cb17-444"><a href="#cb17-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-445"><a href="#cb17-445" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>mislabeled samples requiring removal,</span>
<span id="cb17-446"><a href="#cb17-446" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>spectral confusion between classes,</span>
<span id="cb17-447"><a href="#cb17-447" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>natural variability in land cover signatures. s</span>
<span id="cb17-448"><a href="#cb17-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-449"><a href="#cb17-449" aria-hidden="true" tabindex="-1"></a>The <span class="in">`sits_cluster_clean()`</span> function removes minority labels within clusters, retaining only dominant classes to reduce training noise.</span>
<span id="cb17-450"><a href="#cb17-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-451"><a href="#cb17-451" aria-hidden="true" tabindex="-1"></a>Self-Organizing Maps provide efficient quality assessment for large datasets through unsupervised learning that projects high-dimensional time series onto 2D grids. The <span class="in">`sits_som_map()`</span> function identifies outliers and evaluates class separability:</span>
<span id="cb17-452"><a href="#cb17-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-455"><a href="#cb17-455" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-456"><a href="#cb17-456" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb17-457"><a href="#cb17-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-458"><a href="#cb17-458" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove cluster#5 from the samples</span></span>
<span id="cb17-459"><a href="#cb17-459" aria-hidden="true" tabindex="-1"></a>clusters_new <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(clusters, cluster <span class="sc">!=</span> <span class="dv">5</span>)</span>
<span id="cb17-460"><a href="#cb17-460" aria-hidden="true" tabindex="-1"></a>clusters_clean <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_cluster_clean</span>(clusters_new)</span>
<span id="cb17-461"><a href="#cb17-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-462"><a href="#cb17-462" aria-hidden="true" tabindex="-1"></a><span class="co"># Check clusters samples frequency</span></span>
<span id="cb17-463"><a href="#cb17-463" aria-hidden="true" tabindex="-1"></a>sits<span class="sc">::</span><span class="fu">sits_cluster_frequency</span>(clusters_clean)</span>
<span id="cb17-464"><a href="#cb17-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-465"><a href="#cb17-465" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate SOM with optimal grid dimensions</span></span>
<span id="cb17-466"><a href="#cb17-466" aria-hidden="true" tabindex="-1"></a>som_map <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_som_map</span>(</span>
<span id="cb17-467"><a href="#cb17-467" aria-hidden="true" tabindex="-1"></a>    training_samples_with_indices, </span>
<span id="cb17-468"><a href="#cb17-468" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid_xdim =</span> <span class="dv">10</span>, </span>
<span id="cb17-469"><a href="#cb17-469" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid_ydim =</span> <span class="dv">10</span>)</span>
<span id="cb17-470"><a href="#cb17-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-471"><a href="#cb17-471" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean samples by removing mixed neurons</span></span>
<span id="cb17-472"><a href="#cb17-472" aria-hidden="true" tabindex="-1"></a>samples_clean <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_som_clean_samples</span>(som_map)</span>
<span id="cb17-473"><a href="#cb17-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-474"><a href="#cb17-474" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize sample clustering &amp; class confusions</span></span>
<span id="cb17-475"><a href="#cb17-475" aria-hidden="true" tabindex="-1"></a>som_eval <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_som_evaluate_cluster</span>(som_map)</span>
<span id="cb17-476"><a href="#cb17-476" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(som_eval)</span>
<span id="cb17-477"><a href="#cb17-477" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(som_map)</span>
<span id="cb17-478"><a href="#cb17-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-479"><a href="#cb17-479" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-480"><a href="#cb17-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-481"><a href="#cb17-481" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb17-482"><a href="#cb17-482" aria-hidden="true" tabindex="-1"></a><span class="in">                         1  2  3  4 Total</span></span>
<span id="cb17-483"><a href="#cb17-483" aria-hidden="true" tabindex="-1"></a><span class="in">  Clear_Cut_Burned_Area  0  5  0  0     5</span></span>
<span id="cb17-484"><a href="#cb17-484" aria-hidden="true" tabindex="-1"></a><span class="in">  Forest                 0  0  0  6     6</span></span>
<span id="cb17-485"><a href="#cb17-485" aria-hidden="true" tabindex="-1"></a><span class="in">  Mountainside_Forest   12  0  2  0    14</span></span>
<span id="cb17-486"><a href="#cb17-486" aria-hidden="true" tabindex="-1"></a><span class="in">  Total                 12  5  2  6    25</span></span>
<span id="cb17-487"><a href="#cb17-487" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-488"><a href="#cb17-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-489"><a href="#cb17-489" aria-hidden="true" tabindex="-1"></a>::: {#fig-som-a layout-ncol="2"}</span>
<span id="cb17-490"><a href="#cb17-490" aria-hidden="true" tabindex="-1"></a><span class="al">![](assets/images/png/activity-data-h1.png)</span>{fig-align="center"} <span class="al">![](assets/images/png/activity-data-h2.png)</span>{fig-align="center"}</span>
<span id="cb17-491"><a href="#cb17-491" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-492"><a href="#cb17-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-493"><a href="#cb17-493" aria-hidden="true" tabindex="-1"></a>Neurons containing multiple classes reveal spectral overlap requiring investigation. The SOM-based cleaning removes samples from mixed neurons, improving class separability while preserving within-class variability essential for generalization.</span>
<span id="cb17-494"><a href="#cb17-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-495"><a href="#cb17-495" aria-hidden="true" tabindex="-1"></a><span class="fu">### Class Imbalances</span></span>
<span id="cb17-496"><a href="#cb17-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-497"><a href="#cb17-497" aria-hidden="true" tabindex="-1"></a>Imbalanced training sets—where some classes have many more samples than others—bias classifiers toward over-represented classes, inflating omission errors for rare forest types. The <span class="in">`sits_reduce_imbalance()`</span> function implements under-sampling and over-sampling strategies:</span>
<span id="cb17-498"><a href="#cb17-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-501"><a href="#cb17-501" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-502"><a href="#cb17-502" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb17-503"><a href="#cb17-503" aria-hidden="true" tabindex="-1"></a><span class="co"># Balance samples across classes</span></span>
<span id="cb17-504"><a href="#cb17-504" aria-hidden="true" tabindex="-1"></a>samples_balanced <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_reduce_imbalance</span>(</span>
<span id="cb17-505"><a href="#cb17-505" aria-hidden="true" tabindex="-1"></a>    <span class="at">samples =</span> training_samples_with_indices,</span>
<span id="cb17-506"><a href="#cb17-506" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_samples_over =</span> <span class="dv">200</span>,   <span class="co"># Oversample rare classes</span></span>
<span id="cb17-507"><a href="#cb17-507" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_samples_under =</span> <span class="dv">400</span>,  <span class="co"># Undersample common classes</span></span>
<span id="cb17-508"><a href="#cb17-508" aria-hidden="true" tabindex="-1"></a>    <span class="at">multicores =</span> <span class="dv">4</span>)</span>
<span id="cb17-509"><a href="#cb17-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-510"><a href="#cb17-510" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-evaluate using SOM clustering</span></span>
<span id="cb17-511"><a href="#cb17-511" aria-hidden="true" tabindex="-1"></a>som_map_balanced <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_som_map</span>(</span>
<span id="cb17-512"><a href="#cb17-512" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> samples_balanced,</span>
<span id="cb17-513"><a href="#cb17-513" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid_xdim =</span> <span class="dv">10</span>,</span>
<span id="cb17-514"><a href="#cb17-514" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid_ydim =</span> <span class="dv">10</span>,</span>
<span id="cb17-515"><a href="#cb17-515" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">1.0</span>,</span>
<span id="cb17-516"><a href="#cb17-516" aria-hidden="true" tabindex="-1"></a>    <span class="at">distance =</span> <span class="st">"dtw"</span>,</span>
<span id="cb17-517"><a href="#cb17-517" aria-hidden="true" tabindex="-1"></a>    <span class="at">rlen =</span> <span class="dv">20</span>)</span>
<span id="cb17-518"><a href="#cb17-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-519"><a href="#cb17-519" aria-hidden="true" tabindex="-1"></a><span class="co"># Store estimates in tibble</span></span>
<span id="cb17-520"><a href="#cb17-520" aria-hidden="true" tabindex="-1"></a>som_eval_balanced <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_som_evaluate_cluster</span>(</span>
<span id="cb17-521"><a href="#cb17-521" aria-hidden="true" tabindex="-1"></a>    som_map_balanced)</span>
<span id="cb17-522"><a href="#cb17-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-523"><a href="#cb17-523" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize results</span></span>
<span id="cb17-524"><a href="#cb17-524" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(som_eval_balanced) </span>
<span id="cb17-525"><a href="#cb17-525" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(som_map_balanced) </span>
<span id="cb17-526"><a href="#cb17-526" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(samples_balanced)</span>
<span id="cb17-527"><a href="#cb17-527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-528"><a href="#cb17-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-529"><a href="#cb17-529" aria-hidden="true" tabindex="-1"></a>::: {#fig-som-b layout-ncol="2"}</span>
<span id="cb17-530"><a href="#cb17-530" aria-hidden="true" tabindex="-1"></a><span class="al">![](assets/images/png/activity-data-i1.png)</span>{fig-align="center"} <span class="al">![](assets/images/png/activity-data-i2.png)</span>{fig-align="center"}</span>
<span id="cb17-531"><a href="#cb17-531" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-532"><a href="#cb17-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-533"><a href="#cb17-533" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb17-534"><a href="#cb17-534" aria-hidden="true" tabindex="-1"></a><span class="in"># A tibble: 9 × 3</span></span>
<span id="cb17-535"><a href="#cb17-535" aria-hidden="true" tabindex="-1"></a><span class="in">  label                 count   prop</span></span>
<span id="cb17-536"><a href="#cb17-536" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;chr&gt;                 &lt;int&gt;  &lt;dbl&gt;</span></span>
<span id="cb17-537"><a href="#cb17-537" aria-hidden="true" tabindex="-1"></a><span class="in">1 Clear_Cut_Bare_Soil     400 0.134 </span></span>
<span id="cb17-538"><a href="#cb17-538" aria-hidden="true" tabindex="-1"></a><span class="in">2 Clear_Cut_Burned_Area   388 0.130 </span></span>
<span id="cb17-539"><a href="#cb17-539" aria-hidden="true" tabindex="-1"></a><span class="in">3 Clear_Cut_Vegetation    392 0.131 </span></span>
<span id="cb17-540"><a href="#cb17-540" aria-hidden="true" tabindex="-1"></a><span class="in">4 Forest                  400 0.134 </span></span>
<span id="cb17-541"><a href="#cb17-541" aria-hidden="true" tabindex="-1"></a><span class="in">5 Mountainside_Forest     211 0.0707</span></span>
<span id="cb17-542"><a href="#cb17-542" aria-hidden="true" tabindex="-1"></a><span class="in">6 Riparian_Forest         396 0.133 </span></span>
<span id="cb17-543"><a href="#cb17-543" aria-hidden="true" tabindex="-1"></a><span class="in">7 Seasonally_Flooded      384 0.129 </span></span>
<span id="cb17-544"><a href="#cb17-544" aria-hidden="true" tabindex="-1"></a><span class="in">8 Water                   200 0.0670</span></span>
<span id="cb17-545"><a href="#cb17-545" aria-hidden="true" tabindex="-1"></a><span class="in">9 Wetland                 215 0.0720</span></span>
<span id="cb17-546"><a href="#cb17-546" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-547"><a href="#cb17-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-548"><a href="#cb17-548" aria-hidden="true" tabindex="-1"></a>Under-sampling randomly removes samples from majority classes to match minority class frequencies, reducing computational load but discarding potentially informative data. Over-sampling uses SMOTE <span class="co">[</span><span class="ot">Synthetic Minority Over-sampling Technique; @smotefamily; @DMwR</span><span class="co">]</span> to generate synthetic samples for rare classes, improving classifier sensitivity without losing real observations. For REDD+ applications, maintaining adequate representation of degraded forest classes often requires combined strategies.</span>
<span id="cb17-549"><a href="#cb17-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-550"><a href="#cb17-550" aria-hidden="true" tabindex="-1"></a><span class="fu">### Geographic Variance</span></span>
<span id="cb17-551"><a href="#cb17-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-552"><a href="#cb17-552" aria-hidden="true" tabindex="-1"></a>Training samples must capture spatial variability across jurisdictions. Clustered sampling creates geographic gaps where model predictions have higher uncertainty <span class="co">[</span><span class="ot">@meyer2022machine</span><span class="co">]</span>. The <span class="in">`sits_geo_dist()`</span> function compares sample-to-sample distances against prediction-location-to-sample distances:</span>
<span id="cb17-553"><a href="#cb17-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-556"><a href="#cb17-556" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-557"><a href="#cb17-557" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb17-558"><a href="#cb17-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-559"><a href="#cb17-559" aria-hidden="true" tabindex="-1"></a><span class="co"># Derive jurisdiction boundary</span></span>
<span id="cb17-560"><a href="#cb17-560" aria-hidden="true" tabindex="-1"></a>bbox_cube <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_bbox</span>(cube_s2_reg) </span>
<span id="cb17-561"><a href="#cb17-561" aria-hidden="true" tabindex="-1"></a>bbox_sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_bbox</span>(</span>
<span id="cb17-562"><a href="#cb17-562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="at">xmin =</span> aoi<span class="sc">$</span>xmin, </span>
<span id="cb17-563"><a href="#cb17-563" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> aoi<span class="sc">$</span>ymin, </span>
<span id="cb17-564"><a href="#cb17-564" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> aoi<span class="sc">$</span>xmax, </span>
<span id="cb17-565"><a href="#cb17-565" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> aoi<span class="sc">$</span>ymax),</span>
<span id="cb17-566"><a href="#cb17-566" aria-hidden="true" tabindex="-1"></a>  <span class="at">crs =</span> sf<span class="sc">::</span><span class="fu">st_crs</span>(aoi<span class="sc">$</span>crs))</span>
<span id="cb17-567"><a href="#cb17-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-568"><a href="#cb17-568" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to sf </span></span>
<span id="cb17-569"><a href="#cb17-569" aria-hidden="true" tabindex="-1"></a>aoi <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(sf<span class="sc">::</span><span class="fu">st_as_sfc</span>(bbox_sf))</span>
<span id="cb17-570"><a href="#cb17-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-571"><a href="#cb17-571" aria-hidden="true" tabindex="-1"></a><span class="co"># Assess geographic coverage</span></span>
<span id="cb17-572"><a href="#cb17-572" aria-hidden="true" tabindex="-1"></a>distances <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_geo_dist</span>(</span>
<span id="cb17-573"><a href="#cb17-573" aria-hidden="true" tabindex="-1"></a>    training_samples_with_indices, <span class="at">roi =</span> aoi)</span>
<span id="cb17-574"><a href="#cb17-574" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(distances)</span>
<span id="cb17-575"><a href="#cb17-575" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-576"><a href="#cb17-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-577"><a href="#cb17-577" aria-hidden="true" tabindex="-1"></a><span class="al">![](assets/images/png/activity-data-j.png)</span>{fig-align="center"}</span>
<span id="cb17-578"><a href="#cb17-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-579"><a href="#cb17-579" aria-hidden="true" tabindex="-1"></a>Mismatched distributions indicate insufficient spatial coverage. Areas with few nearby training samples will exhibit higher classification uncertainty, requiring either additional field sampling or explicit uncertainty quantification in those regions during accuracy assessment.</span>
<span id="cb17-580"><a href="#cb17-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-581"><a href="#cb17-581" aria-hidden="true" tabindex="-1"></a><span class="fu">### Noise Filtering</span></span>
<span id="cb17-582"><a href="#cb17-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-583"><a href="#cb17-583" aria-hidden="true" tabindex="-1"></a>Atmospheric contamination and sensor artifacts introduce noise requiring smoothing before feature extraction. The package supports Savitzky-Golay (<span class="in">`sits_sgolay()`</span>) and Whittaker (<span class="in">`sits_whittaker()`</span>) filters. Both methods reduce noise while preserving phenological patterns:</span>
<span id="cb17-584"><a href="#cb17-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-587"><a href="#cb17-587" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-588"><a href="#cb17-588" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb17-589"><a href="#cb17-589" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply Whittaker filter with conservative smoothing</span></span>
<span id="cb17-590"><a href="#cb17-590" aria-hidden="true" tabindex="-1"></a>samples_balanced_ndvi <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_select</span>(</span>
<span id="cb17-591"><a href="#cb17-591" aria-hidden="true" tabindex="-1"></a>    samples_balanced, <span class="at">bands =</span> <span class="st">"NDVI"</span>)</span>
<span id="cb17-592"><a href="#cb17-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-593"><a href="#cb17-593" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply Whitakker filter</span></span>
<span id="cb17-594"><a href="#cb17-594" aria-hidden="true" tabindex="-1"></a>samples_balanced_whit <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_whittaker</span>(</span>
<span id="cb17-595"><a href="#cb17-595" aria-hidden="true" tabindex="-1"></a>    samples_balanced_ndvi, <span class="at">lambda =</span> <span class="fl">0.5</span>)</span>
<span id="cb17-596"><a href="#cb17-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-597"><a href="#cb17-597" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge to visualize</span></span>
<span id="cb17-598"><a href="#cb17-598" aria-hidden="true" tabindex="-1"></a>sits<span class="sc">::</span><span class="fu">sits_merge</span>(</span>
<span id="cb17-599"><a href="#cb17-599" aria-hidden="true" tabindex="-1"></a>    samples_balanced_ndvi, </span>
<span id="cb17-600"><a href="#cb17-600" aria-hidden="true" tabindex="-1"></a>    samples_balanced_whit,</span>
<span id="cb17-601"><a href="#cb17-601" aria-hidden="true" tabindex="-1"></a>    <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">".WHIT"</span>)) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb17-602"><a href="#cb17-602" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-603"><a href="#cb17-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-604"><a href="#cb17-604" aria-hidden="true" tabindex="-1"></a>::: {#fig-som-a layout-ncol="4", layout-nrow="4"} <span class="al">![](assets/images/png/activity-data-k1a.png)</span>{fig-align="center"} <span class="al">![](assets/images/png/activity-data-k1b.png)</span>{fig-align="center"} <span class="al">![](assets/images/png/activity-data-k2a.png)</span>{fig-align="center"} <span class="al">![](assets/images/png/activity-data-k2b.png)</span>{fig-align="center"} <span class="al">![](assets/images/png/activity-data-k3a.png)</span>{fig-align="center"} <span class="al">![](assets/images/png/activity-data-k3b.png)</span>{fig-align="center"} <span class="al">![](assets/images/png/activity-data-k4a.png)</span>{fig-align="center"} <span class="al">![](assets/images/png/activity-data-k4b.png)</span>{fig-align="center"} <span class="al">![](assets/images/png/activity-data-k5a.png)</span>{fig-align="center"} <span class="al">![](assets/images/png/activity-data-k5b.png)</span>{fig-align="center"} <span class="al">![](assets/images/png/activity-data-k6a.png)</span>{fig-align="center"} <span class="al">![](assets/images/png/activity-data-k6b.png)</span>{fig-align="center"} <span class="al">![](assets/images/png/activity-data-k7a.png)</span>{fig-align="center"} <span class="al">![](assets/images/png/activity-data-k7b.png)</span>{fig-align="center"} <span class="al">![](assets/images/png/activity-data-k8a.png)</span>{fig-align="center"} <span class="al">![](assets/images/png/activity-data-k8b.png)</span>{fig-align="center"} :::</span>
<span id="cb17-605"><a href="#cb17-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-606"><a href="#cb17-606" aria-hidden="true" tabindex="-1"></a>Over-smoothing (high lambda values) eliminates legitimate phenological variation, reducing model discriminatory power. Conservative filtering (lambda ≤ 1.0) balances noise reduction with pattern preservation <span class="co">[</span><span class="ot">@Atkinson2012; @Zhou2016</span><span class="co">]</span>.</span>
<span id="cb17-607"><a href="#cb17-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-608"><a href="#cb17-608" aria-hidden="true" tabindex="-1"></a>Integration with Uncertainty Workflows: Quality-controlled training data directly reduces classification uncertainty by minimizing systematic errors from mislabeling and improving model generalization. Combined with the cross-validation procedures in Section 3.8 and accuracy assessment in Section 3.9, these enhancement methods establish a rigorous foundation for defensible activity data uncertainty quantification under ART-TREES requirements.</span>
<span id="cb17-609"><a href="#cb17-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-610"><a href="#cb17-610" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.8 Smooth Data Cube</span></span>
<span id="cb17-611"><a href="#cb17-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-612"><a href="#cb17-612" aria-hidden="true" tabindex="-1"></a>Pixel-based classification inherently produces salt-and-pepper noise due to within-class spectral variability and mixed pixels. Isolated misclassified pixels (outliers surrounded by different classes) represent systematic over-fitting to training data rather than true landscape heterogeneity. For REDD+ applications, these artifacts inflate area uncertainty and complicate change detection. To address this, the <span class="in">`sits_smooth()`</span> function implements Bayesian post-processing that incorporates spatial context from neighboring pixels to refine probability estimates. The smoothing process:</span>
<span id="cb17-613"><a href="#cb17-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-614"><a href="#cb17-614" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Computes spatially-weighted probability adjustments based on neighborhood composition</span>
<span id="cb17-615"><a href="#cb17-615" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Updates pixel probabilities using Bayesian inference combining original estimates with spatial priors</span>
<span id="cb17-616"><a href="#cb17-616" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Produces refined probability cube with reduced outlier occurrence while preserving legitimate small patches</span>
<span id="cb17-617"><a href="#cb17-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-620"><a href="#cb17-620" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-621"><a href="#cb17-621" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb17-622"><a href="#cb17-622" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb17-623"><a href="#cb17-623" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb17-624"><a href="#cb17-624" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb17-625"><a href="#cb17-625" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb17-626"><a href="#cb17-626" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb17-627"><a href="#cb17-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-628"><a href="#cb17-628" aria-hidden="true" tabindex="-1"></a><span class="co"># Smoothen a probability cube</span></span>
<span id="cb17-629"><a href="#cb17-629" aria-hidden="true" tabindex="-1"></a>cube_s2_bayes <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_smooth</span>(</span>
<span id="cb17-630"><a href="#cb17-630" aria-hidden="true" tabindex="-1"></a>    <span class="at">cube            =</span> cube_s2_probs,</span>
<span id="cb17-631"><a href="#cb17-631" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_dir  =</span> <span class="st">"./assets/images/bayes/"</span>,</span>
<span id="cb17-632"><a href="#cb17-632" aria-hidden="true" tabindex="-1"></a>    <span class="at">version         =</span> <span class="st">"rf-raster"</span>, <span class="co"># adds suffix to output raster</span></span>
<span id="cb17-633"><a href="#cb17-633" aria-hidden="true" tabindex="-1"></a>    <span class="at">multicores  =</span> <span class="dv">4</span>,</span>
<span id="cb17-634"><a href="#cb17-634" aria-hidden="true" tabindex="-1"></a>    <span class="at">memsize         =</span> <span class="dv">16</span></span>
<span id="cb17-635"><a href="#cb17-635" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-636"><a href="#cb17-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-637"><a href="#cb17-637" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cube_s2_bayes, </span>
<span id="cb17-638"><a href="#cb17-638" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Forest"</span>), </span>
<span id="cb17-639"><a href="#cb17-639" aria-hidden="true" tabindex="-1"></a>         <span class="at">palette =</span> <span class="st">"YlGn"</span></span>
<span id="cb17-640"><a href="#cb17-640" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb17-641"><a href="#cb17-641" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-642"><a href="#cb17-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-643"><a href="#cb17-643" aria-hidden="true" tabindex="-1"></a><span class="al">![Smoothed probability map for class `Forest`.](assets/images/png/activity-data-e.png)</span>{fig-align="center"}</span>
<span id="cb17-644"><a href="#cb17-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-645"><a href="#cb17-645" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb17-646"><a href="#cb17-646" aria-hidden="true" tabindex="-1"></a><span class="fu">## Smoothing Risks</span></span>
<span id="cb17-647"><a href="#cb17-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-648"><a href="#cb17-648" aria-hidden="true" tabindex="-1"></a>Spatial smoothing affects activity data uncertainty in competing directions:</span>
<span id="cb17-649"><a href="#cb17-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-650"><a href="#cb17-650" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Reduces random error: Eliminates isolated misclassifications that inflate variance</span>
<span id="cb17-651"><a href="#cb17-651" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Introduces spatial bias: May smooth over legitimate small-scale heterogeneity</span>
<span id="cb17-652"><a href="#cb17-652" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Improves validation agreement: Better alignment with typical human interpretation scales</span>
<span id="cb17-653"><a href="#cb17-653" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Modifies probability distributions: Changes the shape of pixel-level uncertainty estimates</span>
<span id="cb17-654"><a href="#cb17-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-655"><a href="#cb17-655" aria-hidden="true" tabindex="-1"></a>For REDD+ reporting, smoothed probability cubes typically yield lower reported uncertainties due to reduced classification noise, but verification bodies may require documentation of smoothing parameters demonstrating methodological choices.</span>
<span id="cb17-656"><a href="#cb17-656" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-657"><a href="#cb17-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-658"><a href="#cb17-658" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb17-659"><a href="#cb17-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-660"><a href="#cb17-660" aria-hidden="true" tabindex="-1"></a>Final classified maps are derived from smoothed probability cubes through maximum likelihood labeling: each pixel is assigned the class with highest posterior probability. The <span class="in">`sits_label_classification()`</span> function performs this deterministic assignment while maintaining provenance links to underlying probability distributions.</span>
<span id="cb17-661"><a href="#cb17-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-664"><a href="#cb17-664" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-665"><a href="#cb17-665" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: NA</span></span>
<span id="cb17-666"><a href="#cb17-666" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb17-667"><a href="#cb17-667" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb17-668"><a href="#cb17-668" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: false</span></span>
<span id="cb17-669"><a href="#cb17-669" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false </span></span>
<span id="cb17-670"><a href="#cb17-670" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb17-671"><a href="#cb17-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-672"><a href="#cb17-672" aria-hidden="true" tabindex="-1"></a><span class="co"># Derive lulc-classified raster</span></span>
<span id="cb17-673"><a href="#cb17-673" aria-hidden="true" tabindex="-1"></a>cube_s2_lulc <span class="ot">&lt;-</span> sits<span class="sc">::</span><span class="fu">sits_label_classification</span>(</span>
<span id="cb17-674"><a href="#cb17-674" aria-hidden="true" tabindex="-1"></a>    <span class="at">cube                =</span> cube_s2_bayes,</span>
<span id="cb17-675"><a href="#cb17-675" aria-hidden="true" tabindex="-1"></a>    <span class="at">multicores  =</span> <span class="dv">4</span>,</span>
<span id="cb17-676"><a href="#cb17-676" aria-hidden="true" tabindex="-1"></a>    <span class="at">memsize         =</span> <span class="dv">16</span>,</span>
<span id="cb17-677"><a href="#cb17-677" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_dir  =</span> <span class="st">"./assets/images/classified/"</span>,</span>
<span id="cb17-678"><a href="#cb17-678" aria-hidden="true" tabindex="-1"></a>    <span class="at">version         =</span> <span class="st">"rf-raster"</span></span>
<span id="cb17-679"><a href="#cb17-679" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-680"><a href="#cb17-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-681"><a href="#cb17-681" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb17-682"><a href="#cb17-682" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cube_s2_lulc, <span class="at">legend_text_size =</span> <span class="fl">0.7</span>)</span>
<span id="cb17-683"><a href="#cb17-683" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-684"><a href="#cb17-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-685"><a href="#cb17-685" aria-hidden="true" tabindex="-1"></a><span class="al">![Classified cube obtained by Random Forest model.](assets/images/png/activity-data-f.png)</span></span>
<span id="cb17-686"><a href="#cb17-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-687"><a href="#cb17-687" aria-hidden="true" tabindex="-1"></a>The classified cube produced by <span class="in">`sits`</span> workflows provides the activity data foundation for REDD+ accounting, but uncertainty quantification requires additional analysis beyond the discrete classification procedures. Sections 3.2-3.5 demonstrate more more advanced operations using <span class="in">`caret`</span> <span class="co">[</span><span class="ot">@kuhn2011caret</span><span class="co">]</span>, <span class="in">`ForestToolbox`</span> <span class="co">[</span><span class="ot">@ForesToolboxRS</span><span class="co">]</span>, and <span class="in">`terra`</span> packages <span class="co">[</span><span class="ot">@terra-2</span><span class="co">]</span> required to:</span>
<span id="cb17-688"><a href="#cb17-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-689"><a href="#cb17-689" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Extract pixel-level probability distributions for Monte Carlo sampling (Section 3.3)</span>
<span id="cb17-690"><a href="#cb17-690" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Implement stratified validation with area-adjusted accuracy assessment (Section 3.4)</span>
<span id="cb17-691"><a href="#cb17-691" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Calibrate Random Forest hyperparameters through iterative uncertainty minimization (Section 3.5)</span>
<span id="cb17-692"><a href="#cb17-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-693"><a href="#cb17-693" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb17-694"><a href="#cb17-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-695"><a href="#cb17-695" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.8 Cross-Validation</span></span>
<span id="cb17-696"><a href="#cb17-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-697"><a href="#cb17-697" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.9 Accuracy Assessment</span></span>
<span id="cb17-698"><a href="#cb17-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-699"><a href="#cb17-699" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.2 IPCC Land Monitoring Approaches {#sec-ipcc-approaches}</span></span>
<span id="cb17-700"><a href="#cb17-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-701"><a href="#cb17-701" aria-hidden="true" tabindex="-1"></a>The architecture of land-use transition monitoring systems determines the complexity and uncertainty of activity data. IPCC guidelines define three hierarchical approaches that differ in spatial explicitness and data requirements.</span>
<span id="cb17-702"><a href="#cb17-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-703"><a href="#cb17-703" aria-hidden="true" tabindex="-1"></a><span class="fu">### Approach Classification {#sec-approach-classification}</span></span>
<span id="cb17-704"><a href="#cb17-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-705"><a href="#cb17-705" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Approach   <span class="pp">|</span> Data Requirement        <span class="pp">|</span> Spatial Explicitness         <span class="pp">|</span> Uncertainty <span class="pp">|</span></span>
<span id="cb17-706"><a href="#cb17-706" aria-hidden="true" tabindex="-1"></a><span class="pp">|------------------|------------------|-------------------|------------------|</span></span>
<span id="cb17-707"><a href="#cb17-707" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Approach 1 <span class="pp">|</span> Total areas by category <span class="pp">|</span> None (aggregated statistics) <span class="pp">|</span> Highest     <span class="pp">|</span></span>
<span id="cb17-708"><a href="#cb17-708" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Approach 2 <span class="pp">|</span> Transition matrices     <span class="pp">|</span> Sampling-based               <span class="pp">|</span> Moderate    <span class="pp">|</span></span>
<span id="cb17-709"><a href="#cb17-709" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Approach 3 <span class="pp">|</span> Wall-to-wall maps       <span class="pp">|</span> Spatially explicit           <span class="pp">|</span> Lowest      <span class="pp">|</span></span>
<span id="cb17-710"><a href="#cb17-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-711"><a href="#cb17-711" aria-hidden="true" tabindex="-1"></a>REDD+ Standard: Most carbon projects use Approach 3 with remote sensing classification, combining high spatial resolution with complete coverage. This approach enables:</span>
<span id="cb17-712"><a href="#cb17-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-713"><a href="#cb17-713" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Pixel-level change detection</span>
<span id="cb17-714"><a href="#cb17-714" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Spatial stratification for uncertainty analysis</span>
<span id="cb17-715"><a href="#cb17-715" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Integration with degradation monitoring</span>
<span id="cb17-716"><a href="#cb17-716" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Transparent, verifiable methodologies</span>
<span id="cb17-717"><a href="#cb17-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-718"><a href="#cb17-718" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb17-719"><a href="#cb17-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-720"><a href="#cb17-720" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.10 Chapter Summary {#sec-summary}</span></span>
<span id="cb17-721"><a href="#cb17-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-722"><a href="#cb17-722" aria-hidden="true" tabindex="-1"></a>This chapter established a comprehensive framework for activity data uncertainty quantification in REDD+ monitoring systems. Key contributions include:</span>
<span id="cb17-723"><a href="#cb17-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-724"><a href="#cb17-724" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Data cube architecture: Structured approach to spatiotemporal land cover analysis</span>
<span id="cb17-725"><a href="#cb17-725" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>IPCC methodology alignment: Clear guidance on Approach 3 requirements</span>
<span id="cb17-726"><a href="#cb17-726" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Pixel-level uncertainty tracking: Model residuals for adaptive sampling</span>
<span id="cb17-727"><a href="#cb17-727" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Random Forest optimization: Monte Carlo calibration workflows</span>
<span id="cb17-728"><a href="#cb17-728" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Rigorous accuracy assessment: Confusion matrices with area adjustment</span>
<span id="cb17-729"><a href="#cb17-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-730"><a href="#cb17-730" aria-hidden="true" tabindex="-1"></a>Activity data provides spatial extent; allometry converts extent to biomass. Combined uncertainty requires:</span>
<span id="cb17-731"><a href="#cb17-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-732"><a href="#cb17-732" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb17-733"><a href="#cb17-733" aria-hidden="true" tabindex="-1"></a>U_{total}^2 = U_{activity}^2 + U_{allometry}^2 + 2 \times \text{Cov}(A, B)</span>
<span id="cb17-734"><a href="#cb17-734" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb17-735"><a href="#cb17-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-736"><a href="#cb17-736" aria-hidden="true" tabindex="-1"></a>Where covariance term captures spatial correlation between classification errors and biomass estimation errors.</span>
<span id="cb17-737"><a href="#cb17-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-738"><a href="#cb17-738" aria-hidden="true" tabindex="-1"></a><span class="ot">[^index-1]: </span>In version 1.5.3,<span class="in">`sits`</span> supports access to the following ARD image cloud providers:</span>
<span id="cb17-739"><a href="#cb17-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-740"><a href="#cb17-740" aria-hidden="true" tabindex="-1"></a><span class="in">    -   Amazon Web Services (AWS): Open data Sentinel-2/2A Level-2A collections for the Earth’s land surface.</span></span>
<span id="cb17-741"><a href="#cb17-741" aria-hidden="true" tabindex="-1"></a><span class="in">    -   Brazil Data Cube (BDC): Open data collections of Sentinel-2/2A, Landsat-8, CBERS-4/4A, and MOD13Q1 products for Brazil. These collections are organized as regular data cubes.</span></span>
<span id="cb17-742"><a href="#cb17-742" aria-hidden="true" tabindex="-1"></a><span class="in">    -   Copernicus Data Space Ecosystem (CDSE): Open data collections of Sentinel-1 RTC and Sentinel-2/2A images.</span></span>
<span id="cb17-743"><a href="#cb17-743" aria-hidden="true" tabindex="-1"></a><span class="in">    -   Digital Earth Africa (DEAFRICA): Open data collections of Sentinel-1 RTC, Sentinel-2/2A, Landsat-5/7/8/9 for Africa. Additional products include ALOS_PALSAR mosaics, DEM_COP_30, NDVI_ANOMALY based on Landsat data, and monthly and daily rainfall data from CHIRPS.</span></span>
<span id="cb17-744"><a href="#cb17-744" aria-hidden="true" tabindex="-1"></a><span class="in">    -   Digital Earth Australia (DEAUSTRALIA): Open data ARD collections of Sentinel-2A/2B and Landsat-5/7/8/9 images, yearly geomedians of Landsat 5/7/8 images; yearly fractional land cover from 1986 to 2024.</span></span>
<span id="cb17-745"><a href="#cb17-745" aria-hidden="true" tabindex="-1"></a><span class="in">    -   Harmonized Landsat-Sentinel (HLS): HLS, provided by NASA, is an open data collection that processes Landsat 8 and Sentinel-2 imagery to a common standard.</span></span>
<span id="cb17-746"><a href="#cb17-746" aria-hidden="true" tabindex="-1"></a><span class="in">    -   Microsoft Planetary Computer (MPC): Open data collections of Sentinel-1 GRD, Sentinel-1 RTC, Sentinel-2/2A, Landsat-4/5/7/8/9 images for the Earth’s land areas. Also supported are the Copernicus DEM-30 and MOD13Q1, MOD10A1, MOD09A1 products, and the Harmonized Landsat-Sentinel collections (HLSL30 and HLSS30).</span></span>
<span id="cb17-747"><a href="#cb17-747" aria-hidden="true" tabindex="-1"></a><span class="in">    -   Swiss Data Cube (SDC): Collection of Sentinel-2/2A and Landsat-8 images for Switzerland.</span></span>
<span id="cb17-748"><a href="#cb17-748" aria-hidden="true" tabindex="-1"></a><span class="in">    -   Terrascope: Cloud service with EO products, which includes the ESA World Cover map.</span></span>
<span id="cb17-749"><a href="#cb17-749" aria-hidden="true" tabindex="-1"></a><span class="in">    -   USGS: Landsat-4/5/7/8/9 collections available in AWS, which require access payment.</span></span>
<span id="cb17-750"><a href="#cb17-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-751"><a href="#cb17-751" aria-hidden="true" tabindex="-1"></a><span class="in">    In addition, `sits` supports the use of Planet monthly mosaics stored as local files. For a detailed description of the providers and collections supported by `sits`, please run `sits_list_collections()`.</span></span>
<span id="cb17-752"><a href="#cb17-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-753"><a href="#cb17-753" aria-hidden="true" tabindex="-1"></a><span class="ot">[^index-2]: </span>For addressing the most problematic uncertainty tasks needing longitudinal analyses of extended timelines (1984-2024), such as disaggregation of wildfire uncertainty and the inter-annual variability of natural disturbances, we recommend practicing data cube operations with Landsat imagery <span class="co">[</span><span class="ot">@ipccReportConferenceParties2012, pp. 847; @ipccChapter2Generic2019, pp. 2.67; @ipcc2013RevisedSupplementary2014, pp. O.9; @unfccc2010report, pp. 17-18</span><span class="co">]</span>.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><a href="https://github.com/training-resource/uncertainty">Source</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/training-resource/uncertainty/edit/main/03-activity-data/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/training-resource/uncertainty/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>